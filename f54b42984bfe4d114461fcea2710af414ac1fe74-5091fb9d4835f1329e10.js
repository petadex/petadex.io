"use strict";(self.webpackChunkgatsby_starter_default=self.webpackChunkgatsby_starter_default||[]).push([[153],{1071:function(t,e,n){n.d(e,{mQ:function(){return i}});n(77936),n(69926),n(65533);var r=n(62769),o=n(27125);const i={molstar_atom_site_operator_mapping:{label_asym_id:o.VP.Schema.Str(),auth_asym_id:o.VP.Schema.Str(),operator_name:o.VP.Schema.Str(),suffix:o.VP.Schema.Str(),assembly_id:o.VP.Schema.Str(),assembly_operator_id:o.VP.Schema.Int(),symmetry_operator_index:o.VP.Schema.Int(),symmetry_hkl:o.VP.Schema.Vector(3),ncs_id:o.VP.Schema.Int()}},s=(t,e)=>void 0===e[t].operator.assembly?o.VP.ValueKinds.NotPresent:o.VP.ValueKinds.Present,a=(t,e)=>-1===e[t].operator.spgrOp?o.VP.ValueKinds.NotPresent:o.VP.ValueKinds.Present;r.c.fields().str("label_asym_id",(t,e)=>e[t].label_asym_id).str("auth_asym_id",(t,e)=>e[t].auth_asym_id).str("operator_name",(t,e)=>e[t].operator.name).str("suffix",(t,e)=>e[t].operator.suffix).str("assembly_id",(t,e)=>{var n;return(null===(n=e[t].operator.assembly)||void 0===n?void 0:n.id)||""},{valueKind:s}).int("assembly_operator_id",(t,e)=>{var n;return(null===(n=e[t].operator.assembly)||void 0===n?void 0:n.operId)||0},{valueKind:s}).int("symmetry_operator_index",(t,e)=>e[t].operator.spgrOp,{valueKind:a}).vec("symmetry_hkl",[(t,e)=>e[t].operator.hkl[0],(t,e)=>e[t].operator.hkl[1],(t,e)=>e[t].operator.hkl[2]],{valueKind:a}).int("ncs_id",(t,e)=>e[t].operator.ncsId,{valueKind:a}).getFields()},1342:function(t,e,n){n.d(e,{Q:function(){return A}});var r=n(54135),o=n(65533),i=n(73868),s=n(13636),a=n(31960),u=n(69926),c=n(38530),l=n(78012),d=n(75847),f=n(64059),m=n(51195),h=n(4543),p=n(14139),g=n(73150),y=n(64096);const _=h.U.diff;function A(t,e){return{kind:"element-loci",structure:t,elements:e}}!function(t){function e(t){for(const e of t.elements)if(o.CD.size(e.indices)>0)return!1;return!0}function n(t){let e=0;for(const{indices:n}of t.elements)e+="number"==typeof n?_(n):n.length;return e}function h(n){return e(n)?n:t(n.structure,[{unit:n.elements[0].unit,indices:o.CD.ofSingleton(o.CD.start(n.elements[0].indices))}])}function A(t){return t.length>3&&o.X9.isRange(t)?o.IX.ofRange(t[0],t[t.length-1]):o.X9.ofSortedArray(t)}function b(e,n){const r=[],i=new Set;for(const t of e.elements)if(S(t))r[r.length]=t;else if(t.unit.kind===u.N.Kind.Atomic){const e=t.unit.elements,s=t.unit.model.atomicHierarchy,{label_alt_id:a}=t.unit.model.atomicHierarchy.atoms,{index:u,offsets:c}=s.residueAtomSegments,l=[],d=t.indices,f=o.CD.size(d);let m=0;for(;m<f;){i.clear();const t=e[o.CD.getAt(d,m)],r=u[t];for(i.add(a.value(t)),m++;m<f;){const t=e[o.CD.getAt(d,m)];if(u[t]!==r)break;i.add(a.value(t)),m++}const s=i.has("");for(let u=c[r],d=c[r+1];u<d;u++){const t=o.CD.indexOf(e,u);if(t>=0){const e=a.value(u);n&&!s&&e&&!i.has(e)||(l[l.length]=t)}}}r[r.length]={unit:t.unit,indices:A(l)}}else r[r.length]=t;return t(e.structure,r)}function C(t){switch(t.kind){case u.N.Kind.Atomic:return t.model.atomicHierarchy.chainAtomSegments;case u.N.Kind.Spheres:return t.model.coarseHierarchy.spheres.chainElementSegments;case u.N.Kind.Gaussians:return t.model.coarseHierarchy.gaussians.chainElementSegments}}function S(t){return t.unit.elements.length===o.CD.size(t.indices)}function x(t,e,n){const{index:r}=C(t),i=t.elements;let s=0;for(let o=0,u=i.length;o<u;o++){const t=r[i[o]];e.has(t)&&s++}if(s===t.elements.length)return void(n[n.length]={unit:t,indices:o.IX.ofBounds(0,s)});const a=new Int32Array(s);s=0;for(let o=0,u=i.length;o<u;o++){const t=r[i[o]];e.has(t)&&(a[s++]=o)}a.length>0&&(n[n.length]={unit:t,indices:A(a)})}function v(t,e,n,r,i){const{index:s}=C(t.elements[0].unit),a=new Set;for(let u=e;u<n;u++){const e=t.elements[u],n=e.indices,r=e.unit.elements;for(let t=0,i=o.CD.size(n);t<i;t++)a.add(s[r[o.CD.getAt(n,t)]])}if(r){const e=t.elements[0].unit;for(const n of t.structure.units)u.N.areSameChainOperatorGroup(n,e)&&x(n,a,i)}else for(let o=e;o<n;o++)x(t.elements[o].unit,a,i)}function B(e){const n=[];for(let t=0,r=e.elements.length;t<r;t++){const o=e.elements[t];if(u.N.Traits.is(o.unit.traits,u.N.Trait.Partitioned)){const i=t;for(;t<r&&u.N.areSameChainOperatorGroup(e.elements[t].unit,o.unit);)t++;const s=t;t--,v(e,i,s,!0,n)}else S(o)?n[n.length]=o:v(e,t,t+1,!1,n)}return t(e.structure,n)}function I(t){return`${t.unit.model.id}|${f.Z.entity.id(t)}`}function w(t,e){const n=[];for(let r=0,i=o.CD.size(e);r<i;++r)n.push(t[o.CD.getAt(e,r)]);return o.X9.ofSortedArray(n)}function P(t,e){return o.X9.isRange(t)&&o.X9.areEqual(t,e)?o.IX.ofLength(t.length):A(o.X9.indicesOf(t,e))}t.is=function(t){return!!t&&"element-loci"===t.kind},t.areEqual=function(t,e){if(t.structure!==e.structure)return!1;if(t.elements.length!==e.elements.length)return!1;for(let n=0,r=t.elements.length;n<r;++n){const r=t.elements[n],i=e.elements[n];if(r.unit.id!==i.unit.id)return!1;if(!o.CD.areEqual(r.indices,i.indices))return!1}return!0},t.isEmpty=e,t.isWholeStructure=function(t){return n(t)===t.structure.elementCount},t.size=n,t.all=function(e){return t(e,e.units.map(t=>({unit:t,indices:o.CD.ofBounds(0,t.elements.length)})))},t.none=function(e){return t(e,[])},t.fromExpression=function(t,e,n){let r;r="function"==typeof e?e(s.J):e;const o=(0,p.wE)(r)(null!=n?n:new g.cY(t));return g.cv.toLociWithSourceUnits(o)},t.fromQuery=function(t,e,n){const r=e(null!=n?n:new g.cY(t));return g.cv.toLociWithSourceUnits(r)},t.fromSchema=function(t,e,n){return y.S.toLoci(t,e,n)},t.getFirstLocation=function(t,n){if(e(t))return;const r=t.elements[0].unit,i=r.elements[o.CD.getAt(t.elements[0].indices,0)];return n?(n.structure=t.structure,n.unit=t.elements[0].unit,n.element=i,n):l.a.create(t.structure,r,i)},t.firstElement=h,t.firstResidue=function(t){return e(t)?t:b(h(t))},t.firstChain=function(t){return e(t)?t:B(h(t))},t.toStructure=function(t){const e=[];for(const n of t.elements){const{unit:t,indices:r}=n,i=new Int32Array(o.CD.size(r));o.CD.forEach(r,(e,n)=>i[n]=t.elements[e]),e.push(t.getChild(o.X9.ofSortedArray(i)))}return a.o.create(e,{parent:t.structure.parent})},t.forEachLocation=function(e,n,r){if(t.isEmpty(e))return;const i=r||l.a.create(e.structure);i.structure=e.structure;for(const t of e.elements){const{unit:e,indices:r}=t;i.unit=e;const{elements:s}=t.unit;for(let t=0,a=o.CD.size(r);t<a;t++)i.element=s[o.CD.getAt(r,t)],n(i)}},t.remap=function(e,n){if(n===e.structure)return e;const r=[];return e.elements.forEach(t=>{if(!n.unitMap.has(t.unit.id))return;const e=n.unitMap.get(t.unit.id),i=o.CD.indexedIntersect(t.indices,t.unit.elements,e.elements);o.CD.size(i)>0&&r.push({unit:e,indices:i})}),t(n,r)},t.union=function e(n,r){if(n.elements.length>r.elements.length)return e(r,n);if(t.isEmpty(n))return r;const i=new Map;for(const t of n.elements)i.set(t.unit.id,t.indices);const s=[];for(const t of r.elements)i.has(t.unit.id)?(s[s.length]={unit:t.unit,indices:o.CD.union(i.get(t.unit.id),t.indices)},i.delete(t.unit.id)):s[s.length]=t;return i.forEach((t,e)=>{s[s.length]={unit:n.structure.unitMap.get(e),indices:t}}),t(n.structure,s)},t.subtract=function(e,n){const r=new Map;for(const t of n.elements)r.set(t.unit.id,t.indices);const i=[];for(const t of e.elements)if(r.has(t.unit.id)){const e=o.CD.subtract(t.indices,r.get(t.unit.id));if(0===o.CD.size(e))continue;i[i.length]={unit:t.unit,indices:e}}else i[i.length]=t;return t(e.structure,i)},t.intersect=function(e,n){const r=new Map;for(const t of e.elements)r.set(t.unit.id,t.indices);const i=[];for(const t of n.elements){if(!r.has(t.unit.id))continue;const e=o.CD.intersect(r.get(t.unit.id),t.indices);0!==o.CD.size(e)&&(i[i.length]={unit:t.unit,indices:e})}return t(e.structure,i)},t.areIntersecting=function e(n,r){if(n.elements.length>r.elements.length)return e(r,n);if(t.isEmpty(n))return t.isEmpty(r);const i=new Map;for(const t of n.elements)i.set(t.unit.id,t.indices);for(const t of r.elements)if(i.has(t.unit.id)&&o.CD.areIntersecting(i.get(t.unit.id),t.indices))return!0;return!1},t.isSubset=function(e,n){if(t.isEmpty(e))return t.isEmpty(n);const r=new Map;for(const t of e.elements)r.set(t.unit.id,t.indices);let i=!1;for(const t of n.elements){if(!r.has(t.unit.id))return!1;if(!o.CD.isSubset(r.get(t.unit.id),t.indices))return!1;i=!0}return i},t.extendToWholeResidues=b,t.extendToWholeChains=B,t.extendToWholeEntities=function(e){const n=[],r=l.a.create(e.structure),i=new Set,{units:s}=e.structure;for(let t=0,o=e.elements.length;t<o;t++){const n=e.elements[t];r.unit=n.unit,r.element=n.unit.elements[0],i.add(I(r))}for(let t=0,a=s.length;t<a;++t){const e=s[t];if(r.unit=e,r.element=e.elements[0],i.has(I(r))){const t=o.CD.ofBounds(0,e.elements.length);n[n.length]={unit:e,indices:t}}}return t(e.structure,n)},t.extendToWholeModels=function(e){const n=[],r=new Set,{units:i}=e.structure;for(let t=0,o=e.elements.length;t<o;t++){const n=e.elements[t];r.add(n.unit.model.id)}for(let t=0,s=i.length;t<s;++t){const e=i[t];if(r.has(e.model.id)){const t=o.CD.ofBounds(0,e.elements.length);n[n.length]={unit:e,indices:t}}}return t(e.structure,n)},t.extendToAllInstances=function(e){const n=[],r=new Map;for(let t=0,i=e.elements.length;t<i;t++){const n=e.elements[t],{model:i}=n.unit,s=w(n.unit.elements,n.indices);r.has(i)?r.set(i,o.X9.union(s,r.get(i))):r.set(i,s)}for(let t=0,i=e.structure.units.length;t<i;++t){const i=e.structure.units[t],s=r.get(i.model);if(!s)continue;const a=P(i.elements,s);o.CD.size(a)&&(n[n.length]={unit:i,indices:a})}return t(e.structure,n)},t.extendToWholeOperators=function(e){const n=[],r=new Set,{units:i}=e.structure;for(let t=0,o=e.elements.length;t<o;t++){const n=e.elements[t];r.add(n.unit.conformation.operator.name)}for(let t=0,s=i.length;t<s;++t){const e=i[t];if(r.has(e.conformation.operator.name)){const t=o.CD.ofBounds(0,e.elements.length);n[n.length]={unit:e,indices:t}}}return t(e.structure,n)};const D=new m.Z("98"),M=(0,i.eB)();t.getBoundary=function(t,e,n){D.reset();for(const r of t.elements){const{indices:t}=r,{elements:n,conformation:s}=r.unit;for(let r=0,a=o.CD.size(t);r<a;r++){const a=n[o.CD.getAt(t,r)];s.position(a,M),e&&i.eB.transformMat4(M,M,e),D.includePositionRadius(M,s.r(a))}}D.finishedIncludeStep();for(const r of t.elements){const{indices:t}=r,{elements:n,conformation:s}=r.unit;for(let r=0,a=o.CD.size(t);r<a;r++){const a=n[o.CD.getAt(t,r)];s.position(a,M),e&&i.eB.transformMat4(M,M,e),D.radiusPositionRadius(M,s.r(a))}}return n?(n.box&&D.getBox(n.box),n.sphere&&D.getSphere(n.sphere),n):{box:D.getBox(),sphere:D.getSphere()}};const N=(0,i.eB)();function E(t,e,n=0){let r=n;for(const s of t.elements){const{indices:t}=s,{elements:n,conformation:a}=s.unit,u=o.CD.size(t);for(let s=0;s<u;s++){const u=n[o.CD.getAt(t,s)];a.position(u,N),i.eB.toArray(N,e,r+3*s)}r+=3*u}return e}function k(t,e){return u.N.isAtomic(t)?t.model.atomicHierarchy.atomSourceIndex.value(e):e}function T(t,e,n,r,o){(0,c.eh)(e);const i=[],s=[];let a=0;const u=e.length;for(;a<u;){const t=a;for(a++;a<u&&e[a-1]+1===e[a];)a++;const n=a;if(n-t>12)i[i.length]=e[t],i[i.length]=e[n-1];else for(let r=t;r<n;r++)s[s.length]=e[r]}return n?{atom:{set:s,ranges:i},chain:{opName:[t]},entity:{modelLabel:r,modelIndex:o}}:{atom:{set:s,ranges:i},chain:{opName:[t]}}}t.toPositionsArray=E,t.getPrincipalAxes=function(t){const e=n(t),r=E(t,new Float32Array(3*e));return d.c.ofPositions(r)},t.getPrincipalAxesMany=function(t){let e=0;t.forEach(t=>{e+=n(t)});const r=new Float32Array(3*e);let o=0;return t.forEach(t=>{E(t,r,o),o+=3*n(t)}),d.c.ofPositions(r)},t.toExpression=function(e){if(t.isEmpty(e))return s.J.struct.generator.empty();const n=e.structure.models,i=new Map;for(const t of e.elements){const{indices:e}=t,{elements:n}=t.unit,s=t.unit.conformation.operator.name;let a;i.has(s)?a=i.get(s).xs:(a=r.th.create(),i.set(s,{modelLabel:t.unit.model.label,modelIndex:t.unit.model.modelNum,xs:a}));for(let i=0,u=o.CD.size(e);i<u;i++){const s=k(t.unit,n[o.CD.getAt(e,i)]);r.th.add(a,s,s)}}const a=[],u=i.keys();for(;;){const t=u.next();if(t.done)break;const e=i.get(t.value);a.push(T(t.value,e.xs.array,n.length>1,e.modelLabel,e.modelIndex))}const l=new Map;for(let t=0,r=a.length;t<r;++t){const e=a[t],n=`${(0,c.vb)((0,c.TI)(e.atom.ranges),(0,c.TI)(e.atom.set))}|${e.entity?e.entity.modelLabel+e.entity.modelIndex:""}`;l.has(n)?l.get(n).chain.opName.push(...e.chain.opName):l.set(n,e)}const d=[];return l.forEach(t=>{const{ranges:e,set:n}=t.atom,{opName:r}=t.chain,o=s.J.struct.atomProperty.core.operatorName(),i=s.J.struct.atomProperty.core.sourceIndex(),a=[];n.length>0&&(a[a.length]=s.J.core.set.has([s.J.core.type.set(n),i]));for(let u=0,c=e.length/2;u<c;u++)a[a.length]=s.J.core.rel.inRange([i,e[2*u],e[2*u+1]]);if(t.entity){const{modelLabel:e,modelIndex:n}=t.entity;d.push(s.J.struct.generator.atomGroups({"atom-test":a.length>1?s.J.core.logic.or(a):a[0],"chain-test":r.length>1?s.J.core.set.has([s.J.core.type.set(r),o]):s.J.core.rel.eq([o,r[0]]),"entity-test":s.J.core.logic.and([s.J.core.rel.eq([s.J.struct.atomProperty.core.modelLabel(),e]),s.J.core.rel.eq([s.J.struct.atomProperty.core.modelIndex(),n])])}))}else d.push(s.J.struct.generator.atomGroups({"atom-test":a.length>1?s.J.core.logic.or(a):a[0],"chain-test":r.length>1?s.J.core.set.has([s.J.core.type.set(r),o]):s.J.core.rel.eq([o,r[0]])}))}),s.J.struct.modifier.union([1===d.length?d[0]:s.J.struct.combinator.merge(d.map(t=>s.J.struct.modifier.union([t])))])}}(A||(A={}))},2007:function(t,e,n){n.d(e,{n:function(){return o}});var r=n(73868);function o(){return o.empty()}!function(t){function e(){return{origin:(0,r.eB)(),dirA:(0,r.eB)(),dirB:(0,r.eB)(),dirC:(0,r.eB)()}}function n(t,e){return r.eB.copy(t.origin,e.origin),r.eB.copy(t.dirA,e.dirA),r.eB.copy(t.dirB,e.dirB),r.eB.copy(t.dirC,e.dirC),t}function o(t,e){return r.eB.set(t,2*r.eB.magnitude(e.dirA),2*r.eB.magnitude(e.dirB),2*r.eB.magnitude(e.dirC))}t.create=function(t,e,n,r){return{origin:t,dirA:e,dirB:n,dirC:r}},t.empty=e,t.copy=n,t.clone=function(t){return n(e(),t)},t.size=o;const i=(0,r.eB)();t.volume=function(t){return o(i,t),i[0]*i[1]*i[2]},t.normalize=function(t,e){return r.eB.copy(t.origin,e.origin),r.eB.normalize(t.dirA,e.dirA),r.eB.normalize(t.dirB,e.dirB),r.eB.normalize(t.dirC,e.dirC),t};const s=(0,r.U)();t.transform=function(t,e,n){r.eB.transformMat4(t.origin,e.origin,n);const o=r.U.directionTransform(s,n);return r.eB.transformMat3(t.dirA,e.dirA,o),r.eB.transformMat3(t.dirB,e.dirB,o),r.eB.transformMat3(t.dirC,e.dirC,o),t},t.scale=function(t,e,n){return r.eB.scale(t.dirA,e.dirA,n),r.eB.scale(t.dirB,e.dirB,n),r.eB.scale(t.dirC,e.dirC,n),t}}(o||(o={}))},3108:function(t,e,n){n.d(e,{Dt:function(){return l},HQ:function(){return u},Ju:function(){return s}});var r=n(52500),o=n(73868),i=n(77936);function s(t,e){switch(t.kind){case i.Nf.Kind.Atomic:return t.model.atomicHierarchy.derived.residue.moleculeType[t.residueIndex[e]];case i.Nf.Kind.Spheres:case i.Nf.Kind.Gaussians:const n=function(t,e){const n=t.coarseElements.entityKey[e],r=t.model.sequence.byEntityKey[n].sequence,o=t.coarseElements.seq_id_begin.value(e);return r.compId.value(o-1)}(t,e),o=t.model.properties.chemicalComponentMap.get(n);if(o)return(0,r.RN)(o.type,n)}return r.HX.Unknown}const a=new Set;function u(t,e){const n=r.Pt[t];if(void 0!==n){const t=n[e];if(void 0!==t)return t}return a}const c=o.eB.zero();function l(t,e){const n=t.conformation,r=new Float32Array(3*e.length),{elements:i}=t;for(let s=0,a=e.length;s<a;++s)n.position(i[e[s]],c),o.eB.toArray(c,r,3*s);return r}},3627:function(t,e,n){n.d(e,{AN:function(){return c}});var r=n(45010),o=n(75301),i=n(68223),s=n(62683),a=n(82346);const u={"@header":"Internal Queries",generator:{"@header":"Generators",bundleElement:(0,a.HR)(s.d3.Dictionary({groupedUnits:(0,s.ef)(i.Z.Any),set:(0,s.ef)(i.Z.Any),ranges:(0,s.ef)(i.Z.Any)}),i.Z.Any),bundle:(0,a.HR)(s.d3.Dictionary({elements:(0,s.ef)(i.Z.Any)}),o.O.ElementSelectionQuery,"A selection with single structure containing represented by the bundle."),current:(0,a.HR)(s.d3.None,o.O.ElementSelectionQuery,"Current selection provided by the query context. Avoid using this in State Transforms.")}},c={core:r.I8,structureQuery:o.q,internal:u};(0,a.ec)(c);const l=(0,a.br)(c);!function(){const t=Object.create(null);for(const e of l)t[e.id]=e}()},4543:function(t,e,n){n.d(e,{U:function(){return r}});var r,o=n(38530);!function(t){t.Zero=0;const{_int32:e,_float64:n,_int32_1:r,_float64_1:i}=function(){const t=new ArrayBuffer(8),e=new ArrayBuffer(8);return{_int32:new Int32Array(t),_float64:new Float64Array(t),_int32_1:new Int32Array(e),_float64_1:new Float64Array(e)}}();t.is=function(t){return"number"==typeof t},t.create=function(t,r){return e[0]=t,e[1]=r,n[0]},t.diff=function(t){return n[0]=t,e[1]-e[0]},t.fst=function(t){return n[0]=t,e[0]},t.snd=function(t){return n[0]=t,e[1]},t.areEqual=function(t,o){return n[0]=t,i[0]=o,e[0]===r[0]&&e[1]===r[1]},t.compare=function(t,o){n[0]=t,i[0]=o;const s=e[0]-r[0];return 0!==s?s:e[1]-r[1]},t.compareInArray=function(t,o,s){n[0]=t[o],i[0]=t[s];const a=e[0]-r[0];return 0!==a?a:e[1]-r[1]},t.hashCode=function(t){return n[0]=t,(0,o.vb)(e[0],e[1])},t.toString=function(t){return n[0]=t,`(${e[0]}, ${e[1]})`}}(r||(r={}))},5772:function(t,e,n){n.d(e,{_F:function(){return i},qk:function(){return s},tM:function(){return r}});var r,o=n(24832);function i(t){return{data:t,position:0,length:t.length,lineNumber:1,tokenStart:0,tokenEnd:0}}function s(t,e,n){let r=e,o=n-1,i=t.charCodeAt(r);for(;(9===i||32===i)&&r<=o;)i=t.charCodeAt(++r);for(i=t.charCodeAt(o);(9===i||32===i)&&o>=r;)i=t.charCodeAt(--o);return t.substring(r,o+1)}!function(t){function e(t){return t.data.substring(t.tokenStart,t.tokenEnd)}function n(t){const{data:e}=t;for(;t.position<t.length;)switch(e.charCodeAt(t.position)){case 10:return t.tokenEnd=t.position,++t.position,++t.lineNumber,!0;case 13:return t.tokenEnd=t.position,++t.position,++t.lineNumber,10===e.charCodeAt(t.position)&&++t.position,!0;default:++t.position}return t.tokenEnd=t.position,t.tokenStart!==t.tokenEnd}function i(t){return t.tokenStart=t.position,n(t)}function s(t,e,n){let o=0;for(let s=0;s<e;s++){if(!i(t))return o;r.addUnchecked(n,t.tokenStart,t.tokenEnd),o++}return o}function a(t,e,n){const{data:r}=t;let o=e,i=n-1,s=r.charCodeAt(o);for(;(9===s||32===s)&&o<=i;)s=r.charCodeAt(++o);for(s=r.charCodeAt(i);(9===s||32===s)&&i>=o;)s=r.charCodeAt(--i);return t.tokenStart=o,t.tokenEnd=i+1,t.position=n,t}t.getTokenString=e,t.reset=function(t){t.position=0,t.lineNumber=1,t.tokenStart=0,t.tokenEnd=0},t.eatLine=n,t.markStart=function(t){t.tokenStart=t.position},t.markLine=i,t.readLine=function(t){return i(t),e(t)},t.readLineTrim=function(t){i(t);const n=t.position;return a(t,t.tokenStart,t.tokenEnd),t.position=n,e(t)},t.markLines=function(t,e){const n=r.create(t.data,2*e);return s(t,e,n),n},t.readLines=function(e,n){const r=[];for(let o=0;o<n;o++)r.push(t.readLine(e));return r},t.readLinesAsync=async function(t,e,n,i=1e5){const a=r.create(t.data,2*e);let u=0;return await(0,o.yB)(n,i,t,(t,n)=>{const r=Math.min(e-u,t);return s(n,r,a),u+=r,r},(t,e)=>t.update({message:"Parsing...",current:e.position,max:e.length})),a},t.readAllLines=function(e){const n=t(e),o=r.create(n.data,Math.max(e.length/80,2));for(;i(n);)r.add(o,n.tokenStart,n.tokenEnd);return o},t.readAllLinesAsync=async function(e,n,s=1e5){const a=t(e),u=r.create(a.data,Math.max(e.length/80,2));return await(0,o.yB)(n,s,a,(t,e)=>(function(t,e,n){let o=0;for(let s=0;s<e;s++){if(!i(t))return o;r.add(n,t.tokenStart,t.tokenEnd),o++}}(e,t,u),e.position<e.length?t:0),(t,e)=>t.update({message:"Parsing...",current:e.position,max:e.length})),u},t.eatValue=function(t){for(;t.position<t.length;)switch(t.data.charCodeAt(t.position)){case 9:case 10:case 13:case 32:return void(t.tokenEnd=t.position);default:++t.position}t.tokenEnd=t.position},t.skipWhitespace=function(t){let e=-1;for(;t.position<t.length;){const n=t.data.charCodeAt(t.position);switch(n){case 9:case 32:e=n,++t.position;break;case 10:13!==e&&++t.lineNumber,e=n,++t.position;break;case 13:e=n,++t.position,++t.lineNumber;break;default:return e}}return e},t.skipStrictWhitespace=function(t){let e=-1;for(;t.position<t.length;){const n=t.data.charCodeAt(t.position);switch(n){case 9:case 32:e=n,++t.position;break;default:return e}}return e},t.trim=a}(i||(i={})),function(t){function e(t,e,n){const r=t;r.offset>r.indicesLenMinus2&&function(t){const e=new Uint32Array(1.61*t.indices.length|0);e.set(t.indices),t.indices=e,t.indicesLenMinus2=e.length-2|0}(r),r.indices[r.offset++]=e,r.indices[r.offset++]=n,t.count++}t.add=e,t.addToken=function(t,n){e(t,n.tokenStart,n.tokenEnd)},t.addUnchecked=function(t,e,n){t.indices[t.offset++]=e,t.indices[t.offset++]=n,t.count++},t.create=function(t,e){return{data:t,indicesLenMinus2:(e=Math.max(10,e))-2|0,count:0,offset:0,indices:new Uint32Array(e)}}}(r||(r={}))},7548:function(t,e,n){n.d(e,{Z:function(){return o}});var r=n(35695);function o(){return o.zero()}!function(t){function e(){const t=[.1,0,0,0];return t[0]=0,t}function n(t,e){return t[0]=e.center[0],t[1]=e.center[1],t[2]=e.center[2],t[3]=e.radius,t}t.zero=e,t.clone=function(t){const n=e();return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n},t.create=function(t,n,r,o){const i=e();return i[0]=t,i[1]=n,i[2]=r,i[3]=o,i},t.fromSphere=n,t.ofSphere=function(t){return n(e(),t)},t.hasNaN=function(t){return Number.isNaN(t[0])||Number.isNaN(t[1])||Number.isNaN(t[2])||Number.isNaN(t[3])},t.toArray=function(t,e,n){return e[n+0]=t[0],e[n+1]=t[1],e[n+2]=t[2],e[n+3]=t[3],e},t.fromArray=function(t,e,n){return t[0]=e[n+0],t[1]=e[n+1],t[2]=e[n+2],t[3]=e[n+3],t},t.toVec3Array=function(t,e,n){e[n+0]=t[0],e[n+1]=t[1],e[n+2]=t[2]},t.fromVec3Array=function(t,e,n){return t[0]=e[n+0],t[1]=e[n+1],t[2]=e[n+2],t[3]=0,t},t.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.set=function(t,e,n,r,o){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t},t.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},t.distance=function(t,e){const n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2],i=e[3]-t[3];return Math.sqrt(n*n+r*r+o*o+i*i)},t.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[4]=e[4]*n,t},t.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},t.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},t.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},t.squaredDistance=function(t,e){const n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2],i=e[3]-t[3];return n*n+r*r+o*o+i*i},t.norm=function(t){const e=t[0],n=t[1],r=t[2],o=t[3];return Math.sqrt(e*e+n*n+r*r+o*o)},t.squaredNorm=function(t){const e=t[0],n=t[1],r=t[2],o=t[3];return e*e+n*n+r*r+o*o},t.transformMat4=function(t,e,n){const r=e[0],o=e[1],i=e[2],s=e[3];return t[0]=n[0]*r+n[4]*o+n[8]*i+n[12]*s,t[1]=n[1]*r+n[5]*o+n[9]*i+n[13]*s,t[2]=n[2]*r+n[6]*o+n[10]*i+n[14]*s,t[3]=n[3]*r+n[7]*o+n[11]*i+n[15]*s,t},t.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},t.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},t.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},t.equals=function(t,e){const n=t[0],o=t[1],i=t[2],s=t[3],a=e[0],u=e[1],c=e[2],l=e[3];return Math.abs(n-a)<=r.p*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(o-u)<=r.p*Math.max(1,Math.abs(o),Math.abs(u))&&Math.abs(i-c)<=r.p*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(s-l)<=r.p*Math.max(1,Math.abs(s),Math.abs(l))},t.toString=function(t,e){return`[${t[0].toPrecision(e)} ${t[1].toPrecision(e)} ${t[2].toPrecision(e)}  ${t[3].toPrecision(e)}]`}}(o||(o={}))},8429:function(t,e,n){n.d(e,{P:function(){return r}});class r{getFrameAtIndex(t){return this.frames[t]}constructor(t){this.frames=t,this.frameCount=t.length,this.representative=t[0],this.duration=t.length}}},9058:function(t,e,n){n.d(e,{_:function(){return i}});const r="undefined"!=typeof setImmediate?"undefined"!=typeof window?{setImmediate:(t,...e)=>window.setImmediate(t,...e),clearImmediate:t=>window.clearImmediate(t)}:{setImmediate:setImmediate,clearImmediate:clearImmediate}:function(){const t=function(){const t="undefined"!=typeof window&&window,e="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,r=void 0!==n.g&&n.g;return t||r||e}(),e={},r="undefined"!=typeof document?document:void 0;let o,i=1;function s(t){delete e[t]}function a(t){const n=e[t];s(t),function(t){const e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(n)}return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?o=function(t){process.nextTick(function(){a(t)})}:function(){if(t&&t.postMessage&&!t.importScripts){let e=!0;const n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?function(){const e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&a(+n.data.slice(e.length))};window.addEventListener?window.addEventListener("message",n,!1):window.attachEvent("onmessage",n),o=function(t){window.postMessage(e+t,"*")}}():"undefined"!=typeof MessageChannel?function(){const t=new MessageChannel;t.port1.onmessage=function(t){a(t.data)},o=function(e){t.port2.postMessage(e)}}():r&&"onreadystatechange"in r.createElement("script")?function(){const t=r.documentElement;o=function(e){let n=r.createElement("script");n.onreadystatechange=function(){a(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():o=function(t){setTimeout(a,0,t)},{setImmediate:function(t,...n){"function"!=typeof t&&(t=new Function(""+t));const r={callback:t,args:n};return e[i]=r,o(i),i++},clearImmediate:s}}();function o(t){r.setImmediate(t)}const i={setImmediate:r.setImmediate,clearImmediate:r.clearImmediate,immediatePromise(){return new Promise(o)},delay(t,e=void 0){return new Promise(n=>setTimeout(n,t,e))}}},9239:function(t,e,n){n.d(e,{gn:function(){return K},dZ:function(){return d},kD:function(){return q},MQ:function(){return M}});var r,o=n(77936),i=n(52500),s=n(65533),a=n(33565),u=n(40319),c=n(69926),l=n(77866);!function(t){t.Empty=u.O.create([],[],[],0,{flags:[],order:[],key:[]})}(r||(r={}));class d extends l.Z{getBondFromLocation(t){return c.N.isAtomic(t.aUnit)&&c.N.isAtomic(t.bUnit)?this.getEdge(t.aIndex,t.aUnit.id,t.bIndex,t.bUnit.id):void 0}getBondIndexFromLocation(t){return c.N.isAtomic(t.aUnit)&&c.N.isAtomic(t.bUnit)?this.getEdgeIndex(t.aIndex,t.aUnit.id,t.bIndex,t.bUnit.id):-1}}!function(t){class e extends l.Z.UnitPairEdges{}t.UnitPairBonds=e}(d||(d={}));var f=n(58637),m=n(38818),h=n(94901),p=n(63729),g=n(71460),y=n(73868),_=n(35695),A=n(21544),b=n(38530);const C=y.eB.distance,S=6,x=5.5,v=3.9;function B(t,e,n,r,o,i,s){const a=new u.O.EdgeBuilder(i,t,e),c=new Uint16Array(a.slotCount),l=new Int8Array(a.slotCount),d=new Uint32Array(a.slotCount);for(let u=0,f=a.edgeCount;u<f;u++)a.addNextEdge(),a.assignProperty(c,r[u]),a.assignProperty(l,n[u]),a.assignProperty(d,o[u]);return a.createGraph({flags:c,order:l,key:d},s)}const I=(0,y.eB)(),w=(0,y.eB)();function P(t,e,n){return t.conformation.position(e,I),t.conformation.position(n,w),C(I,w)}const D=new Set;function M(t,e){const n={...f.kD,...e};return n.noCompute||t.elements.length<=1?r.Empty:!n.forceCompute&&h.z.Provider.get(t.model)?function(t){if(-1===t.conformation.operator.key)return!1;const e=h.z.Provider.get(t.model);return!!(null==e?void 0:e.hasOperators)}(t)?function(t){const e=h.z.Provider.get(t.model),n=e.bySameOperator.get(t.conformation.operator.key);if(!n)return r.Empty;const{a:o,b:i,edgeProps:{key:a,flag:u,order:c}}=e.bonds,{invertedIndex:l}=A.K.getInvertedAtomSourceIndex(t.model),{elements:d}=t,f=[],m=[],p=[],g=[],y=[];for(let r=0,h=n.length;r<h;++r){const t=n[r];if(o[t]>=i[t])continue;const e=l[o[t]],h=s.X9.indexOf(d,e);if(h<0)continue;const _=l[i[t]],A=s.X9.indexOf(d,_);A<0||(f[f.length]=h,m[m.length]=A,p[p.length]=u[t],g[g.length]=c[t],y[y.length]=a[t])}return B(f,m,g,p,y,d.length,{canRemap:!1,cacheable:e.cacheable})}(t):function(t){const e=h.z.Provider.get(t.model),{elements:n}=t,{type_symbol:r}=t.model.atomicHierarchy.atoms,o=t.elements.length,{maxDistance:i}=e,{offset:a,b:u,edgeProps:{order:c,distance:l,flag:d,key:m,operatorA:p,operatorB:g}}=e.bonds,{atomSourceIndex:y}=t.model.atomicHierarchy,{invertedIndex:b}=A.K.getInvertedAtomSourceIndex(t.model),C=[],S=[],x=[],v=[],I=[],w=t.conformation.operator.key;for(let h=0;h<o;h++){const e=n[h],o=(0,f.Yd)(r.value(e)),A=(0,f.v3)(o),B=y.value(e);for(let n=a[B],y=a[B+1];n<y;++n){const a=b[u[n]];if(e>=a)continue;const y=s.X9.indexOf(t.elements,a);if(y<0)continue;const B=p[n],D=g[n];if(B>=0&&B!==w||D>=0&&D!==w)continue;const M=(0,f.Yd)(r.value(a)),N=l[n],E=P(t,e,a);let k=!1;N>=0?k=(0,_.T)(E,N,.3):i>=0?k=E<i:(k=E<(0,f.on)(o,M,(0,f.O6)(o),(0,f.O6)(M)),A&&(0,f.v3)(M)&&(k=!1)),k&&(C[C.length]=h,S[S.length]=y,v[v.length]=c[n],x[x.length]=d[n],I[I.length]=m[n])}}return B(C,S,v,x,I,o,{canRemap:!1,cacheable:e.cacheable})}(t):function(t,e){const n=A.K.isCoarseGrained(t.model),r=n?S:e.maxRadius,{x:o,y:a,z:u}=t.model.atomicConformation,c=t.elements.length,{elements:l,residueIndex:d,chainIndex:h}=t,{type_symbol:y,label_atom_id:_,label_alt_id:C,label_comp_id:I}=t.model.atomicHierarchy.atoms,{label_seq_id:w}=t.model.atomicHierarchy.residues,{traceElementIndex:P}=t.model.atomicHierarchy.derived.residue,{index:M}=t.model.atomicHierarchy,{byEntityKey:N}=t.model.sequence,E=t.lookup3d,k=g.A.Provider.get(t.model),T=p.X.Provider.get(t.model),R=g.A.isExhaustive(t.model),U=[],H=[],O=[],F=[],G=[];let L,V=-1,Z=!0,q=!0,K=!0;const X=D,Y=!!(null==k?void 0:k.residueCantorPairs.size);for(let p=0;p<c;p++){const c=l[p],g=y.value(c);Z&&"H"!==g&&"O"!==g&&(Z=!1);const A=e.forceCompute?void 0:k&&k.byAtomIndex.get(c);let S=!1;if(A)for(const e of A){const{partnerA:n,partnerB:r}=e;if(n.symmetry!==r.symmetry)continue;const o=n.atomIndex===c?r:n,i=s.X9.indexOf(t.elements,o.atomIndex);i<0||l[i]<c||(U[U.length]=p,H[H.length]=i,O[O.length]=e.flags,F[F.length]=e.order,G[G.length]=e.rowIndex,S||X.clear(),S=!0,X.add(i))}if(R)continue;const B=d[c],D=w.value(B),z=I.value(c);if(!e.forceCompute&&B!==V)if(T&&T.entries.has(z)){const t=N[M.getEntityFromChain(h[c])];L=t&&t.sequence.microHet.has(D)?void 0:T.entries.get(z).map}else L=void 0;V=B;const $=(0,f.Yd)(g),W=_.value(c),Q=L?L.get(W):void 0,{indices:j,count:J,squaredDistances:tt}=E.find(o[c],a[c],u[c],r),et=(0,f.v3)($),nt=(0,f.O6)($),rt=C.value(c),ot=f.ZL.has($);for(let t=0;t<J;t++){const e=j[t];if(S&&X.has(e))continue;const r=l[e];if(r<=c)continue;const o=C.value(r);if(rt&&o&&rt!==o)continue;if(Y){const t=(0,b.bd)(d[c],d[r]);if(k.residueCantorPairs.has(t))continue}const s=(0,f.Yd)(y.value(r)),a=(0,f.v3)(s);if(et&&a)continue;const u=(ot||f.ZL.has(s))&&!(et||a),h=d[r];if(B===h&&Q){const t=Q.get(_.value(r));if(t){U[U.length]=p,H[H.length]=e,F[F.length]=t.order;let n=t.flags;u&&(n|i.I$.Flag.Covalent&&(n^=i.I$.Flag.Covalent),n|=i.I$.Flag.MetallicCoordination),O[O.length]=n,G[G.length]=t.key}continue}const g=Math.sqrt(tt[t]);if(0===g)continue;let A=!1;if(A=n?B===h?g<=x:g<=v&&P[B]===c&&P[h]===r:g<=(0,f.on)($,s,nt,(0,f.O6)(s)),A){U[U.length]=p,H[H.length]=e,F[F.length]=(0,m.e)(z,W,_.value(r)),O[O.length]=(u?i.I$.Flag.MetallicCoordination:i.I$.Flag.Covalent)|i.I$.Flag.Computed,G[G.length]=-1;const t=w.value(h);D===t&&(q=!1),Math.abs(D-t)>1&&(K=!1)}}}return B(U,H,F,O,G,c,{canRemap:Z||q&&K})}(t,n)}var N=n(31960),E=n(10486);const k=y.eB.distance,T=y.eB.set,R=y.eB.squaredDistance,U=y.eB.transformMat4,H=(0,y.eB)(),O=(0,y.eB)();function F(t,e,n,r){return t.conformation.position(e,H),n.conformation.position(r,O),k(H,O)}const G=(0,y.$I)(),L=(0,y.eB)();const V={...f.kD,ignoreWater:!0,ignoreIon:!0};function Z(t,e){const n=new l.Z.Builder,r=t.models.some(t=>h.z.Provider.get(t)),o=t.models.some(t=>g.A.isExhaustive(t));return e.noCompute||t.isCoarseGrained&&!r&&!o?new d(n.getMap()):!e.forceCompute&&function(t){for(const e of t.models){const t=h.z.Provider.get(e);if(!(null==t?void 0:t.hasOperators))return!1}for(const e of t.units)if(-1===e.conformation.operator.key)return!1;return!0}(t)?(function(t,e){const n=new Map;for(const r of t.units){const{key:t}=r.conformation.operator;n.has(t)?n.get(t).add(r):n.set(t,new Set([r]))}for(const r of t.models){const o=h.z.Provider.get(r),{a:i,b:a}=o.bonds,{order:u,flag:l,key:d,operatorA:f,operatorB:m}=o.bonds.edgeProps,{invertedIndex:p}=E.Kx.getInvertedAtomSourceIndex(r),g=new Map;for(const e of t.units)if(e.model===r)for(let t=0,n=e.elements.length;t<n;++t){const n=e.elements[t];g.has(n)?g.get(n).add(e):g.set(n,new Set([e]))}const y=new Map;for(let t=0,e=f.length;t<e;++t){let e,r;if(f[t]===m[t]?(e=g.get(p[i[t]]),r=g.get(p[a[t]])):(e=n.get(f[t]),r=n.get(m[t])),e&&r)for(const n of e)if(f[t]===n.conformation.operator.key)for(const e of r){if(m[t]!==e.conformation.operator.key)continue;if(n===e||!c.N.isAtomic(n)||!c.N.isAtomic(e))continue;if(n.id>e.id)continue;const r=(0,b.m1)(n.id,e.id);y.has(r)?y.get(r).add(t):y.set(r,new Set([t]))}}const _=[-1,-1];y.forEach((n,r)=>{const[o,c]=(0,b.Ao)(_,r),f=t.unitMap.get(o),m=t.unitMap.get(c);e.startUnitPair(o,c),n.forEach(t=>{const n=p[i[t]],r=s.X9.indexOf(f.elements,n);if(r<0)return;const o=p[a[t]],c=s.X9.indexOf(m.elements,o);c<0||e.add(r,c,{order:u[t],flag:l[t],key:d[t]})}),e.finishUnitPair()})}}(t,n),new d(n.getMap())):(N.o.eachUnitPair(t,(t,r)=>{!function(t,e,n,r){const{maxRadius:o}=n,{elements:a,residueIndex:u}=t,{x:c,y:l,z:d}=t.model.atomicConformation,{elements:p,residueIndex:A}=e,C=t.elements.length,{type_symbol:S,label_alt_id:x,label_atom_id:v,label_comp_id:B}=t.model.atomicHierarchy.atoms,{type_symbol:I,label_alt_id:w,label_atom_id:P,label_comp_id:D}=e.model.atomicHierarchy.atoms,{auth_seq_id:M}=t.model.atomicHierarchy.residues,{auth_seq_id:N}=e.model.atomicHierarchy.residues,{occupancy:k}=t.model.atomicConformation,{occupancy:H}=e.model.atomicConformation,O=k.isDefined&&H.isDefined,V=t.model===e.model&&g.A.Provider.get(t.model),Z=!n.forceCompute&&t.model===e.model&&h.z.Provider.get(t.model),{atomSourceIndex:q}=t.model.atomicHierarchy,{invertedIndex:K}=Z?E.Kx.getInvertedAtomSourceIndex(e.model):{invertedIndex:void 0},X=t.model===e.model&&g.A.isExhaustive(t.model),Y=y.$I.mul(G,e.conformation.operator.inverse,t.conformation.operator.matrix),z=!y.$I.isIdentity(Y),{center:$,radius:W}=e.boundary.sphere,Q=(W+o)*(W+o);r.startUnitPair(t.id,e.id);const j=t.conformation.operator.key,J=e.conformation.operator.key;for(let h=0;h<C;h++){const g=a[h];if(T(L,c[g],l[g],d[g]),z&&U(L,L,Y),R(L,$)>Q)continue;if(!n.forceCompute&&Z){const{maxDistance:n}=Z,{offset:o,b:i,edgeProps:{order:a,distance:u,flag:c,key:l,operatorA:d,operatorB:m}}=Z.bonds,p=q.value(g),y=(0,f.Yd)(S.value(g));for(let A=o[p],b=o[p+1];A<b;++A){const o=K[i[A]],p=s.X9.indexOf(e.elements,o);if(p<0)continue;const b=d[A],C=m[A];if(b>=0&&C>=0){if(b===C)continue;if(b!==j||C!==J)continue}const x=(0,f.Yd)(S.value(o)),v=u[A],B=F(t,g,e,o);let I=!1;v>=0?I=(0,_.T)(B,v,.3):n>=0?I=B<n:(I=B<(0,f.on)(y,x,(0,f.O6)(y),(0,f.O6)(x)),(0,f.v3)(y)&&(0,f.v3)(x)&&(I=!1)),I&&r.add(h,p,{order:a[A],flag:c[A],key:l[A]})}continue}const y=n.forceCompute?void 0:V&&V.byAtomIndex.get(g);if(y&&y.length){let n=!1;for(const i of y){const{partnerA:a,partnerB:u}=i,c=a.atomIndex===g?u:a,l=s.X9.indexOf(e.elements,c.atomIndex);l<0||F(t,g,e,c.atomIndex)>o||(r.add(h,l,{order:i.order,flag:i.flags,key:i.rowIndex}),n=!0)}if(n)continue}if(X)continue;const C=k.value(g),{lookup3d:E}=e,{indices:G,count:W,squaredDistances:tt}=E.find(L[0],L[1],L[2],o);if(0===W)continue;const et=(0,f.Yd)(S.value(g)),nt=(0,f.v3)(et),rt=(0,f.O6)(et),ot=x.value(g),it=f.ZL.has(et),st=v.value(g),at=B.value(u[g]);for(let n=0;n<W;n++){const o=G[n],s=p[o],a=w.value(s);if(ot&&a&&ot!==a)continue;if(O&&H.value(s)<1&&C<1&&M.value(u[g])===N.value(A[s]))continue;if(V&&t.model===e.model){const t=(0,b.bd)(u[g],A[s]);if(V.residueCantorPairs.has(t))continue}const c=(0,f.Yd)(I.value(s)),l=(0,f.v3)(c);if(nt&&l)continue;const d=(it||f.ZL.has(c))&&!(nt||l),y=Math.sqrt(tt[n]);if(0!==y&&y<=(0,f.on)(et,c,rt,(0,f.O6)(c))){const t=P.value(s),e=D.value(A[s]);r.add(h,o,{order:(0,m.m)(at,e,st,t),flag:(d?i.I$.Flag.MetallicCoordination:i.I$.Flag.Covalent)|i.I$.Flag.Computed,key:-1})}}}r.finishUnitPair()}(t,r,e,n)},{maxRadius:e.maxRadius,validUnit:t=>e.validUnit(t),validUnitPair:(n,r)=>e.validUnitPair(t,n,r)}),new d(n.getMap()))}function q(t,e){const n={...V,...e};return Z(t,{...n,validUnit:e&&e.validUnit||(t=>c.N.isAtomic(t)),validUnitPair:e&&e.validUnitPair||((t,e,r)=>{if(!N.o.validUnitPair(t,e,r))return!1;const o=e.model.atomicHierarchy.derived.residue.moleculeType,a=r.model.atomicHierarchy.derived.residue.moleculeType,u=!(c.N.isAtomic(e)&&o[e.residueIndex[e.elements[0]]]===i.HX.Water||c.N.isAtomic(r)&&a[r.residueIndex[r.elements[0]]]===i.HX.Water),l=!c.N.isAtomic(e)||o[e.residueIndex[e.elements[0]]]!==i.HX.Ion,d=!c.N.isAtomic(r)||a[r.residueIndex[r.elements[0]]]!==i.HX.Ion,f=l&&d;return!(!u&&n.ignoreWater||!f&&n.ignoreIon)||function(t,e){if(t.model!==e.model||!c.N.isAtomic(t)||!c.N.isAtomic(e))return!1;const n=g.A.Provider.get(t.model);if(!n)return!1;const r=t.elements.length<e.elements.length?t:e,o=t.elements.length>=e.elements.length?t:e,{elements:i}=r,{elements:a}=o,{indexOf:u}=s.X9;for(let s=0,c=i.length;s<c;s++){const t=i[s],e=n.byAtomIndex.get(t);if(null==e?void 0:e.length)for(const n of e){if(u(a,n.partnerA.atomIndex===t?n.partnerB.atomIndex:n.partnerA.atomIndex)>=0)return!0}}return!1}(e,r)})})}var K;!function(t){function e(t,e,n,r,o,i){return{kind:"bond-location",aStructure:t,aUnit:e,aIndex:n,bStructure:r,bUnit:o,bIndex:i}}function n(t,e){return t.aStructure.label===e.aStructure.label&&t.bStructure.label===e.bStructure.label&&t.aIndex===e.aIndex&&t.bIndex===e.bIndex&&t.aUnit.id===e.aUnit.id&&t.bUnit.id===e.bUnit.id}function r(t,e){return{kind:"bond-loci",structure:t,bonds:e}}t.Location=e,t.isLocation=function(t){return!!t&&"bond-location"===t.kind},t.areLocationsEqual=n,t.Loci=r,t.isLoci=function(t){return!!t&&"bond-loci"===t.kind},t.areLociEqual=function(t,e){if(t.structure!==e.structure)return!1;if(t.bonds.length!==e.bonds.length)return!1;for(let r=0,o=t.bonds.length;r<o;++r)if(!n(t.bonds[r],e.bonds[r]))return!1;return!0},t.isLociEmpty=function(t){return 0===t.bonds.length},t.remapLoci=function(t,n){if(n===t.structure)return t;const o=[];return t.bonds.forEach(r=>{const i=n.unitMap.get(r.aUnit.id);if(!i)return;const a=n.unitMap.get(r.bUnit.id);if(!a)return;const u=r.aUnit.elements[r.aIndex],c=s.X9.indexOf(i.elements,u);if(-1===c)return;const l=r.bUnit.elements[r.bIndex],d=s.X9.indexOf(a.elements,l);-1!==d&&o.push(e(t.structure,i,c,t.structure,a,d))}),r(n,o)},t.toStructureElementLoci=function(t){const e=[],n=new Map;for(const r of t.bonds){const{aIndex:t,aUnit:e,bIndex:o,bUnit:i}=r;e===i?n.has(e.id)?n.get(e.id).push(t,o):n.set(e.id,[t,o]):(n.has(e.id)?n.get(e.id).push(t):n.set(e.id,[t]),n.has(i.id)?n.get(i.id).push(o):n.set(i.id,[o]))}return n.forEach((n,r)=>{e.push({unit:t.structure.unitMap.get(r),indices:s.X9.deduplicate(s.X9.ofUnsortedArray(n))})}),o.iZ.Loci(t.structure,e)},t.toFirstStructureElementLoci=function(t){const{aUnit:e,aIndex:n}=t.bonds[0];return o.iZ.Loci(t.structure,[{unit:e,indices:s.CD.ofSingleton(n)}])},t.getType=function(t,e){if(e.aUnit===e.bUnit){const t=e.aUnit.bonds,n=t.getEdgeIndex(e.aIndex,e.bIndex);return n<0?i.I$.create(i.I$.Flag.None):i.I$.create(t.edgeProps.flags[n])}{const n=t.interUnitBonds.getBondFromLocation(e);return n?i.I$.create(n.props.flag):i.I$.create(i.I$.Flag.None)}},t.getOrder=function(t,e){if(e.aUnit===e.bUnit){const t=e.aUnit.bonds,n=t.getEdgeIndex(e.aIndex,e.bIndex);return n<0?0:t.edgeProps.order[n]}{const n=t.interUnitBonds.getBondFromLocation(e);return n?n.props.order:0}},t.getIntraUnitBondCount=function(t){let e=0;for(const n of t.unitSymmetryGroups){const t=n.units[0];o.Nf.isAtomic(t)&&(e+=t.bonds.edgeCount*n.units.length)}return e};t.ElementBondIterator=class{move(){return this.advance(),this.current}setElement(t,e,n){this.structure=t,this.unit=e,this.index=n,this.interBondIndices=t.interUnitBonds.getEdgeIndices(n,e.id),this.interBondCount=this.interBondIndices.length,this.interBondIndex=0,this.intraBondEnd=e.bonds.offset[n+1],this.intraBondIndex=e.bonds.offset[n],this.hasNext=this.interBondIndex<this.interBondCount||this.intraBondIndex<this.intraBondEnd}advance(){if(this.intraBondIndex<this.intraBondEnd)this.current.otherUnit=this.unit,this.current.otherIndex=this.unit.bonds.b[this.intraBondIndex],this.current.type=this.unit.bonds.edgeProps.flags[this.intraBondIndex],this.current.order=this.unit.bonds.edgeProps.order[this.intraBondIndex],this.intraBondIndex+=1;else{if(!(this.interBondIndex<this.interBondCount))return void(this.hasNext=!1);{const t=this.structure.interUnitBonds.edges[this.interBondIndices[this.interBondIndex]];this.current.otherUnit=this.structure.unitMap.get(t.unitA!==this.unit.id?t.unitA:t.unitB),this.current.otherIndex=t.indexA!==this.index?t.indexA:t.indexB,this.current.type=t.props.flag,this.current.order=t.props.order,this.interBondIndex+=1}}this.hasNext=this.interBondIndex<this.interBondCount||this.intraBondIndex<this.intraBondEnd}constructor(){this.current={},this.hasNext=!1}},t.getBoundingSphere=function(t,e){return a.p.fromPairProvider(t.bonds.length,(e,n,r)=>{const{aUnit:o,aIndex:i,bUnit:s,bIndex:a}=t.bonds[e];o.conformation.position(o.elements[i],n),s.conformation.position(s.elements[a],r)},e)}}(K||(K={}))},9422:function(t,e,n){n.d(e,{t:function(){return r}});var r,o=n(51142),i=n(73868),s=n(35332),a=n(78850),u=n(34370),c=n(55178);!function(t){function e(t,e){return e?(e.label&&(t.label=e.label),e.description&&(t.description=e.description),e.legend&&(t.legend=e.legend),e.fieldLabels&&(t.fieldLabels=e.fieldLabels),e.isHidden&&(t.isHidden=e.isHidden),e.shortLabel&&(t.shortLabel=e.shortLabel),e.twoColumns&&(t.twoColumns=e.twoColumns),e.isEssential&&(t.isEssential=e.isEssential),e.category&&(t.category=e.category),e.hideIf&&(t.hideIf=e.hideIf),e.help&&(t.help=e.help),t):t}function n(t,n,r){return e({type:"select",defaultValue:I(t,n),options:n,cycle:null==r?void 0:r.cycle},r)}function r(t,e){return e?(void 0!==e.min&&(t.min=e.min),void 0!==e.max&&(t.max=e.max),void 0!==e.step&&(t.step=e.step),t):t}function l(t,n){const r=e({type:"group",defaultValue:(null==n?void 0:n.customDefault)||m(t),params:t},n);return(null==n?void 0:n.presets)&&(r.presets=n.presets),(null==n?void 0:n.isExpanded)&&(r.isExpanded=n.isExpanded),(null==n?void 0:n.isFlat)&&(r.isFlat=n.isFlat),(null==n?void 0:n.pivot)&&(r.pivot=n.pivot),r}function d(){return m(this.element)}function f(){throw new Error("getValue not set. Fix runtime.")}function m(t){const e={};for(const n of Object.keys(t))t[n].isOptional||(e[n]=t[n].defaultValue);return e}function h(t,e,n){return()=>t(e,n)}function p(t,e,n){if(e)if("value-ref"===t.type){const r=e;r.ref?r.getValue=h(t.resolveRef,r.ref,n):r.getValue=()=>{throw new Error("Unset ref in ValueRef value.")}}else if("data-ref"===t.type){const t=e;t.ref?t.getValue=h(n,t.ref,n):t.getValue=()=>{throw new Error("Unset ref in ValueRef value.")}}else if("group"===t.type)_(t.params,e,n);else if("mapped"===t.type){const r=e;p(t.map(r.name),r.params,n)}else if("object-list"===t.type){if(!y(t.element))return;for(const r of e)_(t.element,r,n)}}function g(t){if("value-ref"===t.type||"data-ref"===t.type)return!0;if("group"===t.type){if(y(t.params))return!0}else if("mapped"===t.type){for(const[e]of t.select.options)if(g(t.map(e)))return!0}else if("object-list"===t.type)return y(t.element);return!1}function y(t){for(const e of Object.keys(t))if(g(t[e]))return!0;return!1}function _(t,e,n){for(const r of Object.keys(t))p(t[r],null==e?void 0:e[r],n)}function A(t,e,n){if(e===n)return!0;if("object"!=typeof e||"object"!=typeof n)return!1;for(const r of Object.keys(t))if(!b(t[r],e[r],n[r]))return!1;return!0}function b(t,e,n){if(e===n)return!0;if("group"===t.type)return A(t.params,e,n);if("mapped"===t.type){const r=e,o=n;if(r.name!==o.name)return!1;return b(t.map(r.name),r.params,o.params)}if("multi-select"===t.type){const t=e,r=n;if(t.length!==r.length)return!1;if(t.length<10){for(let e=0,n=t.length;e<n;e++)if(t[e]!==r[e]&&r.indexOf(t[e])<0)return!1}else{const e=new Set(r);for(let n=0,o=t.length;n<o;n++)if(t[n]!==r[n]&&!e.has(t[n]))return!1}return!0}if("interval"===t.type)return e[0]===n[0]&&e[1]===n[1];if("line-graph"===t.type){const t=e,r=n;if(t.length!==r.length)return!1;for(let e=0,n=t.length;e<n;e++)if(!i.ZY.areEqual(t[e],r[e]))return!1;return!0}if("vec3"===t.type)return i.eB.equals(e,n);if("mat4"===t.type)return i.$I.areEqual(e,n,i.p8);if("script"===t.type){const t=e,r=n;return t.language===r.language&&t.expression===r.expression}if("object-list"===t.type){const r=e,o=n,i=r.length;if(i!==o.length)return!1;for(let e=0;e<i;e++)if(!A(t.element,r[e],o[e]))return!1;return!0}return"object"==typeof e&&"object"==typeof n&&(0,o.f8)(e,n)}function C(t,e,n){if(void 0===e)return{...n};if(void 0===n)return{...e};const r={};for(const o of Object.keys(t))r[o]=S(t[o],e[o],n[o]);return r}function S(t,e,n){if(void 0===e)return"object"!=typeof n||Array.isArray(n)?n:{...n};if(void 0===n)return"object"!=typeof e||Array.isArray(e)?e:{...e};if("group"===t.type)return C(t.params,e,n);if("mapped"===t.type){const r=e,o=n;if(r.name!==o.name)return{...o};const i=t.map(o.name);return{name:o.name,params:S(i,r.params,o.params)}}return"value"===t.type?n:"object"==typeof e&&"object"==typeof n?Array.isArray(n)?n:{...e,...n}:n}function x(t,e){for(const n of t.options)if(n[0]===e)return!0;return!1}function v(t,e,n){if(null==e)return n?t.defaultValue:void 0;if("value"===t.type)return e;if("group"===t.type){const r={};for(const o of Object.keys(t.params)){const i=t.params[o];void 0===e[o]?n&&(r[o]=i.defaultValue):r[o]=v(i,e[o],n)}return r}if("mapped"===t.type){const r=e;if("string"!=typeof r.name)return t.defaultValue;if(void 0===r.params)return n?t.defaultValue:void 0;if(!x(t.select,r.name))return t.defaultValue;const o=t.map(r.name);return{name:r.name,params:v(o,r.params,n)}}if("select"===t.type)return x(t,e)?e:t.defaultValue;if("multi-select"===t.type){if(!Array.isArray(e))return t.defaultValue;const n=e.filter(function(t){return x(this,t)},t);return e.length>0&&0===n.length?t.defaultValue:n}return"object-list"===t.type?Array.isArray(e)?e.map(e=>B(t.element,e,n?"all":"skip")):t.defaultValue:e}function B(t,e,n){if("object"!=typeof e||null===e)return n?m(t):e;const r={};for(const o of Object.keys(t)){const i=t[o];void 0===e[o]?"all"===n&&(r[o]=i.defaultValue):r[o]=v(i,e[o],"skip"!==n)}return r}function I(t,e){for(const n of e)if(n[0]===t)return t;return e.length>0?e[0][0]:void 0}t.Essential={isEssential:!0},t.Optional=function(t){const e={...t};return e.isOptional=!0,e},t.Value=function(t,n){return e({type:"value",defaultValue:t},n)},t.Select=n,t.MultiSelect=function(t,n,r){const o=e({type:"multi-select",defaultValue:t,options:n},r);return(null==r?void 0:r.emptyValue)&&(o.emptyValue=r.emptyValue),o},t.Boolean=function(t,n){return e({type:"boolean",defaultValue:t},n)},t.Text=function(t="",n){return e({type:"text",defaultValue:t,multiline:null==n?void 0:n.multiline,placeholder:null==n?void 0:n.placeholder,disableInteractiveUpdates:null==n?void 0:n.disableInteractiveUpdates},n)},t.Color=function(t,n){const r=e({type:"color",defaultValue:t},n);return(null==n?void 0:n.isExpanded)&&(r.isExpanded=n.isExpanded),r},t.ColorList=function(t,n){let r;if("string"==typeof t){const e=(0,u.JA)(t);r={kind:"qualitative"!==e.type?"interpolate":"set",colors:e.list}}else r=t;return e({type:"color-list",presetKind:(null==n?void 0:n.presetKind)||"all",defaultValue:r,offsets:!!(null==n?void 0:n.offsets)},n)},t.Vec3=function(t,n,o){return e(r({type:"vec3",defaultValue:t},n),o)},t.Mat4=function(t,n){return e({type:"mat4",defaultValue:t},n)},t.Url=function(t,n){return e({type:"url",defaultValue:"string"==typeof t?c.V.Url(t):c.V.Url(t.url,{body:t.body})},n)},t.File=function(t){const n=e({type:"file",defaultValue:null},t);return(null==t?void 0:t.accept)&&(n.accept=t.accept),n},t.FileList=function(t){const n=e({type:"file-list",defaultValue:null},t);return(null==t?void 0:t.accept)&&(n.accept=t.accept),n},t.Numeric=function(t,n,o){const i=e(r({type:"number",defaultValue:t},n),o);return(null==o?void 0:o.immediateUpdate)&&(i.immediateUpdate=!0),i},t.Interval=function(t,n,o){return e(r({type:"interval",defaultValue:t},n),o)},t.LineGraph=function(t,n){const r=e({type:"line-graph",defaultValue:t},n);return(null==n?void 0:n.getVolume)&&(r.getVolume=n.getVolume),r},t.Group=l,t.EmptyGroup=function(t){return l({},t)},t.Mapped=function(t,r,o,i){const s=I(t,r);return e({type:"mapped",defaultValue:{name:s,params:o(s).defaultValue},select:n(s,r,i),map:o},i)},t.MappedStatic=function(t,r,o){const i=(null==o?void 0:o.options)?o.options:Object.keys(r).map(t=>[t,r[t].label||(0,a.Mk)(t)]),s=I(t,i);return e({type:"mapped",defaultValue:{name:s,params:r[s].defaultValue},select:n(s,i,o),map:t=>r[t]},o)},t.ObjectList=function(t,n,r){return e({type:"object-list",element:t,getLabel:n,ctor:d,defaultValue:(null==r?void 0:r.defaultValue)||[]},r)},t.ValueRef=function(t,n,r){var o;return e({type:"value-ref",defaultValue:{ref:null!==(o=null==r?void 0:r.defaultRef)&&void 0!==o?o:"",getValue:f},getOptions:t,resolveRef:n},r)},t.DataRef=function(t){var n;return e({type:"data-ref",defaultValue:{ref:null!==(n=null==t?void 0:t.defaultRef)&&void 0!==n?n:"",getValue:f}},t)},t.Converted=function(t,n,r){return e({type:"converted",defaultValue:n(r.defaultValue),converted:r,fromValue:t,toValue:n},r)},t.Conditioned=function(t,r,o,i,s){const a=Object.keys(r).map(t=>[t,t]);return e({type:"conditioned",select:n(o(t),a,s),defaultValue:t,conditionParams:r,conditionForValue:o,conditionedValue:i},s)},t.Script=function(t,n){return e({type:"script",defaultValue:t},n)},t.For=function(t){return 0},t.getDefaultValues=m,t.resolveRefs=_,t.setDefaultValues=function(t,e){for(const n of Object.keys(t))t[n].isOptional||(t[n].defaultValue=e[n])},t.clone=function(t){return(0,s.Go)(t)},t.validate=function(t,e){},t.areEqual=A,t.isParamEqual=b,t.merge=C,t.mergeParam=S,t.normalizeParams=B,t.objectToOptions=function(t,e){const n=[];for(const r of Object.keys(t))if(e){const o=e(r,t[r]);n.push("string"==typeof o?[r,o]:[r,o[0],o[1]])}else"string"==typeof t[r]?n.push([r,t[r]]):n.push([r,null===e?r:(0,a.Mk)(r)]);return n},t.arrayToOptions=function(t,e){const n=[];for(const r of t)e?n.push([r,e(r)]):n.push([r,null===e?r:(0,a.Mk)(r)]);return n},t.optionLabel=function(t,e){for(const n of t.options)if(n[0]===e)return n[1];return""},t.withDefaults=function(t,e){const n={};for(const r of Object.keys(e)){const o=e[r];t[r]&&null!=o&&t[r].defaultValue!==o&&(n[r]={...t[r],defaultValue:o})}return{...t,...n}}}(r||(r={}))},10486:function(t,e,n){n.d(e,{Kx:function(){return o.K},vw:function(){return i.v}});var r,o=n(21544),i=(n(52500),n(98820)),s=(n(32211),n(77936)),a=n(65533),u=n(51142);function c(t){const e=new Map;for(let n=0,r=t.length;n<r;n++)e.set(n,t[n]);return e}!function(t){t.getCifDataSource=function(t,e,n){if(!e)return{rowCount:0};if(n&&n[e.id])return n[e.id];const r=e.getElements(t),o={data:r,rowCount:r.elements.length};return n&&(n[e.id]=o),o},t.fromAtomMap=function(t){return new d(t)},t.fromAtomArray=function(t){return new d(c(t))};const e=t=>t.atomicHierarchy.residueAtomSegments;t.fromResidueMap=function(t){return new l("residue",t,e,s.Nf.Kind.Atomic)},t.fromResidueArray=function(t){return new l("residue",c(t),e,s.Nf.Kind.Atomic)};const n=t=>t.atomicHierarchy.chainAtomSegments;t.fromChainMap=function(t){return new l("chain",t,n,s.Nf.Kind.Atomic)},t.fromChainArray=function(t){return new l("chain",c(t),n,s.Nf.Kind.Atomic)},t.fromEntityMap=function(t){return new f(t)}}(r||(r={}));class l{has(t){return this.map.has(t)}get(t){return this.map.get(t)}getStructureElements(t){const e=t.models;if(1!==e.length)throw new Error("Only works on structures with a single model.");const n=new Set,r=t.unitSymmetryGroups,o=[],i=this.segmentGetter(e[0]);for(const u of r){const e=u.units[0];if(e.kind!==this.kind)continue;const r=a.hT.transientSegments(i,e.elements);for(;r.hasNext;){const i=r.move();this.has(i.index)&&!n.has(i.index)&&(n.add(i.index),o[o.length]=s.iZ.Location.create(t,e,e.elements[i.start]))}}return o.sort((t,e)=>t.element-e.element),o}getElements(t){const e=this.segmentGetter(t.model).index,n=this.getStructureElements(t);return{elements:n,property:t=>this.get(e[n[t].element])}}constructor(t,e,n,r){this.level=t,this.map=e,this.segmentGetter=n,this.id=u.kk.create22(),this.kind=r}}class d{has(t){return this.map.has(t)}get(t){return this.map.get(t)}getStructureElements(t){if(1!==t.models.length)throw new Error("Only works on structures with a single model.");const e=new Set,n=t.unitSymmetryGroups,r=[];for(const o of n){const n=o.units[0];if(n.kind!==this.kind)continue;const i=n.elements;for(let o=0,a=i.length;o<a;o++){const a=i[o];this.has(a)&&!e.has(a)&&(e.add(i[o]),r[r.length]=s.iZ.Location.create(t,n,a))}}return r.sort((t,e)=>t.element-e.element),r}getElements(t){const e=this.getStructureElements(t);return{elements:e,property:t=>this.get(e[t].element)}}constructor(t){this.map=t,this.id=u.kk.create22(),this.level="atom",this.kind=s.Nf.Kind.Atomic}}class f{has(t){return this.map.has(t)}get(t){return this.map.get(t)}getStructureElements(t){const e=t.models;if(1!==e.length)throw new Error("Only works on structures with a single model.");const n=e[0].atomicHierarchy.index,r=new Set,o=t.unitSymmetryGroups,i=[],u=e[0].atomicHierarchy.chainAtomSegments;for(const c of o){const e=c.units[0];if(e.kind!==this.kind)continue;const o=a.hT.transientSegments(u,e.elements);for(;o.hasNext;){const a=o.move(),u=n.getEntityFromChain(a.index);this.has(u)&&!r.has(u)&&(r.add(u),i[i.length]=s.iZ.Location.create(t,e,e.elements[a.start]))}}return i.sort((t,e)=>t.element-e.element),i}getElements(t){const e=this.getStructureElements(t),n=t.model.atomicHierarchy.chainAtomSegments.index,r=t.model.atomicHierarchy.index;return{elements:e,property:t=>this.get(r.getEntityFromChain(n[e[t].element]))}}constructor(t){this.map=t,this.id=u.kk.create22(),this.level="entity",this.kind=s.Nf.Kind.Atomic}}},12284:function(t,e,n){n.d(e,{E:function(){return a}});var r=n(98391),o=n(12716),i=n(75849),s=n(41430);function a(){return a.zero()}!function(t){function e(){const t=[.1,0,0];return t[0]=0,t}function n(t,e){const[n,r,o]=e,s=Math.sqrt(r*r+o*o);let a=((0,i.H)(Math.atan2(o,r))+360)%360;return 0===Math.round(1e4*s)&&(a=Number.NaN),t[0]=a,t[1]=s,t[2]=n,t}function a(t,e,n){return t[0]=e[0]-l*n,t[1]=e[1],t[2]=e[2],t}t.zero=e,t.create=function(t,n,r){const o=e();return o[0]=t,o[1]=n,o[2]=r,o},t.set=function(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t},t.distance=function(t,e){const n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2];return Math.sqrt(n*n+r*r+o*o)},t.fromColor=function(t,e){const[n,o,i]=r.Q1.toRgb(e),[s,a,u]=function(t,e,n){t=b(t),e=b(e),n=b(n);const r=C((.4124564*t+.3575761*e+.1804375*n)/d),o=C((.2126729*t+.7151522*e+.072175*n)/f),i=C((.0193339*t+.119192*e+.9503041*n)/m);return[r,o,i]}(n,o,i),c=116*a-16;return t[0]=c<0?0:c,t[1]=500*(s-a),t[2]=200*(a-u),t},t.fromHcl=function(t,e){return o.G.toLab(t,e)},t.toColor=function(t){let e=(t[0]+16)/116,n=isNaN(t[1])?e:e+t[1]/500,o=isNaN(t[2])?e:e-t[2]/200;e=f*A(e),n=d*A(n),o=m*A(o);const i=_(3.2404542*n-1.5371385*e-.4985314*o),a=_(-.969266*n+1.8760108*e+.041556*o),u=_(.0556434*n-.2040259*e+1.0572252*o);return r.Q1.fromRgb(Math.round((0,s.qE)(i,0,255)),Math.round((0,s.qE)(a,0,255)),Math.round((0,s.qE)(u,0,255)))},t.toHcl=n,t.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},t.darken=a,t.lighten=function(t,e,n){return a(t,e,-n)};const u=[0,0,0];function c(t,e,r){return n(u,e),o.G.toLab(t,o.G.saturate(u,u,r))}t.saturate=c,t.desaturate=function(t,e,n){return c(t,e,-n)};const l=18,d=.95047,f=1,m=1.08883,h=.137931034,p=.206896552,g=.12841855,y=.008856452;function _(t){return 255*(t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function A(t){return t>p?t*t*t:g*(t-h)}function b(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function C(t){return t>y?Math.pow(t,1/3):t/g+h}}(a||(a={}))},12606:function(t,e,n){n.d(e,{C:function(){return H}});var r=n(87504),o=n(90790);const i=o.I.Empty,s=o.I.ofSingleton,a=o.I.ofRange,u=o.I.ofBounds;function c(t){return t.length?r.X.isRange(t)?o.I.ofRange(t[0],t[t.length-1]):t:i}function l(t){return o.I.is(t)?o.I.size(t):r.X.size(t)}function d(t,e){return o.I.is(t)?o.I.has(t,e):r.X.has(t,e)}function f(t,e){return o.I.is(t)?o.I.indexOf(t,e):r.X.indexOf(t,e)}function m(t,e){return o.I.is(t)?o.I.getAt(t,e):t[e]}function h(t){return o.I.is(t)?o.I.min(t):r.X.min(t)}function p(t){return o.I.is(t)?o.I.max(t):r.X.max(t)}function g(t){return o.I.is(t)?o.I.start(t):r.X.start(t)}function y(t){return o.I.is(t)?o.I.end(t):r.X.end(t)}function _(t){return 0===l(t)}function A(t){return o.I.is(t)?o.I.hashCode(t):r.X.hashCode(t)}function b(t,e){return o.I.is(t)?o.I.is(e)?o.I.areEqual(t,e):M(t,e):o.I.is(e)?M(e,t):r.X.areEqual(t,e)}function C(t,e){return o.I.is(t)?o.I.is(e)?o.I.areIntersecting(t,e):N(e,t):o.I.is(e)?N(t,e):r.X.areIntersecting(t,e)}function S(t,e){return o.I.is(t)?o.I.is(e)?o.I.isSubInterval(t,e):function(t,e){const n=o.I.min(t),i=o.I.max(t);if(i-n+1==0)return!1;const s=r.X.min(e),a=r.X.max(e);return s>=n&&a<=i}(t,e):o.I.is(e)?function(t,e){const n=o.I.min(e),i=o.I.max(e);if(i-n+1==0)return!0;const s=r.X.min(t),a=r.X.max(t);if(n<s||i>a)return!1;const u=r.X.findRange(t,n,i);return o.I.size(u)===o.I.size(e)}(t,e):r.X.isSubset(t,e)}function x(t,e){return o.I.is(t)?o.I.findPredecessorIndex(t,e):r.X.findPredecessorIndex(t,e)}function v(t,e,n){return o.I.is(t)?o.I.findPredecessorIndexInInterval(t,e,n):r.X.findPredecessorIndexInInterval(t,e,n)}function B(t,e,n){return o.I.is(t)?o.I.findRange(t,e,n):r.X.findRange(t,e,n)}function I(t,e){return o.I.is(t)?o.I.is(e)?o.I.intersectionSize(t,e):T(e,t):o.I.is(e)?T(t,e):r.X.intersectionSize(t,e)}function w(t,e){return o.I.is(t)?o.I.is(e)?function(t,e){if(o.I.areEqual(t,e))return t;const n=o.I.size(t),r=o.I.size(e);if(!r)return t;if(!n)return e;const i=o.I.min(t),s=o.I.min(e);if(function(t,e){const n=l(t),r=l(e);return 0===n&&0===r||n>0&&r>0&&p(t)>=h(e)&&h(t)<=p(e)}(t,e))return o.I.ofRange(Math.min(i,s),Math.max(o.I.max(t),o.I.max(e)));let a,u,d,f;i<s?(a=n,u=i,d=r,f=s):(a=r,u=s,d=n,f=i);const m=new Int32Array(n+r);for(let o=0;o<a;o++)m[o]=o+u;for(let o=0;o<d;o++)m[o+a]=o+f;return c(m)}(t,e):k(e,t):o.I.is(e)?k(t,e):c(r.X.union(t,e))}function P(t,e){return o.I.is(t)?o.I.is(e)?o.I.intersect(t,e):R(e,t):o.I.is(e)?R(t,e):c(r.X.intersect(t,e))}function D(t,e){return o.I.is(t)?o.I.is(e)?function(t,e){if(o.I.areEqual(t,e))return i;if(!o.I.areIntersecting(t,e))return t;const n=o.I.min(t),r=o.I.max(t),s=o.I.min(e),a=o.I.max(e);if(r<n||a<s)return t;if(o.I.isSubInterval(e,t))return i;if(o.I.isSubInterval(t,e)){const t=s-n,e=r-a;if(t<=0)return o.I.ofRange(a+1,a+e);if(e<=0)return o.I.ofRange(n,n+t-1);const i=new Int32Array(t+e);let u=0;for(let r=0;r<t;r++)i[u++]=n+r;for(let n=1;n<=e;n++)i[u++]=a+n;return c(i)}return n<s?o.I.ofRange(n,s-1):o.I.ofRange(a+1,r)}(t,e):function(t,e){const n=o.I.min(t),s=o.I.max(t);if(s<n)return t;const a=s-n+1,u=r.X.findRange(e,n,s),l=o.I.start(u),d=o.I.end(u),f=d-l;if(0===f)return t;const m=a-f;if(m<=0)return i;const h=new Int32Array(m),p=e.length-1,g=e[Math.min(l,p)],y=e[Math.min(d,p)];let _=0;for(let r=n;r<g;r++)h[_++]=r;for(let o=g;o<=y;o++)r.X.indexOfInInterval(e,o,u)<0&&(h[_++]=o);for(let r=y+1;r<=s;r++)h[_++]=r;return c(h)}(t,e):o.I.is(e)?function(t,e){const n=o.I.min(e),s=o.I.max(e);if(s<n)return t;const a=r.X.findRange(t,n,s),u=o.I.start(a),l=o.I.end(a),d=t.length-(l-u);if(d<=0)return i;if(d===t.length)return t;const f=new Int32Array(d);let m=0;for(let r=0;r<u;r++)f[m++]=t[r];for(let r=l,o=t.length;r<o;r++)f[m++]=t[r];return c(f)}(t,e):c(r.X.subtract(t,e))}function M(t,e){return o.I.size(t)===r.X.size(e)&&o.I.start(t)===r.X.start(e)&&o.I.end(t)===r.X.end(e)}function N(t,e){return 0!==t.length&&0!==o.I.size(r.X.findRange(t,o.I.min(e),o.I.max(e)))}function E(t,e){return l(t)?!l(e)||h(t)<=h(e)&&p(t)>=p(e):0===l(e)}function k(t,e){const n=o.I.size(e);if(!n)return t;if(E(e,t))return e;const i=o.I.min(e),s=o.I.max(e),a=r.X.findRange(t,i,s),u=o.I.start(a),l=o.I.end(a),d=new Int32Array(u+(t.length-l)+n);let f=0;for(let r=0;r<u;r++)d[f++]=t[r];for(let r=i;r<=s;r++)d[f++]=r;for(let r=l,o=t.length;r<o;r++)d[f++]=t[r];return c(d)}function T(t,e){if(!o.I.size(e))return 0;const n=r.X.findRange(t,o.I.min(e),o.I.max(e));return o.I.end(n)-o.I.start(n)}function R(t,e){if(!o.I.size(e))return i;const n=r.X.findRange(t,o.I.min(e),o.I.max(e)),s=o.I.start(n),a=o.I.end(n),u=a-s;if(!u)return i;if(u===t.length)return t;const l=new Int32Array(u);let d=0;for(let r=s;r<a;r++)l[d++]=t[r];return c(l)}function U(t,e,n){if(e===n)return t;const o=l(t),s=e.length,a=n.length;if(0===o||0===s||0===a)return i;const u=r.X.findPredecessorIndex(n,e[h(t)]),d=r.X.findPredecessorIndex(n,e[p(t)]+1);let f=0,g=0,y=0,_=u;for(;y<o&&_<d;){const r=e[m(t,y)],o=n[_];r<o?y++:(r>o||(f++,y++),_++)}if(0===f)return i;if(f===s&&f===a)return t;const A=new Int32Array(f);for(g=0,y=0,_=u;y<o&&_<d;){const r=e[m(t,y)],o=n[_];r<o?y++:(r>o||(A[g++]=_,y++),_++)}return c(A)}var H;!function(t){t.Empty=i,t.ofSingleton=s,t.ofRange=a,t.ofBounds=u,t.ofSortedArray=c,t.has=d,t.indexOf=f,t.getAt=m,t.isEmpty=_,t.min=h,t.max=p,t.start=g,t.end=y,t.size=l,t.hashCode=A,t.areEqual=b,t.areIntersecting=C,t.isSubset=S,t.union=w,t.intersect=P,t.indexedIntersect=U,t.subtract=D,t.findPredecessorIndex=x,t.findPredecessorIndexInInterval=v,t.findRange=B,t.intersectionSize=I,t.forEach=function(t,e,n){return function(t,e,n){if(o.I.is(t)){const r=o.I.min(t);for(let i=r,s=o.I.max(t);i<=s;i++)e(i,i-r,n)}else for(let r=0,o=t.length;r<o;r++)e(t[r],r,n);return n}(t,e,n)},t.forEachSegment=function(t,e,n,r){return function(t,e,n,r){if(o.I.is(t)){let i=0;for(let s=o.I.min(t),a=o.I.max(t);s<=a;s++){const t=e(s);let o=s+1;for(;o<a&&e(o)===t;)o++;s=o-1,n(t,i,r),i++}}else{let o=0;for(let i=0,s=t.length;i<s;i++){const a=e(t[i]);let u=i+1;for(;u<s&&e(t[u])===a;)u++;i=u-1,n(a,o,r),o++}}return r}(t,e,n,r)},t.isInterval=function(t){return o.I.is(t)},t.isSortedArray=function(t){return!o.I.is(t)},t.toArray=function(e){const n=[];return t.forEach(e,t=>n.push(t)),n},t.toString=function(t){return function(t){return o.I.is(t)?o.I.toString(t):r.X.toString(t)}(t)}}(H||(H={}))},12716:function(t,e,n){n.d(e,{G:function(){return i}});var r=n(75849),o=n(12284);function i(){return i.zero()}!function(t){function e(){const t=[.1,0,0];return t[0]=0,t}t.zero=e,t.create=function(t,n,r){const o=e();return o[0]=t,o[1]=n,o[2]=r,o},t.set=function(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t},t.hasHue=function(t){return!isNaN(t[0])};const n=[0,0,0];t.fromColor=function(t,e){return o.E.toHcl(t,o.E.fromColor(n,e))},t.fromLab=function(t,e){return o.E.toHcl(t,e)};const i=[0,0,0];function s(t,e){let[n,o,i]=e;return isNaN(n)&&(n=0),n=(0,r.pu)(n),t[0]=i,t[1]=Math.cos(n)*o,t[2]=Math.sin(n)*o,t}function a(t,e,n){return t[0]=e[0],t[1]=Math.max(0,e[1]+l*n),t[2]=e[2],t}t.toColor=function(t){return o.E.toColor(s(i,t))},t.toLab=s,t.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},t.saturate=a,t.desaturate=function(t,e,n){return a(t,e,-n)};const u=[0,0,0];function c(t,e,n){return s(u,e),o.E.toHcl(t,o.E.darken(u,u,n))}t.darken=c,t.lighten=function(t,e,n){return c(t,e,-n)};const l=18}(i||(i={}))},13636:function(t,e,n){n.d(e,{J:function(){return r}});var r,o=n(3627);!function(t){t.core=o.AN.core,t.struct=o.AN.structureQuery,t.internal=o.AN.internal,t.atomName=function(e){return t.struct.type.atomName([e])},t.es=function(e){return t.struct.type.elementSymbol([e])},t.list=function(...e){return t.core.type.list(e)},t.set=function(...e){return t.core.type.set(e)},t.re=function(e,n){return t.core.type.regex([e,n])},t.fn=function(e){return t.core.ctrl.fn([e])},t.evaluate=function(e){return t.core.ctrl.eval([e])};const e=t.struct.atomProperty.core,n=t.struct.atomProperty.macromolecular,r=t.struct.atomProperty.topology;function i(t){return e[t]()}function s(t){return r[t]()}function a(t){return n[t]()}t.acp=i,t.atp=s,t.ammp=a;const u=t.struct.atomSet.propertySet;t.acpSet=function(t){return u([i(t)])},t.atpSet=function(t){return u([s(t)])},t.ammpSet=function(t){return u([a(t)])}}(r||(r={}))},14139:function(t,e,n){n.d(e,{Bg:function(){return l},TO:function(){return c},oY:function(){return i},wE:function(){return h}});var r=n(50669),o=n(28243);const i=new class{constructor(){this.map=new Map}removeSymbol(t){this.map.delete(t.symbol.id)}addSymbol(t){this.map.has(t.symbol.id)&&console.warn(`Symbol '${t.symbol.id}' already added. Call removeSymbol/removeCustomProps re-adding the symbol.`),this.map.set(t.symbol.id,t)}addCustomProp(t){if(t.symbols)for(const e of Object.keys(t.symbols))this.addSymbol(t.symbols[e])}removeCustomProp(t){if(t.symbols)for(const e of Object.keys(t.symbols))this.removeSymbol(t.symbols[e])}getRuntime(t){return this.map.get(t)}};class s{constructor(t){this.table=t,this.constQueryContext=new o.cY(o.Structure.Empty)}}var a,u,c,l;!function(t){t.Const=function(t){return{kind:"const",value:t}},t.Dynamic=function(t){return{kind:"dynamic",runtime:t}}}(a||(a={})),function(t){t.Const=function(t){return{isConst:!0,fn:function(e){return t}}},t.Dynamic=function(t){return{isConst:!1,fn:t}}}(u||(u={})),function(t){t.forEachEval=function(t,e,n,r){if("number"==typeof t.length)for(let o=0,i=t.length;o<i;o++)n(t[o](e),o,r);else{let o=0;for(const i of Object.keys(t))n(t[i](e),o++,r)}return r}}(c||(c={})),function(t){t.Const=function(t,e){return new d(t,e,!0)},t.Dynamic=function(t,e){return new d(t,e,!1)}}(l||(l={}));class d{compile(t,e){let n,o=!1;if(e)if(r.r.isArgumentsArray(e)){n=[],o=!0;for(const r of e){const e=m(t,r);o=o&&e.isConst,n.push(e.fn)}}else{n=Object.create(null),o=!0;for(const r of Object.keys(e)){const i=m(t,e[r]);o=o&&i.isConst,n[r]=i.fn}}else n=void 0,o=!0;return this.isConst&&this.isConst&&o?u.Const(this.fn(t.constQueryContext,n)):u.Dynamic(f(this.fn,n))}constructor(t,e,n){this.symbol=t,this.fn=e,this.isConst=n}}function f(t,e){return function(n){return t(n,e)}}function m(t,e){if(r.r.isLiteral(e))return u.Const(e);if(r.r.isSymbol(e)){const n=t.table.getRuntime(e.name);return n?n.compile(t):u.Const(e.name)}if(!r.r.isSymbol(e.head))throw new Error("Can only apply symbols.");const n=t.table.getRuntime(e.head.name);if(!n)throw new Error(`Symbol '${e.head.name}' is not implemented.`);return n.compile(t,e.args)}function h(t){return m(new s(i),t).fn}},14511:function(t,e,n){n.d(e,{A9:function(){return l},K9:function(){return r},PR:function(){return d},sO:function(){return c}});const r={H:1,D:1,T:1,HE:2,LI:3,BE:4,B:5,C:6,N:7,O:8,F:9,NE:10,NA:11,MG:12,AL:13,SI:14,P:15,S:16,CL:17,AR:18,K:19,CA:20,SC:21,TI:22,V:23,CR:24,MN:25,FE:26,CO:27,NI:28,CU:29,ZN:30,GA:31,GE:32,AS:33,SE:34,BR:35,KR:36,RB:37,SR:38,Y:39,ZR:40,NB:41,MO:42,TC:43,RU:44,RH:45,PD:46,AG:47,CD:48,IN:49,SN:50,SB:51,TE:52,I:53,XE:54,CS:55,BA:56,LA:57,CE:58,PR:59,ND:60,PM:61,SM:62,EU:63,GD:64,TB:65,DY:66,HO:67,ER:68,TM:69,YB:70,LU:71,HF:72,TA:73,W:74,RE:75,OS:76,IR:77,PT:78,AU:79,HG:80,TL:81,PB:82,BI:83,PO:84,AT:85,RN:86,FR:87,RA:88,AC:89,TH:90,PA:91,U:92,NP:93,PU:94,AM:95,CM:96,BK:97,CF:98,ES:99,FM:100,MD:101,NO:102,LR:103,RF:104,DB:105,SG:106,BH:107,HS:108,MT:109},o={1:1.1,2:1.4,3:1.81,4:1.53,5:1.92,6:1.7,7:1.55,8:1.52,9:1.47,10:1.54,11:2.27,12:1.73,13:1.84,14:2.1,15:1.8,16:1.8,17:1.75,18:1.88,19:2.75,20:2.31,21:2.3,22:2.15,23:2.05,24:2.05,25:2.05,26:2.05,27:2,28:2,29:2,30:2.1,31:1.87,32:2.11,33:1.85,34:1.9,35:1.83,36:2.02,37:3.03,38:2.49,39:2.4,40:2.3,41:2.15,42:2.1,43:2.05,44:2.05,45:2,46:2.05,47:2.1,48:2.2,49:2.2,50:1.93,51:2.17,52:2.06,53:1.98,54:2.16,55:3.43,56:2.68,57:2.5,58:2.48,59:2.47,60:2.45,61:2.43,62:2.42,63:2.4,64:2.38,65:2.37,66:2.35,67:2.33,68:2.32,69:2.3,70:2.28,71:2.27,72:2.25,73:2.2,74:2.1,75:2.05,76:2,77:2,78:2.05,79:2.1,80:2.05,81:1.96,82:2.02,83:2.07,84:1.97,85:2.02,86:2.2,87:3.48,88:2.83,89:2,90:2.4,91:2,92:2.3,93:2,94:2,95:2,96:2,97:2,98:2,99:2,100:2,101:2,102:2,103:2,104:2,105:2,106:2,107:2,108:2,109:2},i={1:1.008,2:4.0026,3:6.94,4:9.0122,5:10.81,6:10.81,7:14.007,8:15.999,9:18.998,10:20.18,11:22.99,12:24.305,13:26.982,14:28.085,15:30.974,16:32.06,17:35.45,18:39.948,19:39.098,20:40.078,21:44.956,22:47.867,23:50.942,24:51.996,25:54.938,26:55.845,27:58.933,28:58.693,29:63.546,30:65.38,31:69.723,32:72.63,33:74.922,34:78.971,35:79.904,36:83.798,37:85.468,38:87.62,39:88.906,40:91.224,41:92.906,42:95.95,43:96.906,44:101.07,45:102.91,46:106.42,47:107.87,48:112.41,49:114.82,50:118.71,51:121.76,52:127.6,53:127.6,54:131.29,55:132.91,56:137.33,57:138.91,58:140.12,59:140.91,60:144.24,61:144.912,62:150.36,63:151.96,64:157.25,65:158.93,66:162.5,67:164.93,68:167.26,69:168.93,70:173.05,71:174.97,72:178.49,73:180.95,74:183.84,75:186.21,76:190.23,77:192.22,78:195.08,79:196.97,80:200.59,81:204.38,82:207.2,83:208.98,84:1.97,85:2.02,86:2.2,87:3.48,88:2.83,89:2,90:232.04,91:231.04,92:238.03,93:237.048,94:244.064,95:243.061,96:247.07,97:247.07,98:251.079,99:252.083,100:257.095,101:258.098,102:259.101,103:262.11,104:267.122,105:270.131,106:271.134,107:270.133,108:270.134,109:278.156},s=1.7,a=10.81,u=0;function c(t){const e=r[t];return void 0===e?s:o[e]}function l(t){const e=r[t];return void 0===e?a:i[e]}function d(t){const e=r[t];return void 0===e?u:e}},15387:function(t,e,n){n.d(e,{g:function(){return c}});const r={HIS:"H",ARG:"R",LYS:"K",ILE:"I",PHE:"F",LEU:"L",TRP:"W",ALA:"A",MET:"M",PRO:"P",CYS:"C",ASN:"N",VAL:"V",GLY:"G",SER:"S",GLN:"Q",TYR:"Y",ASP:"D",GLU:"E",THR:"T",SEC:"U",PYL:"O",HSD:"H",HSE:"H",HSP:"H",LSN:"K",ASPP:"D",GLUP:"E",HID:"H",HIE:"H",HIP:"H",LYN:"K",ASH:"D",GLH:"E"},o={DA:"A",DC:"C",DG:"G",DT:"T",DU:"U"},i={A:"A",C:"C",G:"G",T:"T",U:"U"};function s(t){return r[t]||"X"}function a(t){return i[t]||"X"}function u(t){return o[t]||"X"}var c,l=n(27125),d=n(99487);!function(t){let e;!function(t){t.Protein="protein",t.RNA="RNA",t.DNA="DNA",t.Generic="generic"}(e=t.Kind||(t.Kind={})),t.getSequenceString=function(t){const e=t.code.toArray();return(e instanceof Array?e:Array.from(e)).join("")},t.ofResidueNames=function(t,r){if(0===r.rowCount)throw new Error("cannot be empty");const o=function(t){for(let n=0,r=Math.min(t.rowCount,10);n<r;n++){const r=t.value(n)||"";if("X"!==s(r))return e.Protein;if("X"!==a(r))return e.RNA;if("X"!==u(r))return e.DNA}return e.Generic}(t);return new n(o,t,r)};class n{index(t){return this.indexMap.get(t)}constructor(t,n,r){this.kind=t,this.microHet=new Map;const o=function(t,n){let r;switch(t){case e.Protein:r=s;break;case e.DNA:r=u;break;case e.RNA:r=a;break;case e.Generic:r=()=>"X";break;default:(0,d.dr)(t)}return n&&n.size>0?t=>{const e=r(t);return"X"===e&&n.has(t)?r(n.get(t)):e}:r}(t),i=[],c=[],f=[],m=new Map;let h=0;const p=new Map;for(let e=0,s=r.rowCount;e<s;++e){const t=r.value(e);if(p.has(t))m.has(t)?m.get(t).push(n.value(e)):m.set(t,[c[p.get(t)],n.value(e)]);else{p.set(t,h);const r=n.value(e);c[h]=r,f[h]=t,i[h]=o(r),h+=1}}const g=[];for(let e=0,s=h;e<s;++e){const t=m.get(f[e]);if(t){const n=t.map(t=>{const e=o(t);return"X"===e?t:e});g[e]=`(${n.join("|")})`}else g[e]="X"===i[e]?c[e]:i[e]}this.length=h,this.code=l.VP.ofStringArray(i),this.compId=l.VP.ofStringArray(c),this.seqId=l.VP.ofIntArray(f),this.label=l.VP.ofStringArray(g),this.microHet=m,this.indexMap=p}}t.ofSequenceRanges=function(t,n){const o=e.Generic;return new r(o,t,n)};class r{index(t){return t-this.minSeqId}constructor(t,e,n){this.kind=t,this.seqIdStart=e,this.seqIdEnd=n,this.microHet=new Map;let r=0,o=Number.MAX_SAFE_INTEGER;for(let s=0,a=this.seqIdStart.rowCount;s<a;s++){const t=this.seqIdStart.value(s),e=this.seqIdEnd.value(s);t<o&&(o=t),r<e&&(r=e)}const i=r-o+1;this.code=l.VP.ofConst("X",i,l.VP.Schema.str),this.label=l.VP.ofConst("",i,l.VP.Schema.str),this.seqId=l.VP.ofLambda({value:t=>t+o+1,rowCount:i,schema:l.VP.Schema.int}),this.compId=l.VP.ofConst("",i,l.VP.Schema.str),this.length=i,this.minSeqId=o}}}(c||(c={}))},15819:function(t,e,n){n.d(e,{A9:function(){return o.A9},K9:function(){return o.K9},PR:function(){return o.PR},c1:function(){return r.c1},sO:function(){return o.sO},vE:function(){return r.vE},wi:function(){return r.wi},yA:function(){return r.yA}});var r=n(89851),o=n(14511)},17197:function(t,e,n){n.d(e,{Ui:function(){return b},dH:function(){return c},hW:function(){return l}});var r,o=n(86242),i=n(24832),s=n(55178),a=n(83771),u=n(40915);function c(t,e){return g(t,e)}function l(t){return"string"==typeof t?_(t,t,"string"):_(t.title,t.url,t.type||"string",t.body,t.headers)}function d(t){return t?"Failed to download data. Possible reasons: Resource is not available, or CORS is not allowed on the server.":"Failed to open file."}function f(t,e,n){if(a.K)throw new Error("`readData` should not be used when running in Node.js");return new Promise((r,o)=>{if(function(t){if(a.K)throw new Error("`isDone` should not be used when running in Node.js");if(t instanceof FileReader)return t.readyState===FileReader.DONE;if(t instanceof XMLHttpRequest)return t.readyState===XMLHttpRequest.DONE;throw new Error("unknown data type")}(n)){const{error:t}=n;return void(null!=t?o(null!=t?t:d(n instanceof XMLHttpRequest)):r(n))}let i=!1;n.onerror=t=>{if(i)return;const{error:e}=t.target;o(null!=e?e:d(n instanceof XMLHttpRequest))},n.onprogress=n=>{if(t.shouldUpdate&&!i)try{n.lengthComputable?t.update({message:e,isIndeterminate:!1,current:n.loaded,max:n.total}):t.update({message:`${e} ${(n.loaded/1024/1024).toFixed(2)} MB`,isIndeterminate:!0})}catch(n){i=!0,o(n)}},n.onload=t=>{r(n)}})}function m(t){return/\.gz$/i.test(t)?r.Gzip:/\.zip$/i.test(t)?r.Zip:r.None}!function(t){t[t.None=0]="None",t[t.Gzip=1]="Gzip",t[t.Zip=2]="Zip"}(r||(r={}));const h=/^(__MACOSX|.DS_Store)/;async function p(t,e,n,i){if(null===e)throw new Error("no data given");let s=new Uint8Array(e);if(i!==r.None&&"zip"!==n&&(s=await async function(t,e,n){switch(n){case r.None:return e;case r.Gzip:return(0,u.Aq)(t,e);case r.Zip:const n=await(0,u.$1)(t,e.buffer),o=Object.keys(n).filter(t=>!h.test(t));if(1!==o.length)throw new Error("can only decompress zip files with a single entry");return n[o[0]]}}(t,s,i)),"binary"===n)return s;if("zip"===n)return await(0,u.$1)(t,s.buffer);if("string"===n)return(0,o.uu)(s);if("xml"===n){return(new DOMParser).parseFromString((0,o.ss)(s),"application/xml")}if("json"===n)return JSON.parse((0,o.ss)(s));throw new Error(`could not get requested response data '${n}'`)}function g(t,e){if(a.K)return function(t,e){return i.YZ.create("Read File",async n=>{await n.update({message:"Opening file...",canAbort:!1});const r=await t.arrayBuffer();return await n.update({message:"Processing file...",canAbort:!1}),await p(n,r,e,m(t.name))})}(t,e);let n;return i.YZ.create("Read File",async r=>{try{await r.update({message:"Opening file...",canAbort:!0}),n=new FileReader,n.readAsArrayBuffer(t);const o=(await f(r,"Reading...",n)).result;return await r.update({message:"Processing file...",canAbort:!1}),await p(r,o,e,m(t.name))}finally{n=void 0}},()=>{n&&n.abort()})}class y{static get(){if(a.K)throw new Error("`RequestPool.get` should not be used when running in Node.js");return this.pool.length?this.pool.pop():new XMLHttpRequest}static emptyFunc(){}static deposit(t){this.pool.length<this.poolSize&&(t.onabort=y.emptyFunc,t.onerror=y.emptyFunc,t.onload=y.emptyFunc,t.onprogress=y.emptyFunc,this.pool.push(t))}}function _(t,e,n,o,s){if(a.K)return e.startsWith("file://")?function(t,e,n){if(!a.K)throw new Error("This function should only be used when running in Node.js");if(!e.startsWith("file://"))throw new Error("This function is only for URLs with protocol file://");return i.YZ.create(null!=t?t:"Download",async t=>{const o=e.substring(7);await t.update({message:"Loading file...",canAbort:!1});const i=await function(t){return new Promise((e,n)=>{(function(){if(!A)throw new Error("When running in Node.js and reading from files, call mol-util/data-source's setFSModule function first.");return A})().readFile(t,(t,r)=>{t?n(t):e(r)})})}(o);await t.update({message:"Parsing response...",canAbort:!1});return await p(t,i.buffer,n,r.None)})}(t,e,n):function(t,e,n){if(!a.K)throw new Error("This function should only be used when running in Node.js");const o=new AbortController;return i.YZ.create(null!=t?t:"Download",async t=>{await t.update({message:"Downloading...",canAbort:!0});const i=await fetch(e,{signal:o.signal});if(!(i.status>=200&&i.status<400))throw new Error(`Download failed with status code ${i.status}`);const s=await i.bytes();await t.update({message:"Parsing response...",canAbort:!1});return await p(t,s.buffer,n,r.None)},()=>{o.abort()})}(t,e,n);let u;return i.YZ.create(t||"Download",async t=>{if(u=y.get(),u.open(o?"post":"get",e,!0),s)for(const[e,n]of s)u.setRequestHeader(e,n);u.responseType=function(t){switch(t){case"json":return"json";case"xml":return"document";case"string":return"text";case"binary":case"zip":return"arraybuffer"}}(n),u.send(o),await t.update({message:"Waiting for server...",canAbort:!0});const r=await f(t,"Downloading...",u);u=void 0,await t.update({message:"Parsing response...",canAbort:!1});const i=function(t,e){if(t.status>=200&&t.status<400){const{response:n}=t;if(y.deposit(t),("binary"===e||"zip"===e)&&n instanceof ArrayBuffer)return new Uint8Array(n);if("string"===e&&"string"==typeof n)return n;if("xml"===e&&n instanceof XMLDocument)return n;if("json"===e&&"object"==typeof n)return n;throw new Error(`could not get requested response data '${e}'`)}throw y.deposit(t),new Error(`Download failed with status code ${t.status}`)}(r,n);return i},()=>{u&&(u.abort(),u=void 0)})}let A;async function b(t,e,n,r){const o=n.length,i=new Array(n.length);await t.update({message:"Downloading...",current:0,max:o});let a=[],u=[],c=0;for(let d=Math.min(o,r);c<d;c++){const r=n[c];a.push(S(c,r.id,e.resolve(s.V.getUrlAsset(e,r.url),r.isBinary?"binary":"string").runAsChild(t))),u.push(c)}let l=0;for(;a.length>0;){const r=await Promise.race(a),d=n[r.index],f=u.indexOf(r.index);if(l++,"error"===r.kind&&!d.canFail)throw new Error(`${d.url}: ${r.error}`);if(t.shouldUpdate&&await t.update({message:"Downloading...",current:l,max:o}),i[r.index]=r,a=a.filter(C,f),u=u.filter(C,f),c<o){const r=n[c],o=e.resolve(s.V.getUrlAsset(e,r.url),r.isBinary?"binary":"string").runAsChild(t);a.push(S(c,r.id,o)),u.push(c),c++}}return i}function C(t,e){return this!==e}async function S(t,e,n){try{return{kind:"ok",result:await n,index:t,id:e}}catch(r){return{kind:"error",error:r,index:t,id:e}}}y.pool=[],y.poolSize=15},18593:function(t,e,n){n.d(e,{ar:function(){return d.ar},ND:function(){return d.ND},xv:function(){return r.x},D4:function(){return s}});var r=n(77427),o=n(33236),i=n(99487);function s(t){let e=t.data;for(let n=t.encoding.length-1;n>=0;n--)e=a(e,t.encoding[n]);return e}function a(t,e){switch(e.kind){case"ByteArray":switch(e.type){case r.W.IntDataType.Uint8:return t;case r.W.IntDataType.Int8:return function(t){return new Int8Array(t.buffer,t.byteOffset)}(t);case r.W.IntDataType.Int16:return function(t){return l(t,2,Int16Array)}(t);case r.W.IntDataType.Uint16:return function(t){return l(t,2,Uint16Array)}(t);case r.W.IntDataType.Int32:return function(t){return l(t,4,Int32Array)}(t);case r.W.IntDataType.Uint32:return function(t){return l(t,4,Uint32Array)}(t);case r.W.FloatDataType.Float32:return function(t){return l(t,4,Float32Array)}(t);case r.W.FloatDataType.Float64:return function(t){return l(t,8,Float64Array)}(t);default:(0,i.dr)(e.type)}case"FixedPoint":return function(t,e){const n=t.length,r=c(e.srcType,n),o=1/e.factor;for(let i=0;i<n;i++)r[i]=o*t[i];return r}(t,e);case"IntervalQuantization":return function(t,e){const n=t.length,r=c(e.srcType,n),o=(e.max-e.min)/(e.numSteps-1),i=e.min;for(let s=0;s<n;s++)r[s]=i+o*t[s];return r}(t,e);case"RunLength":return function(t,e){const n=u(e.srcType,e.srcSize);let r=0;for(let o=0,i=t.length;o<i;o+=2){const e=t[o],i=t[o+1];for(let t=0;t<i;++t)n[r++]=e}return n}(t,e);case"Delta":return function(t,e){const n=t.length,r=u(e.srcType,n);if(!n)return t;r[0]=t[0]+(0|e.origin);for(let o=1;o<n;++o)r[o]=t[o]+r[o-1];return r}(t,e);case"IntegerPacking":return function(t,e){return t.length===e.srcSize?t:e.isUnsigned?function(t,e){const n=1===e.byteCount?255:65535,r=t.length,o=new Int32Array(e.srcSize);let i=0,s=0;for(;i<r;){let e=0,r=t[i];for(;r===n;)e+=r,i++,r=t[i];e+=r,o[s]=e,i++,s++}return o}(t,e):function(t,e){const n=1===e.byteCount?127:32767,r=-n-1,o=t.length,i=new Int32Array(e.srcSize);let s=0,a=0;for(;s<o;){let e=0,o=t[s];for(;o===n||o===r;)e+=o,s++,o=t[s];e+=o,i[a]=e,s++,a++}return i}(t,e)}(t,e);case"StringArray":return function(t,e){const n=s({encoding:e.offsetEncoding,data:e.offsets}),r=s({encoding:e.dataEncoding,data:t}),o=e.stringData,i=new Array(n.length);i[0]="";for(let s=1,c=n.length;s<c;s++)i[s]=o.substring(n[s-1],n[s]);let a=0;const u=new Array(r.length);for(let s=0,c=r.length;s<c;s++)u[a++]=i[r[s]+1];return u}(t,e)}}function u(t,e){switch(t){case r.W.IntDataType.Int8:return new Int8Array(e);case r.W.IntDataType.Int16:return new Int16Array(e);case r.W.IntDataType.Int32:return new Int32Array(e);case r.W.IntDataType.Uint8:return new Uint8Array(e);case r.W.IntDataType.Uint16:return new Uint16Array(e);case r.W.IntDataType.Uint32:return new Uint32Array(e);default:return new Int32Array(e)}}function c(t,e){switch(t){case r.W.FloatDataType.Float32:return new Float32Array(e);case r.W.FloatDataType.Float64:default:return new Float64Array(e)}}function l(t,e,n){return o.vX?new n(t.buffer):new n((0,o.yw)(t,e))}var d=n(99572);n(37631)},19600:function(t,e,n){n.d(e,{u:function(){return r}});var r,o=n(65533),i=n(38530),s=n(46031),a=n(73868),u=n(24832),c=n(10486),l=n(73150),d=n(31960),f=n(69926),m=n(35256),h=n(64059);function p(t){return l.RT.generators.atoms({chainTest:l.RT.pred.and(l.RT.pred.eq(t=>h.Z.unit.operator_name(t.element),s.JX.DefaultName),l.RT.pred.inSet(t=>h.Z.chain.label_asym_id(t.element),t))})}function g(t,e,n,r,o,i){const{spacegroup:u,ncsOperators:c}=t,l=[],{toFractional:d}=u.cell,f=a.eB.transformMat4((0,a.eB)(),i,d),m=s.is.getSymmetryOperatorRef(u,e,n,r,o,f);if(c&&c.length)for(let h=0,p=c.length;h<p;++h){const t=c[h],e=a.$I.mul((0,a.$I)(),m.matrix,t.matrix),n=s.JX.create(`${m.name} ${t.name}`,e,{assembly:m.assembly,ncsId:t.ncsId,hkl:m.hkl,spgrOp:m.spgrOp});l.push(n)}else l.push(m);return l}function y(t,e,n,r){const{spacegroup:o,ncsOperators:i}=t,a=i&&i.length||0,u=[];!a&&e[0]<=0&&n[0]>=0&&e[1]<=0&&n[1]>=0&&e[2]<=0&&n[2]>=0&&(u[0]=s.is.getSymmetryOperator(o,0,0,0,0));for(let s=0;s<o.operators.length;s++)for(let o=e[0];o<=n[0];o++)for(let i=e[1];i<=n[1];i++)for(let c=e[2];c<=n[2];c++)(a||0!==s||0!==o||0!==i||0!==c)&&u.push(...g(t,s,o,i,c,r));return u}function _(t,e){const n=d.o.Builder({label:t.label,dynamicBonds:t.dynamicBonds}),{units:r}=t;for(const o of e)for(const t of r)n.addWithOperator(t,o);return n.getStructure()}!function(t){function e(t,e){return t.invariantId===e.invariantId&&t.model.id===e.model.id&&o.X9.areEqual(t.elements,e.elements)}function n(){return(0,i.BI)(f.N.hashUnit,e)}t.buildAssembly=function(t,e){return u.YZ.create("Build Assembly",async n=>{const r=t.models;if(1!==r.length)throw new Error("Can only build assemblies from structures based on 1 model.");const o=c.vw.findAssembly(r[0],e);if(!o)throw new Error(`Assembly '${e}' is not defined.`);const i=s.JX.create(o.id,a.$I.identity(),{assembly:{id:o.id,operId:0,operList:[]}}),u=d.o.Builder({coordinateSystem:i,label:t.label,dynamicBonds:t.dynamicBonds}),f=new l.cY(t);for(const t of o.operatorGroups){const e=t.selector(f);if(0===l.cv.structureCount(e))continue;const{units:n}=l.cv.unionStructure(e);for(const r of t.operators)for(const t of n)u.addWithOperator(t,r)}return u.getStructure()})},t.buildSymmetryAssembly=function(t,e,n){return u.YZ.create("Build Symmetry Assembly",async r=>{const o=t.models;if(1!==o.length)throw new Error("Can only build symmetry assemblies from structures based on 1 model.");const i=(0,a.eB)(),s=d.o.Builder({label:t.label,representativeModel:o[0],dynamicBonds:t.dynamicBonds}),u=new l.cY(t);for(const t of e){const e=p(t.asymIds)(u);if(0===l.cv.structureCount(e))continue;const{units:r}=l.cv.unionStructure(e);for(const{index:o,shift:[a,u,c]}of t.operators){const t=g(n,o,a,u,c,i);for(const e of r)for(const n of t)s.addWithOperator(e,n)}}return s.getStructure()})},t.builderSymmetryMates=function(t,e){return u.YZ.create("Find Symmetry Mates",n=>async function(t,e,n){const r=e.models;if(1!==r.length)throw new Error("Can only build symmetries from structures based on 1 model.");const o=m.i.Provider.get(r[0]);if(!o)return e;const{spacegroup:i}=o;if(s.O8.isZero(i.cell))return e;t.shouldUpdate&&await t.update("Initialing...");const u=c.Kx.getCenter(r[0]),l=function(t,e){if(t._operators_333&&a.eB.equals(e,t._operators_333.ref))return t._operators_333.operators;return t._operators_333={ref:a.eB.clone(e),operators:y(t,a.eB.create(-3,-3,-3),a.eB.create(3,3,3),e)},t._operators_333.operators}(o,u),f=e.lookup3d,h=new Set;function p(t,e){return`${t.invariantId}|${e.name}`}const g=d.o.Builder({label:e.label,dynamicBonds:e.dynamicBonds}),{units:_}=e,A=a.eB.zero();for(const s of l){for(const t of _){const e=t.lookup3d.boundary.sphere;a.eB.transformMat4(A,e.center,s.matrix);const r=f.findUnitIndices(A[0],A[1],A[2],e.radius+n);for(let o=0,i=r.count;o<i;o++){if(!_[r.indices[o]].lookup3d.check(A[0],A[1],A[2],e.radius+n))continue;const i=p(t,s);h.has(i)||(g.addWithOperator(t,s),h.add(i))}}t.shouldUpdate&&await t.update("Building symmetry...")}return g.getStructure()}(n,t,e))},t.buildSymmetryRange=function(t,e,n){return u.YZ.create("Build Symmetry",r=>async function(t,e,n,r){const o=e.models;if(1!==o.length)throw new Error("Can only build symmetries from structures based on 1 model.");const i=m.i.Provider.get(o[0]);if(!i)return e;const{spacegroup:a}=i;if(s.O8.isZero(a.cell))return e;const u=c.Kx.getCenter(o[0]),l=y(i,n,r,u);return _(e,l)}(0,t,e,n))},t.buildNcs=function(t){return u.YZ.create("Build NCS",e=>async function(t,e){const n=e.models;if(1!==n.length)throw new Error("Can only build NCS from structures based on 1 model.");const r=m.i.Provider.get(n[0]);if(!r)return e;const o=r.ncsOperators;return o&&o.length?_(e,o):e}(0,t))},t.areUnitsEquivalent=e,t.UnitEquivalenceBuilder=n,t.computeTransformGroups=function(t){const e=n();for(const n of t.units)e.add(n.id,n);const r=[];for(const n of e.groups)r.push(f.N.SymmetryGroup(n.map(e=>t.unitMap.get(e))));return r},t.areTransformGroupsEquivalent=function(t,e){if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;++n){const r=t[n].units,o=e[n].units;if(r.length!==o.length)return!1;if(t[n].hashCode!==e[n].hashCode)return!1;for(let t=0,e=r.length;t<e;t++)if(r[t].conformation!==o[t].conformation)return!1}return!0}}(r||(r={}))},20722:function(t,e,n){function r(t,e,n){let r,o=1;for(r=0;r<e;r++){const e=o*t;if(Math.abs(Math.round(e)-e)<=n)return r;o*=10}return-1}function o(t,e){return Math.abs(t)<e?0:Math.floor(Math.log10(Math.abs(t)))+1}function i(t,e,n){let o=1,i=0;for(let s=0,a=t.length;s<a;s++){if(o>=0){const i=r(t[s],e,n);i<0?o=-1:i>o&&(o=i)}const a=Math.abs(t[s]);if(a>n){const t=Math.floor(Math.log10(Math.abs(a)))+1;t>i&&(i=t)}}return{mantissaDigits:o,integerDigits:i}}function s(t){t=t.trim();const e=parseInt(t,10);return!Number.isNaN(e)&&e.toString()===t}function a(t){if(!isFinite(t))return 0;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,++n;return n}function u(t,e){return parseFloat(t.toPrecision(e))}function c(t,e){return parseFloat(t.toFixed(e))}n.d(e,{Fq:function(){return s},In:function(){return i},Mg:function(){return c},QX:function(){return u},XV:function(){return a},bL:function(){return o}})},21002:function(t,e,n){var r;n.d(e,{H:function(){return r}}),function(t){t.error=function(t,n=-1){return new e(t,n)},t.success=function(t,e=[]){return new n(t,e)};class e{toString(){return this.line>=0?`[Line ${this.line}] ${this.message}`:this.message}constructor(t,e){this.message=t,this.line=e,this.isError=!0}}t.Error=e;class n{constructor(t,e){this.result=t,this.warnings=e,this.isError=!1}}t.Success=n}(r||(r={}))},21087:function(t,e,n){n.d(e,{IQ:function(){return a},xv:function(){return s}});var r,o=n(84729);!function(t){t.create=function(t){return{ref:t}},t.set=function(t,e){return t.ref=e,t}}(r||(r={}));const i=(0,o.q)(0,2147483647);var s,a;!function(t){t.create=function(t,e){return{id:i(),version:0,value:t,metadata:e}},t.withValue=function(t,e){return{id:t.id,version:t.version+1,value:e,metadata:t.metadata}}}(s||(s={})),function(t){function e(t,e){return r.set(t,s.withValue(t.ref,e))}t.create=function(t,e){return r.create(s.create(t,e))},t.update=e,t.set=function(t,e){return r.set(t,e)},t.updateIfChanged=function(t,n){return t.ref.value!==n?e(t,n):t}}(a||(a={}))},21544:function(t,e,n){n.d(e,{K:function(){return u}});var r=n(70888),o=n(15819),i=n(59859),s=n(73868),a=n(31186);var u,c=n(52780),l=n(24832),d=n(94901),f=n(63346),m=n(26511),h=n(35256),p=n(27125),g=n(75434),y=n(8429),_=n(52500),A=n(93739);!function(t){function e(e,o){const s=[],{frames:a}=o,c=n(e),l=w(e),d=e.atomicHierarchy.atoms._rowCount;for(let n=0,f=a.length;n<f;++n){const o=a[n];if(o.elementCount!==d)throw new Error(`Frame element count mismatch, got ${o.elementCount} but expected ${d}.`);const c={...e,id:r.k.create22(),modelNum:n,atomicConformation:u(e,o),customProperties:new i.v,_staticPropertyData:Object.create(null),_dynamicPropertyData:Object.create(null)};if(o.cell){const t=h.i.fromCell(o.cell.size,o.cell.anglesInRadians);h.i.Provider.set(c,t)}t.TrajectoryInfo.set(c,{index:n,size:a.length}),t.CoarseGrained.set(c,l),s.push(c)}return{trajectory:s,srcIndexArray:c}}function n(t){const e=t.atomicHierarchy.atomSourceIndex;let n;return"__srcIndexArray__"in t._staticPropertyData?n=t._dynamicPropertyData.__srcIndexArray__:(n=p.VP.isIdentity(e)?void 0:e.toArray({array:Int32Array}),t._dynamicPropertyData.__srcIndexArray__=n),n}function u(t,e){return c.E.getAtomicConformation(e,{atomId:t.atomicConformation.atomId,occupancy:t.atomicConformation.occupancy,B_iso_or_equiv:t.atomicConformation.B_iso_or_equiv},n(t))}t.trajectoryFromModelAndCoordinates=function(t,n){return new y.P(e(t,n).trajectory)},t.trajectoryFromTopologyAndCoordinates=function(n,r){return l.YZ.create("Create Trajectory",async o=>{const i=await(0,f.X)(n.basic,n.sourceData,o);if(0===i.frameCount)throw new Error("found no model");const s=i.representative,{trajectory:a}=e(s,r),u={pairs:n.bonds,count:s.atomicHierarchy.atoms._rowCount},c=d.z.fromData(u),l=w(s);let m=0;for(const e of a)d.z.Provider.set(e,c),t.TrajectoryInfo.set(e,{index:m++,size:a.length}),t.CoarseGrained.set(e,l);return new y.P(a)})},t.getAtomicConformationFromFrame=u;const b="__Center__";t.getCenter=function(t){if(t._dynamicPropertyData[b])return t._dynamicPropertyData[b];const e=function(t,e){const n=[],r=[],o=[];t.x.length&&(n.push(...(0,a.em)(t.x)),r.push(...(0,a.em)(t.y)),o.push(...(0,a.em)(t.z))),e&&(e.spheres.x.length&&(n.push(...(0,a.em)(e.spheres.x)),r.push(...(0,a.em)(e.spheres.y)),o.push(...(0,a.em)(e.spheres.z))),e.gaussians.x.length&&(n.push(...(0,a.em)(e.gaussians.x)),r.push(...(0,a.em)(e.gaussians.y)),o.push(...(0,a.em)(e.gaussians.z))));const[i,u]=(0,a.em)(n),[c,l]=(0,a.em)(r),[d,f]=(0,a.em)(o),m=i+(u-i)/2,h=c+(l-c)/2,p=d+(f-d)/2;return s.eB.create(m,h,p)}(t.atomicConformation,t.coarseConformation);return t._dynamicPropertyData[b]=e,e};const C="__AtomicRadii__";t.getAtomicRadii=function(t){if(t._dynamicPropertyData[C])return t._dynamicPropertyData[C];const e=t.atomicHierarchy.atoms._rowCount,n=t.atomicHierarchy.atoms.type_symbol.value,r=new Float32Array(e);for(let i=0;i<e;i++)r[i]=(0,o.sO)(n(i));return t._dynamicPropertyData[C]=r,r};const S="__InvertedAtomSrcIndex__";t.getInvertedAtomSourceIndex=function(t){if(t._staticPropertyData[S])return t._staticPropertyData[S];const e=function(t){const e=new Int32Array(t.rowCount);let n=!1;for(let r=0,o=t.rowCount;r<o;r++){const o=t.value(r);o!==r&&(n=!1),e[o]=r}return{isIdentity:n,invertedIndex:e}}(t.atomicHierarchy.atomSourceIndex);return t._staticPropertyData[S]=e,e};const x="__TrajectoryInfo__";t.TrajectoryInfo={get(t){return t._dynamicPropertyData[x]||{index:0,size:1}},set(t,e){return t._dynamicPropertyData[x]=e}};const v="__AsymIdCount__";t.AsymIdCount={get(t){if(t._dynamicPropertyData[v])return t._dynamicPropertyData[v];const e=function(t){const e=new Set,n=new Set;return t.properties.structAsymMap.forEach(({auth_id:t},r)=>{e.add(t),n.add(r)}),{auth:e.size,label:n.size}}(t);return t._dynamicPropertyData[v]=e,e}},t.AsymIdOffset=g._.createSimple("asym_id_offset","static"),t.Index=g._.createSimple("index","static"),t.MaxIndex=g._.createSimple("max_index","static"),t.getRoot=function(t){return t.parent||t},t.areHierarchiesEqual=function(t,e){return t.atomicHierarchy===e.atomicHierarchy&&t.coarseHierarchy===e.coarseHierarchy};const B="__CoordinatesHistory__";t.CoordinatesHistory={get(t){return t._staticPropertyData[B]},set(t,e){return t._staticPropertyData[B]=e}};const I="__CoarseGrained__";function w(e){let n=t.CoarseGrained.get(e);if(void 0===n){let r=0,o=0;const{polymerType:i,directionToElementIndex:s}=e.atomicHierarchy.derived.residue;for(let t=0;t<i.length;++t)i[t]!==_.XB.NA&&(r+=1,-1!==s[t]&&(o+=1));let a=!1,u=!1;const{label_atom_id:c,_rowCount:l}=e.atomicHierarchy.atoms;for(let t=0;t<l;++t){const e=c.value(t);if(a||"BB"!==e||(a=!0),u||"SC1"!==e||(u=!0),a&&u)break}n=!1,l>0&&r>0&&(a&&u||l/r<3||0===o)&&(n=!0),t.CoarseGrained.set(e,n)}return n}function P(t){return!!m.K4.is(t.sourceData)&&(null!==t.entryId.match(/^[1-9][a-z0-9]{3,3}$/i)||null!==t.entryId.match(/^pdb_[0-9]{4,4}[1-9][a-z0-9]{3,3}$/i))}t.CoarseGrained={get(t){return t._staticPropertyData[I]},set(t,e){return t._staticPropertyData[I]=e}},t.isCoarseGrained=w,t.hasCarbohydrate=function(t){return t.properties.saccharideComponentMap.size>0},t.hasProtein=function(t){const{subtype:e}=t.entities;for(let n=0,r=e.rowCount;n<r;++n)if(e.value(n).startsWith("polypeptide"))return!0;return!1},t.hasNucleic=function(t){const{subtype:e}=t.entities;for(let n=0,r=e.rowCount;n<r;++n){const t=e.value(n);if(t.endsWith("ribonucleotide hybrid")||t.endsWith("ribonucleotide"))return!0}return!1},t.isFromPdbArchive=function(t){if(!m.K4.is(t.sourceData))return!1;const{db:e}=t.sourceData.data;for(let n=0,r=e.database_2.database_id.rowCount;n<r;++n)if("pdb"===e.database_2.database_id.value(n))return!0;return!1},t.hasPdbId=P,t.hasSecondaryStructure=function(t){if(m.K4.is(t.sourceData)){const{db:e}=t.sourceData.data;return e.struct_conf.id.isDefined||e.struct_sheet_range.id.isDefined}return A.v.Provider.isApplicable(t)};const D=s.eB.create(1.5707963,1.5707963,1.5707963),M=s.eB.create(1,1,1);function N(t){if(!m.K4.is(t.sourceData))return!1;const{db:e}=t.sourceData.data;for(let n=0;n<e.exptl.method.rowCount;n++){if(e.exptl.method.value(n).toUpperCase().indexOf("DIFFRACTION")>=0)return!0}return!1}function E(t){if(!m.K4.is(t.sourceData))return!1;const{db:e}=t.sourceData.data;for(let n=0;n<e.exptl.method.rowCount;n++){if(e.exptl.method.value(n).toUpperCase().indexOf("MICROSCOPY")>=0)return!0}return!1}function k(t){if(!m.K4.is(t.sourceData))return!1;if(!N(t))return!1;const{db:e}=t.sourceData.data,{status_code_sf:n}=e.pdbx_database_status;return n.isDefined&&"REL"===n.value(0)}function T(t){if(!m.K4.is(t.sourceData))return!1;const{db:e}=t.sourceData.data,{db_name:n,content_type:r}=e.pdbx_database_related;for(let o=0,i=e.pdbx_database_related._rowCount;o<i;++o)if("EMDB"===n.value(o).toUpperCase()&&"associated EM volume"===r.value(o))return!0;return!1}function R(t){return!!m.K4.is(t.sourceData)&&(k(t)||T(t))}t.hasCrystalSymmetry=function(t){var e;const n=null===(e=h.i.Provider.get(t))||void 0===e?void 0:e.spacegroup;return!(!n||1===n.num&&s.eB.equals(n.cell.anglesInRadians,D)&&s.eB.equals(n.cell.size,M))},t.isFromXray=N,t.isFromEm=E,t.isFromNmr=function(t){if(!m.K4.is(t.sourceData))return!1;const{db:e}=t.sourceData.data;for(let n=0;n<e.exptl.method.rowCount;n++){if(e.exptl.method.value(n).toUpperCase().indexOf("NMR")>=0)return!0}return!1},t.isExperimental=function(t){if(!m.K4.is(t.sourceData))return!1;const{db:e}=t.sourceData.data;for(let n=0;n<e.struct.pdbx_structure_determination_methodology.rowCount;n++)if("experimental"===e.struct.pdbx_structure_determination_methodology.value(n).toLowerCase())return!0;return!1},t.isIntegrative=function(t){if(!m.K4.is(t.sourceData))return!1;const{db:e}=t.sourceData.data;for(let n=0;n<e.struct.pdbx_structure_determination_methodology.rowCount;n++)if("integrative"===e.struct.pdbx_structure_determination_methodology.value(n).toLowerCase())return!0;return!1},t.isComputational=function(t){if(!m.K4.is(t.sourceData))return!1;const{db:e}=t.sourceData.data;for(let n=0;n<e.struct.pdbx_structure_determination_methodology.rowCount;n++)if("computational"===e.struct.pdbx_structure_determination_methodology.value(n).toLowerCase())return!0;return!1},t.hasXrayMap=k,t.hasEmMap=T,t.hasDensityMap=R,t.probablyHasDensityMap=function(e){if(!m.K4.is(e.sourceData))return!1;if(t.isIntegrative(e))return!1;const{db:n}=e.sourceData.data;return R(e)||P(e)&&(!n.exptl.method.isDefined||N(e)&&(!n.pdbx_database_status.status_code_sf.isDefined||n.pdbx_database_status.status_code_sf.valueKind(0)===p.VP.ValueKinds.Unknown)||E(e)&&!n.pdbx_database_related.db_name.isDefined)}}(u||(u={}))},21547:function(t,e,n){n.d(e,{i:function(){return r}});var r={};n.r(r),n.d(r,{Bundle:function(){return a.N},Location:function(){return i.a},Loci:function(){return s.Q},Schema:function(){return u.S},Stats:function(){return o},atomicProperty:function(){return h},chainIndex:function(){return y},coarseProperty:function(){return p},entityIndex:function(){return _},property:function(){return f},residueIndex:function(){return g}});var o,i=n(78012),s=n(1342),a=n(88255),u=n(64096),c=n(65533),l=n(69926);!function(t){function e(){return{elementCount:0,conformationCount:0,residueCount:0,chainCount:0,unitCount:0,structureCount:0,firstElementLoc:i.a.create(void 0),firstConformationLoc:i.a.create(void 0),firstResidueLoc:i.a.create(void 0),firstChainLoc:i.a.create(void 0),firstUnitLoc:i.a.create(void 0),firstStructureLoc:i.a.create(void 0)}}function n(t,e,n){const r=t.get(e)||0;t.set(e,r+n)}function r(t,e,r){const{indices:o,unit:s}=r,{elements:a}=s,u=c.CD.size(o),d=new Map,f=new Map;if(u>0&&i.a.set(t.firstElementLoc,e,s,a[c.CD.start(o)]),u===a.length)t.unitCount+=1,1===t.unitCount&&i.a.set(t.firstUnitLoc,e,s,a[c.CD.start(o)]);else if(1===u){if(l.N.Traits.is(s.traits,l.N.Trait.MultiChain))return;t.elementCount+=1,1===t.elementCount&&i.a.set(t.firstElementLoc,e,s,a[c.CD.start(o)])}else if(l.N.isAtomic(s)){const{index:r,offsets:l}=s.model.atomicHierarchy.residueAtomSegments,{label_alt_id:m}=s.model.atomicHierarchy.atoms;let h=0;for(;h<u;){d.clear();let p=0;const g=a[c.CD.getAt(o,h)],y=r[g];for(n(d,m.value(g),1),++h,++p;h<u;){const t=a[c.CD.getAt(o,h)];if(r[t]!==y)break;n(d,m.value(t),1),++h,++p}if(l[y+1]-l[y]===p)t.residueCount+=1,1===t.residueCount&&i.a.set(t.firstResidueLoc,e,s,l[y]);else{f.clear();for(let t=l[y],e=l[y+1];t<e;++t)n(f,m.value(t),1);f.get("")===d.get("")&&d.forEach((n,r)=>{if(f.get(r)===n){if(""!==r&&(t.conformationCount+=1,1===t.conformationCount))for(let n=l[y],o=l[y+1];n<o;++n)if(r===m.value(n)){i.a.set(t.firstConformationLoc,e,s,n);break}p-=n}}),t.elementCount+=p}}}else t.elementCount+=u,1===t.elementCount&&i.a.set(t.firstElementLoc,e,s,a[c.CD.start(o)])}function o(t,e,n){const{indices:r,unit:o}=n,s=c.CD.size(r);if(0===s)return;const{elements:a}=o;if(!l.N.Traits.is(o.traits,l.N.Trait.MultiChain))return void(s===a.length&&(t.chainCount+=1,1===t.chainCount&&i.a.set(t.firstChainLoc,e,o,a[c.CD.start(r)])));const u=l.N.isAtomic(o)?o.model.atomicHierarchy.chainAtomSegments:l.N.isSpheres(o)?o.model.coarseHierarchy.spheres.chainElementSegments:l.N.isGaussians(o)?o.model.coarseHierarchy.gaussians.chainElementSegments:void 0;if(!u)return void console.warn("StructureElement loci stats: unknown unit type");const{index:d,offsets:f}=u;let m=0;for(;m<s;){let n=0;const u=a[c.CD.getAt(r,m)],l=d[u];for(++m,++n;m<s;){if(d[a[c.CD.getAt(r,m)]]!==l)break;++m,++n}f[l+1]-f[l]===n?(t.chainCount+=1,1===t.chainCount&&i.a.set(t.firstChainLoc,e,o,f[l])):1===s&&(t.elementCount+=1,1===t.elementCount&&i.a.set(t.firstElementLoc,e,o,u))}}function a(t,e,r,o,s){let a=r[o];const u=l.N.isAtomic(a.unit)?a.unit.model.atomicHierarchy.chainAtomSegments:l.N.isSpheres(a.unit)?a.unit.model.coarseHierarchy.spheres.chainElementSegments:l.N.isGaussians(a.unit)?a.unit.model.coarseHierarchy.gaussians.chainElementSegments:void 0;if(!u)return void console.warn("StructureElement loci stats: unknown unit type");const{index:d,offsets:f}=u,m=new Map;for(let i=o;i<s;i++){a=r[i];const{indices:t,unit:e}=a,o=c.CD.size(t);if(0===o)continue;const{elements:s}=e;if(!l.N.Traits.is(e.traits,l.N.Trait.MultiChain)){n(m,d[s[c.CD.start(t)]],s.length);continue}let u=0;for(;u<o;){let e=0;const r=d[s[c.CD.getAt(t,u)]];for(++u,++e;u<o;){if(d[s[c.CD.getAt(t,u)]]!==r)break;++u,++e}n(m,r,e)}}let h=-1;if(m.forEach((e,n)=>{f[n+1]-f[n]===e&&(t.chainCount+=1,1===t.chainCount&&(h=n))}),!(h<0))for(let n=o;n<s;n++){a=r[n];const{indices:o,unit:s}=a,u=c.CD.size(o);if(0===u)continue;const{elements:l}=s,f=0;for(;f<u;){const n=l[c.CD.getAt(o,f)];if(d[n]===h)return void i.a.set(t.firstChainLoc,e,s,n)}}}t.create=e,t.ofLoci=function(t){const n=e();if(s.Q.isEmpty(t))return n;let u=!1;if(s.Q.isWholeStructure(t)){if(n.structureCount+=1,1===n.structureCount){const{unit:e,indices:r}=t.elements[0];i.a.set(n.firstStructureLoc,t.structure,e,e.elements[c.CD.min(r)])}}else for(const e of t.elements)r(n,t.structure,e),l.N.Traits.is(e.unit.traits,l.N.Trait.Partitioned)?u=!0:o(n,t.structure,e);if(u)for(let e=0,r=t.elements.length;e<r;e++){const i=t.elements[e];if(!l.N.Traits.is(i.unit.traits,l.N.Trait.Partitioned))continue;const s=e;for(;e<r&&l.N.areSameChainOperatorGroup(t.elements[e].unit,i.unit);)e++;const u=e;e--,u-s===1?o(n,t.structure,i):a(n,t.structure,t.elements,s,u)}return n},t.add=function(t,e,n){return 1===e.elementCount&&0===n.elementCount?i.a.copy(t.firstElementLoc,e.firstElementLoc):0===e.elementCount&&1===n.elementCount&&i.a.copy(t.firstElementLoc,n.firstElementLoc),1===e.conformationCount&&0===n.conformationCount?i.a.copy(t.firstConformationLoc,e.firstConformationLoc):0===e.conformationCount&&1===n.conformationCount&&i.a.copy(t.firstConformationLoc,n.firstConformationLoc),1===e.residueCount&&0===n.residueCount?i.a.copy(t.firstResidueLoc,e.firstResidueLoc):0===e.residueCount&&1===n.residueCount&&i.a.copy(t.firstResidueLoc,n.firstResidueLoc),1===e.chainCount&&0===n.chainCount?i.a.copy(t.firstChainLoc,e.firstChainLoc):0===e.chainCount&&1===n.chainCount&&i.a.copy(t.firstChainLoc,n.firstChainLoc),1===e.unitCount&&0===n.unitCount?i.a.copy(t.firstUnitLoc,e.firstUnitLoc):0===e.unitCount&&1===n.unitCount&&i.a.copy(t.firstUnitLoc,n.firstUnitLoc),1===e.structureCount&&0===n.structureCount?i.a.copy(t.firstStructureLoc,e.firstStructureLoc):0===e.structureCount&&1===n.structureCount&&i.a.copy(t.firstStructureLoc,n.firstStructureLoc),t.elementCount=e.elementCount+n.elementCount,t.conformationCount=e.conformationCount+n.conformationCount,t.residueCount=e.residueCount+n.residueCount,t.chainCount=e.chainCount+n.chainCount,t.unitCount=e.unitCount+n.unitCount,t.structureCount=e.structureCount+n.structureCount,t}}(o||(o={}));var d=n(64059);function f(t){return t}function m(t){throw new Error(`Property only available for ${t} models.`)}function h(t){return e=>l.N.isAtomic(e.unit)?t(e):m("atomic")}function p(t){return e=>l.N.isCoarse(e.unit)?t(e):m("coarse")}function g(t){return l.N.isAtomic(t.unit)?t.unit.residueIndex[t.element]:-1}function y(t){return l.N.isAtomic(t.unit)?t.unit.chainIndex[t.element]:-1}function _(t){return d.Z.entity.key(t)}},22463:function(t,e,n){n.d(e,{J:function(){return r}});var r,o=n(41430),i=n(22753),s=n(95156),a=n(78605),u=n(98537);function c(t){return 0}!function(t){function e(e,r,o){var i;let{assembly:a,ncsId:c,hkl:l,spgrOp:d,key:f}=o||{};const m=l?u.e.clone(l):(0,u.e)();d=null!=d?d:-1,f=null!=f?f:-1,c=c||-1;const h=s.$.isIdentity(r),p=function(t,e){if(!t)return"";if(t.assembly)return(r=t)&&r.matrix&&r.inverse&&"string"==typeof r.name?t.suffix:e?"":`_${t.assembly.operId}`;var r;if(void 0!==t.spgrOp&&void 0!==t.hkl&&-1!==t.spgrOp){const[e,r,o]=t.hkl;return`-${n(t.spgrOp,e,r,o)}`}if(-1!==t.ncsId)return`_${t.ncsId}`;return""}(o,h),g=null!==(i=null==o?void 0:o.instanceId)&&void 0!==i?i:e;return h?{name:e,instanceId:g,assembly:a,matrix:r,inverse:s.$.identity(),isIdentity:!0,hkl:m,spgrOp:d,ncsId:c,suffix:p,key:f}:(s.$.isRotationAndTranslation(r,t.RotationTranslationEpsilon)||console.warn(`Symmetry operator (${e}) should be a composition of rotation and translation.`),{name:e,instanceId:g,assembly:a,matrix:r,inverse:s.$.invert((0,s.$)(),r),isIdentity:!1,hkl:m,spgrOp:d,key:f,ncsId:c,suffix:p})}function n(t,e,n,r){const o=t=>t>=0&&t<=9?`${t}`:`(${t})`;return`${t+1}_${o(e+5)}${o(n+5)}${o(r+5)}`}t.DefaultName="1_555",t.Default=e(t.DefaultName,s.$.identity()),t.RotationTranslationEpsilon=.005,t.create=e,t.getSymmetryOperatorName=n,t.getAssemblyOperatorName=function(t){return"ASM-"+t.join("-")};const r=(0,s.$)();t.checkIfRotationAndTranslation=function(e,n){s.$.setIdentity(r);for(let t=0;t<3;t++)for(let n=0;n<3;n++)s.$.setValue(r,t,n,i.U.getValue(e,t,n));return s.$.setTranslation(r,n),s.$.isRotationAndTranslation(r,t.RotationTranslationEpsilon)},t.ofRotationAndOffset=function(t,n,r,o){const a=s.$.identity();for(let e=0;e<3;e++)for(let t=0;t<3;t++)s.$.setValue(a,e,t,i.U.getValue(n,e,t));return s.$.setTranslation(a,r),e(t,a,{ncsId:o})};const l=a.k.identity(),d=(0,a.k)(),f=(0,a.k)(),m=(0,u.e)();t.lerpFromIdentity=function(t,e,n){const r=e.inverse;if(e.isIdentity)return s.$.copy(t,r);const o=1-n;s.$.getRotation(d,r),a.k.slerp(d,l,d,o);const i=a.k.getAxisAngle(m,d);return s.$.fromRotation(t,i,m),s.$.setValue(t,0,3,o*s.$.getValue(r,0,3)),s.$.setValue(t,1,3,o*s.$.getValue(r,1,3)),s.$.setValue(t,2,3,o*s.$.getValue(r,2,3)),t},t.slerp=function(t,e,n,r){if(Math.abs(r)<=1e-5)return s.$.copy(t,e);if(Math.abs(r-1)<=1e-5)return s.$.copy(t,n);s.$.getRotation(d,e),s.$.getRotation(f,n),a.k.slerp(f,d,f,r);const i=a.k.getAxisAngle(m,f);return s.$.fromRotation(t,i,m),s.$.setValue(t,0,3,(0,o.Cc)(s.$.getValue(e,0,3),s.$.getValue(n,0,3),r)),s.$.setValue(t,1,3,(0,o.Cc)(s.$.getValue(e,1,3),s.$.getValue(n,1,3),r)),s.$.setValue(t,2,3,(0,o.Cc)(s.$.getValue(e,2,3),s.$.getValue(n,2,3),r)),t},t.compose=function(t,n){const r=s.$.mul((0,s.$)(),n.matrix,t.matrix);return e(n.name,r,n)};class h{constructor(t,e,n=c){this.operator=t,this.coordinates=e,this.r=n,this._x=e.x,this._y=e.y,this._z=e.z,this._m=t.matrix}invariantPosition(t,e){return e[0]=this._x[t],e[1]=this._y[t],e[2]=this._z[t],e}position(t,e){return e[0]=this._x[t],e[1]=this._y[t],e[2]=this._z[t],u.e.transformMat4(e,e,this._m),e}x(t){const e=this._m,n=e[0],r=e[4],o=e[8],i=e[12],s=this._x[t],a=this._y[t],u=this._z[t];return(n*s+r*a+o*u+i)/(e[3]*s+e[7]*a+e[11]*u+e[15]||1)}y(t){const e=this._m,n=e[1],r=e[5],o=e[9],i=e[13],s=this._x[t],a=this._y[t],u=this._z[t];return(n*s+r*a+o*u+i)/(e[3]*s+e[7]*a+e[11]*u+e[15]||1)}z(t){const e=this._m,n=e[2],r=e[6],o=e[10],i=e[14],s=this._x[t],a=this._y[t],u=this._z[t];return(n*s+r*a+o*u+i)/(e[3]*s+e[7]*a+e[11]*u+e[15]||1)}}class p{constructor(t,e,n=c){this.operator=t,this.coordinates=e,this.r=n,this._x=e.x,this._y=e.y,this._z=e.z,this._m=t.matrix}invariantPosition(t,e){return e[0]=this._x[t],e[1]=this._y[t],e[2]=this._z[t],e}position(t,e){return e[0]=this.x(t),e[1]=this.y(t),e[2]=this.z(t),e}x(t){const e=this._m;return e[0]*this._x[t]+e[4]*this._y[t]+e[8]*this._z[t]+e[12]}y(t){const e=this._m;return e[1]*this._x[t]+e[5]*this._y[t]+e[9]*this._z[t]+e[13]}z(t){const e=this._m;return e[2]*this._x[t]+e[6]*this._y[t]+e[10]*this._z[t]+e[14]}}class g{constructor(t,e,n=c){this.operator=t,this.coordinates=e,this.r=n,this._x=e.x,this._y=e.y,this._z=e.z}invariantPosition(t,e){return e[0]=this._x[t],e[1]=this._y[t],e[2]=this._z[t],e}position(t,e){return e[0]=this._x[t],e[1]=this._y[t],e[2]=this._z[t],e}x(t){return this._x[t]}y(t){return this._y[t]}z(t){return this._z[t]}}t.createMapping=function(t,e,n=c){return s.$.isIdentity(t.matrix)?new g(t,e,n):0===(r=t.matrix)[3]&&0===r[7]&&0===r[11]&&1===r[15]?new p(t,e,n):new h(t,e,n);var r}}(r||(r={}))},22753:function(t,e,n){n.d(e,{U:function(){return s}});var r=n(35695),o=n(95156),i=n(98537);function s(){return s.zero()}!function(t){function e(){const t=[.1,0,0,0,0,0,0,0,0];return t[0]=0,t}function n(){const t=e();return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function s(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}t.zero=e,t.identity=n,t.setIdentity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.toArray=function(t,e,n){return e[n+0]=t[0],e[n+1]=t[1],e[n+2]=t[2],e[n+3]=t[3],e[n+4]=t[4],e[n+5]=t[5],e[n+6]=t[6],e[n+7]=t[7],e[n+8]=t[8],e},t.fromArray=function(t,e,n){return t[0]=e[n+0],t[1]=e[n+1],t[2]=e[n+2],t[3]=e[n+3],t[4]=e[n+4],t[5]=e[n+5],t[6]=e[n+6],t[7]=e[n+7],t[8]=e[n+8],t},t.fromColumns=function(t,e,n,r){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=n[0],t[4]=n[1],t[5]=n[2],t[6]=r[0],t[7]=r[1],t[8]=r[2],t},t.fromMat4=s;const a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];t.fromEuler=function(t,e,n){return o.$.fromEuler(a,e,n),s(t,a)},t.fromRotation=function(t,e,n){return o.$.fromRotation(a,e,n),s(t,a)},t.create=function(t,n,r,o,i,s,a,u,c){const l=e();return l[0]=t,l[1]=n,l[2]=r,l[3]=o,l[4]=i,l[5]=s,l[6]=a,l[7]=u,l[8]=c,l};const u=n();function c(t,e,n){for(let r=0;r<9;r++)if(Math.abs(t[r]-e[r])>n)return!1;return!0}function l(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function d(t,e){if(t===e){const n=e[1],r=e[2],o=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=o}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function f(t,e){const n=e[0],r=e[1],o=e[2],i=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=e[8],d=l*s-a*c,f=-l*i+a*u,m=c*i-s*u;let h=n*d+r*f+o*m;return h?(h=1/h,t[0]=d*h,t[1]=(-l*r+o*c)*h,t[2]=(a*r-o*s)*h,t[3]=f*h,t[4]=(l*n-o*u)*h,t[5]=(-a*n+o*i)*h,t[6]=m*h,t[7]=(-c*n+r*u)*h,t[8]=(s*n-r*i)*h,t):(console.warn("non-invertible matrix.",e),t)}function m(t){const e=t[0],n=t[1],r=t[2],o=t[3],i=t[4],s=t[5],a=t[6],u=t[7],c=t[8];return e*(c*i-s*u)+n*(-c*o+s*a)+r*(u*o-i*a)}function h(t){return t[0]+t[4]+t[8]}function p(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function g(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}t.isIdentity=function(t,e){return c(t,u,void 0===e?r.p:e)},t.hasNaN=function(t){for(let e=0;e<9;e++)if(Number.isNaN(t[e]))return!0;return!1},t.clone=function(t){return l(e(),t)},t.areEqual=c,t.setValue=function(t,e,n,r){t[3*n+e]=r},t.getValue=function(t,e,n){return t[3*n+e]},t.copy=l,t.transpose=d,t.invert=f,t.symmtricFromUpper=function(t,e){return t===e?(t[3]=e[1],t[6]=e[2],t[7]=e[5]):(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[1],t[4]=e[4],t[5]=e[5],t[6]=e[2],t[7]=e[5],t[8]=e[8]),t},t.symmtricFromLower=function(t,e){return t===e?(t[1]=e[3],t[2]=e[6],t[5]=e[7]):(t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[3],t[4]=e[4],t[5]=e[7],t[6]=e[6],t[7]=e[7],t[8]=e[8]),t},t.determinant=m,t.trace=h,t.sub=p,t.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},t.mul=function(t,e,n){const r=e[0],o=e[1],i=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],d=e[8],f=n[0],m=n[1],h=n[2],p=n[3],g=n[4],y=n[5],_=n[6],A=n[7],b=n[8];return t[0]=f*r+m*s+h*c,t[1]=f*o+m*a+h*l,t[2]=f*i+m*u+h*d,t[3]=p*r+g*s+y*c,t[4]=p*o+g*a+y*l,t[5]=p*i+g*u+y*d,t[6]=_*r+A*s+b*c,t[7]=_*o+A*a+b*l,t[8]=_*i+A*u+b*d,t},t.subScalar=function(t,e,n){return t[0]=e[0]-n,t[1]=e[1]-n,t[2]=e[2]-n,t[3]=e[3]-n,t[4]=e[4]-n,t[5]=e[5]-n,t[6]=e[6]-n,t[7]=e[7]-n,t[8]=e[8]-n,t},t.addScalar=function(t,e,n){return t[0]=e[0]+n,t[1]=e[1]+n,t[2]=e[2]+n,t[3]=e[3]+n,t[4]=e[4]+n,t[5]=e[5]+n,t[6]=e[6]+n,t[7]=e[7]+n,t[8]=e[8]+n,t},t.mulScalar=g;const y=Math.PI/3,_=e();t.symmetricEigenvalues=function(e,n){const r=n[1]*n[1]+n[2]*n[2]+n[5]*n[5];if(0===r)e[0]=n[0],e[1]=n[4],e[2]=n[8];else{const o=h(n)/3,i=n[0]-o,s=n[4]-o,a=n[8]-o,u=i*i+s*s+a*a+2*r,c=Math.sqrt(u/6);g(_,t.Identity,o),p(_,n,_),g(_,_,1/c);const l=m(_)/2,d=l<=-1?y:l>=1?0:Math.acos(l)/3;e[0]=o+2*c*Math.cos(d),e[2]=o+2*c*Math.cos(d+2*y),e[1]=3*o-e[0]-e[2]}return e};const A=[.1,0,0],b=[.1,0,0],C=[.1,0,0],S=[.1,0,0],x=[.1,0,0],v=[.1,0,0];t.eigenvector=function(t,e,n){i.e.set(A,e[0]-n,e[1],e[2]),i.e.set(b,e[1],e[4]-n,e[5]),i.e.set(C,e[2],e[5],e[8]-n),i.e.cross(S,A,b),i.e.cross(x,A,C),i.e.cross(v,b,C);const r=i.e.dot(S,S),o=i.e.dot(x,x),s=i.e.dot(v,v);let a=r,u=0;return o>a&&(a=o,u=1),s>a&&(u=2),0===u?i.e.scale(t,S,1/Math.sqrt(r)):1===u?i.e.scale(t,x,1/Math.sqrt(o)):i.e.scale(t,v,1/Math.sqrt(s)),t},t.directionTransform=function(t,e){return s(t,e),f(t,t),d(t,t),t},t.Identity=n(),t.innerProduct=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]+t[4]*e[4]+t[5]*e[5]+t[6]*e[6]+t[7]*e[7]+t[8]*e[8]},t.adjointFromMat4=function(t,e){const n=e[0],r=e[1],o=e[2],i=e[4],s=e[5],a=e[6],u=e[8],c=e[9],l=e[10];return t[0]=s*l-a*c,t[1]=a*u-i*l,t[2]=i*c-s*u,t[3]=c*o-l*r,t[4]=l*n-u*o,t[5]=u*r-c*n,t[6]=r*a-o*s,t[7]=o*i-n*a,t[8]=n*s-r*i,t}}(s||(s={}))},24303:function(t,e,n){var r;n.d(e,{M:function(){return r}}),function(t){t.toArray=function(t){return Array.from(t.values())},t.isSuperset=function(t,e){if(t===e)return!0;if(t.size<e.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0},t.add=function(t,...e){for(let n=0;n<e.length;n++)for(const r of e[n])t.add(r);return t},t.union=function(t,e){const n=new Set(t);if(t===e)return n;for(const r of e)n.add(r);return n},t.unionMany=function(...t){if(0===t.length)return new Set;const e=new Set(t[0]);for(let n=1,r=t.length;n<r;n++)for(const o of t[n])e.add(o);return e},t.unionManyArrays=function(t){if(0===t.length)return new Set;const e=new Set(t[0]);for(let n=1;n<t.length;n++)for(const r of t[n])e.add(r);return e},t.intersection=function(t,e){if(t===e)return new Set(t);const n=new Set;for(const r of e)t.has(r)&&n.add(r);return n},t.areIntersecting=function(t,e){if(t===e)return t.size>0;t.size<e.size&&([t,e]=[e,t]);for(const n of e)if(t.has(n))return!0;return!1},t.intersectionSize=function(t,e){if(t===e)return t.size;t.size<e.size&&([t,e]=[e,t]);let n=0;for(const r of e)t.has(r)&&(n+=1);return n},t.difference=function(t,e){if(t===e)return new Set;const n=new Set(t);for(const r of e)n.delete(r);return n},t.differenceSize=function(t,e){if(t===e)return 0;let n=t.size;for(const r of t)e.has(r)&&(n-=1);return n},t.areEqual=function(t,e){if(t===e)return!0;if(t.size!==e.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}}(r||(r={}))},24832:function(t,e,n){n.d(e,{_F:function(){return a._},YZ:function(){return i.Y},yB:function(){return c}});var r,o,i=n(80881),s=n(92510);!function(t){t.Synchronous=s.f}(r||(r={})),function(t){function e(t,n=""){const r=t.progress;if(!t.children.length)return r.isIndeterminate?`${n}${r.taskName}: ${r.message}`:`${n}${r.taskName}: [${r.current}/${r.max}] ${r.message}`;const o=n+"  |_ ",i=t.children.map(t=>e(t,o));return r.isIndeterminate?`${n}${r.taskName}: ${r.message}\n${i.join("\n")}`:`${n}${r.taskName}: [${r.current}/${r.max}] ${r.message}\n${i.join("\n")}`}t.format=function(t){return e(t.root)}}(o||(o={}));var a=n(9058);var u=n(86143);async function c(t,e,n,r,o){let i=Math.max(e,0),s=0,a=0;if(t.isSynchronous)return r(Number.MAX_SAFE_INTEGER,n),n;let c=(0,u.t)(),l=0,d=0;for(;(l=r(i,n))>0;){s+=l;const e=(0,u.t)()-c;d+=e,a+=e,t.shouldUpdate&&(await o(t,n,s),i=Math.round(d*s/a)+1,c=(0,u.t)(),d=0)}return t.shouldUpdate&&await o(t,n,s),n}},25261:function(t,e,n){n.d(e,{w:function(){return l}});var r=n(98391),o=n(34370),i=n(51142),s=n(71490),a=n(65533),u=n(41430);const c={domain:[0,1],reverse:!1,listOrName:"red-yellow-blue",minLabel:"",maxLabel:""};var l;!function(t){function e(t,e){const{domain:n,reverse:l,listOrName:d}={...c,...t},f="string"==typeof d?(0,o.JA)(d).list:d,m=l?f.slice().reverse():f;let h=0,p=0,g=0;function y(t,e){p=t,g=e,h=g-p||1}y(n[0],n[1]);const _=(0,i.NT)(t.minLabel,p.toString()),A=(0,i.NT)(t.maxLabel,g.toString());let b;if(m.every(t=>Array.isArray(t))){const t=[...m];t.sort((t,e)=>t[1]-e[1]);const n=t.map(t=>t[0]),o=a.X9.ofSortedArray(t.map(t=>t[1])),i=n.length-1;switch(e){case"continuous":b=t=>function(t,e,n,o,i,s){const c=(0,u.qE)((t-o)/s,0,1),l=a.X9.findPredecessorIndex(n,c);if(0===l)return e[0];if(l>i)return e[i];const d=n[l-1],f=n[l],m=(0,u.qE)((c-d)/(f-d),0,1);return r.Q1.interpolate(e[l-1],e[l],m)}(t,n,o,p,i,h);break;case"discrete":b=t=>function(t,e,n,o,i,s){if(0===e.length)return r.Q1.fromRgb(0,0,0);const c=(0,u.qE)((t-o)/s,0,1),l=a.X9.findPredecessorIndex(n,c);if(0===l)return e[0];if(l>i)return e[i];return e[l]}(t,n,o,p,i,h)}}else switch(e){case"continuous":b=t=>function(t,e,n,o){const i=Math.min(e.length-1,Math.max(0,(t-n)/o*(e.length-1))),s=Math.floor(i),a=e[s],u=e[Math.ceil(i)];return r.Q1.interpolate(a,u,i-s)}(t,m,p,h);break;case"discrete":b=t=>function(t,e,n,o,i){if(0===e.length)return r.Q1.fromRgb(0,0,0);const s=i/e.length;if(t<=n)return e[0];if(t>=o)return e[e.length-1];const a=Math.min(e.length-1,Math.floor((t-n)/s));return e[a]}(t,m,p,g,h)}return{color:b,colorToArray:(t,e,n)=>{r.Q1.toArray(b(t),e,n)},normalizedColorToArray:(t,e,n)=>{r.Q1.toArrayNormalized(b(t),e,n)},setDomain:y,get legend(){return(0,s.A)(_,A,m)}}}t.create=function(t){return e(t,"continuous")},t.createDiscrete=function(t){return e(t,"discrete")}}(l||(l={}))},26511:function(t,e,n){n.d(e,{K4:function(){return r},OQ:function(){return B},YG:function(){return I}});var r,o,i=n(21544),s=n(24832),a=n(63590),u=n(63346),c=n(35256),l=n(93739),d=n(27125),f=n(83448),m=n(63729),h=n(71460),p=n(28243),g=n(40728),y=n(84796),_=n(70318),A=n(52500),b=n(44478),C=n(38530),S=n(94901),x=n(59663),v=n(49e3);function B(t,e){const n=r.fromFrame(t,void 0,void 0,e),o=(0,y.z)(n.data.db,!0);return s.YZ.create("Create mmCIF Model",t=>(0,u.X)(o,n,t))}function I(t){const e=o.fromFrame(t);return s.YZ.create("Create CCD Models",n=>async function(t,e,n){const r=await w(t,e,{coordinateType:"ideal",cartn_x:"pdbx_model_Cartn_x_ideal",cartn_y:"pdbx_model_Cartn_y_ideal",cartn_z:"pdbx_model_Cartn_z_ideal"},n),o=await w(t,e,{coordinateType:"model",cartn_x:"model_Cartn_x",cartn_y:"model_Cartn_y",cartn_z:"model_Cartn_z"},n),s=[];r&&s.push(r);o&&s.push(o);for(let a=0,u=s.length;a<u;++a)i.K.TrajectoryInfo.set(s[a],{index:a,size:s.length});return new p.P4(s)}(e.data.db,o.fromFrame(t),n))}async function w(t,e,n,r){const{chem_comp:i,chem_comp_atom:s,chem_comp_bond:a}=t,{coordinateType:c,cartn_x:l,cartn_y:f,cartn_z:h}=n,p=i.name.value(0),g=i.id.value(0),{atom_id:C,charge:S,comp_id:x,pdbx_ordinal:v,type_symbol:B}=s,I=s._rowCount,w=[];for(let o=0;o<I;o++)s[l].valueKind(o)>0||(w[w.length]=o);const P=w.length,D=d.VP.ofConst("A",P,d.VP.Schema.str),M=d.VP.ofConst(1,P,d.VP.Schema.int),N=d.VP.ofConst("1",P,d.VP.Schema.str),E=d.VP.ofConst(1,P,d.VP.Schema.float),k=d.VP.ofConst(1,P,d.VP.Schema.int),T=d.VP.view(C,w),R=d.VP.view(x,w),U=d.VP.view(s[l],w),H=d.VP.view(s[f],w),O=d.VP.view(s[h],w),F=d.VP.view(v,w),G=d.VP.view(B,w),L=d.VP.view(S,w),V=d.XI.ofPartialColumns(y.e.atom_site,{auth_asym_id:D,auth_atom_id:T,auth_comp_id:R,auth_seq_id:M,Cartn_x:U,Cartn_y:H,Cartn_z:O,id:F,label_asym_id:D,label_atom_id:T,label_comp_id:R,label_seq_id:M,label_entity_id:N,occupancy:E,type_symbol:G,pdbx_PDB_model_num:k,pdbx_formal_charge:L},P),Z=new _.V;Z.setNames([[g,`${p} (${c})`]]),Z.getEntityId(g,A.HX.Unknown,"A");const q=new b.N(M,B);q.setNames([[g,`${p} (${c})`]]),q.add(g,0);const K=(0,y.z)({entity:Z.getEntityTable(),chem_comp:q.getChemCompTable(),atom_site:V}),X=await(0,u.X)(K,e,r);if(!X.representative)return;const Y=X.representative,z=m.X.getEntriesFromChemCompBond(a);return m.X.Provider.set(Y,{data:a,entries:z}),o.CoordinateType.set(Y,c),X.representative}c.i.Provider.formatRegistry.add("mmCIF",function(t){if(r.is(t.sourceData))return c.i.fromData(t.sourceData.data.db)}),l.v.Provider.formatRegistry.add("mmCIF",function(t){if(!r.is(t.sourceData))return;const{struct_conf:e,struct_sheet_range:n}=t.sourceData.data.db;return l.v.fromStruct(e,n,t.atomicHierarchy)}),f._.Provider.formatRegistry.add("mmCIF",function(t){if(!r.is(t.sourceData))return;const{atom_site_anisotrop:e}=t.sourceData.data.db;return{data:d.XI.ofColumns(f._.Schema,e),elementToAnsiotrop:f._.getElementToAnsiotrop(t.atomicConformation.atomId,e.id)}},function(t){return!!r.is(t.sourceData)&&t.sourceData.data.db.atom_site_anisotrop.U.isDefined}),m.X.Provider.formatRegistry.add("mmCIF",function(t){if(!r.is(t.sourceData))return;const{chem_comp_bond:e}=t.sourceData.data.db;return 0!==e._rowCount?{data:e,entries:m.X.getEntriesFromChemCompBond(e)}:void 0}),h.A.Provider.formatRegistry.add("mmCIF",function(t){if(!r.is(t.sourceData))return;const{struct_conn:e}=t.sourceData.data.db;if(0===e._rowCount)return;const n=h.A.getEntriesFromStructConn(e,t),o=new Set;for(const r of n)r.partnerA.residueIndex!==r.partnerB.residueIndex&&o.add((0,C.bd)(r.partnerA.residueIndex,r.partnerB.residueIndex));return{data:e,byAtomIndex:h.A.getAtomIndexFromEntries(n),residueCantorPairs:o,entries:n}}),S.z.Provider.formatRegistry.add("mmCIF",function(t){if(!r.is(t.sourceData))return;const{molstar_bond_site:e}=(0,x.Pd)(v.G,t.sourceData.data.frame);if(0===e._rowCount)return;const n=new Map,{atomId:o}=t.atomicConformation;for(let r=0;r<o.rowCount;r++)n.set(o.value(r),r);const i=[],s=[],a=[],u=[],{atom_id_1:c,atom_id_2:l,value_order:f,type_id:m}=e;for(let r=0;r<e._rowCount;r++){i.push(n.get(c.value(r))),s.push(n.get(l.value(r)));let t=A.I$.Flag.None,e=1;switch(f.value(r)){case"sing":e=1;break;case"doub":e=2;break;case"trip":e=3;break;case"quad":e=4;break;case"arom":e=1,t=A.I$.Flag.Aromatic}switch(m.value(r)){case"covale":t|=A.I$.Flag.Covalent;break;case"disulf":t|=A.I$.Flag.Covalent|A.I$.Flag.Disulfide;break;case"hydrog":t|=A.I$.Flag.HydrogenBond;break;case"metalc":t|=A.I$.Flag.MetallicCoordination}a.push(e),u.push(t)}return S.z.fromData({pairs:{indexA:d.VP.ofIntArray(i),indexB:d.VP.ofIntArray(s),order:d.VP.ofIntArray(a),flag:d.VP.ofArray({array:u,schema:d.VP.Schema.int})},count:t.atomicHierarchy.atoms._rowCount},{maxDistance:1/0})}),g.T.Provider.formatRegistry.add("mmCIF",g.T.fromMmCif,g.T.hasData),function(t){t.is=function(t){return"mmCIF"===(null==t?void 0:t.kind)},t.fromFrame=function(t,e,n,r){return e||(e=a.f$.schema.mmCIF(t)),{kind:"mmCIF",name:e._name,data:{db:e,file:r,frame:t,source:n}}}}(r||(r={})),function(t){const e="__CcdCoordinateType__";t.CoordinateType={get(t){return t._staticPropertyData[e]},set(t,n){return t._staticPropertyData[e]=n}},t.is=function(t){return"CCD"===(null==t?void 0:t.kind)},t.fromFrame=function(t,e){return e||(e=a.f$.schema.CCD(t)),{kind:"CCD",name:e._name,data:{db:e,frame:t}}}}(o||(o={}))},27125:function(t,e,n){n.d(e,{VP:function(){return l},iu:function(){return r},Wm:function(){return A},XI:function(){return _}});var r={};function o(t,e){return{start:e&&void 0!==e.start?Math.max(Math.min(e.start,t-1),0):0,end:e&&void 0!==e.end?Math.min(e.end,t):t}}function i(t,e){const n=e&&void 0!==e.array?e.array:Array,{start:r,end:i}=o(t,e);return{array:new n(i-r),start:r,end:i}}function s(t,e,n){for(let r=0,o=e.length;r<o;r++)e[r]=t(n+r);return e}function a(t,e,n){const{array:r,start:o}=i(t,n);return s(e,r,o)}function u(t){return!!t.buffer&&"number"==typeof t.byteLength&&"number"==typeof t.BYTES_PER_ELEMENT}function c(t,e){const{constructor:n,buffer:r,length:i,byteOffset:s,BYTES_PER_ELEMENT:a}=t,{start:u,end:c}=o(i,e);return 0===u&&c===i?t:new n(r,s+a*u,Math.min(i,c-u))}n.r(r),n.d(r,{createAndFillArray:function(){return a},createArray:function(){return i},fillArrayValues:function(){return s},getArrayBounds:function(){return o},isTypedArray:function(){return u},typedArrayWindow:function(){return c}});var l,d=n(73868),f=n(94106);function m(t,e,n,r){return{schema:n,__array:void 0,isDefined:r===l.ValueKinds.Present,rowCount:e,value:e=>t,valueKind:t=>r,toArray:n=>{const{array:r}=i(e,n);for(let e=0,o=r.length;e<o;e++)r[e]=t;return r},areValuesEqual:(t,e)=>!0}}function h({value:t,valueKind:e,areValuesEqual:n,rowCount:r,schema:o}){return{schema:o,__array:void 0,isDefined:!0,rowCount:r,value:t,valueKind:e||(t=>l.ValueKinds.Present),toArray:e=>{const{array:n,start:o}=i(r,e);for(let r=0,i=n.length;r<i;r++)n[r]=t(r+o);return n},areValuesEqual:n||((e,n)=>t(e)===t(n))}}function p({array:t,schema:e,valueKind:n}){const r=t.length,i=e.T,s="str"===e.valueType?"lowercase"===e.transform?e=>{const n=t[e];return"string"==typeof n?n.toLowerCase():`${null!=n?n:i}`.toLowerCase()}:"uppercase"===e.transform?e=>{const n=t[e];return"string"==typeof n?n.toUpperCase():`${null!=n?n:i}`.toUpperCase()}:e=>{const n=t[e];return"string"==typeof n?n:`${null!=n?n:i}`}:e=>t[e],a=u(t);return{schema:e,__array:t,isDefined:!0,rowCount:r,value:s,valueKind:n||(t=>l.ValueKinds.Present),toArray:"str"===e.valueType?"lowercase"===e.transform?e=>{const{start:n,end:s}=o(r,e),a=new(e&&void 0!==e.array?e.array:t.constructor)(s-n);for(let r=0,o=s-n;r<o;r++){const e=t[n+r];a[r]="string"==typeof e?e.toLowerCase():`${null!=e?e:i}`.toLowerCase()}return a}:"uppercase"===e.transform?e=>{const{start:n,end:s}=o(r,e),a=new(e&&void 0!==e.array?e.array:t.constructor)(s-n);for(let r=0,o=s-n;r<o;r++){const e=t[n+r];a[r]="string"==typeof e?e.toUpperCase():`${null!=e?e:i}`.toUpperCase()}return a}:e=>{const{start:n,end:s}=o(r,e),a=new(e&&void 0!==e.array?e.array:t.constructor)(s-n);for(let r=0,o=s-n;r<o;r++){const e=t[n+r];a[r]="string"==typeof e?e:`${null!=e?e:i}`}return a}:a?e=>c(t,e):e=>{const{start:n,end:i}=o(r,e);if(0===n&&i===t.length)return t;const s=new(e&&void 0!==e.array?e.array:t.constructor)(i-n);for(let r=0,o=i-n;r<o;r++)s[r]=t[n+r];return s},areValuesEqual:(e,n)=>t[e]===t[n]}}function g(t,e,n){return t.isDefined?0===e&&n===t.rowCount?t:t.__array&&u(t.__array)?function(t,e,n){const r=c(t.__array,{start:e,end:n}),o=t.valueKind;return p({array:r,schema:t.schema,valueKind:t=>o(e+t)})}(t,e,n):function(t,e,n){const r=t.value,o=t.valueKind,s=t.areValuesEqual,a=0===e?r:t=>r(t+e),u=n-e;return{schema:t.schema,__array:void 0,isDefined:t.isDefined,rowCount:u,value:a,valueKind:0===e?o:t=>o(t+e),toArray:t=>{const{array:n}=i(u,t);for(let o=0,i=n.length;o<i;o++)n[o]=r(o+e);return n},areValuesEqual:0===e?s:(t,n)=>s(t+e,n+e)}}(t,e,n):l.Undefined(n-e,t.schema)}function y(t,e,n){return 0===t.rowCount||n&&function(t,e){if(t.length!==e)return!1;for(let n=0,r=t.length;n<r;n++)if(t[n]!==n)return!1;return!0}(e,t.rowCount)?t:t.__array&&typeof t.value(0)==typeof t.__array[0]?function(t,e){const n=t.__array,r=new n.constructor(e.length);for(let i=0,s=e.length;i<s;i++)r[i]=n[e[i]];const o=t.valueKind;return p({array:r,schema:t.schema,valueKind:t=>o(e[t])})}(t,e):function(t,e){const n=t.value,r=t.valueKind,o=t.areValuesEqual,s=t=>n(e[t]),a=e.length;return{schema:t.schema,__array:void 0,isDefined:t.isDefined,rowCount:a,value:s,valueKind:t=>r(e[t]),toArray:t=>{const{array:r}=i(a,t);for(let o=0,i=r.length;o<i;o++)r[o]=n(e[o]);return r},areValuesEqual:(t,n)=>o(e[t],e[n])}}(t,e)}!function(t){let e,n;function r(t,e){return m(e.T,t,e,n.NotPresent)}function o(t){return h(t)}!function(t){function e(e,n=t.float){return{"@type":"tensor",T:e.create(),space:e,valueType:"tensor",baseType:n}}t.str={"@type":"str",T:"",valueType:"str"},t.ustr={"@type":"str",T:"",valueType:"str",transform:"uppercase"},t.lstr={"@type":"str",T:"",valueType:"str",transform:"lowercase"},t.int={"@type":"int",T:0,valueType:"int"},t.coord={"@type":"coord",T:0,valueType:"float"},t.float={"@type":"float",T:0,valueType:"float"},t.Str=function(t){var e;return{"@type":"str",T:null!==(e=null==t?void 0:t.defaultValue)&&void 0!==e?e:"",transform:null==t?void 0:t.transform,valueType:"str"}},t.Int=function(t=0){return{"@type":"int",T:t,valueType:"int"}},t.Float=function(t=0){return{"@type":"float",T:t,valueType:"float"}},t.Tensor=e,t.Vector=function(n,r=t.float){return e(d.qY.Vector(n,"int"===r["@type"]?Int32Array:Float64Array),r)},t.Matrix=function(n,r,o=t.float){return e(d.qY.ColumnMajorMatrix(n,r,"int"===o["@type"]?Int32Array:Float64Array),o)},t.Aliased=function(t){return t},t.List=function(t,e,n=[]){return{"@type":"list",T:n,separator:t,itemParse:e,valueType:"list"}}}(e=t.Schema||(t.Schema={})),t.is=function(t){return!!t&&!!t.schema&&!!t.value},function(t){t[t.Present=0]="Present",t[t.NotPresent=1]="NotPresent",t[t.Unknown=2]="Unknown"}(n=t.ValueKinds||(t.ValueKinds={})),t.ValueKind={Present:n.Present,NotPresent:n.NotPresent,Unknown:n.Unknown},t.Undefined=r,t.ofConst=function(t,e,r){return m(t,e,r,n.Present)},t.ofLambda=o,t.range=function(t,n){return o({value:e=>e+t,rowCount:Math.max(n-t+1,0),schema:e.int})},t.ofArray=function(t){return p(t)},t.ofIntArray=function(t){return p({array:t,schema:e.int})},t.ofFloatArray=function(t){return p({array:t,schema:e.float})},t.ofStringArray=function(t){return p({array:t,schema:e.str})},t.ofStringAliasArray=function(t){return p({array:t,schema:e.Aliased(e.str)})},t.ofStringListArray=function(t,n=","){return p({array:t,schema:e.List(n,t=>t)})},t.ofIntTokens=function(t){const{count:n,data:r,indices:o}=t;return h({value:t=>(0,f.H9)(r,o[2*t],o[2*t+1])||0,rowCount:n,schema:e.int})},t.ofFloatTokens=function(t){const{count:n,data:r,indices:o}=t;return h({value:t=>(0,f.sS)(r,o[2*t],o[2*t+1])||0,rowCount:n,schema:e.float})},t.ofStringTokens=function(t){const{count:n,data:r,indices:o}=t;return h({value:t=>{const e=r.substring(o[2*t],o[2*t+1]);return"."===e||"?"===e?"":e},rowCount:n,schema:e.str})},t.window=function(t,e,n){return g(t,e,n)},t.view=function(t,e,n=!0){return y(t,e,n)},t.createFirstIndexMap=function(t){return function(t){const e=new Map;for(let n=0,r=t.rowCount;n<r;n++){const r=t.value(n);e.has(r)||e.set(t.value(n),n)}return e}(t)},t.createIndexer=function(t){return function(t){const e=new Map;for(let n=0,r=t.rowCount;n<r;n++){const r=t.value(n);e.has(r)||e.set(t.value(n),n)}return t=>e.has(t)?e.get(t):-1}(t)},t.mapToArray=function(t,e,n){return function(t,e,n){const r=new n(t.rowCount);for(let o=0,i=t.rowCount;o<i;o++)r[o]=e(t.value(o));return r}(t,e,n||Array)},t.areEqual=function(t,e){return function(t,e){return t===e||t.rowCount===e.rowCount&&t.isDefined===e.isDefined&&t.schema.valueType===e.schema.valueType&&(t.__array&&e.__array?function(t,e){const n=t.__array,r=e.__array;for(let o=0,i=t.rowCount;o<i;o++)if(n[o]!==r[o])return!1;return!0}(t,e):function(t,e){const n=t.value,r=e.value;for(let o=0,i=t.rowCount;o<i;o++)if(n(o)!==r(o))return!1;return!0}(t,e))}(t,e)},t.indicesOf=function(t,e){return function(t,e){const n=[],r=t.value;for(let o=0,i=t.rowCount;o<i;o++)e(r(o))&&(n[n.length]=o);return n}(t,e)},t.asArrayColumn=function(t,e){return t.__array?t:t.isDefined?p({array:t.toArray({array:e}),schema:t.schema,valueKind:t.valueKind}):r(t.rowCount,t.schema)},t.copyToArray=function(t,e,n=0){if(!t.isDefined)return;const r=t.__array;if(r)for(let o=0,i=r.length;o<i;o++)e[n+o]=r[o];else for(let o=0,i=t.rowCount;o<i;o++)e[n+o]=t.value(o)},t.isIdentity=function(t){for(let e=0,n=t.rowCount;e<n;e++)if(e!==t.value(e))return!1;return!0}}(l||(l={}));var _,A,b=n(71746),C=n(51142);!function(t){function e(t,e,n){const r=Object.create(null),o=Object.keys(e);r._rowCount=n.length,r._columns=o,r._schema=e;for(const i of o)r[i]=l.view(t[i],n);return r}function n(t,e){const n=Object.create(null),{_columns:r}=t;for(let o=0;o<r.length;o++){const i=r[o];n[i]=t[i].value(e)}return n}t.is=function(t){return t&&"number"==typeof t._rowCount&&!!t._columns&&!!t._schema},t.pickColumns=function(t,e,n={}){const r=Object.create(null),o=Object.keys(t);r._rowCount=e._rowCount,r._columns=o,r._schema=t;for(const i of o)if(e[i])r[i]=e[i];else{if(!n[i])throw Error(`Cannot find column '${i}'.`);r[i]=n[i]}return r},t.ofColumns=function(t,e){const n=Object.keys(e);return{_rowCount:e[n[0]].rowCount,_columns:n,_schema:t,...e}},t.ofPartialColumns=function(t,e,n){const r=Object.create(null),o=Object.keys(t);r._rowCount=n,r._columns=o,r._schema=t;for(const i of o)r[i]=i in e?e[i]:l.Undefined(n,t[i]);return r},t.ofUndefinedColumns=function(t,e){const n=Object.create(null),r=Object.keys(t);n._rowCount=e,n._columns=r,n._schema=t;for(const o of r)n[o]=l.Undefined(e,t[o]);return n},t.ofRows=function(t,e){const n=Object.create(null),r=e.length,o=Object.keys(t);n._rowCount=r,n._columns=o,n._schema=t;for(const i of o)n[i]=l.ofLambda({rowCount:r,schema:t[i],value:t=>e[t][i],valueKind:t=>void 0===e[t][i]?l.ValueKinds.NotPresent:l.ValueKinds.Present});return n},t.ofArrays=function(t,e){var n;const r=Object.create(null),o=Object.keys(t);r._rowCount=0,r._columns=o,r._schema=t;for(const i of o)void 0!==e[i]?(r[i]=l.ofArray({array:e[i],schema:t[i]}),r._rowCount=null===(n=e[i])||void 0===n?void 0:n.length):r[i]=l.Undefined(r._rowCount,t[i]);return r},t.view=e,t.pick=function(t,n,r){const o=[];for(let e=0,i=t._rowCount;e<i;++e)r(e)&&o.push(e);return e(t,n,o)},t.window=function(t,e,n,r){if(0===n&&r===t._rowCount)return t;const o=Object.create(null),i=Object.keys(e);o._rowCount=r-n,o._columns=i,o._schema=e;for(const s of i)o[s]=l.window(t[s],n,r);return o},t.concat=function(t,e){const n=Object.create(null),r=Object.keys(e);n._rowCount=0;for(const s of t)n._rowCount+=s._rowCount;const o={};for(const s of r)o[s]=new Array(n._rowCount);n._columns=r,n._schema=e;let i=0;for(const s of t){for(const t of r)l.copyToArray(s[t],o[t],i);i+=s._rowCount}for(const s of r)n[s]=l.ofArray({array:o[s],schema:e[s]});return n},t.columnToArray=function(t,e,n){t[e]=l.asArrayColumn(t[e],n)},t.sort=function(t,e){const n=new Int32Array(t._rowCount);for(let i=0,s=n.length;i<s;i++)n[i]=i;(0,b.eh)(n,(t,n,r)=>e(n,r));let r=!0;for(let i=0,s=n.length;i<s;i++)if(n[i]!==i){r=!1;break}if(r)return t;const o=Object.create(null);o._rowCount=t._rowCount,o._columns=t._columns,o._schema=t._schema;for(const i of t._columns)o[i]=l.view(t[i],n,!1);return o},t.areEqual=function(t,e){if(t._rowCount!==e._rowCount)return!1;if(t._columns.length!==e._columns.length)return!1;for(const n of t._columns)if(!e[n])return!1;for(const n of t._columns)if(!l.areEqual(t[n],e[n]))return!1;return!0},t.getRow=n,t.pickRow=function(t,e){for(let r=0,o=t._rowCount;r<o;++r)if(e(r))return n(t,r)},t.getRows=function(t){const e=[],{_rowCount:r}=t;for(let o=0;o<r;o++)e[o]=n(t,o);return e},t.toArrays=function(t){const e={},{_columns:n}=t;for(let r=0;r<n.length;r++){const o=n[r];e[o]=t[o].toArray()}return e},t.formatToString=function(t){const e=C.fe.create(),{_columns:n,_rowCount:r}=t;let o=1;C.fe.write(e,"|");for(let i=0;i<n.length;i++)C.fe.write(e,n[i]),C.fe.write(e,"|"),o+=n[i].length+1;C.fe.newline(e),C.fe.write(e,new Array(o+1).join("-")),C.fe.newline(e);for(let i=0;i<r;i++){C.fe.write(e,"|");for(let r=0;r<n.length;r++){const o=t[n[r]];o.valueKind(i)===l.ValueKinds.Present?(C.fe.write(e,o.value(i)),C.fe.write(e,"|")):C.fe.write(e,".|")}C.fe.newline(e)}return C.fe.getString(e)}}(_||(_={})),function(t){t.ofTables=function(t,e,n){const r=Object.keys(n),o=Object.create(null),i=[];o._name=t,o._tableNames=i,o._schema=e;for(const s of r)_.is(n[s])&&(o[s]=n[s],i[i.length]=s);return o},t.getTablesAsRows=function(t){const e={};for(const n of t._tableNames)e[n]=_.getRows(t[n]);return e}}(A||(A={}))},27552:function(t,e,n){n.d(e,{Jq:function(){return c},jM:function(){return l}});var r,o=n(46031),i=n(73868),s=n(65533),a=n(21547),u=n(41054);function c(){return{result:r.create(),closeUnitsResult:o.Q7.create(),unitGroupResult:o.Q7.create()}}!function(t){t.add=function(t,e,n,r){t.indices[t.count]=n,t.units[t.count]=e,t.squaredDistances[t.count]=r,t.count++},t.create=function(){return{count:0,indices:[],units:[],squaredDistances:[]}},t.copy=function(t,e){for(let n=0;n<e.count;++n)t.indices[n]=e.indices[n],t.units[n]=e.units[n],t.squaredDistances[n]=e.squaredDistances[n];return t.count=e.count,t}}(r||(r={}));class l{findUnitIndices(t,e,n,r){return this.unitLookup.find(t,e,n,r)}find(t,e,n,r,o){return this._find(t,e,n,r,null!=o?o:this.findContext)}_find(t,e,n,s,a){o.Q7.reset(a.result);const{units:u}=this.structure,c=this.unitLookup.find(t,e,n,s,a.closeUnitsResult);if(0===c.count)return a.result;for(let o=0,l=c.count;o<l;o++){const l=u[c.indices[o]];i.eB.set(this.pivot,t,e,n),l.conformation.operator.isIdentity||i.eB.transformMat4(this.pivot,this.pivot,l.conformation.operator.inverse);const d=l.lookup3d.find(this.pivot[0],this.pivot[1],this.pivot[2],s,a.unitGroupResult);for(let t=0,e=d.count;t<e;t++)r.add(a.result,l,d.indices[t],d.squaredDistances[t])}return a.result}nearest(t,e,n,r=1,o){return this._nearest(t,e,n,r,null!=o?o:this.findContext)}_nearest(t,e,n,s,a){const u=a.result,c=this.heap;o.Q7.reset(u),c.clear();const{units:l}=this.structure;let d=0;const f=this.unitLookup.nearest(t,e,n,l.length,t=>(d+=l[t].elements.length)>=s,a.closeUnitsResult);if(0===f.count)return u;let m=0,h=-Number.MAX_VALUE;for(let r=0,o=f.count;r<o;r++){const o=f.squaredDistances[r];if(m>=s&&h<o)break;i.eB.set(this.pivot,t,e,n);const u=l[f.indices[r]];u.conformation.operator.isIdentity||i.eB.transformMat4(this.pivot,this.pivot,u.conformation.operator.inverse);const d=u.lookup3d.nearest(this.pivot[0],this.pivot[1],this.pivot[2],s,void 0,a.unitGroupResult);if(0!==d.count){m+=d.count,h=Math.max(h,d.squaredDistances[d.count-1]);for(let t=0,e=d.count;t<e;t++)c.insert(d.squaredDistances[t],{index:d.indices[t],unit:u})}}if(1===s){const t=c.findMinimum();if(t){const{key:e}=t,{unit:n,index:o}=t.value;r.add(u,n,o,e)}}else for(;!c.isEmpty()&&u.count<s;){const t=c.extractMinimum(),{key:e}=t,{unit:n,index:o}=t.value;r.add(u,n,o,e)}return u}findIntoBuilder(t,e,n,r,o){const{units:s}=this.structure,a=this.unitLookup.find(t,e,n,r);if(0!==a.count)for(let u=0,c=a.count;u<c;u++){const c=s[a.indices[u]];i.eB.set(this.pivot,t,e,n),c.conformation.operator.isIdentity||i.eB.transformMat4(this.pivot,this.pivot,c.conformation.operator.inverse);const l=c.lookup3d.find(this.pivot[0],this.pivot[1],this.pivot[2],r);if(0===l.count)continue;const d=c.elements;o.beginUnit(c.id);for(let t=0,e=l.count;t<e;t++)o.addElement(d[l.indices[t]]);o.commitUnit()}}findIntoBuilderIf(t,e,n,r,o,s){const{units:u}=this.structure,c=this.unitLookup.find(t,e,n,r);if(0===c.count)return;const l=a.i.Location.create(this.structure);for(let a=0,d=c.count;a<d;a++){const d=u[c.indices[a]];i.eB.set(this.pivot,t,e,n),d.conformation.operator.isIdentity||i.eB.transformMat4(this.pivot,this.pivot,d.conformation.operator.inverse);const f=d.lookup3d.find(this.pivot[0],this.pivot[1],this.pivot[2],r);if(0===f.count)continue;const m=d.elements;l.unit=d,o.beginUnit(d.id);for(let t=0,e=f.count;t<e;t++)l.element=m[f.indices[t]],s(l)&&o.addElement(l.element);o.commitUnit()}}findIntoBuilderWithRadius(t,e,n,r,o,s,u,c){const{units:l}=this.structure,d=this.unitLookup.find(t,e,n,s);if(0===d.count)return;const f=a.i.Location.create(this.structure),m=r+o+s;for(let a=0,h=d.count;a<h;a++){const o=l[d.indices[a]];i.eB.set(this.pivot,t,e,n),o.conformation.operator.isIdentity||i.eB.transformMat4(this.pivot,this.pivot,o.conformation.operator.inverse);const h=o.lookup3d.find(this.pivot[0],this.pivot[1],this.pivot[2],m);if(0===h.count)continue;const p=o.elements;f.unit=o,c.beginUnit(o.id);for(let t=0,e=h.count;t<e;t++){f.element=p[h.indices[t]];const e=u(f);Math.sqrt(h.squaredDistances[t])-r-e>s||c.addElement(p[h.indices[t]])}c.commitUnit()}}check(t,e,n,r){const{units:o}=this.structure,s=this.unitLookup.find(t,e,n,r);if(0===s.count)return!1;for(let a=0,u=s.count;a<u;a++){const u=o[s.indices[a]];i.eB.set(this.pivot,t,e,n),u.conformation.operator.isIdentity||i.eB.transformMat4(this.pivot,this.pivot,u.conformation.operator.inverse);if(u.lookup3d.check(this.pivot[0],this.pivot[1],this.pivot[2],r))return!0}return!1}approxNearest(t,e,n,r,o){return this._approxNearest(t,e,n,r,null!=o?o:this.findContext)}_approxNearest(t,e,n,s,a){o.Q7.reset(a.result);const{units:u}=this.structure,c=this.unitLookup.find(t,e,n,s,a.closeUnitsResult);if(0===c.count)return a.result;let l=Number.MAX_VALUE;for(let o=0,d=c.count;o<d;o++){const d=u[c.indices[o]];i.eB.set(this.pivot,t,e,n),d.conformation.operator.isIdentity||i.eB.transformMat4(this.pivot,this.pivot,d.conformation.operator.inverse);const f=d.lookup3d.approxNearest(this.pivot[0],this.pivot[1],this.pivot[2],s,a.unitGroupResult);for(let t=0,e=f.count;t<e;t++)f.squaredDistances[t]<l&&(r.add(a.result,d,f.indices[t],f.squaredDistances[t]),l=f.squaredDistances[t])}return a.result}get boundary(){return this.structure.boundary}constructor(t){this.structure=t,this.pivot=(0,i.eB)(),this.heap=new u.h,this.findContext=c();const{units:e,boundary:n}=t,r=e.length,a=new Float32Array(r),l=new Float32Array(r),d=new Float32Array(r),f=new Float32Array(r),m=(0,i.eB)();for(let o=0;o<r;o++){const t=e[o],n=t.boundary.sphere;i.eB.transformMat4(m,n.center,t.conformation.operator.matrix),a[o]=m[0],l[o]=m[1],d[o]=m[2],f[o]=n.radius}const h={x:a,y:l,z:d,radius:f,indices:s.CD.ofBounds(0,r)};this.unitLookup=(0,o.Eh)(h,n)}}},28026:function(t,e,n){function r(){return r.zero()}n.d(e,{Z:function(){return r}}),function(t){function e(){const t=[.1,0];return t[0]=0,t}function n(t,n){const r=e();return r[0]=t,r[1]=n,r}function r(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function o(t,e){const n=e[0],r=e[1];let o=n*n+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o),t}t.zero=e,t.clone=function(t){const n=e();return n[0]=t[0],n[1]=t[1],n},t.fromObj=function(t){return n(t.x,t.y)},t.toObj=function(t){return{x:t[0],y:t[1]}},t.create=n,t.hasNaN=function(t){return Number.isNaN(t[0])||Number.isNaN(t[1])},t.toArray=function(t,e,n){return e[n+0]=t[0],e[n+1]=t[1],e},t.fromArray=function(t,e,n){return t[0]=e[n+0],t[1]=e[n+1],t},t.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},t.set=function(t,e,n){return t[0]=e,t[1]=n,t},t.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},t.sub=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t},t.mul=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t},t.div=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t},t.scale=r,t.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},t.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},t.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},t.distance=function(t,e){const n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)},t.squaredDistance=function(t,e){const n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r},t.magnitude=function(t){const e=t[0],n=t[1];return Math.sqrt(e*e+n*n)},t.squaredMagnitude=function(t){const e=t[0],n=t[1];return e*e+n*n},t.setMagnitude=function(t,e,n){return r(t,o(t,e),n)},t.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},t.normalize=o,t.areEqual=function(t,e){return t[0]===e[0]&&t[1]===e[1]},t.toString=function(t,e){return`[${t[0].toPrecision(e)} ${t[1].toPrecision(e)}}]`}}(r||(r={}))},28243:function(t,e,n){n.d(e,{P4:function(){return s.P},gn:function(){return o.gn},Kx:function(){return r.Kx},RT:function(){return i.RT},cY:function(){return i.cY},Structure:function(){return o.oE},iZ:function(){return o.iZ},ZP:function(){return o.ZP},Oz:function(){return i.Oz},cv:function(){return i.cv},us:function(){return o.us},vw:function(){return r.vw},Nf:function(){return o.Nf},X$:function(){return o.X$}});n(52780),n(39065);var r=n(10486),o=n(77936),i=n(73150),s=n(8429)},31186:function(t,e,n){n.d(e,{af:function(){return p},u$:function(){return h},qW:function(){return g},$6:function(){return y},_M:function(){return r},VR:function(){return a},GP:function(){return o},em:function(){return i},P6:function(){return d},mO:function(){return l},C2:function(){return u},Z2:function(){return f},K3:function(){return m},jJ:function(){return s},WE:function(){return c},y1:function(){return _}});n(35332);function r(t){let e=-1/0;for(let n=0,r=t.length;n<r;++n)t[n]>e&&(e=t[n]);return e}function o(t){let e=1/0;for(let n=0,r=t.length;n<r;++n)t[n]<e&&(e=t[n]);return e}function i(t){let e=1/0,n=-1/0;for(let r=0,o=t.length;r<o;++r)t[r]<e&&(e=t[r]),t[r]>n&&(n=t[r]);return[e,n]}function s(t,e=1,n=0){const r=t.length;let o=0;for(let i=n;i<r;i+=e)o+=t[i];return o}function a(t,e=1,n=0){return s(t,e,n)/(t.length/e)}function u(t){const e=t.length;let n=0;for(let r=0;r<e;++r){const e=t[r];n+=e*e}return Math.sqrt(n/e)}function c(t,e){for(let n=0,r=e?Math.min(e,t.length):t.length;n<r;++n)t[n]=n;return t}function l(t,e){let n=0,r=!1;for(const o=t.length;n<o;n++)if(t[n]===e){r=!0;break}return!!r&&(d(t,n),!0)}function d(t,e){for(let n=e,r=t.length-1;n<r;n++)t[n]=t[n+1];t.pop()}function f(t,e){return!(t.indexOf(e)>=0)&&(t.push(e),!0)}function m(t,e){const n=t.indexOf(e);if(n<0)return!1;for(let r=n,o=t.length-1;r<o;r++)t[r]=t[r+1];return t.pop(),!0}function h(t,e){let n=0;for(let r=0,o=t.length;r<o;++r)e.includes(t[r])&&(n+=1);return n}function p(t,e){if(!t||0===t.length)return!e||0===e.length;if(!e)return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function g(t){for(let e=0,n=t.length;e<n;e++)if(t[e]!==e)return!1;return!0}function y(t,e,n){for(let r=0,o=t.length;r<o;++r)if(t[r][0]===e)return void(t[r][1]=n);t.push([e,n])}function _(t,e){void 0===e&&(e=t,t=0);const n=Math.max(e-t,0),r=Array(n);for(let o=0;o<n;o++)r[o]=t+o;return r}},31960:function(t,e,n){n.d(e,{o:function(){return z}});var r=n(65533),o=n(54135),i=n(22463),s=n(10486),a=n(38530),u=n(21547),c=n(69926),l=n(27552),d=n(19600);class f{addToUnit(t,e){const n=this.unitMap.get(t);n?n[n.length]=e:(this.unitMap.set(t,[e]),this.ids[this.ids.length]=t),this.elementCount++}beginUnit(t){this.parentId=t,this.currentUnit=this.currentUnit.length>0?[]:this.currentUnit}addElement(t){this.currentUnit[this.currentUnit.length]=t,this.elementCount++}addElementRange(t,e,n){for(let r=e;r<n;r++)this.currentUnit[this.currentUnit.length]=t[r],this.elementCount++}commitUnit(){0!==this.currentUnit.length&&(this.ids[this.ids.length]=this.parentId,this.unitMap.set(this.parentId,this.currentUnit),this.parentId=-1)}setUnit(t,e){this.ids[this.ids.length]=t,this.unitMap.set(t,e),this.elementCount+=e.length}_getStructure(t){if(this.isEmpty)return z.Empty;const e=[];(0,a.eh)(this.ids);const n=d.u.UnitEquivalenceBuilder();for(let o=0,i=this.ids.length;o<i;o++){const i=this.ids[o],s=this.parent.unitMap.get(i);let u=this.unitMap.get(i),c=!1;t&&(this.isSorted||(0,a.eh)(u),u=r.X9.deduplicate(r.X9.ofSortedArray(this.currentUnit)),c=!0);const l=u.length;if(u.length===s.elements.length){e[e.length]=s,n.add(s.id,s);continue}!this.isSorted&&!c&&l>1&&(0,a.eh)(u);let d=s.getChild(r.X9.ofSortedArray(u));const f=n.add(d.id,d);d!==f&&(d=f.applyOperator(d.id,d.conformation.operator,!0)),e[e.length]=d}return z.create(e,{parent:this.parent})}getStructure(){return this._getStructure(!1)}getStructureDeduplicate(){return this._getStructure(!0)}setSingletonLocation(t){const e=this.ids[0];t.unit=this.parent.unitMap.get(e),t.element=this.unitMap.get(e)[0]}get isEmpty(){return 0===this.elementCount}constructor(t,e){this.parent=t,this.isSorted=e,this.ids=[],this.unitMap=r.Yz.Mutable(),this.parentId=-1,this.currentUnit=[],this.elementCount=0}}var m=n(9239),h=n(64059);function p(t,e){let n=1;for(;e--;)n*=t--;return n}class g{move(){if(this.hasNext){let t=0,e=0,n=this.index;for(;n;n>>>=1,t++)1&n&&(this.value[e++]=this.array[t]);this.index=function(t){const e=t&-t,n=t+e;return n|((n&-n)/e>>1)-1}(this.index),this.hasNext=this.index<this.maxIndex}return this.value}constructor(t,e){var n,r;this.array=t,this.hasNext=!1,this.index=(1<<e)-1,this.size=(n=t.length,(r=e)>n?0:p(n,r)/p(r,r)),this.maxIndex=1<<t.length,this.value=new Array(e),this.hasNext=e>0&&e<=t.length}}function y(t,e){const n=[],r=new g(t,e);for(;r.hasNext;)n.push(r.move().slice());return n}var _=n(40319),A=n(73868),b=n(75847),C=n(31186),S=n(52500),x=n(3108);const v=[],B={links:v,terminalLinks:v,elements:v,partialElements:v,getElementIndices:()=>v,getLinkIndices:()=>v,getTerminalLinkIndices:()=>v};var I=n(93818);const w=(0,S.F1)("C"),P=(0,S.F1)("O"),D=[I.X.elementFingerprint([w,w,w,P]),I.X.elementFingerprint([w,w,w,w,P]),I.X.elementFingerprint([w,w,w,w,w,P]),I.X.elementFingerprint([w,w,w,w,w,w,P])];function M(t,e){let n=-1,r=-1,o=-1,i=-1;const{elements:s}=t,{type_symbol:a,label_atom_id:u}=t.model.atomicHierarchy.atoms,{b:c,offset:l}=t.bonds;for(let d=0,f=e.length;d<f;++d){const t=s[e[d]];if(a.value(t)!==w)continue;let f=0,m=0;for(let n=l[e[d]],r=l[e[d]+1];n<r;++n){const t=s[c[n]],e=a.value(t);e===P?++f:e===w&&++m}if(2===f){n=t;break}1===f&&1===m?r=t:u.value(t).startsWith("C1")?o=t:i=t}return-1!==n?n:-1!==r?r:-1!==o?o:-1!==i?i:s[e[0]]}function N(t,e,n,r){const o=e.conformation;return A.eB.normalize(t,A.eB.sub(t,r,o.position(n,t))),t}function E(t,e){const{elements:n}=t,{label_atom_id:r}=t.model.atomicHierarchy.atoms;return r.value(n[e])}function k(t,e){if(!e||!e.length)return;const{unit:n,all:o}=t,i=new Set,s=y((0,C.WE)(new Array(e.length)),2);for(let a=0,u=s.length;a<u;++a){const t=s[a],u=o[e[t[0]]],c=o[e[t[1]]];r.X9.areIntersecting(u,c)&&I.X.getAltId(n,u)===I.X.getAltId(n,c)&&(i.add(e[t[0]]),i.add(e[t[1]]))}if(i.size){const t=[];for(let n=0,r=e.length;n<r;++n)i.has(e[n])||t.push(e[n]);return t}return e}function T(t,e){return e.properties.saccharideComponentMap.get(t)}function R(t,e,n){function r(t,e){return(0,a.m1)(t.id,e)}function o(t,e,n){const o=[],i=t.get(r(e,n));if(void 0!==i)for(const r of i)(0,C.Z2)(o,r);return o}const i=new Map;for(let a=0,c=t.length;a<c;++a){const{unit:e,ringIndex:n}=t[a],o=e.rings.all[n];for(let t=0,s=o.length;t<s;++t){const n=r(e,e.elements[o[t]]),s=i.get(n);void 0===s?i.set(n,[a]):s.push(a)}}const s=new Map;for(let a=0,c=e.length;a<c;++a){const n=e[a],{unit:o,ringIndex:i}=t[n.carbohydrateIndexA],u=o.rings.all[i];for(let t=0,e=u.length;t<e;++t){const e=r(o,o.elements[u[t]]),n=s.get(e);void 0===n?s.set(e,[a]):n.push(a)}}const u=new Map;for(let a=0,c=n.length;a<c;++a){const{fromCarbohydrate:e,carbohydrateIndex:o,elementUnit:i,elementIndex:s}=n[a];if(e){const{unit:e,ringIndex:n}=t[o],i=e.rings.all[n];for(let t=0,o=i.length;t<o;++t){const n=r(e,e.elements[i[t]]),o=u.get(n);void 0===o?u.set(n,[a]):o.push(a)}}else{const t=r(i,i.elements[s]),e=u.get(t);void 0===e?u.set(t,[a]):e.push(a)}}return{getElementIndices:function(t,e){return o(i,t,e)},getLinkIndices:function(t,e){return o(s,t,e)},getTerminalLinkIndices:function(t,e){return o(u,t,e)}}}var U=n(84729),H=n(59859),O=n(99355),F=n(49330),G=n(24832),L=n(46031),V=n(51195);const Z=(0,L.f8)(),q=new V.Z("14"),K=new V.Z("98");function X(t){const{units:e}=t,n=e.length>500?q:K;n.reset();for(let r=0,o=e.length;r<o;r++){const t=e[r],o=t.boundary,i=t.conformation.operator;i.isIdentity?n.includeSphere(o.sphere):(L.f8.transform(Z,o.sphere,i.matrix),n.includeSphere(Z))}n.finishedIncludeStep();for(let r=0,o=e.length;r<o;r++){const t=e[r],o=t.boundary,i=t.conformation.operator;i.isIdentity?n.radiusSphere(o.sphere):(L.f8.transform(Z,o.sphere,i.matrix),n.radiusSphere(Z))}return{box:n.getBox(),sphere:n.getSphere()}}var Y=n(12606);class z{subsetBuilder(t){return new f(this,t)}get elementCount(){return this.state.elementCount}get bondCount(){return-1===this.state.bondCount&&(this.state.bondCount=this.interUnitBonds.edgeCount/2+m.gn.getIntraUnitBondCount(this)),this.state.bondCount}get hasCustomProperties(){return!!this.state.customProps&&this.state.customProps.all.length>0}get customPropertyDescriptors(){return this.state.customProps||(this.state.customProps=new H.v),this.state.customProps}get currentPropertyData(){return this.state.propertyData||(this.state.propertyData=Object.create(null)),this.state.propertyData}get inheritedPropertyData(){return this.parent?this.parent.currentPropertyData:this.currentPropertyData}get polymerResidueCount(){return-1===this.state.polymerResidueCount&&(this.state.polymerResidueCount=function(t){const{units:e}=t;let n=0;for(let r=0,o=e.length;r<o;r++)n+=e[r].polymerElements.length;return n}(this)),this.state.polymerResidueCount}get polymerGapCount(){return-1===this.state.polymerGapCount&&(this.state.polymerGapCount=function(t){const{units:e}=t;let n=0;for(let r=0,o=e.length;r<o;r++)n+=e[r].gapElements.length/2;return n}(this)),this.state.polymerGapCount}get polymerUnitCount(){return-1===this.state.polymerUnitCount&&(this.state.polymerUnitCount=function(t){const{units:e}=t;let n=0;for(let r=0,o=e.length;r<o;r++)e[r].polymerElements.length>0&&(n+=1);return n}(this)),this.state.polymerUnitCount}get uniqueElementCount(){return-1===this.state.uniqueElementCount&&(this.state.uniqueElementCount=function(t){const{unitSymmetryGroups:e}=t;let n=0;for(let r=0,o=e.length;r<o;r++)n+=e[r].elements.length;return n}(this)),this.state.uniqueElementCount}get atomicResidueCount(){return-1===this.state.atomicResidueCount&&(this.state.atomicResidueCount=function(t){const{units:e}=t;let n=0;for(let r=0,o=e.length;r<o;r++){const t=e[r];if(!c.N.isAtomic(t))continue;const{elements:o,residueIndex:i}=t;let s=-1,a=-1;for(let e=0,r=o.length;e<r;++e)s=i[o[e]],s!==a&&(n+=1,a=s)}return n}(this)),this.state.atomicResidueCount}get isCoarseGrained(){return this.models.some(t=>s.Kx.isCoarseGrained(t))}get isEmpty(){return 0===this.units.length}get hashCode(){return-1!==this.state.hashCode?this.state.hashCode:this.computeHash()}get transformHash(){return-1!==this.state.transformHash||(this.state.transformHash=(0,a.TI)(this.units.map(t=>t.id))),this.state.transformHash}computeHash(){let t=23;for(let e=0,n=this.units.length;e<n;e++){const n=this.units[e];t=31*t+n.id|0,t=31*t+r.X9.hashCode(n.elements)|0}return t=31*t+this.elementCount|0,t=(0,a.C_)(t),-1===t&&(t=0),this.state.hashCode=t,t}elementLocations(){return new z.ElementLocationIterator(this)}get root(){var t;return null!==(t=this.state.parent)&&void 0!==t?t:this}get parent(){return this.state.parent}get coordinateSystem(){return this.state.coordinateSystem}get label(){return this.state.label}get boundary(){return this.state.boundary||(this.state.boundary=X(this)),this.state.boundary}get lookup3d(){return this.state.lookup3d||(this.state.lookup3d=new l.jM(this)),this.state.lookup3d}get interUnitBonds(){return this.state.interUnitBonds||(this.parent&&this.state.dynamicBonds===this.parent.state.dynamicBonds&&this.parent.state.interUnitBonds&&0===this.parent.state.interUnitBonds.edgeCount?this.state.interUnitBonds=new m.dZ(new Map):this.state.interUnitBonds=(0,m.kD)(this,{ignoreWater:!this.dynamicBonds,ignoreIon:!this.dynamicBonds,validUnit:this.state.interBondsValidUnit,validUnitPair:this.state.interBondsValidUnitPair})),this.state.interUnitBonds}get dynamicBonds(){return this.state.dynamicBonds}get interBondsValidUnit(){return this.state.interBondsValidUnit}get interBondsValidUnitPair(){return this.state.interBondsValidUnitPair}get unitSymmetryGroups(){return this.state.unitSymmetryGroups||(this.state.unitSymmetryGroups=d.u.computeTransformGroups(this)),this.state.unitSymmetryGroups}get unitSymmetryGroupsIndexMap(){return this.state.unitSymmetryGroupsIndexMap||(this.state.unitSymmetryGroupsIndexMap=c.N.SymmetryGroup.getUnitSymmetryGroupsIndexMap(this.unitSymmetryGroups)),this.state.unitSymmetryGroupsIndexMap}get carbohydrates(){return this.state.carbohydrates||(this.state.carbohydrates=function(t){if(0===t.models.reduce((t,e)=>t+e.properties.saccharideComponentMap.size,0))return B;const e=[],n=[],o=[],i=[],s=new Map;function a(t,e,n){return`${t}|${e}|${n}`}function u(t,e){s.has(t)?s.get(t).push(e):s.set(t,[e])}function l(t,e){A.eB.sub(o[t].geometry.direction,o[e].geometry.center,o[t].geometry.center),A.eB.normalize(o[t].geometry.direction,o[t].geometry.direction)}const d=(0,A.eB)();function f(t,e,n){const r=n.conformation,i=o[t].geometry;A.eB.sub(i.direction,r.position(n.elements[e],d),i.center),A.eB.normalize(i.direction,i.direction)}for(let h=0,p=t.units.length;h<p;++h){const n=t.units[h];if(!c.N.isAtomic(n))continue;const{model:s,rings:d}=n,{chainAtomSegments:f,residueAtomSegments:m,atoms:p}=s.atomicHierarchy,{label_comp_id:g}=p,S=r.hT.transientSegments(f,n.elements),v=r.hT.transientSegments(m,n.elements);let B;for(;S.hasNext;)for(v.setSegment(S.move());v.hasNext;){const{index:t}=v.move(),r=T(g.value(m.offsets[t]),s);if(!r)continue;B||(B=I.g.byFingerprintAndResidue(d,D));const c=k(d,B.get(t));if(!c||!c.length){i.push({unit:n,residueIndex:t,component:r});continue}const f=[];for(let e=0,i=c.length;e<i;++e){const i=d.all[c[e]],s=M(n,i),l=b.c.calculateMomentsAxes((0,x.Dt)(n,i)),m=b.c.calculateNormalizedAxes(l),h=A.eB.copy((0,A.eB)(),m.origin),p=A.eB.copy((0,A.eB)(),m.dirC),g=N((0,A.eB)(),n,s,h);A.eB.orthogonalize(g,p,g);const y=I.X.getAltId(n,i),_=o.length;f.push(_),u(a(t,n.id,y),_),y&&u(a(t,n.id,""),_),o.push({geometry:{center:h,normal:p,direction:g},component:r,ringIndex:c[e],altId:y,unit:n,residueIndex:t})}const h=y((0,C.WE)(new Array(c.length)),2);for(let i=0,s=h.length;i<s;++i){const t=h[i],r=d.all[c[t[0]]],s=d.all[c[t[1]]];if(_.O.areVertexSetsConnected(n.bonds,r,s,3)){const n=f[t[0]],r=f[t[1]];o[n].altId===o[r].altId&&(l(n,r),l(r,n),e.push({carbohydrateIndexA:n,carbohydrateIndexB:r}),e.push({carbohydrateIndexA:r,carbohydrateIndexB:n}))}}}}function m(t,e){return s.get(a(t.getResidueIndex(e),t.id,function(t,e){const{elements:n}=t,{label_alt_id:r}=t.model.atomicHierarchy.atoms;return r.value(n[e])}(t,e)))||[]}for(let r=0,c=o.length;r<c;++r){const t=o[r],{unit:n}=t;for(let i=r+1;i<c;++i){const s=o[i];if(n!==s.unit||t.residueIndex===s.residueIndex)continue;const a=n.rings.all[t.ringIndex],u=n.rings.all[s.ringIndex];_.O.areVertexSetsConnected(n.bonds,a,u,3)&&(l(r,i),l(i,r),e.push({carbohydrateIndexA:r,carbohydrateIndexB:i}),e.push({carbohydrateIndexA:i,carbohydrateIndexB:r}))}}for(let r=0,h=t.units.length;r<h;++r){const o=t.units[r];c.N.isAtomic(o)&&t.interUnitBonds.getConnectedUnits(o.id).forEach(r=>{r.connectedIndices.forEach(o=>{r.getEdges(o).forEach(({props:i,indexB:s})=>{if(!S.I$.isCovalent(i.flag))return;const a=t.unitMap.get(r.unitA),u=t.unitMap.get(r.unitB),c=m(a,o),d=m(u,s);if(c.length>0&&d.length>0){const t=c.length,n=d.length;for(let r=0,i=Math.max(t,n);r<i;++r){const i=c[Math.min(r,t-1)],s=d[Math.min(r,n-1)],u=E(a,o);(u.startsWith("O1")||u.startsWith("C1"))&&l(i,s),e.push({carbohydrateIndexA:i,carbohydrateIndexB:s})}}else if(0===d.length)for(const t of c){const e=E(a,o);(e.startsWith("O1")||e.startsWith("C1"))&&f(t,s,u),n.push({carbohydrateIndex:t,elementIndex:s,elementUnit:u,fromCarbohydrate:!0})}else if(0===c.length)for(const t of d)n.push({carbohydrateIndex:t,elementIndex:o,elementUnit:a,fromCarbohydrate:!1})})})})}return{links:e,terminalLinks:n,elements:o,partialElements:i,...R(o,e,n)}}(this)),this.state.carbohydrates}get models(){return this.state.models||(this.state.models=function(t){const{units:e}=t,n=o.th.create();for(const r of e)o.th.add(n,r.model.id,r.model);return n.array}(this)),this.state.models}get uniqueResidueNames(){return this.state.uniqueResidueNames||(this.state.uniqueResidueNames=function(t){const{microheterogeneityCompIds:e}=h.Z.residue,n=new Set,o=u.i.Location.create(t);for(const i of t.unitSymmetryGroups){const t=i.units[0];if(!c.N.isAtomic(t))continue;const s=r.hT.transientSegments(t.model.atomicHierarchy.residueAtomSegments,t.elements);for(o.unit=t;s.hasNext;){const r=s.move();o.element=t.elements[r.start];const i=e(o);for(const t of i)n.add(t)}}return n}(this))}get uniqueElementSymbols(){return this.state.uniqueElementSymbols||(this.state.uniqueElementSymbols=function(t){const e=h.Z.atom.type_symbol,n=new Set,r=u.i.Location.create(t);for(const o of t.unitSymmetryGroups){const t=o.units[0];if(c.N.isAtomic(t)){r.unit=t;for(let o=0,i=t.elements.length;o<i;++o)r.element=t.elements[o],n.add(e(r))}}return n}(this))}get entityIndices(){return this.state.entityIndices||(this.state.entityIndices=function(t){const{units:e}=t,n=u.i.Location.create(t),i=o.th.create();for(const s of e){const t=s.kind===c.N.Kind.Atomic?h.Z.entity.key:h.Z.coarse.entityKey;n.unit=s;const e=s.elements,a=r.hT.transientSegments(s.model.atomicHierarchy.chainAtomSegments,e);for(;a.hasNext;){const r=a.move();n.element=e[r.start];const s=t(n);o.th.add(i,s,s)}}return(0,a.eh)(i.array),i.array}(this))}get uniqueAtomicResidueIndices(){return this.state.uniqueAtomicResidueIndices||(this.state.uniqueAtomicResidueIndices=function(t){const e=new Map,n=[],i=t.unitSymmetryGroups;for(const a of i){const t=a.units[0];if(!c.N.isAtomic(t))continue;let i;e.has(t.model.id)?i=e.get(t.model.id):(i=o.th.create(),n.push(t.model.id),e.set(t.model.id,i));const s=r.hT.transientSegments(t.model.atomicHierarchy.residueAtomSegments,t.elements);for(;s.hasNext;){const t=s.move();o.th.add(i,t.index,t.index)}}const s=new Map;for(const r of n){const t=e.get(r).array;(0,a.eh)(t),s.set(r,t)}return s}(this))}get isAtomic(){for(const t of this.units)if(!c.N.isAtomic(t))return!1;return!0}get hasAtomic(){for(const t of this.units)if(c.N.isAtomic(t))return!0;return!1}get isCoarse(){for(const t of this.units)if(!c.N.isCoarse(t))return!1;return!0}get hasCoarse(){for(const t of this.units)if(c.N.isCoarse(t))return!0;return!1}get serialMapping(){return this.state.serialMapping||(this.state.serialMapping=function(t){const{units:e,elementCount:n,unitIndexMap:r}=t,o=new Uint32Array(e.length),i=new Uint32Array(n),s=new Uint32Array(n);for(let a=0,u=0,c=e.length;a<c;++a){o[a]=u;const{elements:t}=e[a];for(let e=0,n=t.length;e<n;++e){const n=u+e;i[n]=a,s[n]=t[e]}u+=t.length}return{cumulativeUnitElementCount:o,unitIndices:i,elementIndices:s,getSerialIndex:(t,e)=>o[r.get(t.id)]+Y.C.indexOf(t.elements,e)}}(this))}get intraUnitBondMapping(){return this.state.intraUnitBondMapping||(this.state.intraUnitBondMapping=function(t){let e=0;const n=[];for(const u of t.unitSymmetryGroups){n.push(e);const t=u.units[0];c.N.isAtomic(t)&&(e+=2*t.bonds.edgeCount*u.units.length)}const r=new Uint32Array(e),o=new Uint32Array(e),i=new Uint32Array(e);let s=0,a=0;for(const u of t.unitSymmetryGroups){const t=u.units[0];if(c.N.isAtomic(t)){const e=2*t.bonds.edgeCount;for(let t=0,n=u.units.length;t<n;++t)for(let u=0,c=e;u<c;++u)r[s]=a,o[s]=u,i[s]=t,s+=1}a+=1}return{bondCount:e,unitIndex:r,unitEdgeIndex:o,unitGroupIndex:i,unitGroupOffset:n}}(this))}get model(){if(this.state.model)return this.state.model;if(this.state.representativeModel)return this.state.representativeModel;if(this.state.masterModel)return this.state.masterModel;const t=this.models;if(t.length>1)throw new Error("The structure is based on multiple models and has neither a master- nor a representative-model.");return this.state.model=t[0],this.state.model}get masterModel(){return this.state.masterModel}get representativeModel(){return this.state.representativeModel}hasElement(t){return!!this.unitMap.has(t.unit.id)&&r.X9.has(this.unitMap.get(t.unit.id).elements,t.element)}getModelIndex(t){return this.models.indexOf(t)}remapModel(t){const{dynamicBonds:e,interUnitBonds:n,parent:r}=this.state,o=[];for(const i of this.unitSymmetryGroups){const n=i.units[0].remapModel(t,e);o.push(n);for(let r=1,s=i.units.length;r<s;++r){const s=i.units[r];o.push(s.remapModel(t,e,n.props))}}return z.create(o,{parent:null==r?void 0:r.remapModel(t),label:this.label,interUnitBonds:e?void 0:n,dynamicBonds:e,interBondsValidUnit:this.state.interBondsValidUnit,interBondsValidUnitPair:this.state.interBondsValidUnitPair,coordinateSystem:this.state.coordinateSystem,masterModel:this.state.masterModel,representativeModel:this.state.representativeModel})}asParent(){if(this._proxy)return this._proxy;if(this.parent){const t=this.parent.coordinateSystem.isIdentity?this.parent:z.transform(this.parent,this.parent.coordinateSystem.inverse),e=this.coordinateSystem.isIdentity?t:z.transform(t,this.coordinateSystem.matrix);this._proxy=new z(e.units,e.unitMap,e.unitIndexMap,{...e.state,dynamicBonds:this.dynamicBonds},{child:this,target:this.parent})}else this._proxy=this;return this._proxy}get child(){return this._child}get target(){var t;return null!==(t=this._target)&&void 0!==t?t:this}constructor(t,e,n,r,o){this.units=t,this.unitMap=e,this.unitIndexMap=n,this.state=r,this._child=null==o?void 0:o.child,this._target=null==o?void 0:o.target,this._proxy=void 0}}function $(t,e,n){return t[e].id-t[n].id}!function(t){function e(t){return{kind:"structure-loci",structure:t}}function n(e,n={}){const o=r.Yz.Mutable(),s=r.Yz.Mutable();let u=0,c=!0,l=e.length>0?e[0].id:0;for(let t=0,r=e.length;t<r;t++){const n=e[t];o.set(n.id,n),u+=n.elements.length,n.id<l&&(c=!1),l=n.id}c||(0,a.di)(e,0,e.length,$,a.VE);for(let t=0,r=e.length;t<r;t++)s.set(e[t].id,t);const d={hashCode:-1,transformHash:-1,elementCount:u,bondCount:-1,uniqueElementCount:-1,atomicResidueCount:-1,polymerResidueCount:-1,polymerGapCount:-1,polymerUnitCount:-1,dynamicBonds:!1,coordinateSystem:i.J.Default,label:""};return n.parent&&(d.parent=n.parent.parent||n.parent),n.interUnitBonds&&(d.interUnitBonds=n.interUnitBonds),n.interBondsValidUnit?d.interBondsValidUnit=n.interBondsValidUnit:n.parent&&(d.interBondsValidUnit=n.parent.interBondsValidUnit),n.interBondsValidUnitPair?d.interBondsValidUnitPair=n.interBondsValidUnitPair:n.parent&&(d.interBondsValidUnitPair=n.parent.interBondsValidUnitPair),n.dynamicBonds?d.dynamicBonds=n.dynamicBonds:n.parent&&(d.dynamicBonds=n.parent.dynamicBonds),n.coordinateSystem?d.coordinateSystem=n.coordinateSystem:n.parent&&(d.coordinateSystem=n.parent.coordinateSystem),n.label?d.label=n.label:n.parent&&(d.label=n.parent.label),n.masterModel?d.masterModel=n.masterModel:n.parent&&(d.masterModel=n.parent.masterModel),n.representativeModel?d.representativeModel=n.representativeModel:n.parent&&(d.representativeModel=n.parent.representativeModel),new t(e,o,s,d)}function o(t,e={}){const n=t.atomicHierarchy.chainAtomSegments,{index:o}=t.atomicHierarchy,{auth_asym_id:a}=t.atomicHierarchy.chains,{atomicChainOperatorMappinng:u}=t,d=new m({label:t.label,...e});for(let f=0;f<n.count;f++){const e=u.get(f)||i.J.Default,m=n.offsets[f];let h=!1,p=!1;if(l(t,f))for(p=!0;f+1<n.count&&l(t,f+1);){if(u.get(f)!==u.get(f+1))break;h=!0,f++}else for(;f+1<n.count&&n.offsets[f+1]-n.offsets[f]===1&&n.offsets[f+2]-n.offsets[f+1]===1;){if(o.getEntityFromChain(f)!==o.getEntityFromChain(f+1))break;if(a.value(f)!==a.value(f+1))break;if(u.get(f)!==u.get(f+1))break;h=!0,f++}const g=r.X9.ofBounds(m,n.offsets[f+1]);let y=c.N.Trait.None;h&&(y|=c.N.Trait.MultiChain),p&&(y|=c.N.Trait.Water),s.Kx.isCoarseGrained(t)&&(y|=c.N.Trait.CoarseGrained),d.addUnit(c.N.Kind.Atomic,t,e,g,y)}const h=t.coarseHierarchy;return h.isDefined&&(h.spheres.count>0&&f(d,t,t.coarseHierarchy.spheres,c.N.Kind.Spheres),h.gaussians.count>0&&f(d,t,t.coarseHierarchy.gaussians,c.N.Kind.Gaussians)),d.getStructure()}function l(t,e){const n=t.atomicHierarchy.index.getEntityFromChain(e);return"water"===t.entities.data.type.value(n)}function f(t,e,n,o){const{chainElementSegments:s}=n;for(let a=0;a<s.count;a++){const n=r.X9.ofBounds(s.offsets[a],s.offsets[a+1]);t.addUnit(o,e,i.J.Default,n,c.N.Trait.None)}}t.Empty=n([]),t.Loci=e,t.toStructureElementLoci=function(t){const e=[];for(const n of t.units)e.push({unit:n,indices:r.IX.ofBounds(0,n.elements.length)});return u.i.Loci(t,e)},t.toSubStructureElementLoci=function(t,e){return O.c.toLociWithSourceUnits(O.c.Singletons(t,e))},t.isLoci=function(t){return!!t&&"structure-loci"===t.kind},t.areLociEqual=function(t,e){return t.structure===e.structure},t.isLociEmpty=function(t){return t.structure.isEmpty},t.remapLoci=function(t,n){return n===t.structure?t:e(n)},t.create=n,t.ofTrajectory=async function(e,r){if(0===e.frameCount)return t.Empty;const i=[];let s,a=0;for(let t=0,n=e.frameCount;t<n;++t){const n=await G.YZ.resolveInContext(e.getFrameAtIndex(t),r);s||(s=n);const u=o(n);for(let t=0,e=u.units.length;t<e;++t){const e=u.units[t],n=e.invariantId+a,r=e.chainGroupId+a,o=c.N.create(i.length,n,r,e.traits,e.kind,e.model,e.conformation.operator,e.elements);i.push(o)}a=i.length}return n(i,{representativeModel:s,label:s.label})},t.ofModel=o,t.transform=function(t,e){if(A.$I.isIdentity(e))return t;if(!A.$I.isRotationAndTranslation(e,i.J.RotationTranslationEpsilon))throw new Error("Only rotation/translation combination can be applied.");const r=[];for(const n of t.units){const t=n.conformation.operator,o=i.J.create(t.name,e,t);r.push(n.applyOperator(n.id,o))}const o=t.coordinateSystem;return n(r,{parent:t,coordinateSystem:i.J.compose(i.J.create(o.name,e,o),o)})},t.instances=function(t,e){for(const n of e)if(!A.$I.isRotationAndTranslation(n,i.J.RotationTranslationEpsilon))throw new Error("Only rotation/translation combination can be applied.");const r=[];let o=0;for(const n of t.units){const t=n.conformation.operator;for(const s of e){if(A.$I.isIdentity(s)){r.push(n);continue}const e=i.J.create(t.name,s,t);r.push(n.applyOperator(o++,e))}}return n(r,{parent:t})};class m{beginChainGroup(){this.chainGroupId++,this.inChainGroup=!0}endChainGroup(){this.inChainGroup=!1}addUnit(t,e,n,r,o,i){void 0===i&&(i=this.invariantId());const s=this.inChainGroup?this.chainGroupId:++this.chainGroupId,a=c.N.create(this.units.length,i,s,o,t,e,n,r);return this.add(a)}copyUnit(t,e){let n=null==e?void 0:e.invariantId;void 0===n&&(n=this.invariantId());const r=this.inChainGroup?this.chainGroupId:++this.chainGroupId,o=t.getCopy(this.units.length,n,r,e);return this.add(o)}add(t){if(1===t.elements.length){t.conformation.position(t.elements[0],this.p);const e=[t.invariantId,this.p[0],this.p[1],this.p[2]].join("|");if(this.singleElementUnits.has(e))return this.singleElementUnits.get(e);this.singleElementUnits.set(e,t)}return this.units.push(t),t}addWithOperator(t,e,n=!1){return this.add(t.applyOperator(this.units.length,e,n))}getStructure(){return n(this.units,this.props)}get isEmpty(){return 0===this.units.length}constructor(t={}){this.props=t,this.units=[],this.invariantId=(0,U.q)(),this.chainGroupId=-1,this.inChainGroup=!1,this.p=(0,A.eB)(),this.singleElementUnits=new Map}}function h(t,e){if(t===e)return!0;if(t.elementCount!==e.elementCount)return!1;const n=t.units.length;if(n!==e.units.length)return!1;for(let r=0;r<n;r++)if(t.units[r].id!==e.units[r].id)return!1;return!0}function p(t,e){return t===e||t.hashCode===e.hashCode&&d.u.areTransformGroupsEquivalent(t.unitSymmetryGroups,e.unitSymmetryGroups)}t.StructureBuilder=m,t.Builder=function(t={}){return new m(t)},t.hashCode=function(t){return t.hashCode},t.conformationHash=function(t){return(0,a.YZ)(t.units.map(t=>c.N.conformationId(t)).join("|"))},t.areUnitIdsEqual=h,t.areUnitIdsAndIndicesEqual=function(t,e){if(t===e)return!0;if(!h(t,e))return!1;for(let n=0,o=t.units.length;n<o;n++)if(!r.X9.areEqual(t.units[n].elements,e.units[n].elements))return!1;return!0},t.areHierarchiesEqual=function(t,e){if(t.hashCode!==e.hashCode)return!1;const n=t.models.length;if(n!==e.models.length)return!1;for(let r=0;r<n;r++)if(!s.Kx.areHierarchiesEqual(t.models[r],e.models[r]))return!1;return!0},t.areEquivalent=p,t.areRootsEquivalent=function(t,e){return p(t.root,e.root)},t.areRootsEqual=function(t,e){return t.root===e.root};t.ElementLocationIterator=class{move(){return this.advance(),this.current.element=this.elements[this.idx],this.current}advance(){if(this.idx<this.maxIdx)return this.idx++,void(this.idx===this.maxIdx&&(this.hasNext=this.unitIndex+1<this.structure.units.length));this.idx=0,this.unitIndex++,this.unitIndex>=this.structure.units.length?this.hasNext=!1:(this.current.unit=this.structure.units[this.unitIndex],this.elements=this.current.unit.elements,this.maxIdx=this.elements.length-1,0===this.maxIdx&&(this.hasNext=this.unitIndex+1<this.structure.units.length))}constructor(t){this.structure=t,this.unitIndex=0,this.maxIdx=0,this.idx=-1,this.current=u.i.Location.create(t),this.hasNext=t.elementCount>0,this.hasNext&&(this.elements=t.units[0].elements,this.maxIdx=this.elements.length-1,this.current.unit=t.units[0])}};const g=(0,A.eB)();function y(t,e,n){const{elements:r,conformation:o}=t,i=g;let s=Number.MAX_VALUE;for(let a=0,u=r.length;a<u;a++){const t=r[a],u=A.eB.distance(e,o.position(t,i))-n-o.r(t);u<s&&(s=u)}return s}function _(t,e,n){const{units:r}=t;let o=Number.MAX_VALUE;for(let i=0,s=r.length;i<s;i++){const t=y(r[i],e,n);t<o&&(o=t)}return o}t.minDistanceToPoint=_;const b=(0,A.eB)();function C(t){return t.unitSymmetryGroups.filter(t=>t.units[0].polymerElements.length>0)}let S;t.distance=function(t,e){if(0===t.elementCount||0===e.elementCount)return 0;const{units:n}=t;let r=Number.MAX_VALUE;for(let o=0,i=n.length;o<i;o++){const t=n[o],{elements:i,conformation:s}=t;for(let n=0,o=i.length;n<o;n++){const t=i[n],o=_(e,s.position(t,b),s.r(t));o<r&&(r=o)}}return r},t.elementDescription=function(t){return 1===t.elementCount?"1 element":`${t.elementCount} elements`},t.validUnitPair=function(t,e,n){return t.masterModel?e.model===n.model||e.model===t.masterModel||n.model===t.masterModel:e.model===n.model},t.eachUnitPair=function(t,e,n){const{maxRadius:r,validUnit:o,validUnitPair:i}=n;if(!t.units.some(t=>o(t)))return;const s=t.lookup3d,a=(0,A.eB)();for(const u of t.units){if(!o(u))continue;const n=u.boundary.sphere;A.eB.transformMat4(a,n.center,u.conformation.operator.matrix);const c=s.findUnitIndices(a[0],a[1],a[2],n.radius+r);for(let r=0;r<c.count;r++){const n=t.units[c.indices[r]];u.id>=n.id||o(n)&&i(u,n)&&(n.elements.length>=u.elements.length?e(u,n):e(n,u))}}},t.eachAtomicHierarchyElement=function(t,{chain:e,residue:n,atom:o}){const i=u.i.Location.create(t);for(const s of t.units){if(s.kind!==c.N.Kind.Atomic)continue;i.unit=s;const{elements:t}=s,a=r.hT.transientSegments(s.model.atomicHierarchy.chainAtomSegments,t),u=r.hT.transientSegments(s.model.atomicHierarchy.residueAtomSegments,t);for(;a.hasNext;){const r=a.move();if(e&&(i.element=t[r.start],e(i)),n||o)for(u.setSegment(r);u.hasNext;){const e=u.move();if(n&&(i.element=t[e.start],n(i)),o)for(let n=e.start,r=e.end;n<r;n++)i.element=t[n],o(i)}}}},t.DefaultSizeThresholds={smallResidueCount:10,mediumResidueCount:5e3,largeResidueCount:3e4,highSymmetryUnitCount:10,fiberResidueCount:15},function(t){t[t.Small=0]="Small",t[t.Medium=1]="Medium",t[t.Large=2]="Large",t[t.Huge=3]="Huge",t[t.Gigantic=4]="Gigantic"}(S=t.Size||(t.Size={})),t.getSize=function(e,n={},r=1){const o={...t.DefaultSizeThresholds,...n};return e.polymerResidueCount>=o.largeResidueCount*r?function(t,e){const n=C(t);return n.length>=1&&n[0].units.length>e.highSymmetryUnitCount}(e,o)?S.Huge:S.Gigantic:function(t,e){const n=C(t);return 1===n.length&&n[0].units.length>2&&n[0].units[0].polymerElements.length<e.fiberResidueCount}(e,o)||e.polymerResidueCount<o.smallResidueCount*r?S.Small:e.polymerResidueCount<o.mediumResidueCount*r?S.Medium:S.Large},t.Index=F.S.createSimple("index","root"),t.MaxIndex=F.S.createSimple("max_index","root");const x="__PrincipalAxes__";t.getPrincipalAxes=function(e){if(e.currentPropertyData[x])return e.currentPropertyData[x];const n=u.i.Loci.getPrincipalAxes(t.toStructureElementLoci(e));return e.currentPropertyData[x]=n,n}}(z||(z={}))},32211:function(t,e,n){n.d(e,{V:function(){return r}});var r,o=n(27125),i=n(15387);!function(t){const e={byEntityKey:{},sequences:[]};function n(...t){const e=[],n={};for(let r=0,o=t.length;r<o;++r)e.push(...t[r].sequences),Object.assign(n,t[r].byEntityKey);return{sequences:e,byEntityKey:n}}function r(t,e){const{label_comp_id:n}=e.atoms,{label_seq_id:r}=e.residues,{chainAtomSegments:s,residueAtomSegments:a}=e,{count:u,offsets:c}=s,l={},d=[];if(1===u&&0===c[0]&&0===c[1])return{byEntityKey:l,sequences:d};for(let f=0,m=e.chains._rowCount;f<m;f++){const s=e.index.getEntityFromChain(f);if(void 0!==l[s]||"polymer"!==t.data.type.value(s))continue;const u=f;for(f++;f<m&&s===e.index.getEntityFromChain(f)&&"polymer"!==t.data.type.value(s);)f++;f--;const h=a.index[c[u]],p=a.index[c[f+1]-1]+1,g=o.VP.window(r,h,p),y=[];for(let t=h;t<p;++t)y.push(n.value(a.offsets[t]));const _=o.VP.ofStringArray(y);l[s]={entityId:t.data.id.value(s),sequence:i.g.ofResidueNames(_,g)},d.push(l[s])}return{byEntityKey:l,sequences:d}}function s(t,e){return n(a(t,e.spheres),a(t,e.gaussians))}function a(t,e){const{chainElementSegments:n,seq_id_begin:r,seq_id_end:s}=e,{count:a,offsets:u}=n,c={},l=[];if(1===a&&0===u[0]&&0===u[1])return{byEntityKey:c,sequences:l};for(let d=0,f=a;d<f;d++){const n=e.getEntityFromChain(d);if(void 0!==c[n])continue;const a=d;for(d++;d<f&&n===e.getEntityFromChain(d);)d++;d--;const m=u[a],h=u[d+1]-1,p=o.VP.window(r,m,h),g=o.VP.window(s,m,h);c[n]={entityId:t.data.id.value(n),sequence:i.g.ofSequenceRanges(p,g)},l.push(c[n])}return{byEntityKey:c,sequences:l}}t.fromHierarchy=function(t,o,i){return n(r(t,o),i.isDefined?s(t,i):e)},t.fromAtomicHierarchy=r,t.fromCoarseHierarchy=s,t.fromCoarseElements=a}(r||(r={}))},33236:function(t,e,n){n.d(e,{$q:function(){return s},vX:function(){return r},yw:function(){return o}});const r=13330===new Uint16Array(new Uint8Array([18,52]).buffer)[0];function o(t,e){const n=new ArrayBuffer(t.length),r=new Uint8Array(n);for(let o=0,i=t.length;o<i;o+=e)for(let n=0;n<e;n++)r[o+e-n-1]=t[o+n];return n}const i=28672;function s(t){if(t.length>i){const e=[];for(let n=0;n<t.length;n+=i)e.push(String.fromCharCode.apply(null,t.subarray(n,n+i)));return e.join("")}return String.fromCharCode.apply(null,t)}},33565:function(t,e,n){n.d(e,{p:function(){return u}});var r=n(98537),o=n(46291);const i=r.e.add,s=r.e.squaredDistance,a=r.e.distance;class u{reset(){r.e.set(this.center,0,0,0),this.radiusSq=0,this.count=0}includeStep(t){i(this.center,this.center,t),this.count++}finishedIncludeStep(){0!==this.count&&r.e.scale(this.center,this.center,1/this.count)}radiusStep(t){const e=s(t,this.center);e>this.radiusSq&&(this.radiusSq=e)}radiusSphereStep(t,e){const n=a(t,this.center)+e,r=n*n;r>this.radiusSq&&(this.radiusSq=r)}getSphere(t){return t||(t=(0,o.f)()),r.e.copy(t.center,this.center),t.radius=Math.sqrt(this.radiusSq),t}getCount(){return this.count}constructor(){this.count=0,this.center=(0,r.e)(),this.radiusSq=0}}!function(t){const e=new t,n=(0,r.e)(),o=(0,r.e)();t.fromArrays=function({x:t,y:o,z:i},s){e.reset();const a=t.length;for(let u=0;u<a;u++)r.e.set(n,t[u],o[u],i[u]),e.includeStep(n);e.finishedIncludeStep();for(let u=0;u<a;u++)r.e.set(n,t[u],o[u],i[u]),e.radiusStep(n);return r.e.copy(s.center,e.center),s.radius=Math.sqrt(e.radiusSq),s},t.fromProvider=function(t,o,i){e.reset();for(let r=0;r<t;r++)o(r,n),e.includeStep(n);e.finishedIncludeStep();for(let r=0;r<t;r++)o(r,n),e.radiusStep(n);return r.e.copy(i.center,e.center),i.radius=Math.sqrt(e.radiusSq),i},t.fromPairProvider=function(t,i,s){e.reset();for(let r=0;r<t;r++)i(r,n,o),e.includeStep(n),e.includeStep(o);e.finishedIncludeStep();for(let r=0;r<t;r++)i(r,n,o),e.radiusStep(n),e.radiusStep(o);return r.e.copy(s.center,e.center),s.radius=Math.sqrt(e.radiusSq),s}}(u||(u={}))},34370:function(t,e,n){n.d(e,{CL:function(){return s},JA:function(){return c},Qx:function(){return a},VI:function(){return i},cG:function(){return u}});var r=n(78850),o=n(98391);const i={reds:(0,o.Q5)("Reds","sequential","Reds, sequential color scheme from ColorBrewer 2.0",[16774640,16703698,16563105,16552562,16476746,15678252,13309981,10817301,6750221]),oranges:(0,o.Q5)("Oranges","sequential","Oranges, sequential color scheme from ColorBrewer 2.0",[16774635,16705230,16634018,16625259,16616764,15821075,14239745,10892803,8333060]),greens:(0,o.Q5)("Greens","sequential","Greens, sequential color scheme from ColorBrewer 2.0",[16252149,15070688,13101504,10607003,7652470,4303709,2329413,27948,17435]),blues:(0,o.Q5)("Blues","sequential","Blues, sequential color scheme from ColorBrewer 2.0",[16251903,14609399,13032431,10406625,7057110,4362950,2191797,545180,536683]),purples:(0,o.Q5)("Purples","sequential","Purples, sequential color scheme from ColorBrewer 2.0",[16579581,15724021,14342891,12369372,10394312,8420794,6967715,5515151,4128893]),greys:(0,o.Q5)("Greys","sequential","Greys, sequential color scheme from ColorBrewer 2.0",[16777215,15790320,14277081,12434877,9868950,7566195,5395026,2434341,0]),"orange-red":(0,o.Q5)("Orange-Red","sequential","OrRd, sequential color scheme from ColorBrewer 2.0",[16775148,16705736,16635038,16628612,16551257,15689032,14102559,11730944,8323072]),"blue-green":(0,o.Q5)("Blue-Green","sequential","BuGn, sequential color scheme from ColorBrewer 2.0",[16252157,15070713,13429990,10082505,6734500,4304502,2329413,27948,17435]),"purple-blue-green":(0,o.Q5)("Purple-Blue-Green","sequential","PuBuGn, sequential color scheme from ColorBrewer 2.0",[16775163,15524592,13685222,10927579,6793679,3576e3,164234,93273,83510]),"green-blue":(0,o.Q5)("Green-Blue","sequential","GnBu, sequential color scheme from ColorBrewer 2.0",[16252144,14742491,13429701,11066805,8113348,5157843,2854078,551084,540801]),"purple-blue":(0,o.Q5)("Purple-Blue","sequential","PuBu, sequential color scheme from ColorBrewer 2.0",[16775163,15525874,13685222,10927579,7645647,3576e3,356528,285325,145496]),"blue-purple":(0,o.Q5)("Blue-Purple","sequential","BuPu, sequential color scheme from ColorBrewer 2.0",[16252157,14740724,12571622,10403034,9213638,9202609,8929693,8458108,5046347]),"red-purple":(0,o.Q5)("Red-Purple","sequential","RdPu, sequential color scheme from ColorBrewer 2.0",[16775155,16638173,16565696,16424885,16214177,14496919,11403646,7995767,4784234]),"purple-red":(0,o.Q5)("Purple-Red","sequential","PuRd, sequential color scheme from ColorBrewer 2.0",[16250105,15196655,13941210,13210823,14640560,15149450,13505110,9961539,6750239]),"yellow-orange-red":(0,o.Q5)("Yellow-Orange-Red","sequential","YlOrRd, sequential color scheme from ColorBrewer 2.0",[16777164,16772512,16701814,16691788,16616764,16535082,14883356,12386342,8388646]),"yellow-orange-brown":(0,o.Q5)("Yellow-Orange-Brown","sequential","YlOrBr, sequential color scheme from ColorBrewer 2.0",[16777189,16775100,16704401,16696399,16685353,15495188,13388802,10040324,6694150]),"yellow-green":(0,o.Q5)("Yellow-Green","sequential","YlGn, sequential color scheme from ColorBrewer 2.0",[16777189,16252089,14282915,11394446,7915129,4303709,2327619,26679,17705]),"yellow-green-blue":(0,o.Q5)("Yellow-Green-Blue","sequential","YlGnBu, sequential color scheme from ColorBrewer 2.0",[16777177,15595697,13101492,8375739,4306628,1937856,2252456,2438292,531800]),"red-blue":(0,o.Q5)("Red-Blue","diverging","RdBu, diverging color scheme from ColorBrewer 2.0",[6750239,11671595,14049357,16033154,16636871,16250871,13755888,9618910,4428739,2188972,340065]),"red-grey":(0,o.Q5)("Red-Grey","diverging","RdGy, diverging color scheme from ColorBrewer 2.0",[6750239,11671595,14049357,16033154,16636871,16777215,14737632,12237498,8882055,5066061,1710618]),"pink-yellow-green":(0,o.Q5)("Pink-Yellow-Green","diverging","PiYG, diverging color scheme from ColorBrewer 2.0",[9306450,12917629,14579630,15840986,16638191,16250871,15136208,12116358,8371265,5083681,2581529]),"brown-white-green":(0,o.Q5)("Brown-White-Green","diverging","BrBG, diverging color scheme from ColorBrewer 2.0",[5517317,9195786,12550445,14664317,16181443,16119285,13101797,8441281,3512207,91742,15408]),"purple-green":(0,o.Q5)("Purple-Green","diverging","PRGn, diverging color scheme from ColorBrewer 2.0",[4194379,7744131,10055851,12756431,15193320,16250871,14282963,10935200,5942881,1800247,17435]),"purple-orange":(0,o.Q5)("Purple-Orange","diverging","PuOr, diverging color scheme from ColorBrewer 2.0",[2949195,5515144,8418220,11709394,14211819,16250871,16703670,16627811,14713364,11753478,8338184]),"orange-purple":(0,o.Q5)("Orange-Purple","diverging","Reversed PuOr, diverging color scheme from ColorBrewer 2.0",[8338184,11753478,14713364,16627811,16703670,16250871,14211819,11709394,8418220,5515144,2949195]),"red-yellow-green":(0,o.Q5)("Red-Yellow-Green","diverging","RdYlGn, diverging color scheme from ColorBrewer 2.0",[10813478,14102567,16018755,16625249,16703627,16777151,14282635,10934634,6733155,1742928,26679]),"red-yellow-blue":(0,o.Q5)("Red-Yellow-Blue","diverging","RdYlBu, diverging color scheme from ColorBrewer 2.0",[10813478,14102567,16018755,16625249,16703632,16777151,14742520,11262441,7646673,4552116,3225237]),spectral:(0,o.Q5)("Spectral","diverging","Spectral, diverging color scheme from ColorBrewer 2.0",[10355010,13975119,16018755,16625249,16703627,16777151,15136152,11263396,6734501,3311805,6180770]),magma:(0,o.Q5)("Magma","sequential","Magma, sequential color scheme from Matplotlib, perceptually uniform shades of black-red-white",[4,131595,328726,591648,920363,1314358,1708098,2167117,2691418,3346535,3870576,4460406,4985210,5510013,5969279,6560384,7019905,7676289,8135554,8660609,9185665,9710720,10235519,10826110,11351164,12007289,12532343,13057395,13516656,14042475,14567784,14962532,15357537,15687006,16017244,16216156,16349533,16483167,16551011,16619112,16686957,16689523,16692347,16694658,16696970,16699282,16701594,16638627,16640940,16577718,16580031]),"magma-no-black":(0,o.Q5)("Magma (no black)","sequential","Magma, sequential color scheme from Matplotlib, perceptually uniform shades of black-red-white (with the black region removed)",[4329332,4853881,5378684,5903742,6363263,6888576,7413633,7938689,8463745,8988801,9513600,10038655,10563454,11088508,11613562,12138360,12728949,13254258,13714030,14239338,14699366,15094114,15489119,15753309,16017499,16216411,16350045,16483424,16551523,16619368,16621934,16689780,16692091,16694402,16696969,16633746,16636058,16638371,16575148,16577461,16514239]),inferno:(0,o.Q5)("Inferno","sequential","Inferno, sequential color scheme from Matplotlib, perceptually uniform shades of black-red-yellow",[4,131596,328727,657186,1050925,1444665,1969221,2427985,3082843,3737955,4328040,4852843,5377645,5902702,6427502,6952814,7477870,8133997,8659051,9184105,9643623,10168676,10693729,11218782,11743834,12334932,12794703,13254730,13583429,14109502,14504250,14833460,15162926,15427112,15757088,15955993,16154643,16288012,16421383,16489222,16557322,16559634,16497183,16434218,16305463,16176966,16048470,15919721,15921789,16120210,16580516]),"inferno-no-black":(0,o.Q5)("Inferno (no black)","sequential","Inferno, sequential color scheme from Matplotlib, perceptually uniform shades of black-red-yellow (with the black region removed)",[4721514,5246316,5771373,6296430,6821486,7346542,7871597,8396651,8921450,9446504,9971557,10496610,10956127,11481435,12006486,12466258,12926285,13386056,13780802,14241085,14570295,14965297,15229227,15558693,15757342,15956248,16154897,16288267,16421638,16489734,16492043,16494612,16496926,16368426,16305463,16111429,15982678,15853928,15856253,16119953,16580260]),plasma:(0,o.Q5)("Plasma","sequential","Plasma, sequential color scheme from Matplotlib, perceptually uniform shades of blue-red-yellow",[1771148,2426257,3081365,3671193,4195228,4784799,5308834,5833124,6357158,6815911,7340200,7864744,8324007,8783782,9309348,9769377,10164126,10624154,11018902,11413393,11808141,12137352,12466307,12795519,13124730,13453685,13717361,14046573,14309992,14573668,14837344,15035483,15299159,15497299,15695438,15893834,16091974,16224833,16357693,16425017,16557877,16625457,16627245,16629289,16631334,16567845,16438820,16310052,16115494,15921190,15726625]),viridis:(0,o.Q5)("Viridis","sequential","Viridis, sequential color scheme from Matplotlib, perceptually uniform shades of blue-green-yellow",[4524123,4656994,4658793,4726127,4727668,4663929,4599933,4535937,4406404,4276870,4081800,3952010,3822475,3627148,3497356,3302029,3172237,3042446,2912654,2782862,2652814,2523022,2393229,2328973,2198924,2069132,2004874,2005897,2007175,2139525,2337154,2666111,3060348,3520376,4045684,4570991,5227369,5883748,6605661,7392854,8180303,8967495,9819967,10672695,11525166,12443174,13295646,14148121,15000344,15852828,16639780]),cividis:(0,o.Q5)("Cividis","sequential","Cividis, sequential color scheme from Matplotlib, perceptually uniform shades of blue-grey-yellow, should look effectively identical to colorblind and non-colorblind users",[8273,9305,10079,76644,339560,668266,1062508,1390957,1916270,2375790,2835566,3295342,3754862,4214638,4543085,5068397,5462638,5856878,6185326,6579567,6908272,7236721,7499890,7828595,8091764,8354933,8617846,8946551,9209463,9472888,9736056,10064760,10327928,10656632,10985591,11379830,11708532,12102770,12497264,12891501,13285994,13745766,14140259,14600287,14994522,15389014,15717970,16046926,16310347,16508232,16640581]),twilight:(0,o.Q5)("Twilight","cyclical","Twilight, cyclical color scheme from Matplotlib, perceptually uniform shades of white-blue-black-red-white",[14670305,14211037,13554648,12766675,11847630,10993866,10139847,9351365,8628419,8036290,7509952,7048895,6718653,6519739,6386105,6252470,6184114,6181293,6112935,6044831,5976470,5777291,5447293,5052270,4592479,4067665,3674181,3281211,3150646,3543352,4067644,4657728,5379141,6166345,6953549,7741007,8463184,9120336,9777743,10304079,10830671,11291984,11687762,12083541,12348505,12613471,12878439,13077872,13211771,13411209,13545111,13809830,14074293,14338756,14537169,14735067,14801121]),"set-2":(0,o.Q5)("Set-2","qualitative","Set2, categorical color scheme from ColorBrewer 2.0",[6734501,16551266,9281739,15174339,10934356,16767279,15058068,11776947]),accent:(0,o.Q5)("Accent","qualitative","Accent, categorical color scheme from ColorBrewer 2.0",[8374655,12496596,16629894,16777113,3697840,15729279,12540695,6710886]),"set-1":(0,o.Q5)("Set-1","qualitative","Set1, categorical color scheme from ColorBrewer 2.0",[14948892,3636920,5091146,9981603,16744192,16777011,10901032,16220607,10066329]),"set-3":(0,o.Q5)("Set-3","qualitative","Set3, categorical color scheme from ColorBrewer 2.0",[9294791,16777139,12499674,16482418,8434131,16626786,11787881,16567781,14277081,12353725,13429701,16772463]),"dark-2":(0,o.Q5)("Dark-2","qualitative","Dark2, categorical color scheme from ColorBrewer 2.0",[1810039,14245634,7696563,15149450,6727198,15117058,10909213,6710886]),paired:(0,o.Q5)("Paired","qualitative","Paired, categorical color scheme from ColorBrewer 2.0",[10931939,2062516,11722634,3383340,16489113,14883356,16629615,16744192,13284054,6962586,16777113,11622696]),"pastel-2":(0,o.Q5)("Pastel-2","qualitative","Pastel2, categorical color scheme from ColorBrewer 2.0",[11789005,16633260,13358568,16042724,15136201,16773806,15852236,13421772]),"pastel-1":(0,o.Q5)("Pastel-1","qualitative","Pastel1, categorical color scheme from ColorBrewer 2.0",[16495790,11783651,13429701,14601188,16701862,16777164,15063229,16636652,15921906]),turbo:(0,o.Q5)("Turbo","sequential","Turbo color scheme from D3.js, improved (smooth) rainbow colormap for visualization",[2299675,3547990,4337541,4799658,4934343,4872413,4613867,4289780,3900152,3510520,3120629,2796271,2602726,2474716,2477264,2611140,2875575,3270826,3731101,4387984,5109892,5897080,6815085,7798371,8781145,9829201,10811209,11858498,12774460,13755446,14605618,15389486,16042283,16563496,16757029,16753699,16750369,16746782,16743196,16608538,16146200,15487253,14763026,13973263,13052940,12198408,11344133,10621442,9965056,9571328,9440256]),"turbo-no-black":(0,o.Q5)("Turbo (no black)","sequential","Turbo color scheme from D3.js, improved (smooth) rainbow colormap for visualization, with black region removed",[4866485,4872413,4354034,3770361,3120629,2667241,2475736,2611140,3073454,3928216,5109892,6487408,8126047,9829201,11531332,13167162,14605618,15780908,16693543,16753699,16748063,16741916,16146200,15026195,13644558,12198408,10818563,9833728]),warm:(0,o.Q5)("Warm","sequential","Warm, sequential color scheme from D3.js",[7225514,7684013,8208303,8797873,9322162,9846195,10370483,10960051,11484338,12008625,12532911,13057452,13581737,14040742,14434210,14959005,15352473,15746196,16074382,16402824,16665475,16731772,16732790,16733808,16734826,16735843,16737117,16738135,16739409,16740939,16742471,16743746,16745277,16747065,16748598,16487987,16162097,15901743,15575598,15184174,14858031,14466608,14140466,13748788,13422648,13030972,12704833,12378438,12052044,11791187,11530331]),cool:(0,o.Q5)("Cool","sequential","Cool, sequential color scheme from D3.js",[7225514,7095217,6899639,6769597,6574275,6313160,6117837,5856977,5596117,5335513,5009115,4748510,4422368,4161761,3835361,3575009,3314401,3053791,2793438,2598363,2337752,2208213,2013137,1883340,1819335,1755074,1691068,1692086,1758640,1825706,1957795,2155164,2352790,2615695,2878601,3207042,3600764,3994230,4453489,4912492,5437031,5961315,6551391,7140956,7730778,8386136,8975703,9630807,10285911,10940761,11530331]),"cubehelix-default":(0,o.Q5)("CubehelixDefault","sequential","CubehelixDefault, sequential color scheme from D3.js",[0,525064,984594,1313308,1576742,1709360,1776697,1712705,1649479,1520715,1457486,1394254,1396557,1529674,1662534,2057794,2518076,3109175,3765555,4618288,5536047,6519343,7568178,8550967,9599551,10516809,11368789,12155235,12745329,13270146,13663891,13861539,13928371,13929921,13800654,13606106,13411811,13217514,12957935,12829170,12700403,12768243,12835826,13099761,13428976,13823727,14349039,14939888,15530483,16186616,16777215]),rainbow:(0,o.Q5)("Rainbow","cyclical","Rainbow, cyclical color scheme from D3.js",[7225514,8208303,9322162,10370483,11484338,12532911,13581737,14434210,15352473,16074382,16665475,16732790,16734826,16737117,16739409,16742471,16745277,16748598,16162097,15575598,14858031,14140466,13422648,12704833,12052044,11530331,10285911,8975703,7730777,6485855,5437031,4453489,3600764,2878601,2352790,1957795,1758896,1691068,1819335,2013137,2337752,2793438,3314401,3835617,4422368,5009115,5596117,6117837,6574275,6899639,7225514]),sinebow:(0,o.Q5)("Sinebow","cyclical","Sinebow, cyclical color scheme from D3.js",[16728128,16666162,16473382,16149788,15695122,15174923,14458117,13740802,12892928,11978752,10999043,9953287,8972813,7860757,6879262,5831722,4849463,3931972,3079507,2357858,1635442,1109378,648082,317858,118193,49087,111053,303833,561890,1081837,1602292,2319098,3036157,3884287,4798463,5778172,6823928,7804402,8916458,9897952,10945493,11927752,12845243,13697708,14419357,15141773,15667837,16129133,16459357,16659022,16728128]),"category-10":(0,o.Q5)("Category10","qualitative","Category10, categorical color scheme from D3.js / tab10 from Matplotlib (default in Matplotlib)",[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175]),"observable-10":(0,o.Q5)("Observable10","qualitative","Observable10, categorical color scheme from D3.js",[4352464,15708440,16740956,7128496,3975505,16747191,10773490,9944053,10251086,9738400]),"tableau-10":(0,o.Q5)("Tableau10","qualitative","Tableau10, categorical color scheme from D3.js",[5142951,15896108,14767961,7780274,5873999,15583561,11500193,16752039,10253663,12234923]),"simple-rainbow":(0,o.Q5)("Simple rainbow","sequential","Simple 5-color rainbow (blue-green-yellow-orange-red)",[3367393,3516485,16383744,15501073,12526114]),"red-white-blue":(0,o.Q5)("Red-White-Blue","diverging","Diverging color scheme with red-white-blue",[12526114,16777215,3367393]),"many-distinct":(0,o.Q5)("Many-Distinct","qualitative","Customized color scheme combining colors from multiple standard schemes (Dark2, Set1, Set2)",[1810039,14245634,7696563,15149450,6727198,15117058,10909213,6710886,14948892,3636920,5091146,9981603,16744192,16777011,10901032,16220607,10066329,6734501,16551266,9281739,15174339,10934356,16767279,15058068,11776947])},s=Object.keys(i).map(t=>[t,i[t].label,(0,r.ZH)(i[t].type),i[t].description]),a=s.filter(t=>"sequential"===i[t[0]].type||"diverging"===i[t[0]].type||"cyclical"===i[t[0]].type),u=s.filter(t=>"qualitative"===i[t[0]].type);function c(t){return t in i?i[t]:(console.warn(`unknown color list named '${t}'`),i["red-yellow-blue"])}},35256:function(t,e,n){n.d(e,{i:function(){return p}});var r=n(784),o=n(46031),i=n(73868),s=n(22463),a=n(98820),u=n(28243);function c(t,e,n){if(!t._rowCount)return[];const r=function(t){const{id:e,matrix:n,vector:r,_schema:o}=t,s=new Map,a=(0,i.eB)();for(let u=0,c=t._rowCount;u<c;u++){const t=i.qY.toMat4((0,i.$I)(),o.matrix.space,n.value(u));i.qY.toVec3(a,o.vector.space,r.value(u)),i.$I.setTranslation(t,a),i.$I.setValue(t,3,3,1),s.set(e.value(u),t)}return s}(n),o=[];for(let i=0;i<t._rowCount;i++)o[o.length]=l(t,e,i,r);return o}function l(t,e,n,r){const o=t.id.value(n),i=t.details.value(n),c=[],{assembly_id:l,oper_expression:f,asym_id_list:p}=e;for(let s=0,a=e._rowCount;s<a;s++)l.value(s)===o&&(c[c.length]={assemblyId:o,expression:f.value(s),asymIds:p.value(s)});return a.N.create(o,i,function(t,e){return()=>{const n=[];let r=0;for(let o=0;o<t.length;o++){const i=t[o],a=d(h(i.expression)),c=m(e,a,r,i.assemblyId),l=u.RT.generators.atoms({chainTest:u.RT.pred.and(u.RT.pred.eq(t=>u.ZP.unit.operator_name(t.element),s.J.DefaultName),u.RT.pred.inSet(t=>u.ZP.chain.label_asym_id(t.element),i.asymIds))});n[n.length]={selector:l,operators:c,asymIds:i.asymIds},r+=c.length}return n}}(c,r))}function d(t){const e=[],n=[];for(let r=0;r<t.length;r++)n[r]="";return f(t,e,t.length-1,n),e}function f(t,e,n,r){if(n<0)return void(e[e.length]=r.slice(0));const o=t[n],i=o.length;for(let s=0;s<i;s++)r[n]=o[s],f(t,e,n-1,r)}function m(t,e,n,r){const o=[];let a=n;for(const u of e){const e=i.$I.identity();for(let r=0;r<u.length;r++)i.$I.mul(e,e,t.get(u[r]));a++;const n=`ASM_${a}`,c=s.J.getAssemblyOperatorName(u);o[o.length]=s.J.create(n,e,{instanceId:c,assembly:{id:r,operId:a,operList:u}})}return o}function h(t){const e=/\(?([^\(\)]+)\)?]*/g,n=[],r=[];let o;for(;o=e.exec(t);)n[n.length]=o[1];return n.forEach(t=>{const e=[];t.split(",").forEach(t=>{const n=t.indexOf("-");if(n>0){const r=parseInt(t.substring(0,n)),o=parseInt(t.substr(n+1));for(let t=r;t<=o;t++)e[e.length]=t.toString()}else e[e.length]=t.trim()}),r[r.length]=e}),r}var p,g=n(58392);function y(t){if(0===t._rowCount)return;const{id:e,matrix:n,vector:s}=t,a=r.r.struct_ncs_oper.matrix.space,u=r.r.struct_ncs_oper.vector.space,c=[];for(let r=0;r<t._rowCount;r++){const l=i.qY.toMat3((0,i.U)(),a,n.value(r)),d=i.qY.toVec3((0,i.eB)(),u,s.value(r));if(!o.JX.checkIfRotationAndTranslation(l,d))continue;if("given"===t.code.value(r)&&!i.U.isIdentity(l)&&!i.eB.isZero(d))continue;const f=e.value(r);c[c.length]=o.JX.ofRotationAndOffset(`ncs_${f}`,l,d,f)}return c}!function(t){t.Descriptor={name:"model_symmetry"},t.Provider=g.q.create(t.Descriptor),t.fromData=function(t){const e=c(t.pdbx_struct_assembly,t.pdbx_struct_assembly_gen,t.pdbx_struct_oper_list),n=function(t,e){if(0===t._rowCount||0===e._rowCount)return o.is.ZeroP1;const n=e.length_a.value(0),r=e.length_b.value(0),s=e.length_c.value(0);if(0===n||0===r||0===s)return o.is.ZeroP1;const a=e.angle_alpha.value(0),u=e.angle_beta.value(0),c=e.angle_gamma.value(0);if(0===a||0===u||0===c)return o.is.ZeroP1;const l=function(t){const e=t.Int_Tables_number.value(0),n=t["space_group_name_H-M"].value(0);return t.Int_Tables_number.isDefined?t["space_group_name_H-M"].isDefined?n:e:n}(t),d=o.O8.create(l,i.eB.create(n,r,s),i.eB.scale((0,i.eB)(),i.eB.create(a,u,c),Math.PI/180));return o.is.create(d)}(t.symmetry,t.cell);return{assemblies:e,spacegroup:n,isNonStandardCrystalFrame:(t.atom_sites._rowCount,!1),ncsOperators:y(t.struct_ncs_oper)}},t.fromCell=function(t,e){const n=o.O8.create("P 1",t,e);return{assemblies:[],spacegroup:o.is.create(n),isNonStandardCrystalFrame:!1}}}(p||(p={}))},35332:function(t,e,n){n.d(e,{Go:function(){return u},IF:function(){return c},JW:function(){return o},Wv:function(){return a},bN:function(){return s}});const r=Object.prototype.hasOwnProperty;function o(t,e){for(const n of Object.keys(e))r.call(e,n)&&void 0===t[n]&&(t[n]=e[n]);return t}function i(t,e){let n=!1;for(const o of Object.keys(e))if(r.call(e,o)&&e[o]!==t[o]){n=!0;break}return n?Object.assign({},t,e):t}function s(t,e){if(!t)return!e;if(!e)return!1;const n=Object.keys(t);if(Object.keys(e).length!==n.length)return!1;for(const o of n)if(!r.call(t,o)||t[o]!==e[o])return!1;return!0}function a(t,e){let n=t;for(let r=0;r<e.length;r++)if(e[r]&&(n=i(t,e[r]),n!==t)){for(let t=r+1;t<e.length;t++)n=Object.assign(n,e[t]);break}return n}function u(t){if(null===t||"object"!=typeof t)return t;if(t instanceof Array){const e=[];for(let n=0,r=t.length;n<r;n++)e[n]=u(t[n]);return e}if("object"==typeof t&&!("prototype"in t)){const e={};for(const n in t)r.call(t,n)&&(e[n]=u(t[n]));return e}throw new Error(`Can't clone, type "${typeof t}" unsupported`)}function c(t,e){if(t)for(const n of Object.keys(t))e(t[n],n)}},35695:function(t,e,n){n.d(e,{T:function(){return o},p:function(){return r}});const r=1e-6;function o(t,e,n){return Math.abs(t-e)<=n}},37631:function(t,e,n){n.d(e,{O:function(){return c},P:function(){return u}});var r,o,i=n(99572),s=n(20722),a=n(99487);function u(t){return r.classify(t)}function c(t){return o.classify(t)}!function(t){function e(t,e){return t>=0?Math.ceil((t+1)/e):Math.ceil((t+1)/(-e-1))}function n({limit8:t,limit16:n},r,o){r.pack8+=e(o,t),r.pack16+=e(o,n),r.count+=1}function r(t,n){t.pack8+=e(n,127),t.pack16+=e(n,32767),t.count+=1}function o(t){return 4*t.count<2*t.pack16?{length:4*t.count,elem:4}:2*t.pack16<t.pack8?{length:2*t.pack16,elem:2}:{length:t.pack8,elem:1}}function s(t,e){const r={pack8:0,pack16:0,count:0};for(let o=0,i=t.length;o<i;o++)n(e,r,t[o]);return{...o(r),kind:"pack"}}function u(t,e){const n={pack8:0,pack16:0,count:0};let i=t[0];for(let o=1,s=t.length;o<s;o++)r(n,t[o]-i),i=t[o];return{...o(n),kind:"delta"}}function c(t,e){const r={pack8:0,pack16:0,count:0};let i=1;for(let o=1,s=t.length;o<s;o++)t[o-1]!==t[o]?(n(e,r,t[o-1]),n(e,r,i),i=1):i++;return n(e,r,t[t.length-1]),n(e,r,i),{...o(r),kind:"rle"}}function l(t,e){const n={pack8:0,pack16:0,count:0};let i=1,s=0,a=0;for(let o=1,u=t.length;o<u;o++){const e=t[o]-s;a!==e?(r(n,a),r(n,i),i=1):i++,a=e,s=t[o]}return r(n,a),r(n,i),{...o(n),kind:"delta-rle"}}function d(t){const e=function(t){let e=!1;for(let n=0,r=t.length;n<r;n++)if(t[n]<0){e=!0;break}return e?{signed:e,limit8:127,limit16:32767}:{signed:e,limit8:255,limit16:65535}}(t),n=[s(t,e),c(t,e),u(t),l(t)];return n.sort((t,e)=>t.length-e.length),n}t.getSize=d,t.classify=function(t){if(t.length<2)return i.ND.by(i.ND.byteArray);const e=d(t)[0];switch(e.kind){case"pack":return i.ND.by(i.ND.integerPacking);case"rle":return i.ND.by(i.ND.runLength).and(i.ND.integerPacking);case"delta":return i.ND.by(i.ND.delta).and(i.ND.integerPacking);case"delta-rle":return i.ND.by(i.ND.delta).and(i.ND.runLength).and(i.ND.integerPacking);default:(0,a.dr)(e)}}}(r||(r={})),function(t){t.classify=function(t){const{mantissaDigits:e,integerDigits:n}=(0,s.In)(t,4,1e-6);if(e<0||e+n>10)return i.ND.by(i.ND.byteArray);if(0===e)return r.classify(t);const o=function(t){let e=1;for(let n=0;n<t;n++)e*=10;return e}(e),u=new Int32Array(t.length);for(let r=0,i=t.length;r<i;r++)u[r]=Math.round(o*t[r]);const c=r.getSize(u)[0],l=i.ND.by(i.ND.fixedPoint(o));switch(c.kind){case"pack":return l.and(i.ND.integerPacking);case"rle":return l.and(i.ND.runLength).and(i.ND.integerPacking);case"delta":return l.and(i.ND.delta).and(i.ND.integerPacking);case"delta-rle":return l.and(i.ND.delta).and(i.ND.runLength).and(i.ND.integerPacking);default:(0,a.dr)(c)}}}(o||(o={}))},38328:function(t,e,n){var r;n.d(e,{f:function(){return r}}),function(t){let e;t.create=function(t=512){return{current:[],offset:0,capacity:t,chunks:[]}},t.getString=function(t){return t.chunks.length?(t.offset>0&&(t.chunks[t.chunks.length]=t.current.length===t.offset?t.current.join(""):t.current.slice(0,t.offset).join("")),t.chunks.join("")):t.current.length===t.offset?t.current.join(""):t.current.splice(0,t.offset).join("")},t.getSize=function(t){let e=0;for(const n of t.chunks)e+=n.length;for(let n=0;n<t.offset;n++)e+=t.current[n].length;return e},t.getChunks=function(t){return t.offset>0&&(t.current.length===t.offset?t.chunks[t.chunks.length]=t.current.join(""):t.chunks[t.chunks.length]=t.current.slice(0,t.offset).join(""),t.offset=0),t.chunks},function(t){t[t.Count=512]="Count"}(e||(e={}));const n=[];function r(t,e){e>0&&o(t,n[e])}function o(t,e){t.offset===t.capacity&&(t.chunks[t.chunks.length]=t.current.join(""),t.offset=0),t.current[t.offset++]=e}!function(){let t="";for(let r=0;r<e.Count;r++)n[r]=t,t+=" "}(),t.newline=function(t){o(t,"\n")},t.whitespace=r,t.whitespace1=function(t){o(t," ")},t.write=function(t,e){e&&(t.offset===t.capacity&&(t.chunks[t.chunks.length]=t.current.join(""),t.offset=0),t.current[t.offset++]=e)},t.writeSafe=o,t.writePadLeft=function(t,e,n){if(!e)return void r(t,n);r(t,n-e.length),o(t,e)},t.writePadRight=function(t,e,n){if(!e)return void r(t,n);const i=n-e.length;o(t,e),r(t,i)},t.writeInteger=function(t,e){o(t,""+e)},t.writeIntegerAndSpace=function(t,e){o(t,e+" ")},t.writeIntegerPadLeft=function(t,e,n){const i=""+e;r(t,n-i.length),o(t,i)},t.writeIntegerPadRight=function(t,e,n){const i=""+e,s=n-i.length;o(t,i),r(t,s)},t.writeFloat=function(t,e,n){o(t,""+Math.round(n*e)/n)},t.writeFloatPadLeft=function(t,e,n,i){const s=""+Math.round(n*e)/n;r(t,i-s.length),o(t,s)},t.writeFloatPadRight=function(t,e,n,i){const s=""+Math.round(n*e)/n,a=i-s.length;o(t,s),r(t,a)}}(r||(r={}))},38530:function(t,e,n){var r;n.d(e,{Gm:function(){return r},BI:function(){return u},L9:function(){return I},qI:function(){return D},VE:function(){return o.VE},m1:function(){return h},vc:function(){return P},C_:function(){return c},vb:function(){return l},CP:function(){return d},hX:function(){return f},TI:function(){return y},XS:function(){return v},YZ:function(){return m},Ao:function(){return g},ZR:function(){return w},h3:function(){return s},di:function(){return o.di},eh:function(){return o.eh},bd:function(){return p}}),function(t){function e(t){const e=t.growBy*t.elementSize;t.currentSize=e,t.currentIndex=0,t.currentChunk=new t.ctor(e),t.allocatedSize+=e,t.chunks[t.chunks.length]=t.currentChunk}function n(t,e){const{ctor:n,chunks:r,currentIndex:o}=t;if(!r.length)return new n(0);if(1===r.length&&(e||o===t.allocatedSize))return r[0];let i=0;for(let c=0,l=r.length-1;c<l;c++)i+=r[c].length;i+=t.currentIndex;const s=new n(i);let a=0;if(s.buffer)for(let c=0,l=r.length-1;c<l;c++)s.set(r[c],a),a+=r[c].length;else for(let c=0,l=r.length-1;c<l;c++){const t=r[c];for(let e=0,n=t.length;e<n;e++)s[a+e]=t[e];a+=t.length}const u=r[r.length-1];if(s.buffer&&o>=t.currentSize)s.set(u,a);else for(let c=0,l=u.length;c<l;c++)s[a+c]=u[c];return s}t.is=function(t){return t.creator&&t.chunkSize},t.add4=function(t,n,r,o,i){t.currentIndex>=t.currentSize&&e(t);const s=t.currentChunk,a=t.currentIndex;return s[a]=n,s[a+1]=r,s[a+2]=o,s[a+3]=i,t.currentIndex+=4,t.elementCount++},t.add3=function(t,n,r,o){t.currentIndex>=t.currentSize&&e(t);const i=t.currentChunk,s=t.currentIndex;return i[s]=n,i[s+1]=r,i[s+2]=o,t.currentIndex+=3,t.elementCount++},t.add2=function(t,n,r){t.currentIndex>=t.currentSize&&e(t);const o=t.currentChunk,i=t.currentIndex;return o[i]=n,o[i+1]=r,t.currentIndex+=2,t.elementCount++},t.add=function(t,n){return t.currentIndex>=t.currentSize&&e(t),t.currentChunk[t.currentIndex]=n,t.currentIndex+=1,t.elementCount++},t.addRepeat=function(t,n,r){for(let o=0;o<n;o++)t.currentIndex>=t.currentSize&&e(t),t.currentChunk[t.currentIndex++]=r,t.elementCount++;return t.elementCount},t.addMany=function(t,n){const{elementSize:r}=t;for(let o=0,i=n.length;o<i;o+=r){t.currentIndex>=t.currentSize&&e(t);const{currentChunk:i}=t;for(let e=0;e<r;e++)i[t.currentIndex++]=n[o+e];t.elementCount++}return t.elementCount},t.compact=function(t,e=!1){return n(t,e)},t._compact=n,t.create=function(t,e,n,r){const o={ctor:t,elementSize:e,growBy:Math.max(1,Math.ceil(n)),allocatedSize:0,elementCount:0,currentSize:0,currentChunk:void 0,currentIndex:0,chunks:[]};if(void 0===r)return o;if("number"==typeof r)return o.currentChunk=new t(r*e),o.allocatedSize=r*e,o.currentSize=o.currentChunk.length,o.chunks[0]=o.currentChunk,o;const i=r;if(i.length%e!==0)throw new Error("initialChunk length must be a multiple of the element size.");return o.currentChunk=i,o.allocatedSize=i.length,o.currentSize=i.length,o.chunks[0]=i,o}}(r||(r={}));var o=n(71746);function i(t,e,n){return t[e].key<t[n].key?-1:1}function s(t,e,n){const r=n&&n.start||0,s=n&&n.end||t.length;if(s-r<=0)throw new Error("Can only bucket non-empty collections.");return function(t,e,n,r,s){const a=new Map,u=[];let c=e(t[0]),l=!0;for(let o=r;o<s;o++){const n=e(t[o]);if(a.has(n))a.get(n).count++,c!==n&&(l=!1);else{const t={key:n,count:1,offset:o};a.set(n,t),u[u.length]=t}c=n}const d=new Int32Array(u.length+1);d[u.length]=s;let f=!0;if(n)for(let o=1,i=u.length;o<i;o++)if(u[o-1].key>u[o].key){f=!1;break}if(l&&f){for(let t=0;t<u.length;t++)d[t]=u[t].offset;return d}n&&!f&&(0,o.di)(u,0,u.length,i,o.VE);let m=0;for(let o=0;o<u.length;o++){const t=u[o];t.offset=m,m+=t.count}const h=new Int32Array(s-r);for(let o=r;o<s;o++){const n=e(t[o]);h[a.get(n).offset++]=t[o]}for(let o=0,i=h.length;o<i;o++)t[o+r]=h[o];d[0]=r;for(let o=1;o<u.length;o++)d[o]=u[o-1].offset+r;return d}(t,e,!(!n||!n.sort),r,s)}class a{createGroup(t,e){const n=this.id++,r=[t];return this.groups[n]=r,{id:n,keys:r,value:e}}add(t,e){const n=this.getHash(e);if(this.byHash.has(n)){const r=this.byHash.get(n);for(let n=0,i=r.length;n<i;n++){const o=r[n];if(this.areEqual(e,o.value))return o.keys[o.keys.length]=t,o.value}const o=this.createGroup(t,e);return r[r.length]=o,o.value}{const r=this.createGroup(t,e);return this.byHash.set(n,[r]),r.value}}constructor(t,e){this.getHash=t,this.areEqual=e,this.id=0,this.byHash=new Map,this.groups=[]}}function u(t,e){return new a(t,e)}function c(t){let e=t^t>>4;return e=(3735928559^e)+(e<<5),e^=e>>11,e}function l(t,e){let n=23;return n=31*n+t|0,n=31*n+e|0,n^=n>>4,n=(3735928559^n)+(n<<5),n^=n>>11,n}function d(t,e,n){let r=23;return r=31*r+t|0,r=31*r+e|0,r=31*r+n|0,r^=r>>4,r=(3735928559^r)+(r<<5),r^=r>>11,r}function f(t,e,n,r){let o=23;return o=31*o+t|0,o=31*o+e|0,o=31*o+n|0,o=31*o+r|0,o^=o>>4,o=(3735928559^o)+(o<<5),o^=o>>11,o}function m(t){let e=0;for(let n=0,r=t.length;n<r;n++)e=(e<<5)-e+t.charCodeAt(n)|0;return e}function h(t,e){return(t+e)*(t+e+1)/2+e}function p(t,e){return t<e?h(t,e):h(e,t)}function g(t,e){const n=Math.floor((Math.sqrt(8*e+1)-1)/2),r=e-(n*n+n)/2;return t[0]=n-r,t[1]=r,t}function y(t){let e=2166136261;for(let n=0,r=t.length;n<r;++n)e^=t[n],e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24);return e>>>0}new class{constructor(){this.hashTarget=new Uint32Array(8),this.numberBytes=new Uint8Array(8),this.numberView=new DataView(this.numberBytes.buffer)}hash(t){return this.hashTarget.set(_),this.hashValue(t,0),function(t){let e="";for(let n=7;n>=0;n--)e+=x(t[n]);return e}(this.hashTarget)}hashValue(t,e){if(e>50)return;const n=typeof t;switch(this.addByte(n.charCodeAt(0)),n){case"string":this.addString(t);break;case"number":this.addNumber(t);break;case"boolean":this.addByte(t?1:0);break;case"object":null===t?this.addByte(0):Array.isArray(t)?this.addArray(t,e):this.addObject(t,e);break;case"undefined":this.addByte(255)}}addByte(t){this.hashTarget[0]^=255&t,C(this.hashTarget)}addString(t){for(let e=0;e<t.length;e++){const n=t.charCodeAt(e);n<128?this.addByte(n):n<2048?(this.addByte(192|n>>6),this.addByte(128|63&n)):(this.addByte(224|n>>12),this.addByte(128|n>>6&63),this.addByte(128|63&n))}}addNumber(t){if(Number.isNaN(t))this.addByte(127),this.addByte(192),this.addByte(0),this.addByte(0),this.addByte(0),this.addByte(0),this.addByte(0),this.addByte(0);else if(Number.isFinite(t)){this.numberView.setFloat64(0,t,!1);for(let t=0;t<8;t++)this.addByte(this.numberBytes[t])}else t>0?(this.addByte(127),this.addByte(128),this.addByte(0),this.addByte(0)):(this.addByte(255),this.addByte(128),this.addByte(0),this.addByte(0)),this.addByte(0),this.addByte(0),this.addByte(0),this.addByte(0)}addArray(t,e){this.addNumber(t.length);for(let n=0;n<t.length;n++)this.addNumber(n),this.hashValue(t[n],e+1)}addObject(t,e){const n=Object.keys(t).sort();this.addNumber(n.length);for(const r of n)this.addString(r),this.hashValue(t[r],e+1)}};const _=new Uint32Array([1818371886,129696066,1656234357,1653982605,383153456,3715178979,3004645376,256]),A=new Uint32Array(8),b=new Uint32Array(8);function C(t){A[0]=0,A[1]=0,A[2]=t[0]<<24,A[3]=t[0]>>>8|t[1]<<24,A[4]=t[1]>>>8|t[2]<<24,A[5]=t[2]>>>8|t[3]<<24,A[6]=t[3]>>>8|t[4]<<24,A[7]=t[4]>>>8|t[5]<<24,b[0]=t[0]<<8,b[1]=t[0]>>>24|t[1]<<8,b[2]=t[1]>>>24|t[2]<<8,b[3]=t[2]>>>24|t[3]<<8,b[4]=t[3]>>>24|t[4]<<8,b[5]=t[4]>>>24|t[5]<<8,b[6]=t[5]>>>24|t[6]<<8,b[7]=t[6]>>>24|t[7]<<8;let e=0;for(let n=0;n<8;n++){const r=59*t[n]+e;t[n]=r>>>0,e=Math.floor(r/4294967296)}e=0;for(let n=0;n<8;n++){const r=t[n]+A[n]+b[n]+e;t[n]=r>>>0,e=r>=4294967296?1:0}}const S=["00000000","0000000","000000","00000","0000","000","00","0"];function x(t){const e=t.toString(16);return e.length>=8?e:S[e.length]+e}function v(t,e=42){return B(JSON.stringify(t),e)}function B(t,e){let n=e>>>0,r=e>>>0,o=e>>>0,i=e>>>0;const s=t.length%16,a=t.length-s;for(let f=0;f<a;f+=16){let e=255&t.charCodeAt(f)|(255&t.charCodeAt(f+1))<<8|(255&t.charCodeAt(f+2))<<16|(255&t.charCodeAt(f+3))<<24,s=255&t.charCodeAt(f+4)|(255&t.charCodeAt(f+5))<<8|(255&t.charCodeAt(f+6))<<16|(255&t.charCodeAt(f+7))<<24,a=255&t.charCodeAt(f+8)|(255&t.charCodeAt(f+9))<<8|(255&t.charCodeAt(f+10))<<16|(255&t.charCodeAt(f+11))<<24,u=255&t.charCodeAt(f+12)|(255&t.charCodeAt(f+13))<<8|(255&t.charCodeAt(f+14))<<16|(255&t.charCodeAt(f+15))<<24;e=Math.imul(e,597399067),e=e<<15|e>>>17,e=Math.imul(e,2869860233),n^=e,n=n<<19|n>>>13,n+=r,n=Math.imul(n,5)+1444728091,s=Math.imul(s,2869860233),s=s<<16|s>>>16,s=Math.imul(s,951274213),r^=s,r=r<<17|r>>>15,r+=o,r=Math.imul(r,5)+197830471,a=Math.imul(a,951274213),a=a<<17|a>>>15,a=Math.imul(a,2716044179),o^=a,o=o<<15|o>>>17,o+=i,o=Math.imul(o,5)+2530024501,u=Math.imul(u,2716044179),u=u<<13|u>>>19,u=Math.imul(u,597399067),i^=u,i=i<<13|i>>>19,i+=n,i=Math.imul(i,5)+850148119}let u=0,c=0,l=0,d=0;switch(s){case 15:d^=t.charCodeAt(a+14)<<16;case 14:d^=t.charCodeAt(a+13)<<8;case 13:d^=t.charCodeAt(a+12),d=Math.imul(d,2716044179),d=d<<13|d>>>19,d=Math.imul(d,597399067),i^=d;case 12:l^=t.charCodeAt(a+11)<<24;case 11:l^=t.charCodeAt(a+10)<<16;case 10:l^=t.charCodeAt(a+9)<<8;case 9:l^=t.charCodeAt(a+8),l=Math.imul(l,951274213),l=l<<17|l>>>15,l=Math.imul(l,2716044179),o^=l;case 8:c^=t.charCodeAt(a+7)<<24;case 7:c^=t.charCodeAt(a+6)<<16;case 6:c^=t.charCodeAt(a+5)<<8;case 5:c^=t.charCodeAt(a+4),c=Math.imul(c,2869860233),c=c<<16|c>>>16,c=Math.imul(c,951274213),r^=c;case 4:u^=t.charCodeAt(a+3)<<24;case 3:u^=t.charCodeAt(a+2)<<16;case 2:u^=t.charCodeAt(a+1)<<8;case 1:u^=t.charCodeAt(a),u=Math.imul(u,597399067),u=u<<15|u>>>17,u=Math.imul(u,2869860233),n^=u}return n^=t.length,r^=t.length,o^=t.length,i^=t.length,n+=r,n+=o,n+=i,r+=n,o+=n,i+=n,n^=n>>>16,n=Math.imul(n,2246822507),n^=n>>>13,n=Math.imul(n,3266489909),n^=n>>>16,r^=r>>>16,r=Math.imul(r,2246822507),r^=r>>>13,r=Math.imul(r,3266489909),r^=r>>>16,o^=o>>>16,o=Math.imul(o,2246822507),o^=o>>>13,o=Math.imul(o,3266489909),o^=o>>>16,i^=i>>>16,i=Math.imul(i,2246822507),i^=i>>>13,i=Math.imul(i,3266489909),i^=i>>>16,n+=r,n+=o,n+=i,r+=n,o+=n,i+=n,(n>>>0).toString(16).padStart(8,"0")+(r>>>0).toString(16).padStart(8,"0")+(o>>>0).toString(16).padStart(8,"0")+(i>>>0).toString(16).padStart(8,"0")}n(27125);function I(t,e){for(let n=0,r=t.length;n<r;n++)if(e(t[n]))return t[n]}function w(t){if(Array.from)return Array.from(t);const e=[];for(;;){const{done:n,value:r}=t.next();if(n)break;e[e.length]=r}return e}function P(t,e,n){const r=e-t+1,o=n?new n(r):new Int32Array(r);for(let i=0;i<r;i++)o[i]=i+t;return o}function D(t,e){const n=new(function(t){const e=t.constructor;if(!e)throw new Error("data does not define a constructor and it should");return e}(t))(e.length);for(let r=0,o=e.length;r<o;r++)n[r]=t[e[r]];return n}},38818:function(t,e,n){n.d(e,{e:function(){return i},m:function(){return a}});var r=n(52500);const o=new Map([["HIS|CD2|CG",2],["HIS|CE1|ND1",2],["ARG|CZ|NH2",2],["PHE|CE1|CZ",2],["PHE|CD2|CE2",2],["PHE|CD1|CG",2],["TRP|CD1|CG",2],["TRP|CD2|CE2",2],["TRP|CE3|CZ3",2],["TRP|CH2|CZ2",2],["ASN|CG|OD1",2],["GLN|CD|OE1",2],["TYR|CD1|CG",2],["TYR|CD2|CE2",2],["TYR|CE1|CZ",2],["ASP|CG|OD1",2],["GLU|CD|OE1",2],["G|C8|N7",2],["G|C4|C5",2],["G|C2|N3",2],["G|C6|O6",2],["C|C4|N3",2],["C|C5|C6",2],["C|C2|O2",2],["A|C2|N3",2],["A|C6|N1",2],["A|C4|C5",2],["A|C8|N7",2],["U|C5|C6",2],["U|C2|O2",2],["U|C4|O4",2],["DG|C8|N7",2],["DG|C4|C5",2],["DG|C2|N3",2],["DG|C6|O6",2],["DC|C4|N3",2],["DC|C5|C6",2],["DC|C2|O2",2],["DA|C2|N3",2],["DA|C6|N1",2],["DA|C4|C5",2],["DA|C8|N7",2],["DT|C5|C6",2],["DT|C2|O2",2],["DT|C4|O4",2]]);function i(t,e,n){return[e,n]=e<n?[e,n]:[n,e],r.uA.has(t)&&"C"===e&&"O"===n||r.ii.has(t)&&"OP1"===e&&"P"===n?2:o.get(`${t}|${e}|${n}`)||1}const s=new Map([["LYS|NZ|RET|C15",2]]);function a(t,e,n,r){return t>n&&([t,n]=[n,t],[e,r]=[r,e]),s.get(`${t}|${e}|${n}|${r}`)||1}},39065:function(t,e,n){n.d(e,{c:function(){return r}});var r,o=n(51142);!function(t){t.create=function(t,e,n,r){return{id:o.kk.create22(),label:t,basic:e,sourceData:r,bonds:n}}}(r||(r={}))},40319:function(t,e,n){n.d(e,{O:function(){return r}});var r,o=n(38530),i=n(65533);function s(t,e,n,r,o){const{b:a,offset:u}=t,c=[];for(let s=0,l=e.length;s<l;++s){const t=e[s];for(let e=u[t],r=u[t+1];e<r;++e){const t=a[e];if(!o.has(t)){if(i.X9.has(n,t))return!0;o.add(t),c[c.length]=t}}}return r>1&&s(t,c,n,r-1,o)}!function(t){t.areEqual=function(t,e){if(t===e)return!0;if(t.vertexCount!==e.vertexCount||t.edgeCount!==e.edgeCount)return!1;const{a:n,b:r,offset:o}=t,{a:i,b:s,offset:a}=e;for(let u=0,c=t.a.length;u<c;u++)if(n[u]!==i[u])return!1;for(let u=0,c=t.b.length;u<c;u++)if(r[u]!==s[u])return!1;for(let u=0,c=t.offset.length;u<c;u++)if(o[u]!==a[u])return!1;for(const u of Object.keys(t.edgeProps)){const n=t.edgeProps[u],r=e.edgeProps[u];if(!r)return!1;for(let t=0,e=n.length;t<e;t++)if(n[t]!==r[t])return!1}return!0};class e{getEdgeIndex(t,e){let n,r;t<e?(n=t,r=e):(n=e,r=t);for(let o=this.offset[n],i=this.offset[n+1];o<i;o++)if(this.b[o]===r)return o;return-1}getDirectedEdgeIndex(t,e){for(let n=this.offset[t],r=this.offset[t+1];n<r;n++)if(this.b[n]===e)return n;return-1}getVertexEdgeCount(t){return this.offset[t+1]-this.offset[t]}constructor(t,e,n,r,o,i){this.offset=t,this.a=e,this.b=n,this.edgeCount=r,this.props=i,this.vertexCount=t.length-1,this.edgeProps=o||{}}}function n(t,n,r,o,i,s){return new e(t,n,r,o,i,s)}t.create=n;class r{createGraph(t,e){return n(this.offsets,this.a,this.b,this.edgeCount,t,e)}addNextEdge(){const t=this.xs[this.current],e=this.ys[this.current],n=this.offsets[t]+this.bucketFill[t];this.a[n]=t,this.b[n]=e,this.bucketFill[t]++;const r=this.offsets[e]+this.bucketFill[e];this.a[r]=e,this.b[r]=t,this.bucketFill[e]++,this.current++,this.curA=n,this.curB=r}addAllEdges(){for(let t=0;t<this.edgeCount;t++)this.addNextEdge()}assignProperty(t,e){t[this.curA]=e,t[this.curB]=e}assignDirectedProperty(t,e,n,r){t[this.curA]=e,t[this.curB]=r,n[this.curB]=e,n[this.curA]=r}constructor(t,e,n){this.vertexCount=t,this.xs=e,this.ys=n,this.current=0,this.curA=0,this.curB=0,this.edgeCount=e.length,this.offsets=new Int32Array(this.vertexCount+1),this.bucketFill=new Int32Array(this.vertexCount);const r=new Int32Array(this.vertexCount);for(let i=0,s=this.xs.length;i<s;i++)r[this.xs[i]]++;for(let i=0,s=this.ys.length;i<s;i++)r[this.ys[i]]++;let o=0;for(let i=0;i<this.vertexCount;i++)this.offsets[i]=o,o+=r[i];this.offsets[this.vertexCount]=o,this.slotCount=o,this.a=new Int32Array(o),this.b=new Int32Array(o)}}t.EdgeBuilder=r;t.DirectedEdgeBuilder=class{createGraph(t,e){return n(this.offsets,this.a,this.b,this.edgeCount,t,e)}addNextEdge(){const t=this.xs[this.current],e=this.ys[this.current],n=this.offsets[t]+this.bucketFill[t];this.a[n]=t,this.b[n]=e,this.bucketFill[t]++,this.current++,this.curA=n}addAllEdges(){for(let t=0;t<this.edgeCount;t++)this.addNextEdge()}assignProperty(t,e){t[this.curA]=e}constructor(t,e,n){this.vertexCount=t,this.xs=e,this.ys=n,this.current=0,this.curA=0,this.edgeCount=e.length,this.offsets=new Int32Array(this.vertexCount+1),this.bucketFill=new Int32Array(this.vertexCount);const r=new Int32Array(this.vertexCount);for(let i=0,s=this.xs.length;i<s;i++)r[this.xs[i]]++;let o=0;for(let i=0;i<this.vertexCount;i++)this.offsets[i]=o,o+=r[i];this.offsets[this.vertexCount]=o,this.slotCount=o,this.a=new Int32Array(o),this.b=new Int32Array(o)}};function a(e,n,r){const o=new t.EdgeBuilder(e,n,r);return o.addAllEdges(),o.createGraph({})}t.UniqueEdgeBuilder=class{addEdge(t,e){let n=t,r=e;t>e&&(n=e,r=t);const i=(0,o.m1)(n,r);return!this.included.has(i)&&(this.included.add(i),this.xs[this.xs.length]=n,this.ys[this.ys.length]=r,!0)}getGraph(){return a(this.vertexCount,this.xs,this.ys)}getEdgeBuiler(){return new r(this.vertexCount,this.xs,this.ys)}constructor(t){this.vertexCount=t,this.xs=[],this.ys=[],this.included=new Set}},t.fromVertexPairs=a,t.induceByVertices=function(t,e,r){const{b:i,offset:s,vertexCount:a,edgeProps:u}=t,c=new Int32Array(a);for(let n=0,o=e.length;n<o;n++)c[e[n]]=n+1;let l=0;for(let n=0;n<a;n++)if(0!==c[n])for(let t=s[n],e=s[n+1];t<e;t++)i[t]>n&&0!==c[i[t]]&&l++;const d=new Int32Array(e.length+1),f=new Int32Array(2*l),m=new Int32Array(2*l),h=new Int32Array(2*l);let p=0,g=0;for(let n=0;n<a;n++){if(0===c[n])continue;const t=c[n]-1;for(let e=s[n],r=s[n+1];e<r;e++){const n=c[i[e]];0!==n&&(m[p]=t,h[p]=n-1,f[p]=e,p++)}d[++g]=p}const y={};for(const n of Object.keys(u))y[n]=(0,o.qI)(u[n],f);return n(d,m,h,l,y,r)},t.connectedComponents=function(t){const e=t.vertexCount;if(0===e)return{componentCount:0,componentIndex:new Int32Array(0)};if(0===t.edgeCount){const t=new Int32Array(e);for(let n=0,r=e;n<r;n++)t[n]=n;return{componentCount:e,componentIndex:t}}const n=new Int32Array(e);for(let i=0,c=e;i<c;i++)n[i]=-1;let r=0;n[0]=r;const{offset:o,b:s}=t,a=[0],u=(0,i.YB)(e);for(u.remove(0);a.length>0;){const t=a.pop(),e=n[t];for(let r=o[t],i=o[t+1];r<i;r++){const t=s[r];u.has(t)&&(u.remove(t),a.push(t),n[t]=e)}0===a.length&&u.head>=0&&(a.push(u.head),n[u.head]=++r,u.remove(u.head))}return{componentCount:e,componentIndex:n}},t.areVertexSetsConnected=function(t,e,n,r){if(i.X9.areIntersecting(e,n))return!0;if(r<1)return!1;const o=new Set;for(let i=0,s=e.length;i<s;++i)o.add(e[i]);return s(t,e,n,r,o)}}(r||(r={}))},40728:function(t,e,n){n.d(e,{T:function(){return r}});var r,o=n(58392),i=n(59859),s=n(27125),a=n(62769),u=n(26511),c=n(59663);!function(t){const e="molstar_global_model_transform_info";function n(e){return t.Provider.get(e)}t.Schema={[e]:{matrix:s.VP.Schema.Matrix(4,4,s.VP.Schema.float)}},t.Descriptor=(0,i.e)({name:e,cifExport:{categories:[{name:e,instance(e){const r=n(e.firstModel);if(!r)return a.c.Category.Empty;const o=s.XI.ofRows(t.Schema.molstar_global_model_transform_info,[{matrix:r}]);return a.c.Category.ofTable(o)}}],prefix:"molstar"}}),t.Provider=o.q.create(t.Descriptor),t.attach=function(e,n){e.customProperties.has(t.Descriptor)||e.customProperties.add(t.Descriptor),t.Provider.set(e,n)},t.get=n,t.fromMmCif=function(n){if(!u.K4.is(n.sourceData))return;const r=n.sourceData.data.frame.categories[e];if(!r)return;const o=(0,c.MR)(t.Schema[e],r);return 0!==o._rowCount?o.matrix.value(0):void 0},t.hasData=function(t){if(!u.K4.is(t.sourceData))return!1;const n=t.sourceData.data.frame.categories[e];return!!n&&n.rowCount>0},t.writeMmCif=function(n,r){n.writeCategory({name:e,instance(){const e=s.XI.ofRows(t.Schema.molstar_global_model_transform_info,[{matrix:r}]);return a.c.Category.ofTable(e)}})}}(r||(r={}))},40915:function(t,e,n){function r(t,e){return t[e]|t[e+1]<<8}function o(t,e,n){t[e]=255&n,t[e+1]=n>>8&255}function i(t,e){return 16777216*t[e+3]+(t[e+2]<<16|t[e+1]<<8|t[e])}function s(t,e,n){t[e]=255&n,t[e+1]=n>>8&255,t[e+2]=n>>16&255,t[e+3]=n>>24&255}function a(t){return t.length<2?"0"+t:t}function u(t,e,n){let r,o="";for(let s=0;s<n;s++)o+="%"+a(t[e+s].toString(16));try{r=decodeURIComponent(o)}catch(i){return function(t,e,n){let r="";for(let o=0;o<n;o++)r+=String.fromCharCode(t[e+o]);return r}(t,e,n)}return r}function c(t){const e=t.length;let n=0;for(let r=0;r<e;r++){const e=t.charCodeAt(r);if(4294967168&e)if(4294965248&e)if(4294901760&e){if(4292870144&e)throw new Error("e");n+=4}else n+=3;else n+=2;else n++}return n}n.d(e,{qQ:function(){return W},Aq:function(){return z},$1:function(){return K}});const l=function(){const t=new Uint32Array(256);for(let e=0;e<256;e++){let n=e;for(let t=0;t<8;t++)1&n?n=3988292384^n>>>1:n>>>=1;t[e]=n}return t}();function d(t,e,n){return 4294967295^function(t,e,n,r){for(let o=0;o<r;o++)t=l[255&(t^e[n+o])]^t>>>8;return t}(4294967295,t,e,n)}const f={deflate:void 0,"deflate-raw":void 0,gzip:void 0};function m(t){if(void 0===f[t])try{new CompressionStream(t),f[t]=!0}catch(e){f[t]=!1}return!!f[t]}const h=function(){const t=Uint16Array,e=Uint32Array;return{next_code:new t(16),bl_count:new t(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new t(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new e(32),flmap:new t(512),fltree:[],fdmap:new t(32),fdtree:[],lmap:new t(32768),ltree:[],ttree:[],dmap:new t(32768),dtree:[],imap:new t(512),itree:[],rev15:new t(32768),lhst:new e(286),dhst:new e(30),ihst:new e(19),lits:new e(15e3),strt:new t(65536),prev:new t(32768)}}();function p(t,e,n){const r=t.length,o=h.rev15;for(let i=0;i<r;i+=2)if(0!==t[i+1]){const r=i>>1,s=t[i+1],a=r<<4|s,u=e-s;let c=t[i]<<u;const l=c+(1<<u);for(;c!==l;){n[o[c]>>>15-e]=a,c++}}}function g(t,e){const n=t.length,r=h.bl_count;for(let s=0;s<=e;s++)r[s]=0;for(let s=1;s<n;s+=2)r[t[s]]++;const o=h.next_code;let i=0;r[0]=0;for(let s=1;s<=e;s++)i=i+r[s-1]<<1,o[s]=i;for(let s=0;s<n;s+=2){const e=t[s+1];0!==e&&(t[s]=o[e],o[e]++)}}function y(t,e){const n=h.rev15,r=15-e;for(let o=0;o<t.length;o+=2){const i=t[o]<<e-t[o+1];t[o]=n[i]>>>r}}function _(t,e){const{data:n,noBuf:r}=t;let{buf:o,BFINAL:i,off:s,pos:a}=t,u=0;for(;0===i&&u<e;){let t,e,c=0,l=0;i=v(n,a,1),u+=1;const d=v(n,a+1,2);if(a+=3,0===d){7&a&&(a+=8-(7&a));const t=(a>>>3)+4,e=n[t-4]|n[t-3]<<8;r&&(o=b(o,s+e)),o.set(new Uint8Array(n.buffer,n.byteOffset+t,e),s),a=t+e<<3,s+=e;continue}if(r&&(o=b(o,s+(1<<17))),1===d)t=h.flmap,e=h.fdmap,c=511,l=31;else{if(2!==d)throw new Error(`unknown BTYPE ${d}`);{const r=x(n,a,5)+257,o=x(n,a+5,5)+1,i=x(n,a+10,4)+4;a+=14;for(let t=0;t<38;t+=2)h.itree[t]=0,h.itree[t+1]=0;let s=1;for(let t=0;t<i;t++){const e=x(n,a+3*t,3);h.itree[1+(h.ordr[t]<<1)]=e,e>s&&(s=e)}a+=3*i,g(h.itree,s),p(h.itree,s,h.imap),t=h.lmap,e=h.dmap,a=C(h.imap,(1<<s)-1,r+o,n,a,h.ttree);const u=S(h.ttree,0,r,h.ltree);c=(1<<u)-1;const d=S(h.ttree,r,o,h.dtree);l=(1<<d)-1,g(h.ltree,u),p(h.ltree,u,t),g(h.dtree,d),p(h.dtree,d,e)}}for(;;){const i=t[B(n,a)&c];a+=15&i;const u=i>>>4;if(u>>>8==0)o[s++]=u;else{if(256===u)break;{let t=s+u-254;if(u>264){const e=h.ldef[u-257];t=s+(e>>>3)+x(n,a,7&e),a+=7&e}const i=e[B(n,a)&l];a+=15&i;const c=i>>>4,d=h.ddef[c],f=(d>>>4)+v(n,a,15&d);for(a+=15&d,r&&(o=b(o,s+(1<<17)));s<t;)o[s]=o[s++-f],o[s]=o[s++-f],o[s]=o[s++-f],o[s]=o[s++-f];s=t}}}}t.buf=o,t.BFINAL=i,t.off=s,t.pos=a}async function A(t,e,n){if(3===e[0]&&0===e[1])return n||new Uint8Array(0);if(m("deflate-raw")){const r=new DecompressionStream("deflate-raw"),o=new Blob([e]).stream().pipeThrough(r);let i=0;const s=[],a=o.getReader(),u=async()=>{const{done:e,value:r}=await a.read();if(!e)return t.shouldUpdate&&await t.update({message:"Inflating blocks...",current:i,max:null==n?void 0:n.length}),n?n.set(r,i):s.push(r),i+=r.length,u()};if(await u(),!n){n=new Uint8Array(i);for(let t=0,e=0;t<s.length;t++)n.set(s[t],e),e+=s[t].length}return n}const r=function(t,e){const n=void 0===e;return void 0===e&&(e=new Uint8Array(t.length>>>2<<3)),{data:t,buf:e,noBuf:n,BFINAL:0,off:0,pos:0}}(e,n);for(;0===r.BFINAL;)t.shouldUpdate&&await t.update({message:"Inflating blocks...",current:r.pos,max:e.length}),_(r,100);return r.buf.length===r.off?r.buf:r.buf.slice(0,r.off)}function b(t,e){const n=t.length;if(e<=n)return t;const r=new Uint8Array(Math.max(n<<1,e));return r.set(t,0),r}function C(t,e,n,r,o,i){let s=0;for(;s<n;){const n=t[B(r,o)&e];o+=15&n;const a=n>>>4;if(a<=15)i[s]=a,s++;else{let t=0,e=0;16===a?(e=3+x(r,o,2),o+=2,t=i[s-1]):17===a?(e=3+x(r,o,3),o+=3):18===a&&(e=11+x(r,o,7),o+=7);const n=s+e;for(;s<n;)i[s]=t,s++}}return o}function S(t,e,n,r){let o=0,i=0;const s=r.length>>>1;for(;i<n;){const n=t[i+e];r[i<<1]=0,r[1+(i<<1)]=n,n>o&&(o=n),i++}for(;i<s;)r[i<<1]=0,r[1+(i<<1)]=0,i++;return o}function x(t,e,n){return(t[e>>>3]|t[(e>>>3)+1]<<8)>>>(7&e)&(1<<n)-1}function v(t,e,n){return(t[e>>>3]|t[(e>>>3)+1]<<8|t[(e>>>3)+2]<<16)>>>(7&e)&(1<<n)-1}function B(t,e){return(t[e>>>3]|t[(e>>>3)+1]<<8|t[(e>>>3)+2]<<16)>>>(7&e)}!function(){for(let e=0;e<32768;e++){let t=e;t=(2863311530&t)>>>1|(1431655765&t)<<1,t=(3435973836&t)>>>2|(858993459&t)<<2,t=(4042322160&t)>>>4|(252645135&t)<<4,t=(4278255360&t)>>>8|(16711935&t)<<8,h.rev15[e]=(t>>>16|t<<16)>>>17}function t(t,e,n){for(;0!==e--;)t.push(0,n)}for(let e=0;e<32;e++)h.ldef[e]=h.of0[e]<<3|h.exb[e],h.ddef[e]=h.df0[e]<<4|h.dxb[e];t(h.fltree,144,8),t(h.fltree,112,9),t(h.fltree,24,7),t(h.fltree,8,8),g(h.fltree,9),p(h.fltree,9,h.flmap),y(h.fltree,9),t(h.fdtree,32,5),g(h.fdtree,5),p(h.fdtree,5,h.fdmap),y(h.fdtree,5),t(h.itree,19,0),t(h.ltree,286,0),t(h.dtree,30,0),t(h.ttree,320,0)}();var I=n(99487);function w(t,e,n){const r=[],o=t.length,i=e.length;for(let h=0;h<i;h+=2)e[h]=0,e[h+1]=0;for(let h=0;h<o;h++)0!==t[h]&&r.push({lit:h,f:t[h],d:void 0});const s=r.length,a=r.slice(0);if(0===s)return 0;if(1===s){const t=r[0].lit,n=0===t?1:0;return e[1+(t<<1)]=1,e[1+(n<<1)]=1,1}r.sort(function(t,e){return t.f-e.f});let u=r[0],c=r[1],l=0,d=1,f=2;for(r[0]={lit:-1,f:u.f+c.f,l:u,r:c,d:0};d!==s-1;)u=l!==d&&(f===s||r[l].f<r[f].f)?r[l++]:r[f++],c=l!==d&&(f===s||r[l].f<r[f].f)?r[l++]:r[f++],r[d++]={lit:-1,f:u.f+c.f,l:u,r:c,d:void 0};let m=P(r[d-1],0);m>n&&(!function(t,e,n){let r=0,o=0;const i=1<<n-e;for(t.sort(function(t,e){return e.d===t.d?t.f-e.f:e.d-t.d}),r=0;r<t.length&&t[r].d>e;r++){const s=t[r].d;t[r].d=e,o+=i-(1<<n-s)}o>>>=n-e;for(;o>0;){const n=t[r].d;n<e?(t[r].d++,o-=1<<e-n-1):r++}for(;r>=0;r--)t[r].d===e&&o<0&&(t[r].d--,o++);0!==o&&console.log("debt left")}(a,n,m),m=n);for(let h=0;h<s;h++)e[1+(a[h].lit<<1)]=a[h].d;return m}function P(t,e){return-1!==t.lit?(t.d=e,e):Math.max(P(t.l,e+1),P(t.r,e+1))}function D(t,e){const{data:n,dlen:r,out:o,opt:i}=t;let{i:s,pos:a,cvrd:u,li:c,lc:l,bs:d,ebits:f,c:m,nc:p}=t;const{lits:g,strt:y,prev:_}=h,A=Math.min(s+e,r);for(;s<A;s++){if(m=p,s+1<r-2){p=T(n,s+1);const t=s+1&32767;_[t]=y[p],y[p]=t}if(u<=s){(c>14e3||l>26697)&&r-s>100&&(u<s&&(g[c]=s-u,c+=2,u=s),a=R(s===r-1||u===r?1:0,g,c,f,n,d,s-d,o,a),c=l=f=0,d=s);let t=0;if(s<r-2&&(t=E(n,s,_,m,Math.min(i[2],r-s),i[3])),0!==t){const e=t>>>16,n=65535&t,r=G(e,h.of0);h.lhst[257+r]++;const o=G(n,h.df0);h.dhst[o]++,f+=h.exb[r]+h.dxb[o],g[c]=e<<23|s-u,g[c+1]=n<<16|r<<8|o,c+=2,u=s+e}else h.lhst[n[s]]++;l++}}t.i=s,t.pos=a,t.cvrd=u,t.li=c,t.lc=l,t.bs=d,t.ebits=f,t.c=m,t.nc=p}const M=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]];async function N(t,e,n,r,o){if(m("deflate-raw")){const o=new CompressionStream("deflate-raw"),i=new Blob([e]).stream().pipeThrough(o).getReader();let s=r;const a=async()=>{const{done:e,value:r}=await i.read();if(!e)return t.shouldUpdate&&await t.update({message:"Deflating...",current:s,max:n.length}),n.set(r,s),s+=r.length,a()};return await a(),s}const i=function(t,e,n,r){const{lits:o,strt:i,prev:s}=h;return{data:t,out:e,opt:M[r],i:0,pos:n<<3,cvrd:0,dlen:t.length,li:0,lc:0,bs:0,ebits:0,c:0,nc:0,lits:o,strt:i,prev:s}}(e,n,r,o),{dlen:s}=i;if(0===o){let{i:t,pos:r}=i;for(;t<s;){const o=Math.min(65535,s-t);V(n,r,t+o===s?1:0),r=U(e,t,o,n,r+8),t+=o}return r>>>3}for(s>2&&(i.nc=T(e,0),i.strt[i.nc]=0);i.i<s;)t.shouldUpdate&&await t.update({message:"Deflating...",current:i.i,max:s}),D(i,1048576);let{li:a,cvrd:u,pos:c}=i;const{i:l,lits:d,bs:f,ebits:p}=i;for(f===l&&0!==e.length||(u<l&&(d[a]=l-u,a+=2,u=l),c=R(1,d,a,p,e,f,l-f,n,c));7&c;)c++;return c>>>3}function E(t,e,n,r,o,i){let s=32767&e,a=n[s],u=s-a+32768&32767;if(a===s||r!==T(t,e-u))return 0;let c=0,l=0;const d=Math.min(32767,e);for(;u<=d&&0!==--i&&a!==s;){if(0===c||t[e+c]===t[e+c-u]){let r=k(t,e,u);if(r>c){if(c=r,l=u,c>=o)break;u+2<r&&(r=u+2);let t=0;for(let o=0;o<r-2;o++){const r=e-u+o+32768&32767,i=r-n[r]+32768&32767;i>t&&(t=i,a=r)}}}s=a,a=n[s],u+=s-a+32768&32767}return c<<16|l}function k(t,e,n){if(t[e]!==t[e-n]||t[e+1]!==t[e+1-n]||t[e+2]!==t[e+2-n])return 0;const r=e,o=Math.min(t.length,e+258);for(e+=3;e<o&&t[e]===t[e-n];)e++;return e-r}function T(t,e){return(t[e]<<8|t[e+1])+(t[e+2]<<4)&65535}function R(t,e,n,r,o,i,s,a,u){h.lhst[256]++;const[c,l,d,f,m,p,_,A]=function(){const t=w(h.lhst,h.ltree,15),e=w(h.dhst,h.dtree,15),n=[],r=F(h.ltree,n),o=[],i=F(h.dtree,o);for(let u=0;u<n.length;u+=2)h.ihst[n[u]]++;for(let u=0;u<o.length;u+=2)h.ihst[o[u]]++;const s=w(h.ihst,h.itree,7);let a=19;for(;a>4&&0===h.itree[1+(h.ordr[a-1]<<1)];)a--;return[t,e,s,r,i,a,n,o]}(),b=32+(u+3&7?8-(u+3&7):0)+(s<<3),C=r+H(h.fltree,h.lhst)+H(h.fdtree,h.dhst);let S=r+H(h.ltree,h.lhst)+H(h.dtree,h.dhst);S+=14+3*p+H(h.itree,h.ihst)+(2*h.ihst[16]+3*h.ihst[17]+7*h.ihst[18]);for(let g=0;g<286;g++)h.lhst[g]=0;for(let g=0;g<30;g++)h.dhst[g]=0;for(let g=0;g<19;g++)h.ihst[g]=0;const x=b<C&&b<S?0:C<S?1:2;if(Z(a,u,t),Z(a,u+1,x),u+=3,0===x){for(;7&u;)u++;u=U(o,i,s,a,u)}else{let t,r;if(1===x)t=h.fltree,r=h.fdtree;else if(2===x){g(h.ltree,c),y(h.ltree,c),g(h.dtree,l),y(h.dtree,l),g(h.itree,d),y(h.itree,d),t=h.ltree,r=h.dtree,V(a,u,f-257),V(a,u+=5,m-1),V(a,u+=5,p-4),u+=4;for(let t=0;t<p;t++)V(a,u+3*t,h.itree[1+(h.ordr[t]<<1)]);u+=3*p,u=O(_,h.itree,a,u),u=O(A,h.itree,a,u)}else(0,I.dr)(x);let s=i;for(let i=0;i<n;i+=2){const n=e[i],c=n>>>23,l=s+(8388607&n);for(;s<l;)u=L(o[s++],t,a,u);if(0!==c){const n=e[i+1],o=n>>16,l=n>>8&255,d=255&n;V(a,u=L(257+l,t,a,u),c-h.of0[l]),Z(a,u=L(d,r,a,u+=h.exb[l]),o-h.df0[d]),u+=h.dxb[d],s+=c}}u=L(256,t,a,u)}return u}function U(t,e,n,r,o){let i=o>>>3;return r[i]=n,r[i+1]=n>>>8,r[i+2]=255-r[i],r[i+3]=255-r[i+1],i+=4,r.set(new Uint8Array(t.buffer,e,n),i),o+(n+4<<3)}function H(t,e){let n=0;for(let r=0;r<e.length;r++)n+=e[r]*t[1+(r<<1)];return n}function O(t,e,n,r){for(let o=0;o<t.length;o+=2){const i=t[o],s=t[o+1];r=L(i,e,n,r);const a=16===i?2:17===i?3:7;i>15&&(V(n,r,s),r+=a)}return r}function F(t,e){let n=t.length;for(;2!==n&&0===t[n-1];)n-=2;for(let r=0;r<n;r+=2){const o=t[r+1],i=r+3<n?t[r+3]:-1,s=r+5<n?t[r+5]:-1,a=0===r?-1:t[r-1];if(0===o&&i===o&&s===o){let i=r+5;for(;i+2<n&&t[i+2]===o;)i+=2;const s=Math.min(i+1-r>>>1,138);s<11?e.push(17,s-3):e.push(18,s-11),r+=2*s-2}else if(o===a&&i===o&&s===o){let i=r+5;for(;i+2<n&&t[i+2]===o;)i+=2;const s=Math.min(i+1-r>>>1,6);e.push(16,s-3),r+=2*s-2}else e.push(o,0)}return n>>>1}function G(t,e){let n=0;return e[16|n]<=t&&(n|=16),e[8|n]<=t&&(n|=8),e[4|n]<=t&&(n|=4),e[2|n]<=t&&(n|=2),e[1|n]<=t&&(n|=1),n}function L(t,e,n,r){return Z(n,r,e[t<<1]),r+e[1+(t<<1)]}function V(t,e,n){n<<=7&e;const r=e>>>3;t[r]|=n,t[r+1]|=n>>>8}function Z(t,e,n){n<<=7&e;const r=e>>>3;t[r]|=n,t[r+1]|=n>>>8,t[r+2]|=n>>>16}var q=n(24832);async function K(t,e,n=!1){const o=Object.create(null),s=new Uint8Array(e);if(19280!==r(s,0))throw new Error('Invalid ZIP file. A valid ZIP file must start with two magic bytes \\x50\\x4b ("PK" in ASCII).');let a=s.length-4;for(;101010256!==i(s,a);)a--;let u=a;u+=4,u+=4;const c=r(s,u);u+=2,u+=2,u+=4;const l=i(s,u);u+=4,u=l;for(let d=0;d<c;d++){u+=4,u+=4,u+=4,u+=4,u+=4,u+=4,u+=4;const e=r(s,u),a=r(s,u+2),c=r(s,u+4);u+=6,u+=8;const l=i(s,u);u+=4,u+=e+a+c,await X(t,s,l,o,n)}return o}async function X(t,e,n,o,s){n+=4,n+=2;const a=r(e,n+=2);n+=2,n+=4;const c=i(e,n+=4),l=i(e,n+=4),d=r(e,n+=4),f=r(e,n+=2),m=u(e,n+=2,d);if(n+=d,n+=f,s)return void(o[m]={size:l,csize:c});const h=new Uint8Array(e.buffer,n,c);if(0===a)o[m]=h;else{if(8!==a)throw new Error(`unknown compression method: ${a}`);{const e=new Uint8Array(l);await Y(t,h,e),o[m]=e}}}async function Y(t,e,n){return A(t,e,n)}async function z(t,e,n){const o=e[3];let s=10;if(4&o){s+=r(e,s)}if(8&o){let t=s;for(;0!==e[t];)++t;s=t+1}if(16&o){let t=s;for(;0!==e[t];)++t;s=t+1}1&o&&(s+=2);const a=0|i(e,e.length-8);const u=i(e,e.length-4);void 0===n&&(n=new Uint8Array(u));const c=new Uint8Array(e.buffer,e.byteOffset+s,e.length-s-8),l=await Y(t,c,n);return a!==d(l,0,l.length)&&console.error("ungzip: checksums don't match"),l}async function $(t,e,n){void 0===n&&(n={level:6});const r=new Uint8Array(50+Math.floor(1.1*e.length)),o=await N(t,e,r,0,n.level);return new Uint8Array(r.buffer,0,o)}function W(t,e=!1){return q.YZ.create("Zip",n=>async function(t,e,n=!1){let r=0;const i={};for(const o in e){const r=!Q(o)&&!n,s=e[o],a=d(s,0,s.length);i[o]={cpr:r,usize:s.length,crc:a,file:r?await $(t,s):s}}for(const o in i)r+=i[o].file.length+30+46+2*c(o);r+=22;const a=new Uint8Array(r);let u=0;const l=[];for(const o in i){const t=i[o];l.push(u),u=j(a,u,o,t,0)}let f=0;const m=u;for(const o in i){const t=i[o];l.push(u),u=j(a,u,o,t,1,l[f++])}const h=u-m;return s(a,u,101010256),u+=4,u+=4,o(a,u,f),u+=2,o(a,u,f),u+=2,s(a,u,h),u+=4,s(a,u,m),u+=4,u+=2,a.buffer}(n,t,e))}function Q(t){const e=t.split(".").pop().toLowerCase();return-1!=="png,jpg,jpeg,zip".indexOf(e)}function j(t,e,n,r,i,a=0){const u=r.file;s(t,e,0===i?67324752:33639248),e+=4,1===i&&(e+=2),o(t,e,20),o(t,e+=2,0),o(t,e+=2,r.cpr?8:0),s(t,e+=2,0),s(t,e+=4,r.crc),s(t,e+=4,u.length),s(t,e+=4,r.usize),o(t,e+=4,c(n)),o(t,e+=2,0),e+=2,1===i&&(e+=2,e+=2,s(t,e+=6,a),e+=4);const l=function(t,e,n){const r=n.length;let o=0;for(let i=0;i<r;i++){const r=n.charCodeAt(i);if(4294967168&r)if(4294965248&r)if(4294901760&r){if(4292870144&r)throw new Error("e");t[e+o]=240|r>>18,t[e+o+1]=128|r>>12&63,t[e+o+2]=128|r>>6&63,t[e+o+3]=128|63&r,o+=4}else t[e+o]=224|r>>12,t[e+o+1]=128|r>>6&63,t[e+o+2]=128|63&r,o+=3;else t[e+o]=192|r>>6,t[e+o+1]=128|63&r,o+=2;else t[e+o]=r,o++}return o}(t,e,n);return e+=l,0===i&&(t.set(u,e),e+=u.length),e}},41054:function(t,e,n){n.d(e,{h:function(){return i}});class r{constructor(t,e){this.parent=null,this.child=null,this.degree=0,this.isMarked=!1,this.key=t,this.value=e,this.prev=this,this.next=this}}const o=new class{constructor(t){if(this._index=-1,this._items=[],this._len=0,t){let e=t,n=0;do{this._items[n++]=e,e=e.next}while(t!==e);this._len=n}}hasNext(){return this._index<this._len-1}next(){return this._items[++this._index]}reset(t){this._index=-1,this._len=0;let e=t,n=0;do{this._items[n++]=e,e=e.next}while(t!==e);this._len=n}};class i{constructor(t){this._minNode=null,this._nodeCount=0,this._compare=t||this._defaultCompare}clear(){this._minNode=null,this._nodeCount=0}decreaseKey(t,e){if(!t)throw new Error("Cannot decrease key of non-existent node");if(this._compare({key:e},{key:t.key})>0)throw new Error("New key is larger than old key");t.key=e;const n=t.parent;n&&this._compare(t,n)<0&&(this._cut(t,n,this._minNode),this._cascadingCut(n,this._minNode)),this._compare(t,this._minNode)<0&&(this._minNode=t)}delete(t){const e=t.parent;e&&(this._cut(t,e,this._minNode),this._cascadingCut(e,this._minNode)),this._minNode=t,this.extractMinimum()}extractMinimum(){const t=this._minNode;if(t){if(t.child){let e=t.child;do{e.parent=null,e=e.next}while(e!==t.child)}let e=null;t.next!==t&&(e=t.next),this._removeNodeFromList(t),this._nodeCount--,this._minNode=this._mergeLists(e,t.child),this._minNode&&(this._minNode=this._consolidate(this._minNode))}return t}findMinimum(){return this._minNode}insert(t,e){const n=new r(t,e);return this._minNode=this._mergeLists(this._minNode,n),this._nodeCount++,n}isEmpty(){return null===this._minNode}size(){return null===this._minNode?0:this._getNodeListSize(this._minNode)}union(t){this._minNode=this._mergeLists(this._minNode,t._minNode),this._nodeCount+=t._nodeCount}_defaultCompare(t,e){return t.key>e.key?1:t.key<e.key?-1:0}_cut(t,e,n){t.parent=null,e.degree--,t.next===t?e.child=null:e.child=t.next,this._removeNodeFromList(t);const r=this._mergeLists(n,t);return t.isMarked=!1,r}_cascadingCut(t,e){const n=t.parent;return n&&(t.isMarked?(e=this._cut(t,n,e),e=this._cascadingCut(n,e)):t.isMarked=!0),e}_consolidate(t){const e=[];for(o.reset(t);o.hasNext();){let t=o.next(),n=e[t.degree];for(;n;){if(this._compare(t,n)>0){const e=t;t=n,n=e}this._linkHeaps(n,t),e[t.degree]=null,t.degree++,n=e[t.degree]}e[t.degree]=t}let n=null;for(let r=0;r<e.length;r++){const t=e[r];t&&(t.next=t,t.prev=t,n=this._mergeLists(n,t))}return n}_removeNodeFromList(t){const e=t.prev,n=t.next;e.next=n,n.prev=e,t.next=t,t.prev=t}_linkHeaps(t,e){this._removeNodeFromList(t),e.child=this._mergeLists(t,e.child),t.parent=e,t.isMarked=!1}_mergeLists(t,e){if(!t)return e||null;if(!e)return t;const n=t.next;return t.next=e.next,t.next.prev=t,e.next=n,e.next.prev=e,this._compare(t,e)<0?t:e}_getNodeListSize(t){let e=0,n=t;do{e++,n.child&&(e+=this._getNodeListSize(n.child)),n=n.next}while(n!==t);return e}}},41430:function(t,e,n){function r(t,e,n){return(t-e)/(n-e)}function o(t,e,n){return Math.max(e,Math.min(n,t))}function i(t){return o(t,0,1)}function s(t,e,n){return t+(e-t)*n}function a(t,e,n,r,o,i){const s=(n-t)*i,a=(r-e)*i,u=o*o;return(2*e-2*n+s+a)*(o*u)+(-3*e+3*n-2*s-a)*u+s*o+e}function u(t,e,n,r){const o=1-r;return o*o*t+2*o*r*e+r*r*n}function c(t,e,n){return(n=i(r(n,t,e)))*n*(3-2*n)}n.d(e,{Cc:function(){return s},S8:function(){return r},TF:function(){return c},Y7:function(){return a},iD:function(){return u},qE:function(){return o}})},42966:function(t,e,n){n.d(e,{U:function(){return o}});var r=n(98537);function o(){return o.create(r.e.create(0,0,0),r.e.create(1,0,0))}!function(t){function e(t,e){return r.e.copy(t.origin,e.origin),r.e.copy(t.direction,e.direction),t}t.create=function(t,e){return{origin:t,direction:e}},t.copy=e,t.clone=function(n){return e(t(),n)},t.targetTo=function(t,e,n){return r.e.copy(t.origin,e.origin),r.e.normalize(t.direction,r.e.sub(t.direction,n,e.origin)),t},t.transform=function(t,e,n){return r.e.transformMat4(t.origin,e.origin,n),r.e.transformDirection(t.direction,e.direction,n),t};const n=(0,r.e)();function o(t,e){const{center:o,radius:i}=e,{origin:s,direction:a}=t,u=r.e.sub(n,s,o),c=r.e.dot(a,a),l=2*r.e.dot(u,a),d=l*l-4*c*(r.e.dot(u,u)-i*i);if(d<0)return-1;const f=(-l-Math.sqrt(d))/(2*c);return f<0?-1:f}function i(t,e){const{origin:n,direction:r}=t,[o,i,s]=e.min,[a,u,c]=e.max,[l,d,f]=n,m=1/r[0],h=1/r[1],p=1/r[2];let g,y,_,A,b,C;return m>=0?(g=(o-l)*m,y=(a-l)*m):(g=(a-l)*m,y=(o-l)*m),h>=0?(_=(i-d)*h,A=(u-d)*h):(_=(u-d)*h,A=(i-d)*h),g>A||_>y?-1:(_>g&&(g=_),A<y&&(y=A),p>=0?(b=(s-f)*p,C=(c-f)*p):(b=(c-f)*p,C=(s-f)*p),g>C||b>y?-1:(b>g&&(g=b),C<y&&(y=C),g>=0?g:-1))}t.intersectSphere3D=function(t,e,n){const i=o(e,n);return!(i<0)&&(r.e.scaleAndAdd(t,e.origin,e.direction,i),!0)},t.isIntersectingSphere3D=function(t,e){return o(t,e)>=0},t.isInsideSphere3D=function(t,e){return r.e.distance(t.origin,e.center)<e.radius},t.intersectBox3D=function(t,e,n){const o=i(e,n);return!(o<0)&&(r.e.scaleAndAdd(t,e.origin,e.direction,o),!0)},t.isIntersectingBox3D=function(t,e){return i(t,e)>=0}}(o||(o={}))},44478:function(t,e,n){n.d(e,{N:function(){return h}});var r=n(27125),o=n(52500),i=n(24303),s=n(84796),a=n(92570);const u=[new Set(["CA"]),new Set(["C"]),new Set(["N"])],c=[new Set(["P","O3'","O3*"]),new Set(["C4'","C4*"]),new Set(["O2'","O2*","F2'","F2*"])],l=[new Set(["P","O3'","O3*"]),new Set(["C3'","C3*"]),new Set(["O2'","O2*","F2'","F2*"])],d=new Set(["FMN","NCN","FNS","FMA","ATP","ADP","AMP","GTP","GDP","GMP","LIG"]),f=function(){const t=new Map;return[{id:"HIS",name:"HISTIDINE",type:"l-peptide linking"},{id:"ARG",name:"ARGININE",type:"l-peptide linking"},{id:"LYS",name:"LYSINE",type:"l-peptide linking"},{id:"ILE",name:"ISOLEUCINE",type:"l-peptide linking"},{id:"PHE",name:"PHENYLALANINE",type:"l-peptide linking"},{id:"LEU",name:"LEUCINE",type:"l-peptide linking"},{id:"TRP",name:"TRYPTOPHAN",type:"l-peptide linking"},{id:"ALA",name:"ALANINE",type:"l-peptide linking"},{id:"MET",name:"METHIONINE",type:"l-peptide linking"},{id:"CYS",name:"CYSTEINE",type:"l-peptide linking"},{id:"ASN",name:"ASPARAGINE",type:"l-peptide linking"},{id:"VAL",name:"VALINE",type:"l-peptide linking"},{id:"GLY",name:"GLYCINE",type:"peptide linking"},{id:"SER",name:"SERINE",type:"l-peptide linking"},{id:"GLN",name:"GLUTAMINE",type:"l-peptide linking"},{id:"TYR",name:"TYROSINE",type:"l-peptide linking"},{id:"ASP",name:"ASPARTIC ACID",type:"l-peptide linking"},{id:"GLU",name:"GLUTAMIC ACID",type:"l-peptide linking"},{id:"THR",name:"THREONINE",type:"l-peptide linking"},{id:"PRO",name:"PROLINE",type:"l-peptide linking"},{id:"SEC",name:"SELENOCYSTEINE",type:"l-peptide linking"},{id:"PYL",name:"PYRROLYSINE",type:"l-peptide linking"},{id:"MSE",name:"SELENOMETHIONINE",type:"l-peptide linking"},{id:"SEP",name:"PHOSPHOSERINE",type:"l-peptide linking"},{id:"TPO",name:"PHOSPHOTHREONINE",type:"l-peptide linking"},{id:"PTR",name:"O-PHOSPHOTYROSINE",type:"l-peptide linking"},{id:"PCA",name:"PYROGLUTAMIC ACID",type:"l-peptide linking"},{id:"A",name:"ADENOSINE-5'-MONOPHOSPHATE",type:"rna linking"},{id:"C",name:"CYTIDINE-5'-MONOPHOSPHATE",type:"rna linking"},{id:"T",name:"THYMIDINE-5'-MONOPHOSPHATE",type:"rna linking"},{id:"G",name:"GUANOSINE-5'-MONOPHOSPHATE",type:"rna linking"},{id:"I",name:"INOSINIC ACID",type:"rna linking"},{id:"U",name:"URIDINE-5'-MONOPHOSPHATE",type:"rna linking"},{id:"DA",name:"2'-DEOXYADENOSINE-5'-MONOPHOSPHATE",type:"dna linking"},{id:"DC",name:"2'-DEOXYCYTIDINE-5'-MONOPHOSPHATE",type:"dna linking"},{id:"DT",name:"THYMIDINE-5'-MONOPHOSPHATE",type:"dna linking"},{id:"DG",name:"2'-DEOXYGUANOSINE-5'-MONOPHOSPHATE",type:"dna linking"},{id:"DI",name:"2'-DEOXYINOSINE-5'-MONOPHOSPHATE",type:"dna linking"},{id:"DU",name:"2'-DEOXYURIDINE-5'-MONOPHOSPHATE",type:"dna linking"}].forEach(e=>t.set(e.id,e)),t}(),m=function(){const t=new Map;return[{id:"ZN2",name:"ZINC ION",type:"ion"},{id:"SOD",name:"SODIUM ION",type:"ion"},{id:"CES",name:"CESIUM ION",type:"ion"},{id:"CLA",name:"CHLORIDE ION",type:"ion"},{id:"CAL",name:"CALCIUM ION",type:"ion"},{id:"POT",name:"POTASSIUM ION",type:"ion"}].forEach(e=>t.set(e.id,e)),t}();class h{set(t){this.comps.set(t.id,t),this.ids.push(t.id),this.names.push(t.name),this.types.push(t.type),this.mon_nstd_flags.push(o.px.has(t.id)?"y":"n")}getAtomIds(t){const e=new Set,n=this.seqId.value(t);for(;t<this.seqId.rowCount;){const r=this.seqId.value(t);if(r!==n)break;e.add(this.atomId.value(t)),t+=1}return e}hasAtomIds(t,e){for(let n=0,r=e.length;n<r;++n)if(!i.M.areIntersecting(t,e[n]))return!1;return!0}getType(t){return this.hasAtomIds(t,u)?"peptide linking":this.hasAtomIds(t,c)?"rna linking":this.hasAtomIds(t,l)?"dna linking":"other"}has(t){return this.comps.has(t)}get(t){return this.comps.get(t)}add(t,e){if(!this.has(t))if(f.has(t))this.set(f.get(t));else if(o.mw.has(t))this.set({id:t,name:"WATER",type:"non-polymer"});else if(d.has(t.toUpperCase()))this.set({id:t,name:this.namesMap.get(t)||t,type:"non-polymer"});else if(a.yt.has(t.toUpperCase()))this.set({id:t,name:this.namesMap.get(t)||t,type:"saccharide"});else{const n=this.getAtomIds(e);if(1===n.size&&m.has(t))this.set(m.get(t));else{const e=this.getType(n);this.set({id:t,name:this.namesMap.get(t)||t,type:e})}}return this.get(t)}getChemCompTable(){return r.XI.ofPartialColumns(s.e.chem_comp,{id:r.VP.ofStringArray(this.ids),name:r.VP.ofStringArray(this.names),type:r.VP.ofStringAliasArray(this.types),mon_nstd_flag:r.VP.ofStringAliasArray(this.mon_nstd_flags)},this.ids.length)}setNames(t){t.forEach(t=>this.namesMap.set(t[0],t[1]))}constructor(t,e){this.seqId=t,this.atomId=e,this.namesMap=new Map,this.comps=new Map,this.ids=[],this.names=[],this.types=[],this.mon_nstd_flags=[]}}},45010:function(t,e,n){n.d(e,{I8:function(){return l},Or:function(){return r}});var r,o=n(68223),i=n(62683),s=n(82346);function a(t,e){return(0,s.HR)(i.d3.Dictionary({0:(0,i.ef)(t)}),t,e)}function u(t,e){return(0,s.HR)(i.d3.List(t,{nonEmpty:!0}),t,e)}function c(t,e,n){return(0,s.HR)(i.d3.Dictionary({0:(0,i.ef)(t),1:(0,i.ef)(t)}),e,n)}!function(t){t.AnyVar=o.Z.Variable("a",o.Z.Any),t.AnyValueVar=o.Z.Variable("a",o.Z.Any),t.ConstrainedVar=o.Z.Variable("a",o.Z.Any,!0),t.Regex=o.Z.Value("Core","Regex"),t.Set=e=>o.Z.Container("Core","Set",e||t.AnyValueVar),t.List=e=>o.Z.Container("Core","List",e||t.AnyVar),t.Fn=(e,n)=>o.Z.Container("Core","Fn",e||t.AnyVar,n),t.Flags=(t,e)=>o.Z.Container("Core","Flags",t,e),t.BitFlags=t.Flags(o.Z.Num,"BitFlags")}(r||(r={}));i.d3.Dictionary({0:(0,i.ef)(o.Z.Num),1:(0,i.ef)(o.Z.Num)});const l={"@header":"Language Primitives",type:{"@header":"Types",bool:(0,s.HR)(i.d3.Dictionary({0:(0,i.ef)(o.Z.AnyValue)}),o.Z.Bool,"Convert a value to boolean."),num:(0,s.HR)(i.d3.Dictionary({0:(0,i.ef)(o.Z.AnyValue)}),o.Z.Num,"Convert a value to number."),str:(0,s.HR)(i.d3.Dictionary({0:(0,i.ef)(o.Z.AnyValue)}),o.Z.Str,"Convert a value to string."),regex:(0,s.HR)(i.d3.Dictionary({0:(0,i.ef)(o.Z.Str,{description:"Expression"}),1:(0,i.ef)(o.Z.Str,{isOptional:!0,description:"Flags, e.g. 'i' for ignore case"})}),r.Regex,"Creates a regular expression from a string using the ECMAscript syntax."),list:(0,s.HR)(i.d3.List(r.AnyVar),r.List()),set:(0,s.HR)(i.d3.List(r.AnyValueVar),r.Set()),bitflags:(0,s.HR)(i.d3.Dictionary({0:(0,i.ef)(o.Z.Num)}),r.BitFlags,"Interpret a number as bitflags."),compositeKey:(0,s.HR)(i.d3.List(o.Z.AnyValue),o.Z.AnyValue)},logic:{"@header":"Logic",not:a(o.Z.Bool),and:u(o.Z.Bool),or:u(o.Z.Bool)},ctrl:{"@header":"Control",eval:(0,s.HR)(i.d3.Dictionary({0:(0,i.ef)(r.Fn(r.AnyVar))}),r.AnyVar,"Evaluate a function."),fn:(0,s.HR)(i.d3.Dictionary({0:(0,i.ef)(r.AnyVar)}),r.Fn(r.AnyVar),'Wrap an expression to a "lazy" function.'),if:(0,s.HR)(i.d3.Dictionary({0:(0,i.ef)(o.Z.Bool,{description:"Condition"}),1:(0,i.ef)(o.Z.Variable("a",o.Z.Any),{description:"If true"}),2:(0,i.ef)(o.Z.Variable("b",o.Z.Any),{description:"If false"})}),o.Z.Union([o.Z.Variable("a",o.Z.Any),o.Z.Variable("b",o.Z.Any)])),assoc:(0,s.HR)(i.d3.Dictionary({0:(0,i.ef)(o.Z.Str,{description:"Name"}),1:(0,i.ef)(o.Z.Variable("a",o.Z.Any),{description:"Value to assign"})}),o.Z.Variable("a",o.Z.Any))},rel:{"@header":"Relational",eq:c(o.Z.Variable("a",o.Z.AnyValue,!0),o.Z.Bool),neq:c(o.Z.Variable("a",o.Z.AnyValue,!0),o.Z.Bool),lt:c(o.Z.Num,o.Z.Bool),lte:c(o.Z.Num,o.Z.Bool),gr:c(o.Z.Num,o.Z.Bool),gre:c(o.Z.Num,o.Z.Bool),inRange:(0,s.HR)(i.d3.Dictionary({0:(0,i.ef)(o.Z.Num,{description:"Value to test"}),1:(0,i.ef)(o.Z.Num,{description:"Minimum value"}),2:(0,i.ef)(o.Z.Num,{description:"Maximum value"})}),o.Z.Bool,"Check if the value of the 1st argument is >= 2nd and <= 3rd.")},math:{"@header":"Math",add:u(o.Z.Num),sub:u(o.Z.Num),mult:u(o.Z.Num),div:c(o.Z.Num,o.Z.Num),pow:c(o.Z.Num,o.Z.Num),mod:c(o.Z.Num,o.Z.Num),min:u(o.Z.Num),max:u(o.Z.Num),cantorPairing:c(o.Z.Num,o.Z.Num),sortedCantorPairing:c(o.Z.Num,o.Z.Num),invertCantorPairing:(0,s.HR)(i.d3.Dictionary({0:(0,i.ef)(o.Z.Num)}),r.List(o.Z.Num)),floor:a(o.Z.Num),ceil:a(o.Z.Num),roundInt:a(o.Z.Num),trunc:a(o.Z.Num),abs:a(o.Z.Num),sign:a(o.Z.Num),sqrt:a(o.Z.Num),cbrt:a(o.Z.Num),sin:a(o.Z.Num),cos:a(o.Z.Num),tan:a(o.Z.Num),asin:a(o.Z.Num),acos:a(o.Z.Num),atan:a(o.Z.Num),sinh:a(o.Z.Num),cosh:a(o.Z.Num),tanh:a(o.Z.Num),exp:a(o.Z.Num),log:a(o.Z.Num),log10:a(o.Z.Num),atan2:c(o.Z.Num,o.Z.Num)},str:{"@header":"Strings",concat:u(o.Z.Str),match:(0,s.HR)(i.d3.Dictionary({0:(0,i.ef)(r.Regex),1:(0,i.ef)(o.Z.Str)}),o.Z.Bool)},list:{"@header":"Lists",getAt:(0,s.HR)(i.d3.Dictionary({0:(0,i.ef)(r.List()),1:(0,i.ef)(o.Z.Num)}),r.AnyVar),equal:(0,s.HR)(i.d3.Dictionary({0:(0,i.ef)(r.List()),1:(0,i.ef)(r.List())}),o.Z.Bool)},set:{"@header":"Sets",has:(0,s.HR)(i.d3.Dictionary({0:(0,i.ef)(r.Set(r.ConstrainedVar)),1:(0,i.ef)(r.ConstrainedVar)}),o.Z.Bool,"Check if the the 1st argument includes the value of the 2nd."),isSubset:(0,s.HR)(i.d3.Dictionary({0:(0,i.ef)(r.Set(r.ConstrainedVar)),1:(0,i.ef)(r.Set(r.ConstrainedVar))}),o.Z.Bool,"Check if the the 1st argument is a subset of the 2nd.")},flags:{"@header":"Flags",hasAny:(0,s.HR)(i.d3.Dictionary({0:(0,i.ef)(r.Flags(r.ConstrainedVar)),1:(0,i.ef)(r.Flags(r.ConstrainedVar))}),o.Z.Bool,"Check if the the 1st argument has at least one of the 2nd one's flags."),hasAll:(0,s.HR)(i.d3.Dictionary({0:(0,i.ef)(r.Flags(r.ConstrainedVar)),1:(0,i.ef)(r.Flags(r.ConstrainedVar))}),o.Z.Bool,"Check if the the 1st argument has all 2nd one's flags.")}};(0,s.ec)(l);const d=(0,s.br)(l);!function(){const t=Object.create(null);for(const e of d)t[e.id]=e}()},46031:function(t,e,n){n.d(e,{n:function(){return A.n},DJ:function(){return o.D},Eh:function(){return y.E},Q7:function(){return g.Q},is:function(){return p},O8:function(){return h},f8:function(){return _.f},JX:function(){return s.J},oI:function(){return i}});var r=n(73868),o=n(60771);function i(t,e,n){const r=new Float32Array(t);for(let o=0;o<r.length;o++)r[o]=e+n*o;return r}var s=n(22463);const a=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[-1,0,0,0],[0,-1,0,0],[0,0,-1,0],[0,1,0,.5],[1,0,0,.5],[-1,0,0,.5],[0,0,1,.5],[0,-1,0,.5],[0,0,-1,.5],[1,0,0,.25],[0,-1,0,.25],[0,0,1,.25],[-1,0,0,.25],[0,1,0,.25],[0,-1,0,.75],[0,0,1,.75],[0,1,0,.75],[1,0,0,.75],[-1,0,0,.75],[0,0,-1,.25],[0,0,-1,.75],[1,-1,0,0],[-1,1,0,0],[0,0,1,1/3],[0,0,1,2/3],[1,0,0,2/3],[0,1,0,1/3],[0,-1,0,2/3],[1,-1,0,1/3],[-1,1,0,2/3],[-1,0,0,1/3],[1,0,0,1/3],[0,1,0,2/3],[0,-1,0,1/3],[1,-1,0,2/3],[-1,1,0,1/3],[-1,0,0,2/3],[0,0,-1,1/3],[0,0,-1,2/3],[0,0,1,5/6],[0,0,1,1/6],[0,0,-1,5/6],[0,0,-1,1/6]],u=[[0,1,2],[3,4,5],[3,1,5],[3,6,5],[7,6,2],[8,6,5],[0,4,2],[0,4,9],[7,10,2],[7,10,9],[0,10,2],[8,10,5],[3,1,11],[3,6,11],[0,10,9],[8,6,11],[3,4,2],[0,4,5],[3,4,9],[7,10,5],[8,4,9],[8,10,9],[8,10,2],[0,6,9],[3,10,9],[0,10,11],[7,1,9],[8,1,11],[7,4,11],[7,6,9],[7,10,11],[3,10,2],[8,1,5],[0,4,11],[3,1,2],[3,1,9],[7,4,2],[8,1,2],[8,1,9],[3,6,9],[7,4,9],[8,6,2],[8,6,9],[3,6,2],[12,13,14],[15,16,14],[12,17,18],[15,19,18],[20,13,18],[21,16,18],[20,17,14],[21,19,14],[0,1,5],[8,10,11],[7,6,11],[7,6,5],[8,4,2],[7,4,5],[7,1,5],[7,1,11],[0,10,5],[0,1,11],[0,6,11],[0,6,5],[3,10,11],[8,4,11],[15,13,22],[12,16,22],[15,17,23],[12,19,23],[21,13,23],[20,16,23],[21,17,22],[20,19,22],[4,0,2],[1,3,2],[4,0,14],[1,3,18],[4,0,9],[1,3,9],[4,0,18],[1,3,14],[10,7,9],[6,8,9],[4,7,14],[6,3,18],[10,0,18],[1,8,14],[1,3,5],[4,0,5],[6,8,11],[10,7,11],[1,3,11],[4,0,11],[10,7,2],[6,8,2],[3,10,22],[7,1,23],[8,4,23],[0,6,22],[1,0,5],[4,3,5],[1,0,23],[4,3,22],[10,7,14],[6,8,18],[8,6,22],[7,10,23],[4,3,11],[1,0,11],[1,0,22],[4,3,23],[10,7,18],[6,8,14],[8,6,23],[7,10,22],[6,7,11],[10,8,11],[8,1,23],[0,10,22],[3,6,22],[7,4,23],[4,3,2],[1,0,2],[10,8,2],[6,7,2],[4,3,9],[1,0,9],[10,8,9],[6,7,9],[4,8,14],[6,0,18],[10,3,18],[1,7,14],[4,8,18],[6,0,14],[10,3,14],[1,7,18],[6,7,5],[10,8,5],[6,8,5],[10,7,5],[8,1,22],[0,10,23],[3,6,23],[7,4,22],[4,24,2],[25,3,2],[4,24,26],[25,3,27],[4,24,27],[25,3,26],[28,29,26],[30,31,26],[32,33,26],[34,35,27],[36,37,27],[38,39,27],[2,0,1],[1,2,0],[1,25,5],[24,0,5],[39,36,40],[35,38,40],[37,34,40],[33,30,41],[29,32,41],[31,28,41],[5,3,4],[4,5,3],[25,1,5],[0,24,5],[24,4,5],[3,25,5],[4,3,41],[25,1,40],[24,4,41],[3,25,40],[4,3,40],[25,1,41],[24,4,40],[3,25,41],[35,34,40],[37,36,40],[39,38,40],[29,28,41],[31,30,41],[33,32,41],[3,5,4],[5,4,3],[25,1,2],[0,24,2],[24,4,2],[3,25,2],[25,1,9],[0,24,9],[24,4,9],[3,25,9],[30,33,26],[32,29,26],[28,31,26],[36,39,27],[38,35,27],[34,37,27],[0,2,1],[2,1,0],[30,33,42],[32,29,42],[28,31,42],[36,39,43],[38,35,43],[34,37,43],[7,9,6],[9,6,7],[25,1,11],[0,24,11],[24,4,11],[3,25,11],[35,34,44],[37,36,44],[39,38,44],[29,28,45],[31,30,45],[33,32,45],[8,11,10],[11,10,8],[1,25,2],[24,0,2],[1,25,42],[24,0,43],[1,25,43],[24,0,42],[1,25,27],[24,0,26],[1,25,26],[24,0,27],[1,25,9],[24,0,9],[4,24,5],[25,3,5],[4,24,11],[25,3,11],[1,0,40],[4,3,44],[0,24,45],[1,0,41],[4,3,45],[0,24,44],[0,24,40],[0,24,41],[2,3,4],[5,3,1],[5,0,4],[4,2,3],[1,5,3],[4,5,0],[2,7,6],[2,8,10],[5,8,6],[5,7,10],[1,9,7],[4,9,8],[1,11,8],[4,11,7],[9,0,6],[9,3,10],[11,3,6],[11,0,10],[6,2,7],[10,2,8],[6,5,8],[10,5,7],[9,7,1],[9,8,4],[11,8,1],[11,7,4],[6,9,0],[10,9,3],[6,11,3],[10,11,0],[9,7,6],[9,8,10],[11,8,6],[11,7,10],[6,9,7],[10,9,8],[6,11,8],[10,11,7],[2,3,10],[5,8,1],[11,0,4],[10,2,3],[1,5,8],[4,11,0],[5,0,1],[2,0,4],[2,3,1],[1,5,0],[4,2,0],[1,2,3],[11,8,10],[11,7,6],[9,7,10],[9,8,6],[10,11,8],[6,11,7],[10,9,7],[6,9,8],[5,8,10],[5,7,6],[2,7,10],[2,8,6],[4,11,8],[1,11,7],[4,9,7],[1,9,8],[11,3,10],[11,0,6],[9,0,10],[9,3,6],[10,5,8],[6,5,7],[10,2,7],[6,2,8],[11,8,4],[11,7,1],[9,7,4],[9,8,1],[10,11,3],[6,11,0],[10,9,0],[6,9,3],[22,15,13],[22,12,16],[14,12,13],[14,15,16],[13,22,15],[16,22,12],[13,14,12],[16,14,15],[22,21,17],[22,20,19],[14,20,17],[14,21,19],[13,23,21],[16,23,20],[13,18,20],[16,18,21],[23,15,17],[23,12,19],[18,12,17],[18,15,19],[17,22,21],[19,22,20],[17,14,20],[19,14,21],[23,21,13],[23,20,16],[18,20,13],[18,21,16],[17,23,15],[19,23,12],[17,18,12],[19,18,15],[5,0,6],[2,7,4],[9,3,1],[6,5,0],[4,2,7],[1,9,3],[0,2,4],[3,2,1],[0,5,1],[2,1,3],[2,4,0],[5,1,0],[7,9,10],[8,9,6],[7,11,6],[9,6,8],[9,10,7],[11,6,7],[1,7,11],[4,8,11],[1,8,9],[4,7,9],[0,9,10],[3,9,6],[3,11,10],[0,11,6],[2,6,8],[2,10,7],[5,6,7],[5,10,8],[6,0,11],[10,3,11],[6,3,9],[10,0,9],[7,2,10],[8,2,6],[8,5,10],[7,5,6],[9,1,8],[9,4,7],[11,1,7],[11,4,8],[7,9,4],[8,9,1],[8,11,4],[7,11,1],[9,6,3],[9,10,0],[11,6,0],[11,10,3],[19,12,23],[13,15,22],[16,21,18],[17,20,14],[20,14,17],[21,18,16],[15,22,13],[12,23,19],[18,16,21],[14,17,20],[23,19,12],[22,13,15],[19,20,22],[13,21,23],[16,15,14],[17,12,18],[20,18,13],[21,14,19],[15,23,17],[12,22,16],[18,19,15],[14,13,12],[23,16,20],[22,17,21],[16,12,22],[17,15,23],[19,21,14],[13,20,18],[12,14,13],[15,18,19],[21,22,17],[20,23,16],[14,16,15],[18,17,12],[22,19,20],[23,13,21],[16,20,23],[17,21,22],[19,15,18],[13,12,14],[12,18,17],[15,14,16],[21,23,13],[20,22,19],[14,19,21],[18,13,20],[22,16,12],[23,17,15],[19,12,22],[17,21,23],[16,15,18],[13,20,14],[20,14,13],[15,18,16],[21,23,17],[12,22,19],[18,16,15],[14,13,20],[22,19,12],[23,17,21],[3,2,4],[3,5,1],[0,5,4],[2,4,3],[5,1,3],[5,4,0],[1,7,9],[4,8,9],[1,8,11],[4,7,11],[0,9,6],[3,9,10],[3,11,6],[0,11,10],[2,6,7],[2,10,8],[5,6,8],[5,10,7],[6,0,9],[10,3,9],[6,3,11],[10,0,11],[7,2,6],[8,2,10],[8,5,6],[7,5,10],[9,1,7],[9,4,8],[11,1,8],[11,4,7],[7,9,1],[8,9,4],[8,11,1],[7,11,4],[9,6,0],[9,10,3],[11,6,3],[11,10,0],[8,9,10],[8,11,6],[7,11,10],[9,10,8],[11,6,8],[11,10,7],[6,0,2],[10,3,2],[6,3,5],[10,0,5],[7,2,1],[8,2,4],[8,5,1],[7,5,4],[9,1,0],[9,4,3],[11,1,3],[11,4,0],[1,7,2],[4,8,2],[1,8,5],[4,7,5],[0,9,1],[3,9,4],[3,11,1],[0,11,4],[2,6,0],[2,10,3],[5,6,3],[5,10,0],[0,2,6],[3,2,10],[3,5,6],[0,5,10],[2,1,7],[2,4,8],[5,1,8],[5,4,7],[16,12,14],[13,21,18],[19,15,23],[17,20,22],[12,14,16],[21,18,13],[15,23,19],[20,22,17],[14,16,12],[18,13,21],[23,19,15],[22,17,20],[19,20,18],[17,15,14],[16,21,22],[13,12,23],[20,18,19],[15,14,17],[21,22,16],[12,23,13],[18,19,20],[14,17,15],[22,16,21],[23,13,12],[6,0,5],[10,3,5],[6,3,2],[10,0,2],[7,2,4],[8,2,1],[8,5,4],[7,5,1],[9,1,3],[9,4,0],[11,1,0],[11,4,3],[1,7,5],[4,8,5],[1,8,2],[4,7,2],[0,9,4],[3,9,1],[3,11,4],[0,11,1],[2,6,3],[2,10,0],[5,6,0],[5,10,3],[0,2,10],[3,2,6],[3,5,10],[0,5,6],[2,1,8],[2,4,7],[5,1,7],[5,4,8],[21,17,23],[20,16,22],[12,13,18],[15,19,14],[23,21,17],[22,20,16],[18,12,13],[14,15,19],[17,23,21],[16,22,20],[13,18,12],[19,14,15],[21,13,22],[20,19,23],[12,17,14],[15,16,18],[23,15,13],[22,12,19],[18,20,17],[14,21,16],[17,22,15],[16,23,12],[13,14,20],[19,18,21],[15,17,22],[12,16,23],[20,13,14],[21,19,18],[22,21,13],[23,20,19],[14,12,17],[18,15,16],[13,23,15],[19,22,12],[17,18,20],[16,14,21],[15,13,23],[12,19,22],[20,17,18],[21,16,14],[22,15,17],[23,12,16],[14,20,13],[18,21,19],[13,22,21],[19,23,20],[17,14,12],[16,18,15],[6,5,3],[4,9,3],[9,3,4],[5,7,4],[4,5,7],[5,3,6]],c=[[0],[0,1],[0,2],[0,3],[0,2,4,5],[0,6],[0,7],[0,6,4,8],[0,7,4,9],[0,6,2,1],[0,3,1,10],[0,6,2,1,4,8,5,11],[0,12,1,7],[0,1,13,14],[0,12,1,7,4,15,11,9],[0,16,2,17],[0,18,12,17],[0,16,5,19],[0,20,13,19],[0,18,12,17,4,21,15,19],[0,16,2,17,4,22,5,19],[0,16,2,17,23,24,13,25,26,20,27,28,4,22,5,19],[0,16,17,2,29,21,30,15],[0,20,13,19,29,31,32,33],[0,16,6,34],[0,18,7,34],[0,16,7,35],[0,16,36,37],[0,18,36,38],[0,16,14,39],[0,20,40,34],[0,16,8,41],[0,18,8,42],[0,16,9,42],[0,16,6,34,4,22,8,41],[0,18,7,34,4,21,9,41],[0,16,7,35,4,22,9,42],[0,16,6,34,23,24,14,39],[0,16,10,43,23,24,7,35],[0,16,36,37,23,24,9,42],[0,16,8,41,23,24,40,38],[0,16,6,34,23,24,14,39,26,20,40,38,4,22,8,41],[0,16,44,45,23,24,46,47,26,20,48,49,4,22,50,51],[0,16,6,34,29,21,9,42],[0,16,8,41,29,21,7,35],[0,16,36,37,29,21,14,39],[0,16,2,17,1,52,6,34],[0,16,2,17,53,54,9,42],[0,16,12,33,1,52,7,35],[0,16,2,17,11,55,8,41],[0,56,2,57,1,58,6,37],[0,56,15,25,1,58,9,39],[0,20,27,17,1,59,40,34],[0,56,12,28,1,58,7,38],[0,16,5,19,1,52,8,41],[0,22,13,28,1,55,14,38],[0,18,13,60,1,61,14,43],[0,16,15,30,1,52,9,42],[0,16,5,19,11,55,6,34],[0,21,12,19,1,54,7,41],[0,20,13,19,1,59,14,41],[0,20,3,30,1,59,10,42],[0,18,12,17,1,61,7,34,4,21,15,19,11,54,9,41],[0,24,13,17,1,62,14,34,4,20,27,19,11,59,40,41],[0,16,2,17,1,52,6,34,4,22,5,19,11,55,8,41],[0,16,12,33,1,52,7,35,4,22,15,30,11,55,9,42],[0,31,3,17,1,63,10,34,4,56,32,19,11,58,36,41],[0,22,2,19,64,59,14,38,4,16,5,17,65,62,40,39],[0,16,2,17,1,52,6,34,23,24,13,25,64,62,14,39,26,20,27,28,65,59,40,38,4,22,5,19,11,55,8,41],[0,16,2,17,66,67,44,45,23,24,13,25,68,69,46,47,26,20,27,28,70,71,48,49,4,22,5,19,72,73,50,51],[0,16,2,17,1,52,6,34,29,21,15,30,53,54,9,42],[0,16,5,19,1,52,8,41,29,21,12,33,53,54,7,35],[0,20,13,19,1,59,14,41,29,31,32,33,53,63,36,35],[0,31,3,17,1,63,10,34,29,20,27,30,53,59,40,42],[0,16,74,75],[0,18,76,77],[0,16,78,79],[0,18,80,81],[0,16,74,75,29,21,82,83],[0,21,84,85,29,16,86,87],[0,16,88,89],[0,16,88,89,29,21,90,91],[0,16,74,75,1,52,88,89],[0,16,78,79,1,52,92,93],[0,16,94,95,11,55,88,89],[0,16,82,83,53,54,88,89],[0,16,74,75,1,52,88,89,29,21,82,83,53,54,90,91],[0,21,84,85,96,97,88,91,29,16,86,87,98,99,90,89],[0,16,74,75,2,17,100,101],[0,16,94,95,5,19,100,101],[0,18,76,77,2,33,102,103],[0,18,104,105,106,107,100,108],[0,16,78,79,2,17,109,108],[0,16,82,83,15,30,100,101],[0,18,80,81,2,33,110,111],[0,18,112,113,114,115,100,108],[0,16,74,75,2,17,100,101,29,21,82,83,15,30,116,117],[0,21,84,85,118,119,116,101,29,16,86,87,120,121,100,117],[0,16,74,75,6,34,122,123],[0,16,74,75,8,41,124,125],[0,16,78,79,7,35,122,123],[0,16,82,83,9,42,122,123],[0,16,74,75,7,35,126,127],[0,16,74,75,9,42,128,129],[0,16,78,79,6,34,126,127],[0,16,78,79,8,41,128,129],[0,16,74,75,6,34,122,123,29,21,82,83,9,42,128,129],[0,16,74,75,7,35,126,127,29,21,82,83,8,41,124,125],[0,21,84,85,6,42,130,131,29,16,86,87,9,34,132,133],[0,21,84,85,7,41,134,135,29,16,86,87,8,35,136,137],[0,16,89,88,2,17,122,123],[0,16,89,88,12,33,126,127],[0,16,89,88,5,19,124,125],[0,16,89,88,15,30,128,129],[0,16,88,89,6,34,100,101],[0,16,89,88,7,35,109,108],[0,16,89,88,8,41,138,139],[0,16,89,88,9,42,116,117],[0,16,89,88,6,34,100,101,29,21,91,90,9,42,116,117],[0,16,89,88,7,35,109,108,29,21,91,90,8,41,138,139],[0,16,89,88,2,17,122,123,29,21,91,90,15,30,128,129],[0,16,89,88,118,121,132,131,29,21,91,90,120,119,130,133],[0,16,74,75,2,17,100,101,1,52,88,89,6,34,122,123],[0,16,74,75,12,33,109,108,1,52,88,89,7,35,126,127],[0,16,74,75,2,17,100,101,11,55,140,141,8,41,124,125],[0,16,74,75,2,17,100,101,53,54,90,91,9,42,128,129],[0,16,74,75,5,19,138,139,1,52,88,89,8,41,124,125],[0,16,74,75,15,30,116,117,1,52,88,89,9,42,128,129],[0,16,94,95,5,19,100,101,11,55,88,89,6,34,124,125],[0,16,94,95,15,30,109,108,11,55,88,89,7,35,128,129],[0,16,78,79,2,17,109,108,1,52,92,93,6,34,126,127],[0,16,78,79,12,33,100,101,1,52,92,93,7,35,122,123],[0,16,82,83,12,33,138,139,53,54,88,89,8,41,126,127],[0,16,82,83,2,17,116,117,53,54,88,89,9,42,122,123],[0,16,78,79,5,19,116,117,1,52,92,93,8,41,128,129],[0,16,82,83,15,30,100,101,1,52,90,91,9,42,122,123],[0,16,82,83,15,30,100,101,53,54,88,89,6,34,128,129],[0,16,82,83,5,19,109,108,53,54,88,89,7,35,124,125],[0,16,74,75,2,17,100,101,1,52,88,89,6,34,122,123,29,21,82,83,15,30,116,117,53,54,90,91,9,42,128,129],[0,16,74,75,12,33,109,108,1,52,88,89,7,35,126,127,29,21,82,83,5,19,138,139,53,54,90,91,8,41,124,125],[0,21,84,85,118,119,116,101,96,97,88,91,9,34,132,133,29,16,86,87,120,121,100,117,98,99,90,89,6,42,130,131],[0,21,84,85,142,143,138,108,96,97,88,91,8,35,136,137,29,16,86,87,144,145,109,139,98,99,90,89,7,41,134,135],[0,146,147],[0,148,149],[0,150,151],[0,146,147,152,153,154,155,156,157],[0,158,159],[0,146,147,1,160,161],[0,146,147,1,160,161,152,153,154,162,163,164,155,156,157,165,166,167],[0,158,159,1,168,169],[0,146,147,101,170,171],[0,146,147,100,172,173],[0,148,149,174,175,171],[0,148,149,100,176,177],[0,150,151,178,179,171],[0,150,151,100,180,181],[0,146,147,100,172,173,152,153,154,182,183,184,155,156,157,185,186,187],[0,158,159,101,188,189],[0,146,147,122,190,191],[0,146,147,123,192,193],[0,146,147,126,194,195],[0,146,147,127,196,197],[0,146,147,122,190,191,152,153,154,198,199,200,155,156,157,201,202,203],[0,158,159,123,204,205],[0,146,147,126,194,195,152,153,154,206,207,208,155,156,157,209,210,211],[0,158,159,129,212,213],[0,146,147,101,170,171,1,160,161,123,192,193],[0,146,147,108,214,215,1,160,161,127,196,197],[0,146,147,100,172,173,1,160,161,122,190,191],[0,146,147,109,216,217,1,160,161,126,194,195],[0,146,147,100,172,173,1,160,161,122,190,191,152,153,154,182,183,184,162,163,164,198,199,200,155,156,157,185,186,187,165,166,167,201,202,203],[0,158,159,101,188,189,1,168,169,123,204,205],[0,146,147,109,216,217,1,160,161,126,194,195,152,153,154,218,219,220,162,163,164,206,207,208,155,156,157,221,222,223,165,166,167,209,210,211],[0,158,159,117,224,225,1,168,169,129,212,213],[0,146,147,16,226,227],[0,148,149,18,228,229],[0,150,151,18,230,231],[0,150,151,16,232,233],[0,148,149,16,234,235],[0,146,147,18,236,237],[0,146,147,52,238,239],[0,146,147,16,226,227,1,160,161,52,238,239],[0,146,147,18,236,237,1,160,161,61,240,241],[0,146,147,16,226,227,100,172,173,101,170,171],[0,148,149,18,228,229,242,172,181,243,214,244],[0,150,151,18,230,231,245,172,177,246,214,247],[0,150,151,16,232,233,245,172,177,174,170,248],[0,148,149,16,234,235,242,172,181,178,170,249],[0,146,147,18,236,237,100,172,173,108,214,215],[0,146,147,16,226,227,122,190,191,123,192,193],[0,146,147,16,226,227,126,194,195,127,196,197],[0,146,147,18,236,237,126,194,195,123,192,193],[0,146,147,18,236,237,122,190,191,127,196,197],[0,146,147,52,238,239,122,190,191,101,170,171],[0,146,147,61,240,241,126,194,195,101,170,171],[0,146,147,52,238,239,100,172,173,123,192,193],[0,146,147,61,240,241,100,172,173,127,196,197],[0,146,147,16,226,227,100,172,173,101,170,171,1,160,161,52,239,238,122,190,191,123,192,193],[0,146,147,16,226,227,109,216,217,108,214,215,1,160,161,52,239,238,126,194,195,127,196,197],[0,146,147,18,236,237,109,216,217,101,170,171,1,160,161,61,241,240,126,194,195,123,192,193],[0,146,147,18,236,237,100,172,173,108,214,215,1,160,161,61,241,240,122,190,191,127,196,197],[0,16,2,17,158,250,251,252,159,253,254,255],[0,16,2,17,158,250,251,252,159,253,254,255,23,24,13,25,256,257,258,259,260,261,262,263,26,20,27,28,264,265,266,267,268,269,270,271,4,22,5,19,272,273,274,275,276,277,278,279],[0,16,2,17,158,250,251,252,159,253,254,255,29,21,15,30,280,281,282,283,284,285,286,287],[0,20,13,19,158,273,266,259,159,261,278,271],[0,20,13,19,158,273,266,259,159,261,278,271,29,31,32,33,280,288,289,290,284,291,292,293],[0,16,2,17,158,250,251,252,159,253,254,255,1,52,6,34,168,294,295,296,169,297,298,299],[0,16,2,17,158,250,251,252,159,253,254,255,53,54,9,42,300,301,302,303,304,305,306,307],[0,16,2,17,158,250,251,252,159,253,254,255,1,52,6,34,168,294,295,296,169,297,298,299,23,24,13,25,256,257,258,259,260,261,262,263,64,62,14,39,308,309,310,311,312,313,314,315,26,20,27,28,264,265,266,267,268,269,270,271,65,59,40,38,316,317,318,319,320,321,322,323,4,22,5,19,272,273,274,275,276,277,278,279,11,55,8,41,324,325,326,327,328,329,330,331],[0,16,2,17,158,250,251,252,159,253,254,255,66,67,44,45,332,333,334,335,336,337,338,339,23,24,13,25,256,257,258,259,260,261,262,263,68,69,46,47,340,341,342,343,344,345,346,347,26,20,27,28,264,265,266,267,268,269,270,271,70,71,48,49,348,349,350,351,352,353,354,355,4,22,5,19,272,273,274,275,276,277,278,279,72,73,50,51,356,357,358,359,360,361,362,363],[0,16,2,17,158,250,251,252,159,253,254,255,1,52,6,34,168,294,295,296,169,297,298,299,29,21,15,30,280,281,282,283,284,285,286,287,53,54,9,42,300,301,302,303,304,305,306,307],[0,20,13,19,158,273,266,259,159,261,278,271,1,59,14,41,168,325,318,311,169,313,330,323],[0,20,13,19,158,273,266,259,159,261,278,271,1,59,14,41,168,325,318,311,169,313,330,323,29,31,32,33,280,288,289,290,284,291,292,293,53,63,36,35,300,364,365,366,304,367,368,369],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189],[0,16,2,17,158,250,251,252,159,253,254,255,116,117,83,82,376,377,224,378,379,380,381,225],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,23,24,13,25,256,257,258,259,260,261,262,263,382,383,384,385,386,387,388,389,390,391,392,393,26,20,27,28,264,265,266,267,268,269,270,271,394,395,396,397,398,399,400,401,402,403,404,405,4,22,5,19,272,273,274,275,276,277,278,279,138,139,95,94,406,407,408,409,410,411,412,413],[0,24,5,28,158,265,258,275,159,277,270,263,414,415,416,417,418,419,420,421,422,423,424,425,23,16,27,19,256,273,251,267,260,269,278,255,426,427,428,429,430,431,432,433,434,435,436,437,26,22,13,17,264,250,274,259,268,261,254,279,438,439,440,441,442,443,444,445,446,447,448,449,4,20,2,25,272,257,266,252,276,253,262,271,450,451,452,453,454,455,456,457,458,459,460,461],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,29,21,15,30,280,281,282,283,284,285,286,287,116,117,83,82,376,377,224,378,379,380,381,225],[0,20,13,19,158,273,266,259,159,261,278,271,450,415,440,429,454,431,420,445,458,447,436,425],[0,20,13,19,158,273,266,259,159,261,278,271,462,463,464,465,466,467,468,469,470,471,472,473],[0,20,13,19,158,273,266,259,159,261,278,271,462,463,464,465,466,467,468,469,470,471,472,473,29,31,32,33,280,288,289,290,284,291,292,293,450,415,440,429,454,431,420,445,458,447,436,425],[0,16,2,17,158,250,251,252,159,253,254,255,123,122,88,89,204,474,475,476,205,477,478,479],[0,16,2,17,158,250,251,252,159,253,254,255,123,122,88,89,204,474,475,476,205,477,478,479,23,24,13,25,256,257,258,259,260,261,262,263,480,481,482,483,484,485,486,487,488,489,490,491,26,20,27,28,264,265,266,267,268,269,270,271,492,493,494,495,496,497,498,499,500,501,502,503,4,22,5,19,272,273,274,275,276,277,278,279,125,124,140,141,504,505,506,507,508,509,510,511],[0,16,2,17,158,250,251,252,159,253,254,255,123,122,88,89,204,474,475,476,205,477,478,479,29,21,15,30,280,281,282,283,284,285,286,287,129,128,90,91,212,512,513,514,213,515,516,517],[0,16,2,17,158,250,251,252,159,253,254,255,129,128,90,91,212,512,513,514,213,515,516,517],[0,16,2,17,158,250,251,252,159,253,254,255,129,128,90,91,212,512,513,514,213,515,516,517,23,24,13,25,256,257,258,259,260,261,262,263,518,519,520,521,522,523,524,525,526,527,528,529,26,20,27,28,264,265,266,267,268,269,270,271,530,531,532,533,534,535,536,537,538,539,540,541,4,22,5,19,272,273,274,275,276,277,278,279,127,126,92,93,542,543,544,545,546,547,548,549],[0,20,13,19,158,273,266,259,159,261,278,271,550,551,552,553,554,555,556,557,558,559,560,561,29,31,32,33,280,288,289,290,284,291,292,293,562,563,564,565,566,567,568,569,570,571,572,573],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,1,52,6,34,168,294,295,296,169,297,298,299,122,123,89,88,475,476,204,474,479,478,477,205],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,53,54,9,42,300,301,302,303,304,305,306,307,128,129,91,90,513,514,212,512,517,516,515,213],[0,16,2,17,158,250,251,252,159,253,254,255,116,117,83,82,376,377,224,378,379,380,381,225,1,52,6,34,168,294,295,296,169,297,298,299,128,129,91,90,513,514,212,512,517,516,515,213],[0,16,2,17,158,250,251,252,159,253,254,255,116,117,83,82,376,377,224,378,379,380,381,225,53,54,9,42,300,301,302,303,304,305,306,307,122,123,89,88,475,476,204,474,479,478,477,205],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,1,52,6,34,168,294,295,296,169,297,298,299,122,123,89,88,475,476,204,474,479,478,477,205,23,24,13,25,256,257,258,259,260,261,262,263,382,383,384,385,386,387,388,389,390,391,392,393,64,62,14,39,308,309,310,311,312,313,314,315,481,480,483,482,486,487,484,485,491,490,489,488,26,20,27,28,264,265,266,267,268,269,270,271,394,395,396,397,398,399,400,401,402,403,404,405,65,59,40,38,316,317,318,319,320,321,322,323,493,492,495,494,498,499,496,497,503,502,501,500,4,22,5,19,272,273,274,275,276,277,278,279,138,139,95,94,406,407,408,409,410,411,412,413,11,55,8,41,324,325,326,327,328,329,330,331,124,125,141,140,506,507,504,505,511,510,509,508],[0,16,2,17,158,250,251,252,159,253,254,255,116,117,83,82,376,377,224,378,379,380,381,225,1,52,6,34,168,294,295,296,169,297,298,299,128,129,91,90,513,514,212,512,517,516,515,213,23,24,13,25,256,257,258,259,260,261,262,263,574,575,576,577,578,579,580,581,582,583,584,585,64,62,14,39,308,309,310,311,312,313,314,315,519,518,521,520,524,525,522,523,529,528,527,526,26,20,27,28,264,265,266,267,268,269,270,271,586,587,588,589,590,591,592,593,594,595,596,597,65,59,40,38,316,317,318,319,320,321,322,323,531,530,533,532,536,537,534,535,541,540,539,538,4,22,5,19,272,273,274,275,276,277,278,279,109,108,79,78,598,599,600,601,602,603,604,605,11,55,8,41,324,325,326,327,328,329,330,331,126,127,93,92,544,545,542,543,549,548,547,546],[0,24,5,28,158,265,258,275,159,277,270,263,414,415,416,417,418,419,420,421,422,423,424,425,66,69,50,49,332,349,342,359,336,361,354,347,493,123,483,140,498,507,204,485,503,490,509,205,23,16,27,19,256,273,251,267,260,269,278,255,426,427,428,429,430,431,432,433,434,435,436,437,68,67,48,51,340,357,334,351,344,353,362,339,124,480,89,494,506,499,484,474,511,478,501,488,26,22,13,17,264,250,274,259,268,261,254,279,438,439,440,441,442,443,444,445,446,447,448,449,70,73,46,45,348,333,358,343,352,345,338,363,122,492,141,482,475,487,496,505,479,510,489,500,4,20,2,25,272,257,266,252,276,253,262,271,450,451,452,453,454,455,456,457,458,459,460,461,72,71,44,47,356,341,350,335,360,337,346,355,481,125,495,88,486,476,504,497,491,502,477,508],[0,24,5,28,158,265,258,275,159,277,270,263,414,415,416,417,418,419,420,421,422,423,424,425,606,607,608,609,610,611,612,613,614,615,616,617,531,129,521,92,536,545,212,523,541,528,547,213,23,16,27,19,256,273,251,267,260,269,278,255,426,427,428,429,430,431,432,433,434,435,436,437,618,619,620,621,622,623,624,625,626,627,628,629,126,518,91,532,544,537,522,512,549,516,539,526,26,22,13,17,264,250,274,259,268,261,254,279,438,439,440,441,442,443,444,445,446,447,448,449,630,631,632,633,634,635,636,637,638,639,640,641,128,530,93,520,513,525,534,543,517,548,527,538,4,20,2,25,272,257,266,252,276,253,262,271,450,451,452,453,454,455,456,457,458,459,460,461,642,643,644,645,646,647,648,649,650,651,652,653,519,127,533,90,524,514,542,535,529,540,515,546],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,1,52,6,34,168,294,295,296,169,297,298,299,122,123,89,88,475,476,204,474,479,478,477,205,29,21,15,30,280,281,282,283,284,285,286,287,116,117,83,82,376,377,224,378,379,380,381,225,53,54,9,42,300,301,302,303,304,305,306,307,128,129,91,90,513,514,212,512,517,516,515,213],[0,20,13,19,158,273,266,259,159,261,278,271,462,463,464,465,466,467,468,469,470,471,472,473,1,59,14,41,168,325,318,311,169,313,330,323,551,550,553,552,556,557,554,555,561,560,559,558,29,31,32,33,280,288,289,290,284,291,292,293,450,415,440,429,454,431,420,445,458,447,436,425,53,63,36,35,300,364,365,366,304,367,368,369,563,562,565,564,568,569,566,567,573,572,571,570],[0,16],[0,18],[0,16,26,20],[0,2,23,13],[0,3,4,32],[0,2,29,15],[0,3,29,27],[0,52],[0,63],[0,52,26,59],[0,63,26,54],[0,52,16,1],[0,18,1,61],[0,52,16,1,26,59,20,65],[0,31,1,63],[0,1,24,62],[0,15,1,9],[0,5,1,8],[0,31,1,63,26,21,65,54],[0,2,57,56],[0,60,3,16],[0,22,57,3],[0,2,28,20],[0,17,13,24],[0,20,19,13,4,24,17,27],[0,22,57,3,4,16,60,32],[0,22,57,3,23,20,30,12,26,24,33,15,4,16,60,32],[0,22,57,3,29,18,27,25],[0,22,3,57,1,55,10,37],[0,22,385,396,3,57,109,117],[0,22,57,3,159,279,654,655,158,274,656,657,29,18,25,27,284,658,262,269,280,659,257,267]],l={"P 1":0,"P -1":1,"P 1 2 1":2,"P 1 21 1":3,"C 1 2 1":4,"P 1 m 1":5,"P 1 c 1":6,"C 1 m 1":7,"C 1 c 1":8,"P 1 2/m 1":9,"P 1 21/m 1":10,"C 1 2/m 1":11,"P 1 2/c 1":12,"P 1 21/c 1":13,"C 1 2/c 1":14,"P 2 2 2":15,"P 2 2 21":16,"P 21 21 2":17,"P 21 21 21":18,"C 2 2 21":19,"C 2 2 2":20,"F 2 2 2":21,"I 2 2 2":22,"I 21 21 21":23,"P m m 2":24,"P m c 21":25,"P c c 2":26,"P m a 2":27,"P c a 21":28,"P n c 2":29,"P m n 21":30,"P b a 2":31,"P n a 21":32,"P n n 2":33,"C m m 2":34,"C m c 21":35,"C c c 2":36,"A m m 2":37,"A b m 2":38,"A m a 2":39,"A b a 2":40,"F m m 2":41,"F d d 2":42,"I m m 2":43,"I b a 2":44,"I m a 2":45,"P 2/m 2/m 2/m":46,"P m m m":46,"P 2/n 2/n 2/n":47,"P n n n":47,"P 2/c 2/c 2/m":48,"P c c m":48,"P 2/b 2/a 2/n":49,"P b a n":49,"P 21/m 2/m 2/a":50,"P m m a":50,"P 2/n 21/n 2/a":51,"P n n a":51,"P 2/m 2/n 21/a":52,"P m n a":52,"P 21/c 2/c 2/a":53,"P c c a":53,"P 21/b 21/a 2/m":54,"P b a m":54,"P 21/c 21/c 2/n":55,"P c c n":55,"P 2/b 21/c 21/m":56,"P b c m":56,"P 21/n 21/n 2/m":57,"P n n m":57,"P 21/m 21/m 2/n":58,"P m m n":58,"P 21/b 2/c 21/n":59,"P b c n":59,"P 21/b 21/c 21/a":60,"P b c a":60,"P 21/n 21/m 21/a":61,"P n m a":61,"C 2/m 2/c 21/m":62,"C m c m":62,"C 2/m 2/c 21/a":63,"C m c a":63,"C 2/m 2/m 2/m":64,"C m m m":64,"C 2/c 2/c 2/m":65,"C c c m":65,"C 2/m 2/m 2/a":66,"C m m a":66,"C 2/c 2/c 2/a":67,"C c c a":67,"F 2/m 2/m 2/m":68,"F m m m":68,"F 2/d 2/d 2/d":69,"F d d d":69,"I 2/m 2/m 2/m":70,"I m m m":70,"I 2/b 2/a 2/m":71,"I b a m":71,"I 21/b 21/c 21/a":72,"I b c a":72,"I 21/m 21/m 21/a":73,"I m m a":73,"P 4":74,"P 41":75,"P 42":76,"P 43":77,"I 4":78,"I 41":79,"P -4":80,"I -4":81,"P 4/m":82,"P 42/m":83,"P 4/n":84,"P 42/n":85,"I 4/m":86,"I 41/a":87,"P 4 2 2":88,"P 4 21 2":89,"P 41 2 2":90,"P 41 21 2":91,"P 42 2 2":92,"P 42 21 2":93,"P 43 2 2":94,"P 43 21 2":95,"I 4 2 2":96,"I 41 2 2":97,"P 4 m m":98,"P 4 b m":99,"P 42 c m":100,"P 42 n m":101,"P 4 c c":102,"P 4 n c":103,"P 42 m c":104,"P 42 b c":105,"I 4 m m":106,"I 4 c m":107,"I 41 m d":108,"I 41 c d":109,"P -4 2 m":110,"P -4 2 c":111,"P -4 21 m":112,"P -4 21 c":113,"P -4 m 2":114,"P -4 c 2":115,"P -4 b 2":116,"P -4 n 2":117,"I -4 m 2":118,"I -4 c 2":119,"I -4 2 m":120,"I -4 2 d":121,"P 4/m 2/m 2/m":122,"P4/m m m":122,"P 4/m 2/c 2/c":123,"P4/m c c":123,"P 4/n 2/b 2/m":124,"P4/n b m":124,"P 4/n 2/n 2/c":125,"P4/n n c":125,"P 4/m 21/b 2/m":126,"P4/m b m":126,"P 4/m 21/n 2/c":127,"P4/m n c":127,"P 4/n 21/m 2/m":128,"P4/n m m":128,"P 4/n 2/c 2/c":129,"P4/n c c":129,"P 42/m 2/m 2/c":130,"P42/m m c":130,"P 42/m 2/c 2/m":131,"P42/m c m":131,"P 42/n 2/b 2/c":132,"P42/n b c":132,"P 42/n 2/n 2/m":133,"P42/n n m":133,"P 42/m 21/b 2/c":134,"P42/m b c":134,"P 42/m 21/n 2/m":135,"P42/m n m":135,"P 42/n 21/m 2/c":136,"P42/n m c":136,"P 42/n 21/c 2/m":137,"P42/n c m":137,"I 4/m 2/m 2/m":138,"I4/m m m":138,"I 4/m 2/c 2/m":139,"I4/m c m":139,"I 41/a 2/m 2/d":140,"I41/a m d":140,"I 41/a 2/c 2/d":141,"I41/a c d":141,"P 3":142,"P 31":143,"P 32":144,"H 3":145,"R 3":146,"P -3":147,"H -3":148,"R -3":149,"P 3 1 2":150,"P 3 2 1":151,"P 31 1 2":152,"P 31 2 1":153,"P 32 1 2":154,"P 32 2 1":155,"H 3 2":156,"R 3 2":157,"P 3 m 1":158,"P 3 1 m":159,"P 3 c 1":160,"P 3 1 c":161,"H 3 m":162,"R 3 m":163,"H 3 c":164,"R 3 c":165,"P -3 1 2/m":166,"P -3 1 m":166,"P -3 1 2/c":167,"P -3 1 c":167,"P -3 2/m 1":168,"P -3 m 1":168,"P -3 2/c 1":169,"P -3 c 1":169,"H -3 2/m":170,"H -3 m":170,"R -3 2/m":171,"R -3 m":171,"H -3 2/c":172,"H -3 c":172,"R -3 2/c":173,"R -3 c":173,"P 6":174,"P 61":175,"P 65":176,"P 62":177,"P 64":178,"P 63":179,"P -6":180,"P 6/m":181,"P 63/m":182,"P 6 2 2":183,"P 61 2 2":184,"P 65 2 2":185,"P 62 2 2":186,"P 64 2 2":187,"P 63 2 2":188,"P 6 m m":189,"P 6 c c":190,"P 63 c m":191,"P 63 m c":192,"P -6 m 2":193,"P -6 c 2":194,"P -6 2 m":195,"P -6 2 c":196,"P 6/m 2/m 2/m":197,"P 6/m m m":197,"P 6/m 2/c 2/c":198,"P 6/m c c":198,"P 63/m 2/c 2/m":199,"P 63/m c m":199,"P 63/m 2/m 2/c":200,"P 63/m m c":200,"P 2 3":201,"F 2 3":202,"I 2 3":203,"P 21 3":204,"I 21 3":205,"P 2/m -3":206,"P m -3":206,"P 2/n -3":207,"P n -3":207,"F 2/m -3":208,"F m -3":208,"F 2/d -3":209,"F d -3":209,"I 2/m -3":210,"I m -3":210,"P 21/a -3":211,"P a -3":211,"I 21/a -3":212,"I a -3":212,"P 4 3 2":213,"P 42 3 2":214,"F 4 3 2":215,"F 41 3 2":216,"I 4 3 2":217,"P 43 3 2":218,"P 41 3 2":219,"I 41 3 2":220,"P -4 3 m":221,"F -4 3 m":222,"I -4 3 m":223,"P -4 3 n":224,"F -4 3 c":225,"I -4 3 d":226,"P 4/m -3 2/m":227,"P m -3 m":227,"P 4/n -3 2/n":228,"P n -3 n":228,"P 42/m -3 2/n":229,"P m -3 n":229,"P 42/n -3 2/m":230,"P n -3 m":230,"F 4/m -3 2/m":231,"F m -3 m":231,"F 4/m -3 2/c":232,"F m -3 c":232,"F 41/d -3 2/m":233,"F d -3 m":233,"F 41/d -3 2/c":234,"F d -3 c":234,"I 4/m -3 2/m":235,"I m -3 m":235,"I 41/a -3 2/d":236,"I a -3 d":236,"P 1 1 2":237,"P 1 1 21":238,"B 1 1 2":239,"B 2":239,"A 1 2 1":240,"C 1 21 1":241,"I 1 2 1":242,"I 2":242,"I 1 21 1":243,"P 1 1 m":244,"P 1 1 b":245,"B 1 1 m":246,"B 1 1 b":247,"P 1 1 2/m":248,"P 1 1 21/m":249,"B 1 1 2/m":250,"P 1 1 2/b":251,"P 1 1 21/b":252,"P 1 21/n 1":253,"P 1 21/a 1":254,"B 1 1 2/b":255,"P 21 2 2":256,"P 2 21 2":257,"P 21 21 2 (a)":258,"P 21 2 21":259,"P 2 21 21":260,"C 2 2 21a)":261,"C 2 2 2a":262,"F 2 2 2a":263,"I 2 2 2a":264,"P 21/m 21/m 2/n a":265,"P 42 21 2a":266,"I 2 3a":267};function d(t){if(t<146)return t+1;if(146===t)return 1146;if(t<149)return t+1-1;if(149===t)return 1148;if(t<157)return t+1-2;if(157===t)return 1155;if(t<163)return t+1-3;if(163===t)return 1160;if(t<165)return t+1-4;if(165===t)return 1161;if(t<171)return t+1-5;if(171===t)return 1166;if(t<173)return t+1-6;if(173===t)return 1167;if(t<237)return t+1-7;if(237===t)return 1003;if(238===t)return 1004;if(239===t)return 1005;if(240===t)return 2005;if(241===t)return 3005;if(242===t)return 4005;if(243===t)return 5005;if(244===t)return 1006;if(245===t)return 1007;if(246===t)return 1008;if(247===t)return 1009;if(248===t)return 1010;if(249===t)return 1011;if(250===t)return 1012;if(251===t)return 1013;if(252===t)return 1014;if(253===t)return 2014;if(254===t)return 3014;if(255===t)return 1015;if(256===t)return 1017;if(257===t)return 2017;if(258===t)return 1018;if(259===t)return 2018;if(260===t)return 3018;if(261===t)return 1020;if(262===t)return 1021;if(263===t)return 1022;if(264===t)return 1023;if(265===t)return 1059;if(266===t)return 1094;if(267===t)return 1197;throw new Error(`unknown spacegroup index '${t}'`)}const f=function(){const t=Object.create(null);for(const e of Object.keys(l))t[l[e]]=e;return t}(),m=function(){const t=Object.create(null);for(const e of Object.keys(l)){const n=l[e];t[n]=d(n)}return t}();var h,p;!function(t){function e(e,n,o){const i=function(t){const e="number"==typeof t?function(t){switch(t){case 1146:return 146;case 1148:return 149;case 1155:return 157;case 1160:return 163;case 1161:return 165;case 1166:return 171;case 1167:return 173;case 1003:return 237;case 1004:return 238;case 1005:return 239;case 2005:return 240;case 3005:return 241;case 4005:return 242;case 5005:return 243;case 1006:return 244;case 1007:return 245;case 1008:return 246;case 1009:return 247;case 1010:return 248;case 1011:return 249;case 1012:return 250;case 1013:return 251;case 1014:return 252;case 2014:return 253;case 3014:return 254;case 1015:return 255;case 1017:return 256;case 2017:return 257;case 1018:return 258;case 2018:return 259;case 3018:return 260;case 1020:return 261;case 1021:return 262;case 1022:return 263;case 1023:return 264;case 1059:return 265;case 1094:return 266;case 1197:return 267}let e=0;return t>146&&++e,t>148&&++e,t>155&&++e,t>160&&++e,t>161&&++e,t>166&&++e,t>167&&++e,t-1+e}(t):l[t];return void 0===e||void 0===f[e]?-1:e}(e);if(i<0)return console.warn(`Unknown spacegroup '${e}', returning a 'P 1' with cellsize [1, 1, 1]`),t.Zero;const s=n[0]*n[1]*n[2],a=o[0],u=o[1],c=o[2],d=n[0],m=n[1],h=n[2],p=Math.cos(u),g=(Math.cos(a)-Math.cos(u)*Math.cos(c))/Math.sin(c),y=Math.sqrt(1-p*p-g*g),_=[d,0,0],A=[Math.cos(c)*m,Math.sin(c)*m,0],b=[p*h,g*h,y*h],C=r.$I.ofRows([[_[0],A[0],b[0],0],[0,A[1],b[1],0],[0,0,b[2],0],[0,0,0,1]]);return{index:i,size:n,volume:s,anglesInRadians:o,toFractional:r.$I.invert(r.$I.zero(),C),fromFractional:C}}t.Zero=e("P 1",r.eB.create(1,1,1),r.eB.create(Math.PI/2,Math.PI/2,Math.PI/2)),t.isZero=function(t){return!t||0===t.index&&1===t.size[0]&&1===t.size[1]&&1===t.size[1]},t.create=e}(h||(h={})),function(t){function e(t){const e=c[t.index].map(t=>function(t){const e=a[t[0]],n=a[t[1]],o=a[t[2]];return r.$I.ofRows([e,n,o,[0,0,0,1]])}(u[t]));return{name:f[t.index],num:m[t.index],cell:t,operators:e}}t.ZeroP1=e(h.Zero),t.create=e;const n=(0,r.eB)(),o=(0,r.$I)();function i(t,e,i,s,a,u){return r.eB.set(n,i,s,a),r.$I.fromTranslation(o,n),r.$I.mul(u,r.$I.mul(u,r.$I.mul(u,t.cell.fromFractional,o),t.operators[e]),t.cell.toFractional)}t.setOperatorMatrix=i,t.getSymmetryOperator=function(t,e,n,o,a){const u=i(t,e,n,o,a,r.$I.zero());return s.J.create(s.J.getSymmetryOperatorName(e,n,o,a),u,{hkl:r.eB.create(n,o,a),spgrOp:e})};const l=(0,r.eB)(),d=(0,r.eB)(),p=(0,r.eB)(),g=(0,r.eB)();function y(t,e,n){const r=[];if(t>0?r.push("+X"):t<0&&r.push("-X"),e>0?r.push("+Y"):e<0&&r.push("-Y"),n>0?r.push("+Z"):n<0&&r.push("-Z"),1===r.length)return"+"===r[0].charAt(0)?r[0].substr(1):r[0];if(2===r.length){const t=r[0].charAt(0),e=r[1].charAt(0);if("+"===t)return`${r[0].substr(1)}${r[1]}`;if("+"===e)return`${r[1].substr(1)}${r[0]}`}throw new Error(`unknown rotation '${r}', ${t} ${e} ${n}`)}function _(t){switch(t){case.5:return"1/2";case 1/4:return"1/4";case 3/4:return"3/4";case 1/3:return"1/3";case 2/3:return"2/3";case 1/6:return"1/6";case 5/6:return"5/6"}return""}function A(t,e){return""===e?t:t.length>2?`${t}+${e}`:"-"===t.charAt(0)?`${e}${t}`:`${e}+${t}`}t.getSymmetryOperatorRef=function(t,e,o,i,a,u){const c=r.$I.zero();r.eB.set(n,o,i,a),r.eB.floor(l,u),r.$I.copy(c,t.operators[e]),r.eB.floor(d,r.eB.transformMat4(d,u,c)),r.$I.getTranslation(g,c),r.eB.sub(g,g,d),r.eB.add(g,g,l),r.eB.add(g,g,n),r.$I.setTranslation(c,g),r.$I.mul(c,t.cell.fromFractional,c),r.$I.mul(c,c,t.cell.toFractional),r.eB.sub(p,d,l);const f=o-p[0],m=i-p[1],h=a-p[2];return s.J.create(s.J.getSymmetryOperatorName(e,f,m,h),c,{hkl:r.eB.create(f,m,h),spgrOp:e})},t.getOperatorXyz=function(t){return[A(y(t[0],t[4],t[8]),_(t[12])),A(y(t[1],t[5],t[9]),_(t[13])),A(y(t[2],t[6],t[10]),_(t[14]))].join(",")}}(p||(p={}));var g=n(98277),y=n(72028),_=n(46291),A=n(2007)},46291:function(t,e,n){n.d(e,{f:function(){return a}});var r=n(73868),o=n(65533),i=n(2007),s=n(75847);function a(){return a.zero()}!function(t){function e(t){return void 0!==t.extrema}function n(t,e){return{center:t,radius:e}}function a(t,e){return void 0!==t.extrema?(t.extrema.length=0,t.extrema.push(...e)):t.extrema=e,t}t.hasExtrema=e,t.create=n,t.zero=function(){return{center:(0,r.eB)(),radius:0}},t.clone=function(t){const o=n(r.eB.clone(t.center),t.radius);return e(t)&&(o.extrema=t.extrema.map(t=>r.eB.clone(t))),o},t.set=function(t,e,n){return r.eB.copy(t.center,e),t.radius=n,t},t.copy=function(t,n){return r.eB.copy(t.center,n.center),t.radius=n.radius,e(n)&&a(t,n.extrema.map(t=>r.eB.clone(t))),t},t.setExtrema=a,t.computeBounding=function(t){const{x:e,y:n,z:i,indices:s}=t;let a=0,u=0,c=0,l=0;const d=o.CD.size(s);for(let r=0;r<d;r++){const t=o.CD.getAt(s,r);a+=e[t],u+=n[t],c+=i[t]}d>0&&(a/=d,u/=d,c/=d);for(let r=0;r<d;r++){const t=o.CD.getAt(s,r),d=e[t]-a,f=n[t]-u,m=i[t]-c,h=d*d+f*f+m*m;h>l&&(l=h)}return{center:r.eB.create(a,u,c),radius:Math.sqrt(l)}},t.transform=function(t,n,o){return r.eB.transformMat4(t.center,n.center,o),t.radius=n.radius*r.$I.getMaxScaleOnAxis(o),e(n)&&a(t,n.extrema.map(t=>r.eB.transformMat4((0,r.eB)(),t,o))),t},t.translate=function(t,n,o){return r.eB.add(t.center,n.center,o),e(n)&&a(t,n.extrema.map(t=>r.eB.add((0,r.eB)(),t,o))),t},t.scale=function(t,n,o){return r.eB.scale(t.center,n.center,o),t.radius=n.radius*o,e(n)&&a(t,n.extrema.map(t=>r.eB.scale((0,r.eB)(),t,o))),t},t.scaleNX=function(t,e,n){return r.eB.scale(t.center,e.center,n),t.radius=e.radius*n,t},t.toArray=function(t,e,n){return r.eB.toArray(t.center,e,n),e[n+3]=t.radius,e},t.fromArray=function(t,e,n){return r.eB.fromArray(t.center,e,n),t.radius=e[n+3],t},t.fromBox3D=function(e,n){return r.eB.scale(e.center,r.eB.add(e.center,n.max,n.min),.5),e.radius=r.eB.distance(e.center,n.max),t.setExtrema(e,[r.eB.create(n.min[0],n.min[1],n.min[2]),r.eB.create(n.max[0],n.max[1],n.max[2]),r.eB.create(n.max[0],n.min[1],n.min[2]),r.eB.create(n.min[0],n.max[1],n.max[2]),r.eB.create(n.min[0],n.min[1],n.max[2]),r.eB.create(n.max[0],n.min[1],n.max[2]),r.eB.create(n.max[0],n.max[1],n.min[2]),r.eB.create(n.min[0],n.max[1],n.min[2])]),e},t.fromAxes3D=function(t,e){return r.eB.copy(t.center,e.origin),t.radius=Math.max(r.eB.magnitude(e.dirA),r.eB.magnitude(e.dirB),r.eB.magnitude(e.dirC)),t};const u=(0,r.eB)();t.fromDimensionsAndTransform=function(e,n,o){const[i,s,a]=n,c=r.eB.create(0,0,0);r.eB.transformMat4(c,c,o);const l=r.eB.create(i,s,a);r.eB.transformMat4(l,l,o);const d=r.eB.create(i,0,0);r.eB.transformMat4(d,d,o);const f=r.eB.create(0,s,a);r.eB.transformMat4(f,f,o);const m=r.eB.create(0,0,a);r.eB.transformMat4(m,m,o);const h=r.eB.create(i,0,a);r.eB.transformMat4(h,h,o);const p=r.eB.create(i,s,0);r.eB.transformMat4(p,p,o);const g=r.eB.create(0,s,0);r.eB.transformMat4(g,g,o),r.eB.add(u,c,l),r.eB.scale(u,u,.5);const y=Math.max(r.eB.distance(c,l),r.eB.distance(d,f));return t.set(e,u,y/2),t.setExtrema(e,[c,l,d,f,m,h,p,g]),e};const c=(0,r.eB)();t.addVec3=function(e,n,o){return r.eB.distance(n.center,o)<n.radius?t.copy(e,n):(r.eB.sub(c,n.center,o),r.eB.sub(c,n.center,c),r.eB.setMagnitude(c,c,n.radius),r.eB.scale(e.center,r.eB.add(c,c,o),.5),e.radius=r.eB.distance(e.center,o),e)},t.expandBySphere=function(t,n,o){return r.eB.copy(t.center,n.center),t.radius=Math.max(n.radius,r.eB.distance(n.center,o.center)+o.radius),e(n)&&e(o)&&a(t,[...n.extrema.map(t=>r.eB.clone(t)),...o.extrema.map(t=>r.eB.clone(t))]),t};const l=(0,r.eB)();t.expand=function(t,n,o){var u,c;if(r.eB.copy(t.center,n.center),t.radius=n.radius+o,n.radius<1e-12||(null!==(c=null===(u=n.extrema)||void 0===u?void 0:u.length)&&void 0!==c?c:0)<=1)return t.extrema=void 0,t;if(e(n)){const e=new Float32Array(3*n.extrema.length);for(let t=0;t<n.extrema.length;t++)r.eB.toArray(n.extrema[t],e,3*t);const u=s.c.calculateMomentsAxes(e);i.n.scale(u,i.n.normalize(u,u),o),a(t,n.extrema.map(e=>{r.eB.normalize(l,r.eB.sub(l,e,n.center));const o=r.eB.clone(e),i=r.eB.dot(l,u.dirA)<0?-1:1;r.eB.scaleAndAdd(o,o,u.dirA,i);const s=r.eB.dot(l,u.dirB)<0?-1:1;r.eB.scaleAndAdd(o,o,u.dirB,s);const a=r.eB.dot(l,u.dirC)<0?-1:1;return r.eB.scaleAndAdd(o,o,u.dirC,a),r.eB.distance(t.center,o)>t.radius&&(n.extrema.length>=14&&r.eB.normalize(l,r.eB.sub(l,o,n.center)),r.eB.scaleAndAdd(o,t.center,l,t.radius)),o}))}return t},t.exactEquals=function(t,e){return t.radius===e.radius&&r.eB.exactEquals(t.center,e.center)},t.equals=function(t,e){const n=t.radius,o=e.radius;return Math.abs(n-o)<=r.p8*Math.max(1,Math.abs(n),Math.abs(o))&&r.eB.equals(t.center,e.center)},t.includes=function(t,n){if(e(n)){for(const e of n.extrema)if(r.eB.distance(t.center,e)>t.radius)return!1;return!0}return r.eB.distance(t.center,n.center)+n.radius<=t.radius},t.overlaps=function(t,e){return r.eB.distance(t.center,e.center)<=t.radius+e.radius},t.distance=function(t,e){return r.eB.distance(t.center,e.center)-t.radius+e.radius},t.distanceToVec=function(t,e){const{center:n,radius:o}=t;return r.eB.distance(e,n)-o}}(a||(a={}))},46867:function(t,e,n){function r(t){let e,n;return(...r)=>{if(!e||e.length!==r.length)return e=r,n=t.apply(void 0,r),n;for(let o=0,i=r.length;o<i;o++)if(r[o]!==e[o])return e=r,n=t.apply(void 0,r),n;return n}}function o(t){const e=new Map;return n=>{if(e.has(n))return e.get(n);const r=t(n);return e.set(n,r),r}}n.d(e,{E:function(){return o},_:function(){return r}})},47925:function(t,e,n){n.d(e,{E7:function(){return s},Yb:function(){return u},do:function(){return i},k5:function(){return a}});var r=n(27125),o=n(94106);function i(t){return function(e){return s(t,e)}}function s(t,e){const{data:n,indices:i,count:s}=t,{valueType:u}=e,c="str"===u?t=>n.substring(i[2*t],i[2*t+1]):"int"===u?t=>(0,o.H9)(n,i[2*t],i[2*t+1])||0:t=>(0,o.sS)(n,i[2*t],i[2*t+1])||0;return{schema:e,__array:void 0,isDefined:!0,rowCount:s,value:c,valueKind:t=>r.VP.ValueKinds.Present,toArray:t=>r.iu.createAndFillArray(s,c,t),areValuesEqual:a(t)}}function a(t){const{data:e,indices:n}=t;return function(t,r){const o=n[2*t],i=n[2*r],s=n[2*t+1]-o;if(s!==n[2*r+1]-i)return!1;for(let n=0;n<s;n++)if(e.charCodeAt(n+o)!==e.charCodeAt(n+i))return!1;return!0}}function u(t){const{count:e,indices:n}=t;for(let r=0;r<e;++r)if(n[2*r]!==n[2*r+1])return!1;return!0}},49e3:function(t,e,n){n.d(e,{G:function(){return i}});var r=n(27125),o=n(62769);n(52500),n(77936),n(38530);const i={molstar_bond_site:{atom_id_1:r.VP.Schema.int,atom_id_2:r.VP.Schema.int,value_order:r.VP.Schema.Aliased(r.VP.Schema.lstr),type_id:r.VP.Schema.Aliased(r.VP.Schema.lstr)}};o.c.fields().int("atom_id_1",(t,e)=>e[t].atom_id_1).int("atom_id_2",(t,e)=>e[t].atom_id_2).str("value_order",(t,e)=>{var n;return null!==(n=e[t].value_order)&&void 0!==n?n:""},{valueKind:(t,e)=>void 0===e[t].value_order?r.VP.ValueKinds.NotPresent:r.VP.ValueKinds.Present}).str("type_id",(t,e)=>{var n;return null!==(n=e[t].type_id)&&void 0!==n?n:""},{valueKind:(t,e)=>void 0===e[t].type_id?r.VP.ValueKinds.NotPresent:r.VP.ValueKinds.Present}).getFields()},49191:function(t,e,n){n.d(e,{v:function(){return $}});var r,o,i=n(61198),s=n(52500),a=n(9422),u=n(73868),c=n(75849),l=n(51142);!function(t){let e;t.is=l.NJ.has,t.create=l.NJ.create,function(t){t[t._=0]="_",t[t.H=1]="H",t[t.B=2]="B",t[t.E=4]="E",t[t.G=8]="G",t[t.I=16]="I",t[t.S=32]="S",t[t.T=64]="T",t[t.T3=128]="T3",t[t.T4=256]="T4",t[t.T5=512]="T5",t[t.T3S=1024]="T3S",t[t.T4S=2048]="T4S",t[t.T5S=4096]="T5S"}(e=t.Flag||(t.Flag={}))}(r||(r={})),function(t){t[t.PARALLEL=0]="PARALLEL",t[t.ANTI_PARALLEL=1]="ANTI_PARALLEL"}(o||(o={}));class d{constructor(t,e,n){this.partner1=Math.min(t,e),this.partner2=Math.max(t,e),this.type=n}}var f=n(40319);const m=-27.888;function h(t,e,n,r){const o=u.eB.distance(t,r),i=u.eB.distance(e,r),s=u.eB.distance(e,n),a=u.eB.distance(t,n),c=m/o-m/i+(m/s-m/a);return c<-9.9?-9.9:c}function p(t,e,n){const{residueIndices:r,cIndices:o,hIndices:i,nIndices:s,oIndices:a}=e,{index:c}=t.model.atomicHierarchy,l=t.conformation,{traceElementIndex:d}=t.model.atomicHierarchy.derived.residue,m=r.length,p=[],g=[],y=[],_=(0,u.eB)(),A=(0,u.eB)(),b=(0,u.eB)(),C=(0,u.eB)(),S=(0,u.eB)(),x=(0,u.eB)(),v=(0,u.eB)();for(let f=0,B=r.length;f<B;++f){const t=f,e=r[f],m=a[t],B=o[t],I=d[e];if(-1===m||-1===B)continue;if(-1!==c.findAtomOnResidue(e,"OXT"))continue;l.invariantPosition(m,_),l.invariantPosition(B,A),l.invariantPosition(I,b);const{indices:w,count:P}=n.find(b[0],b[1],b[2],9);for(let n=0;n<P;++n){const e=w[n];if(e===t||e-1===t||e+1===t)continue;const r=s[e];if(-1===r)continue;l.invariantPosition(r,C);const c=i[e];if(-1===c){if(0===e)continue;const t=e-1,n=a[t],r=o[t];if(-1===n||-1===r)continue;l.invariantPosition(n,v),l.invariantPosition(r,x),u.eB.sub(S,x,v);const i=u.eB.distance(v,x);u.eB.scaleAndAdd(S,C,S,1/i)}else l.invariantPosition(c,S);const d=h(_,A,C,S);d>-.5||(p[p.length]=t,g[g.length]=e,y[y.length]=d)}}return function(t,e,n,r){const o=new f.O.DirectedEdgeBuilder(t,e,n),i=new Float32Array(o.slotCount);for(let s=0,a=o.edgeCount;s<a;s++)o.addNextEdge(),o.assignProperty(i,r[s]);return o.createGraph({energies:r})}(m,p,g,y)}function g(t,e){if(e.type!==t.type)return!1;if(e.partner1!==t.firstEnd+1)return!1;if(e.type===o.PARALLEL){if(e.partner2===t.secondEnd+1)return!0}else if(e.partner2===t.secondStart-1)return!0;return!1}function y(t,e){return t.type===e.type&&e.firstStart-t.firstEnd<6&&t.firstStart<e.firstStart&&0===e.nextLadder&&(t.type===o.PARALLEL?_(t,e):_(e,t))}function _(t,e){return e.secondStart-t.secondEnd>0&&(e.secondStart-t.secondEnd<6&&e.firstStart-t.firstEnd<3||e.secondStart-t.secondEnd<3)}function A(t){return r.is(t,r.Flag.G)||r.is(t,r.Flag.H)||r.is(t,r.Flag.I)}var b=n(46031),C=n(65533),S=n(71626);const x={oldDefinition:a.t.Boolean(!0,{description:"Whether to use the old DSSP convention for the annotation of turns and helices, causes them to be two residues shorter"}),oldOrdering:a.t.Boolean(!0,{description:"Alpha-helices are preferred over 3-10 helices"})},v=a.t.getDefaultValues(x);async function B(t,e){const n=function(t){const{index:e}=t.model.atomicHierarchy,{proteinElements:n,residueIndex:r}=t,o=n.length,i=new Uint32Array(o),s=new Int32Array(o),a=new Int32Array(o),u=new Int32Array(o),c=new Int32Array(o);for(let l=0;l<o;++l){const t=r[n[l]];i[l]=t,s[l]=e.findAtomOnResidue(t,"C"),a[l]=e.findAtomOnResidue(t,"H"),u[l]=e.findAtomOnResidue(t,"O"),c[l]=e.findAtomOnResidue(t,"N")}return{residueIndices:C.X9.ofSortedArray(i),cIndices:s,hIndices:a,oIndices:u,nIndices:c}}(t),{residueIndices:s}=n,a=function(t,e){const{x:n,y:r,z:o}=t.model.atomicConformation,{traceElementIndex:i}=t.model.atomicHierarchy.derived.residue,s=new Uint32Array(e.length);for(let u=0,c=e.length;u<c;++u)s[u]=i[e[u]];const a={x:n,y:r,z:o,indices:C.X9.ofSortedArray(s)};return(0,b.Eh)(a,(0,S.r)(a))}(t,s),l=p(t,n,a),f=s.length,m=new Uint32Array(f),h=function(t,e){const{cIndices:n,nIndices:r,residueIndices:o}=e,i=t.conformation,{index:s}=t.model.atomicHierarchy,{traceElementIndex:a}=t.model.atomicHierarchy.derived.residue,l=o.length,d=(t,e)=>-1===t?u.eB.setNaN(e):i.position(t,e);let f=(0,u.eB)(),m=(0,u.eB)(),h=(0,u.eB)(),p=(0,u.eB)(),g=(0,u.eB)(),y=(0,u.eB)();const _=(0,u.eB)(),A=(0,u.eB)(),b=(0,u.eB)();if(0===l)return{phi:new Float32Array(0),psi:new Float32Array(0)};const C=new Float32Array(l-1),S=new Float32Array(l-1);d(-1,f),d(-1,m),d(-1,h),d(n[0],p),d(a[o[0]],g),d(r[0],y),d(n[1],_),d(a[o[1]],A),d(r[1],b);for(let x=0;x<l-1;++x)-1===s.findAtomOnResidue(o[x],"OXT")&&(C[x]=(0,c.H)(u.eB.dihedralAngle(f,y,g,p)),S[x]=(0,c.H)(u.eB.dihedralAngle(y,g,p,b)),f=p,m=g,h=y,p=_,g=A,y=b,d(n[x+1],_),d(a[o[x+1]],A),d(r[x+1],b));return{phi:C,psi:S}}(t,n),_=e.oldDefinition?P:M,x={params:e,getResidueFlag:_,getFlagName:e.oldOrdering?D:N,unit:t,proteinInfo:n,flags:m,hbonds:l,torsionAngles:h,ladders:[],bridges:[]};!function(t){const{proteinInfo:e,hbonds:n,flags:o}=t,i=[r.Flag.T3S,r.Flag.T4S,r.Flag.T5S,r.Flag.T3,r.Flag.T4,r.Flag.T5];for(let s=0;s<3;s++)for(let a=0,u=e.residueIndices.length-1;a<u;++a)if(-1!==n.getDirectedEdgeIndex(a,a+s+3))if(o[a]|=i[s+3]|i[s],t.params.oldDefinition)for(let t=1;t<s+3;++t)o[a+t]|=i[s+3]|r.Flag.T;else for(let t=0;t<=s+3;++t)o[a+t]|=i[s+3]|r.Flag.T}(x),function(t){const{proteinInfo:e,flags:n}=t,o=e.residueIndices.length,i=[r.Flag.T3S,r.Flag.T4S,r.Flag.T5S,r.Flag.T3,r.Flag.T4,r.Flag.T5],s=[0,0,0,r.Flag.G,r.Flag.H,r.Flag.I],a=t.params.oldOrdering?[4,3,5]:[3,4,5];for(let u=0;u<a.length;u++){const e=a[u];for(let a=1,u=o-e;a<u;a++){const o=r.create(n[a]),u=r.create(n[a-1]),c=r.create(n[a+1]);if(t.params.oldOrdering){if(3===e&&(r.is(o,r.Flag.H)||r.is(c,r.Flag.H))||5===e&&(r.is(o,r.Flag.H)||r.is(o,r.Flag.G)||r.is(c,r.Flag.H)||r.is(c,r.Flag.G)))continue}else if(4===e&&(r.is(o,r.Flag.G)||r.is(c,r.Flag.G))||5===e&&(r.is(o,r.Flag.H)||r.is(o,r.Flag.G)||r.is(c,r.Flag.H)||r.is(c,r.Flag.G)))continue;if(r.is(o,i[e])&&r.is(o,i[e-3])&&r.is(u,i[e])&&r.is(u,i[e-3]))if(t.params.oldDefinition)for(let t=0;t<e;t++)n[a+t]|=s[e];else for(let t=-1;t<=e;t++)n[a+t]|=s[e]}}}(x),function(t){const{unit:e,flags:n,proteinInfo:o}=t,i=e.conformation,{traceElementIndex:s}=e.model.atomicHierarchy.derived.residue,{residueIndices:a,nIndices:l}=o,d=a.length,f=(t,e)=>-1===t?u.eB.setNaN(e):i.position(t,e),m=(0,u.eB)(),h=(0,u.eB)(),p=(0,u.eB)(),g=(0,u.eB)(),y=(0,u.eB)(),_=(0,u.eB)(),A=(0,u.eB)();t:for(let b=2;b<d-2;b++){for(let n=0;n<4;n++){const t=b+n-2;if(f(s[t],g),f(l[t+1],y),u.eB.squaredDistance(g,y)>6.25)continue t}const t=a[b-2],e=a[b],o=a[b+2],i=s[t],d=s[e],C=s[o];f(i,m),f(d,h),f(C,p),u.eB.sub(_,m,h),u.eB.sub(A,h,p);const S=(0,c.H)(u.eB.angle(_,A));S&&S>70&&(n[b]|=r.Flag.S)}}(x),function(t){const{proteinInfo:e,hbonds:n,flags:i,bridges:s}=t,{offset:a,b:u}=n;let c,l;for(let f=0,m=e.residueIndices.length;f<m;++f)for(let t=a[f],e=a[f+1];t<e;t++){const e=u[t];f>e||(c=f+1,l=e,c!==l&&-1!==n.getDirectedEdgeIndex(l,c+1)&&(i[c]|=r.Flag.B,i[l]|=r.Flag.B,s[s.length]=new d(c,l,o.PARALLEL)),c=f,l=e-1,c!==l&&-1!==n.getDirectedEdgeIndex(l-1,c)&&(i[c]|=r.Flag.B,i[l]|=r.Flag.B,s[s.length]=new d(l,c,o.PARALLEL)),c=f,l=e,c!==l&&-1!==n.getDirectedEdgeIndex(l,c)&&(i[c]|=r.Flag.B,i[l]|=r.Flag.B,s[s.length]=new d(l,c,o.ANTI_PARALLEL)),c=f+1,l=e-1,c!==l&&-1!==n.getDirectedEdgeIndex(l-1,c+1)&&(i[c]|=r.Flag.B,i[l]|=r.Flag.B,s[s.length]=new d(l,c,o.ANTI_PARALLEL)))}s.sort((t,e)=>t.partner1>e.partner1?1:t.partner1<e.partner1?-1:0)}(x),function(t){const{bridges:e,ladders:n}=t;for(let r=0;r<e.length;r++){const t=e[r];let i=!1;for(let e=0;e<n.length;e++){const r=n[e];g(r,t)&&(i=!0,r.firstEnd++,t.type===o.PARALLEL?r.secondEnd++:r.secondStart--)}i||(n[n.length]={previousLadder:0,nextLadder:0,firstStart:t.partner1,firstEnd:t.partner1,secondStart:t.partner2,secondEnd:t.partner2,type:t.type})}for(let r=0;r<n.length;r++){const t=n[r];for(let e=r;e<n.length;e++){const o=n[e];y(t,o)&&(t.nextLadder=e,o.previousLadder=r)}}}(x),function(t){const{ladders:e,flags:n}=t;for(let i=0;i<e.length;i++){const t=e[i];for(let e=t.firstStart;e<=t.firstEnd;e++){const o=t.firstStart-e,i=t.secondStart-o;t.firstStart!==t.firstEnd?(n[e]|=r.Flag.E,n[i]|=r.Flag.E):(!A(n[e])&&r.is(n[e],r.Flag.E)&&(n[e]|=r.Flag.B),!A(n[i])&&r.is(n[i],r.Flag.E)&&(n[i]|=r.Flag.B))}if(0===t.nextLadder)continue;const s=e[t.nextLadder];for(let e=t.firstStart;e<=s.firstEnd;e++)n[e]|=r.Flag.E;if(t.type===o.PARALLEL)for(let e=t.secondStart;e<=s.secondEnd;e++)n[e]|=r.Flag.E;else for(let e=s.secondEnd;e<=t.secondStart;e++)n[e]|=r.Flag.E}}(x);const v=function(t,e){const n=new Uint32Array(t.length);for(let o=0,i=t.length;o<i;++o){const i=r.create(t[o]);n[o]=e(i)}return n}(m,_),B=new Uint32Array(f),E=[],k=[];for(let r=0,o=s.length;r<o;++r){const t=v[r];B[r]=t;const e=_(m[r]);0!==k.length&&e===k[k.length-1].flags||(k[k.length]=I(w(t),m[r],_)),E[r]=k.length-1}return(0,i.M)(B,E,k,t=>C.X9.indexOf(s,t))}function I(t,e,n){return"helix"===t?{kind:"helix",flags:n(e)}:"sheet"===t?{kind:"sheet",flags:n(e)}:"turn"===t||"bend"===t?{kind:"turn",flags:n(e)}:{kind:"none"}}function w(t){return t===s.gG.SecondaryStructureDssp.H||t===s.gG.SecondaryStructureDssp.G||t===s.gG.SecondaryStructureDssp.I?"helix":t===s.gG.SecondaryStructureDssp.B||t===s.gG.SecondaryStructureDssp.E?"sheet":t===s.gG.SecondaryStructureDssp.T?"turn":t===s.gG.SecondaryStructureDssp.S?"bend":"none"}function P(t){return r.is(t,r.Flag.H)?s.gG.SecondaryStructureDssp.H:r.is(t,r.Flag.E)?s.gG.SecondaryStructureDssp.E:r.is(t,r.Flag.B)?s.gG.SecondaryStructureDssp.B:r.is(t,r.Flag.G)?s.gG.SecondaryStructureDssp.G:r.is(t,r.Flag.I)?s.gG.SecondaryStructureDssp.I:r.is(t,r.Flag.T)?s.gG.SecondaryStructureDssp.T:r.is(t,r.Flag.S)?s.gG.SecondaryStructureDssp.S:s.gG.Flag.None}function D(t){return r.is(t,r.Flag.H)?"H":r.is(t,r.Flag.E)?"E":r.is(t,r.Flag.B)?"B":r.is(t,r.Flag.G)?"G":r.is(t,r.Flag.I)?"I":r.is(t,r.Flag.T)?"T":r.is(t,r.Flag.S)?"S":"-"}function M(t){return r.is(t,r.Flag.I)?s.gG.SecondaryStructureDssp.I:r.is(t,r.Flag.H)?s.gG.SecondaryStructureDssp.H:r.is(t,r.Flag.E)?s.gG.SecondaryStructureDssp.E:r.is(t,r.Flag.B)?s.gG.SecondaryStructureDssp.B:r.is(t,r.Flag.G)?s.gG.SecondaryStructureDssp.G:r.is(t,r.Flag.T)?s.gG.SecondaryStructureDssp.T:r.is(t,r.Flag.S)?s.gG.SecondaryStructureDssp.S:s.gG.Flag.None}function N(t){return r.is(t,r.Flag.I)?"I":r.is(t,r.Flag.H)?"H":r.is(t,r.Flag.E)?"E":r.is(t,r.Flag.B)?"B":r.is(t,r.Flag.G)?"G":r.is(t,r.Flag.T)?"T":r.is(t,r.Flag.S)?"S":"-"}var E=n(77936),k=n(49330),T=n(93739),R=n(59859),U=n(10486),H=n(98537);const O=[5.45,5.18,6.37],F=[6.1,10.4,13],G=(0,H.e)(),L=(0,H.e)();function V(t,e,n,r,o){const i=t.conformation,{traceElementIndex:s}=t.model.atomicHierarchy.derived.residue;for(let a=Math.max(0,n-2);a<=n;++a)for(let t=2;t<5;++t){if(a+t>=e.length)return!1;const n=e[a],u=e[a+t],c=s[n],l=s[u];if(-1===c||-1===l)return!1;i.invariantPosition(c,G),i.invariantPosition(l,L);const d=H.e.distance(G,L);if(Math.abs(d-r[t-2])>=o)return!1}return!0}async function Z(t){const e=t.proteinElements.length,n=new Uint32Array(e),r=[],o=[],{proteinElements:a,residueIndex:u}=t,c=a.length,l=new Uint32Array(c);for(let i=0;i<c;++i){const t=u[a[i]];l[i]=t}const d=C.X9.ofSortedArray(l);for(let i=0,f=d.length;i<f;++i){let e=s.gG.Flag.None;V(t,d,i,O,2.1)?e=s.gG.Flag.Helix:V(t,d,i,F,1.42)&&(e=s.gG.Flag.Beta),n[i]=e,0!==o.length&&e===X(o[o.length-1])||(o[o.length]=q(K(e),e)),r[i]=o.length-1}return(0,i.M)(n,r,o,t=>C.X9.indexOf(d,t))}function q(t,e){return"helix"===t?{kind:"helix",flags:e}:"sheet"===t?{kind:"sheet",flags:e}:{kind:"none"}}function K(t){return t===s.gG.Flag.Helix?"helix":t===s.gG.Flag.Beta?"sheet":"none"}function X(t){return"helix"===t.kind||"sheet"===t.kind?t.flags:s.gG.Flag.None}function Y(t){return{type:a.t.MappedStatic("auto",{auto:a.t.EmptyGroup({label:"Automatic"}),model:a.t.EmptyGroup({label:"Model"}),dssp:a.t.Group(x,{label:"DSSP",isFlat:!0}),"zhang-skolnick":a.t.EmptyGroup({label:"Zhang-Skolnick"})},{options:[["auto","Automatic"],["model","Model"],["dssp","DSSP"],["zhang-skolnick","Zhang-Skolnick"]]})}}const z=Y(),$=k.S.createProvider({label:"Secondary Structure",descriptor:(0,R.e)({name:"molstar_computed_secondary_structure"}),type:"root",defaultParams:z,getParams:Y,isApplicable:t=>!0,obtain:async(t,e,n)=>{const r={...a.t.getDefaultValues(z),...n};switch(r.type.name){case"auto":return{value:await W(e)};case"dssp":return{value:await Q(e,r.type.params)};case"model":return{value:await J(e)};case"zhang-skolnick":return{value:await j(e)}}}});async function W(t){const e=new Map;for(let n=0,r=t.unitSymmetryGroups.length;n<r;++n){const r=t.unitSymmetryGroups[n].units[0],o=r.model;if(U.Kx.isFromPdbArchive(o)&&U.Kx.isExperimental(o)&&!U.Kx.isCoarseGrained(o)||U.Kx.hasSecondaryStructure(o)){const t=T.v.Provider.get(o);t&&e.set(r.invariantId,t)}else if(E.Nf.isAtomic(r)&&!U.Kx.isCoarseGrained(o)){const t=await B(r,v);e.set(r.invariantId,t)}else if(E.Nf.isAtomic(r)){const t=await Z(r);e.set(r.invariantId,t)}}return e}async function Q(t,e){const n=new Map;for(let r=0,o=t.unitSymmetryGroups.length;r<o;++r){const o=t.unitSymmetryGroups[r].units[0];if(E.Nf.isAtomic(o)&&!U.Kx.isCoarseGrained(o.model)){const t=await B(o,e);n.set(o.invariantId,t)}}return n}async function j(t){const e=new Map;for(let n=0,r=t.unitSymmetryGroups.length;n<r;++n){const r=t.unitSymmetryGroups[n].units[0];if(E.Nf.isAtomic(r)){const t=await Z(r);e.set(r.invariantId,t)}}return e}async function J(t){const e=new Map;for(let n=0,r=t.unitSymmetryGroups.length;n<r;++n){const r=t.unitSymmetryGroups[n].units[0];if(E.Nf.isAtomic(r)){const t=T.v.Provider.get(r.model);t&&e.set(r.invariantId,t)}}return e}},49330:function(t,e,n){n.d(e,{S:function(){return r}});var r,o=n(9422),i=n(51142),s=n(59859),a=n(78850);!function(t){function e(t){const e=t.descriptor.name,n="root"===t.type?"inheritedPropertyData":"currentPropertyData",r=r=>(e in r[n]||(r[n][e]={props:{...o.t.getDefaultValues(t.getParams(r))},data:i.xv.create(void 0)}),r[n][e]),s=(t,o,s)=>{const a=r(t);t[n][e]={props:o,data:i.xv.withValue(a.data,s)}};return{label:t.label,descriptor:t.descriptor,isHidden:t.isHidden,getParams:e=>{const n=o.t.clone(t.getParams(e));return o.t.setDefaultValues(n,r(e).props),n},defaultParams:t.defaultParams,isApplicable:t.isApplicable,attach:async(e,n,i={},a)=>{a&&n.customPropertyDescriptors.reference(t.descriptor,!0),"root"===t.type&&(n=n.root);const u=r(n.root).props,c=r(n),l=o.t.merge(t.defaultParams,u,i);if(c.data.value&&o.t.areEqual(t.defaultParams,c.props,l))return;const{value:d,assets:f}=await t.obtain(e,n,l);n.customPropertyDescriptors.add(t.descriptor),n.customPropertyDescriptors.assets(t.descriptor,f),s(n,l,d)},ref:(e,n)=>e.customPropertyDescriptors.reference(t.descriptor,n),get:t=>r(t).data,set:(e,n={},i)=>{"root"===t.type&&(e=e.root);const a=r(e),u=o.t.merge(t.defaultParams,a.props,n);o.t.areEqual(t.defaultParams,a.props,u)||(s(e,u,i),e.customPropertyDescriptors.assets(t.descriptor))},props:t=>r(t).props}}t.createProvider=e,t.createSimple=function(t,n,r){const i={value:o.t.Value(r,{isHidden:!0})};return e({label:(0,a.Mk)(t),descriptor:(0,s.e)({name:t}),isHidden:!0,type:n,defaultParams:i,getParams:()=>({value:o.t.Value(r,{isHidden:!0})}),isApplicable:()=>!0,obtain:async(t,e,n)=>({...o.t.getDefaultValues(i),...n})})}}(r||(r={}))},49878:function(t,e,n){var r;n.d(e,{N:function(){return r}}),function(t){t.create=function(t){return t},t.has=function(t,e){return 0!==(t&e)},t.hasAll=function(t,e){return!!e&&(t&e)===e}}(r||(r={}))},50669:function(t,e,n){var r;n.d(e,{r:function(){return r}}),function(t){function e(t){return!!t&&!!t.head&&"object"==typeof t}function n(t){return!!t&&"string"==typeof t.name}t.Symbol=function(t){return{name:t}},t.Apply=function(t,e){return e?{head:t,args:e}:{head:t}},t.isArgumentsArray=function(t){return!!t&&Array.isArray(t)},t.isArgumentsMap=function(t){return!!t&&!Array.isArray(t)},t.isLiteral=function(t){return!e(t)&&!n(t)},t.isApply=e,t.isSymbol=n}(r||(r={}))},51142:function(t,e,n){n.d(e,{NJ:function(){return o.N},fe:function(){return i.f},kk:function(){return s.k},xv:function(){return u.xv},IQ:function(){return u.IQ},af:function(){return d},bD:function(){return m},NT:function(){return g},fU:function(){return _},lQ:function(){return c},LI:function(){return l},bN:function(){return h},f8:function(){return p}});var r,o=n(49878),i=n(38328),s=n(70888);function a(t,e){return t-e}!function(t){class e{has(t){return!1}forEach(t,e){return e}constructor(){this.size=0}}class n{has(t){return t===this.idx}forEach(t,e){return t(this.idx,e),e}constructor(t){this.idx=t,this.size=1}}class r{has(t){return t<this.length&&!!this.mask[t]}_forEach(t,e){for(let n=0;n<this.length;n++)this.mask[n]&&t(n,e)}forEach(t,e){return this._forEach(t,e),e}constructor(t,e){this.mask=t,this.size=e,this.length=t.length}}class o{has(t){return!0}_forEach(t,e){for(let n=0;n<this.size;n++)t(n,e)}forEach(t,e){return this._forEach(t,e),e}constructor(t){this.size=t}}class i{has(t){return this.set.has(t)}_forEach(t,e){for(const n of this.flatten())t(n,e)}flatten(){if(this._flat)return this._flat;const t=new Int32Array(this.size);let e=0;var n;return this.set.forEach(n=>t[e++]=n),n=t,Array.prototype.sort.call(n,a),this._flat=t,this._flat}forEach(t,e){return this._forEach(t,e),e}constructor(t){this.set=t,this._flat=void 0,this.size=t.size}}function s(t){return new i(t)}function u(t,e){return new r(t,e)}t.always=function(t){return new o(t)},t.never=new e,t.ofSet=s,t.singleton=function(t){return new n(t)},t.ofUniqueIndices=function(t){const s=t.length;if(0===s)return new e;if(1===s)return new n(t[0]);let a=0;for(const e of t)e>a&&(a=e);if(s===a)return new o(s);if(s/a<1/12){const e=new Set;for(const n of t)e.add(n);return new i(e)}const u=new Int8Array(a+1);for(const e of t)u[e]=1;return new r(u,t.length)},t.ofMask=u,t.hasAny=function(t,e){for(const n of e)if(t.has(n))return!0;return!1},t.complement=function(t,e){let n=0,r=0;if(e.forEach(e=>{t.has(e)||(n++,e>r&&(r=e))}),n/r<1/12){const n=new Set;return e.forEach(e=>{t.has(e)||n.add(e)}),s(n)}{const o=new Uint8Array(r+1);return e.forEach(e=>{t.has(e)||(o[e]=1)}),u(o,n)}}}(r||(r={}));var u=n(21087);const c=function(){};function l(t,e){const n=Math.pow(10,e);return Math.round(n*t)/n}function d(t,e){const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}const f=Object.prototype.hasOwnProperty;function m(t,e){if(t===e)return!0;const n=Array.isArray(t),r=Array.isArray(e);if(n&&r){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!m(t[n],e[n]))return!1;return!0}if(n!==r)return!1;if(t&&e&&"object"==typeof t&&"object"==typeof e){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!1;const r=t instanceof Date,o=e instanceof Date;if(r&&o)return t.getTime()===e.getTime();if(r!==o)return!1;const i=t instanceof RegExp,s=e instanceof RegExp;if(i&&s)return t.toString()===e.toString();if(i!==s)return!1;for(let t=0;t<n.length;t++)if(!f.call(e,n[t]))return!1;for(let a=0;a<n.length;a++)if(!m(t[n[a]],e[n[a]]))return!1;return!0}return!1}function h(t,e){if(t===e)return!0;const n=Array.isArray(t),r=Array.isArray(e);return n&&r?function(t,e){if(t===e)return!0;if(!t||!e)return!1;if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;++n)if(t[n]!==e[n])return!1;return!0}(t,e):n===r&&(!(!t||!e||"object"!=typeof t||"object"!=typeof e)&&p(t,e))}function p(t,e){if(t===e)return!0;if(!t||!e)return!1;const n=Object.keys(t);if(Object.keys(e).length!==n.length)return!1;for(const r of n)if(!f.call(t,r)||t[r]!==e[r])return!1;return!0}function g(t,e){return void 0!==t?t:e}Object.assign;function y(t){return(t<10?"0":"")+t}function _(t){const e=t.getHours(),n=t.getMinutes(),r=t.getSeconds();return`${e}:${y(n)}:${y(r)}`}},51195:function(t,e,n){n.d(e,{Z:function(){return d}});var r=n(98537),o=n(33565),i=n(46291),s=n(60771);const a=r.e.dot,u=r.e.copy,c=r.e.scaleAndSub,l=r.e.scaleAndAdd;class d{computeExtrema(t,e){const n=a(this.dir[t],e);n<this.minDist[t]&&(this.minDist[t]=n,u(this.extrema[2*t],e)),n>this.maxDist[t]&&(this.maxDist[t]=n,u(this.extrema[2*t+1],e))}computeSphereExtrema(t,e,n){const r=this.dir[t],o=a(r,e);o-n<this.minDist[t]&&(this.minDist[t]=o-n,c(this.extrema[2*t],e,r,n)),o+n>this.maxDist[t]&&(this.maxDist[t]=o+n,l(this.extrema[2*t+1],e,r,n))}includeSphere(t){if(i.f.hasExtrema(t)&&t.extrema.length>1)for(const e of t.extrema)this.includePosition(e);else this.includePositionRadius(t.center,t.radius)}includePosition(t){for(let e=0;e<this.dirLength;++e)this.computeExtrema(e,t)}includePositionRadius(t,e){for(let n=0;n<this.dirLength;++n)this.computeSphereExtrema(n,t,e)}finishedIncludeStep(){for(let t=0;t<this.extrema.length;t++)this.centroidHelper.includeStep(this.extrema[t]);this.centroidHelper.finishedIncludeStep()}radiusSphere(t){if(i.f.hasExtrema(t)&&t.extrema.length>1)for(const e of t.extrema)this.radiusPosition(e);else this.radiusPositionRadius(t.center,t.radius)}radiusPosition(t){this.centroidHelper.radiusStep(t)}radiusPositionRadius(t,e){this.centroidHelper.radiusSphereStep(t,e)}getSphere(t){return i.f.setExtrema(this.centroidHelper.getSphere(t),this.extrema.slice())}getBox(t){return s.D.fromVec3Array(t||(0,s.D)(),this.extrema)}reset(){for(let t=0;t<this.dirLength;++t)this.minDist[t]=1/0,this.maxDist[t]=-1/0,this.extrema[2*t]=(0,r.e)(),this.extrema[2*t+1]=(0,r.e)();this.centroidHelper.reset()}constructor(t){this.minDist=[],this.maxDist=[],this.extrema=[],this.centroidHelper=new o.p,this.dir=function(t){let e;switch(t){case"6":e=[...f];break;case"14":e=[...f,...m];break;case"26":e=[...f,...m,...h];break;case"98":e=[...f,...m,...h,...p,...g,...y]}return e.map(t=>{const e=r.e.create(t[0],t[1],t[2]);return r.e.normalize(e,e)})}(t),this.dirLength=this.dir.length,this.reset()}}const f=[[1,0,0],[0,1,0],[0,0,1]],m=[[1,1,1],[-1,1,1],[-1,-1,1],[1,-1,1]],h=[[1,1,0],[1,-1,0],[1,0,1],[1,0,-1],[0,1,1],[0,1,-1]],p=[[0,1,2],[0,2,1],[1,0,2],[2,0,1],[1,2,0],[2,1,0],[0,1,-2],[0,2,-1],[1,0,-2],[2,0,-1],[1,-2,0],[2,-1,0]],g=[[1,1,2],[2,1,1],[1,2,1],[1,-1,2],[1,1,-2],[1,-1,-2],[2,-1,1],[2,1,-1],[2,-1,-1],[1,-2,1],[1,2,-1],[1,-2,-1]],y=[[2,2,1],[1,2,2],[2,1,2],[2,-2,1],[2,2,-1],[2,-2,-1],[1,-2,2],[1,2,-2],[1,-2,-2],[2,-1,2],[2,1,-2],[2,-1,-2]]},52500:function(t,e,n){n.d(e,{uA:function(){return T},Ke:function(){return E},ii:function(){return L},I$:function(){return et},K5:function(){return R},DF:function(){return H},F1:function(){return c},HX:function(){return m},HA:function(){return y},px:function(){return q},XB:function(){return h},Pt:function(){return p},DB:function(){return g},Xk:function(){return nt},XQ:function(){return U},gG:function(){return tt},mw:function(){return N},ut:function(){return Y},bM:function(){return z},FW:function(){return d},UC:function(){return W},wZ:function(){return $},RN:function(){return K},nO:function(){return X},OV:function(){return j},z7:function(){return Q},iu:function(){return J},VH:function(){return V},qN:function(){return Z}});var r=n(49878),o=n(92570),i=n(24303);const s=new Set(["DAPC","DBPC","DFPC","DGPC","DIPC","DLPC","DNPC","DOPC","DPPC","DRPC","DTPC","DVPC","DXPC","DYPC","LPPC","PAPC","PEPC","PGPC","PIPC","POPC","PRPC","PUPC","DAPE","DBPE","DFPE","DGPE","DIPE","DLPE","DNPE","DOPE","DPPE","DRPE","DTPE","DUPE","DVPE","DXPE","DYPE","LPPE","PAPE","PGPE","PIPE","POPE","PQPE","PRPE","PUPE","DAPS","DBPS","DFPS","DGPS","DIPS","DLPS","DNPS","DOPS","DPPS","DRPS","DTPS","DUPS","DVPS","DXPS","DYPS","LPPS","PAPS","PGPS","PIPS","POPS","PQPS","PRPS","PUPS","DAPA","DBPA","DFPA","DGPA","DIPA","DLPA","DNPA","DOPA","DPPA","DRPA","DTPA","DVPA","DXPA","DYPA","LPPA","PAPA","PGPA","PIPA","POPA","PRPA","PUPA","DAPG","DBPG","DFPG","DGPG","DIPG","DLPG","DNPG","DOPG","DPPG","DRPG","DTPG","DVPG","DXPG","DYPG","LPPG","PAPG","PGPG","PIPG","POPG","PRPG","DMPC","DPP","DPPI","PAPI","PIPI","POP","POPI","PUPI","PVP","PVPI","PADG","PIDG","PODG","PUDG","PVDG","APC","CPC","IPC","LPC","OPC","PPC","TPC","UPC","VPC","BNSM","DBSM","DPSM","DXSM","PGSM","PNSM","POSM","PVSM","XNSM","DPCE","DXCE","PNCE","XNCE"]),a=new Set(["118","119","543","1AL","1CU","2FK","2HP","2OF","3CO","3MT","3NI","3OF","3P8","4MO","4PU","4TI","6MO","ACT","AG","AL","ALF","AM","ATH","AU","AU3","AUC","AZI","BA","BCT","BEF","BF4","BO4","BR","BS3","BSY","CA","CAC","CD","CD1","CD3","CD5","CE","CF","CHT","CL","CO","CO3","CO5","CON","CR","CS","CSB","CU","CU1","CU3","CUA","CUZ","CYN","DME","DMI","DSC","DTI","DY","E4N","EDR","EMC","ER3","EU","EU3","F","FE","FE2","FPO","GA","GD3","GEP","HAI","HG","HGC","IN","IOD","IR","IR3","IRI","IUM","K","KO4","LA","LCO","LCP","LI","LU","MAC","MG","MH2","MH3","MLI","MMC","MN","MN3","MN5","MN6","MO1","MO2","MO3","MO4","MO5","MO6","MOO","MOS","MOW","MW1","MW2","MW3","NA","NA2","NA5","NA6","NAO","NAW","ND","NET","NH4","NI","NI1","NI2","NI3","NO2","NO3","NRU","NT3","O4M","OAA","OC1","OC2","OC3","OC4","OC5","OC6","OC7","OC8","OCL","OCM","OCN","OCO","OF1","OF2","OF3","OH","OS","OS4","OXL","PB","PBM","PD","PDV","PER","PI","PO3","PO4","PR","PT","PT4","PTN","RB","RH3","RHD","RHF","RU","SB","SCN","SE4","SEK","SM","SMO","SO3","SO4","SR","T1A","TB","TBA","TCN","TEA","TH","THE","TL","TMA","TRA","UNX","V","VN3","VO4","W","WO5","Y1","YB","YB2","YH","YT3","ZCM","ZN","ZN2","ZN3","ZNO","ZO3","ZR","ZTM","NCO","OHX"]),u=function(){const t=Object.create(null),e=[];for(let n="A".charCodeAt(0);n<="Z".charCodeAt(0);n++)e[e.length]=String.fromCharCode(n);for(let n="a".charCodeAt(0);n<="z".charCodeAt(0);n++)e[e.length]=String.fromCharCode(n);for(let n="0".charCodeAt(0);n<="9".charCodeAt(0);n++)e[e.length]=String.fromCharCode(n);for(const n of e){t[n]=n.toUpperCase();for(const r of e){t[n+r]=(n+r).toUpperCase();for(const o of e)t[n+r+o]=(n+r+o).toUpperCase()}}return t}();function c(t){return u[t]||t.toUpperCase()}const l=new Map([[1,"H"],[2,"He"],[3,"Li"],[4,"Be"],[5,"B"],[6,"C"],[7,"N"],[8,"O"],[9,"F"],[10,"Ne"],[11,"Na"],[12,"Mg"],[13,"Al"],[14,"Si"],[15,"P"],[16,"S"],[17,"Cl"],[18,"Ar"],[19,"K"],[20,"Ca"],[21,"Sc"],[22,"Ti"],[23,"V"],[24,"Cr"],[25,"Mn"],[26,"Fe"],[27,"Co"],[28,"Ni"],[29,"Cu"],[30,"Zn"],[31,"Ga"],[32,"Ge"],[33,"As"],[34,"Se"],[35,"Br"],[36,"Kr"],[37,"Rb"],[38,"Sr"],[39,"Y"],[40,"Zr"],[41,"Nb"],[42,"Mo"],[43,"Tc"],[44,"Ru"],[45,"Rh"],[46,"Pd"],[47,"Ag"],[48,"Cd"],[49,"In"],[50,"Sn"],[51,"Sb"],[52,"Te"],[53,"I"],[54,"Xe"],[55,"Cs"],[56,"Ba"],[57,"La"],[58,"Ce"],[59,"Pr"],[60,"Nd"],[61,"Pm"],[62,"Sm"],[63,"Eu"],[64,"Gd"],[65,"Tb"],[66,"Dy"],[67,"Ho"],[68,"Er"],[69,"Tm"],[70,"Yb"],[71,"Lu"],[72,"Hf"],[73,"Ta"],[74,"W"],[75,"Re"],[76,"Os"],[77,"Ir"],[78,"Pt"],[79,"Au"],[80,"Hg"],[81,"Tl"],[82,"Pb"],[83,"Bi"],[84,"Po"],[85,"At"],[86,"Rn"],[87,"Fr"],[88,"Ra"],[89,"Ac"],[90,"Th"],[91,"Pa"],[92,"U"],[93,"Np"],[94,"Pu"],[95,"Am"],[96,"Cm"],[97,"Bk"],[98,"Cf"],[99,"Es"],[100,"Fm"],[101,"Md"],[102,"No"],[103,"Lr"],[104,"Rf"],[105,"Db"],[106,"Sg"],[107,"Bh"],[108,"Hs"],[109,"Mt"],[110,"Ds"],[111,"Rg"],[112,"Cn"],[113,"Uut"],[114,"Fl"],[115,"Uup"],[116,"Lv"],[117,"Uus"],[118,"Uuo"]].map(t=>[t[0],c(t[1])]));function d(t){return l.has(t)?l.get(t):c("H")}var f,m,h;!function(t){t[t.unknown=0]="unknown",t[t.polymer=1]="polymer",t[t["non-polymer"]=2]="non-polymer",t[t.macrolide=3]="macrolide",t[t.water=4]="water",t[t.branched=5]="branched"}(f||(f={})),function(t){t[t.Unknown=0]="Unknown",t[t.Other=1]="Other",t[t.Water=2]="Water",t[t.Ion=3]="Ion",t[t.Lipid=4]="Lipid",t[t.Protein=5]="Protein",t[t.RNA=6]="RNA",t[t.DNA=7]="DNA",t[t.PNA=8]="PNA",t[t.Saccharide=9]="Saccharide"}(m||(m={})),function(t){t[t.NA=0]="NA",t[t.Protein=1]="Protein",t[t.GammaProtein=2]="GammaProtein",t[t.BetaProtein=3]="BetaProtein",t[t.RNA=4]="RNA",t[t.DNA=5]="DNA",t[t.PNA=6]="PNA"}(h||(h={}));const p={[h.NA]:{trace:new Set,directionFrom:new Set,directionTo:new Set,backboneStart:new Set,backboneEnd:new Set,coarseBackbone:new Set},[h.Protein]:{trace:new Set(["CA"]),directionFrom:new Set(["C"]),directionTo:new Set(["O","OC1","O1","OX1","OXT","OT1"]),backboneStart:new Set(["N"]),backboneEnd:new Set(["C"]),coarseBackbone:new Set(["CA","CA1","BB","BAS"])},[h.GammaProtein]:{trace:new Set(["CA"]),directionFrom:new Set(["C"]),directionTo:new Set(["O"]),backboneStart:new Set(["N"]),backboneEnd:new Set(["CD"]),coarseBackbone:new Set(["CA"])},[h.BetaProtein]:{trace:new Set(["CA"]),directionFrom:new Set(["C"]),directionTo:new Set(["O"]),backboneStart:new Set(["N"]),backboneEnd:new Set(["CG"]),coarseBackbone:new Set(["CA"])},[h.RNA]:{trace:new Set(["O3'","O3*"]),directionFrom:new Set(["C4'","C4*"]),directionTo:new Set(["C3'","C3*"]),backboneStart:new Set(["P"]),backboneEnd:new Set(["O3'","O3*"]),coarseBackbone:new Set(["P"])},[h.DNA]:{trace:new Set(["O3'","O3*"]),directionFrom:new Set(["C3'","C3*"]),directionTo:new Set(["C1'","C1*"]),backboneStart:new Set(["P"]),backboneEnd:new Set(["O3'","O3*"]),coarseBackbone:new Set(["P"])},[h.PNA]:{trace:new Set(["N4'","N4*"]),directionFrom:new Set(["N4'","N4*"]),directionTo:new Set(["C7'","C7*"]),backboneStart:new Set(["N1'","N1*"]),backboneEnd:new Set(["C'","C*"]),coarseBackbone:new Set(["P"])}},g=new Set(["CA","C","N","O","O1","O2","OC1","OC2","OT1","OT2","OX1","OXT","H","H1","H2","H3","HA","HN","HXT","BB"]),y=new Set(["P","OP1","OP2","HOP2","HOP3","O2'","O3'","O4'","O5'","C1'","C2'","C3'","C4'","C5'","H1'","H2'","H2''","HO2'","H3'","H4'","H5'","H5''","HO3'","HO5'","O2*","O3*","O4*","O5*","C1*","C2*","C3*","C4*","C5*"]),_=new Set(["d-peptide linking","d-peptide nh3 amino terminus","d-peptide cooh carboxy terminus","d-gamma-peptide, c-delta linking","d-beta-peptide, c-gamma linking"]),A=new Set(["l-peptide linking","l-peptide nh3 amino terminus","l-peptide cooh carboxy terminus","l-gamma-peptide, c-delta linking","l-beta-peptide, c-gamma linking"]),b=new Set(["d-gamma-peptide, c-delta linking","l-gamma-peptide, c-delta linking"]),C=new Set(["d-beta-peptide, c-gamma linking","l-beta-peptide, c-gamma linking"]),S=new Set(["d-peptide nh3 amino terminus","d-peptide cooh carboxy terminus","l-peptide nh3 amino terminus","l-peptide cooh carboxy terminus"]),x=new Set(["peptide linking","peptide-like"]),v=i.M.unionMany(_,A,x),B=new Set(["dna linking","l-dna linking","dna oh 5 prime terminus","dna oh 3 prime terminus"]),I=new Set(["rna linking","l-rna linking","rna oh 5 prime terminus","rna oh 3 prime terminus"]),w=i.M.unionMany(new Set(["d-saccharide, beta linking","l-saccharide, beta linking","d-saccharide, alpha linking","l-saccharide, alpha linking","l-saccharide","d-saccharide","saccharide"]),new Set(["d-saccharide 1,4 and 1,4 linking","l-saccharide 1,4 and 1,4 linking","d-saccharide 1,4 and 1,6 linking","l-saccharide 1,4 and 1,6 linking"])),P=new Set(["non-polymer","other"]),D=new Set(["ion"]),M=new Set(["lipid"]),N=new Set(["SOL","WAT","HOH","H2O","W","DOD","D3O","TIP","TIP3","TIP4","SPC"]),E=new Set(["HIS","ARG","LYS","ILE","PHE","LEU","TRP","ALA","MET","PRO","CYS","ASN","VAL","GLY","SER","GLN","TYR","ASP","GLU","THR","SEC","PYL","UNK","MSE","SEP","TPO","PTR","PCA","HYP","HSD","HSE","HSP","LSN","ASPP","GLUP","HID","HIE","HIP","LYN","ASH","GLH"]),k=new Set(["DAL","DAR","DSG","DAS","DCY","DGL","DGN","DHI","DIL","DLE","DLY","MED","DPN","DPR","DSN","DTH","DTR","DTY","DVA","DNE"]),T=i.M.unionMany(E,k),R=new Set(["NME","ACE","NH2","FOR","FMT"]),U=new Set(["A","C","T","G","I","U","N"]),H=new Set(["DA","DC","DT","DG","DI","DU","DN"]),O=new Set(["APN","CPN","TPN","GPN"]),F=new Set(["A","G","I","DA","DG","DI","APN","GPN"]),G=new Set(["C","T","U","DC","DT","DU","CPN","TPN"]),L=i.M.unionMany(U,H,O),V=t=>F.has(t.toUpperCase()),Z=t=>G.has(t.toUpperCase()),q=i.M.unionMany(T,L);function K(t,e){return e=e.toUpperCase(),O.has(e)?m.PNA:v.has(t)?m.Protein:I.has(t)?m.RNA:B.has(t)?m.DNA:w.has(t)?m.Saccharide:N.has(e)?m.Water:a.has(e)?m.Ion:s.has(e)?m.Lipid:P.has(t)?o.yt.has(e)?m.Saccharide:T.has(e)?m.Protein:U.has(e)?m.RNA:H.has(e)?m.DNA:m.Other:m.Unknown}function X(t,e){return e===m.Protein?b.has(t)?h.GammaProtein:C.has(t)?h.BetaProtein:S.has(t)?h.NA:h.Protein:e===m.RNA?h.RNA:e===m.DNA?h.DNA:e===m.PNA?h.PNA:h.NA}function Y(t){return t=t.toUpperCase(),T.has(t)?"peptide linking":U.has(t)?"rna linking":H.has(t)?"dna linking":o.yt.has(t)?"saccharide":"other"}function z(t){return{formula:"",formula_weight:0,id:t,name:t,mon_nstd_flag:q.has(t)?"y":"n",pdbx_synonyms:[],type:Y(t)}}function $(t){return t=t.toUpperCase(),N.has(t)?"water":q.has(t)?"polymer":o.yt.has(t)?"branched":"non-polymer"}function W(t,e){return t=t.toUpperCase(),A.has(e)?"polypeptide(L)":_.has(e)?"polypeptide(D)":I.has(e)?"polyribonucleotide":B.has(e)?"polydeoxyribonucleotide":w.has(e)||o.yt.has(t)?"oligosaccharide":O.has(t)?"peptide nucleic acid":E.has(t)?"polypeptide(L)":k.has(t)?"polypeptide(D)":U.has(t)?"polyribonucleotide":H.has(t)?"polydeoxyribonucleotide":D.has(e)||a.has(t)?"ion":M.has(e)||s.has(t)?"lipid":x.has(e)?"peptide-like":"other"}function Q(t){return j(t)||J(t)}function j(t){return t===m.DNA||t===m.RNA||t===m.PNA}function J(t){return t===m.Protein}var tt;!function(t){let e;t.is=r.N.has,t.create=r.N.create,function(t){t[t.None=0]="None",t[t.DoubleHelix=1]="DoubleHelix",t[t.Helix=2]="Helix",t[t.Beta=4]="Beta",t[t.Bend=8]="Bend",t[t.Turn=16]="Turn",t[t.LeftHanded=32]="LeftHanded",t[t.RightHanded=64]="RightHanded",t[t.ClassicTurn=128]="ClassicTurn",t[t.InverseTurn=256]="InverseTurn",t[t.HelixOther=512]="HelixOther",t[t.Helix27=1024]="Helix27",t[t.Helix3Ten=2048]="Helix3Ten",t[t.HelixAlpha=4096]="HelixAlpha",t[t.HelixGamma=8192]="HelixGamma",t[t.HelixOmega=16384]="HelixOmega",t[t.HelixPi=32768]="HelixPi",t[t.HelixPolyproline=65536]="HelixPolyproline",t[t.DoubleHelixOther=131072]="DoubleHelixOther",t[t.DoubleHelixZ=262144]="DoubleHelixZ",t[t.DoubleHelixA=524288]="DoubleHelixA",t[t.DoubleHelixB=1048576]="DoubleHelixB",t[t.BetaOther=2097152]="BetaOther",t[t.BetaStrand=4194304]="BetaStrand",t[t.BetaSheet=8388608]="BetaSheet",t[t.BetaBarell=16777216]="BetaBarell",t[t.TurnOther=33554432]="TurnOther",t[t.Turn1=67108864]="Turn1",t[t.Turn2=134217728]="Turn2",t[t.Turn3=268435456]="Turn3",t[t.NA=536870912]="NA"}(e=t.Flag||(t.Flag={})),t.SecondaryStructureMmcif={helx_lh_27_p:e.Helix|e.LeftHanded|e.Helix27,helx_lh_3t_p:e.Helix|e.LeftHanded|e.Helix3Ten,helx_lh_al_p:e.Helix|e.LeftHanded|e.HelixAlpha,helx_lh_a_n:e.DoubleHelix|e.LeftHanded|e.DoubleHelixA,helx_lh_b_n:e.DoubleHelix|e.LeftHanded|e.DoubleHelixB,helx_lh_ga_p:e.Helix|e.LeftHanded|e.HelixGamma,helx_lh_n:e.DoubleHelix|e.LeftHanded,helx_lh_om_p:e.Helix|e.LeftHanded|e.HelixOmega,helx_lh_ot_n:e.DoubleHelix|e.LeftHanded|e.DoubleHelixOther,helx_lh_ot_p:e.Helix|e.LeftHanded|e.HelixOther,helx_lh_p:e.Helix|e.LeftHanded,helx_lh_pi_p:e.Helix|e.LeftHanded|e.HelixPi,helx_lh_pp_p:e.Helix|e.LeftHanded|e.HelixPolyproline,helx_lh_z_n:e.DoubleHelix|e.LeftHanded|e.DoubleHelixZ,helx_n:e.DoubleHelix,helx_ot_n:e.DoubleHelix,helx_ot_p:e.Helix,helx_p:e.Helix,helx_rh_27_p:e.Helix|e.RightHanded|e.Helix27,helx_rh_3t_p:e.Helix|e.RightHanded|e.Helix3Ten,helx_rh_al_p:e.Helix|e.RightHanded|e.HelixAlpha,helx_rh_a_n:e.DoubleHelix|e.RightHanded|e.DoubleHelixA,helx_rh_b_n:e.DoubleHelix|e.RightHanded|e.DoubleHelixB,helx_rh_ga_p:e.Helix|e.RightHanded|e.HelixGamma,helx_rh_n:e.DoubleHelix|e.RightHanded,helx_rh_om_p:e.Helix|e.RightHanded|e.HelixOmega,helx_rh_ot_n:e.DoubleHelix|e.RightHanded|e.DoubleHelixOther,helx_rh_ot_p:e.Helix|e.RightHanded|e.HelixOther,helx_rh_p:e.Helix|e.RightHanded,helx_rh_pi_p:e.Helix|e.RightHanded|e.HelixPi,helx_rh_pp_p:e.Helix|e.RightHanded|e.HelixPolyproline,helx_rh_z_n:e.DoubleHelix|e.RightHanded|e.DoubleHelixZ,strn:e.Beta|e.BetaStrand,turn_ot_p:e.Turn|e.TurnOther,turn_p:e.Turn,turn_ty1p_p:e.Turn|e.InverseTurn|e.Turn1,turn_ty1_p:e.Turn|e.ClassicTurn|e.Turn1,turn_ty2p_p:e.Turn|e.InverseTurn|e.Turn2,turn_ty2_p:e.Turn|e.ClassicTurn|e.Turn2,turn_ty3p_p:e.Turn|e.InverseTurn|e.Turn3,turn_ty3_p:e.Turn|e.ClassicTurn|e.Turn3,bend:e.Bend,other:e.None},t.SecondaryStructurePdb={1:e.Helix|e.RightHanded|e.HelixAlpha,2:e.Helix|e.RightHanded|e.HelixOmega,3:e.Helix|e.RightHanded|e.HelixPi,4:e.Helix|e.RightHanded|e.HelixGamma,5:e.Helix|e.RightHanded|e.Helix3Ten,6:e.Helix|e.LeftHanded|e.HelixAlpha,7:e.Helix|e.LeftHanded|e.HelixOmega,8:e.Helix|e.LeftHanded|e.HelixGamma,9:e.Helix|e.Helix27,10:e.Helix|e.HelixPolyproline},t.SecondaryStructureStride={H:e.Helix|e.HelixAlpha,G:e.Helix|e.Helix3Ten,I:e.Helix|e.HelixPi,E:e.Beta|e.BetaSheet,B:e.Beta|e.BetaStrand,T:e.Turn,C:e.NA},t.SecondaryStructureDssp={H:e.Helix|e.HelixAlpha,B:e.Beta|e.BetaStrand,E:e.Beta|e.BetaSheet,G:e.Helix|e.Helix3Ten,I:e.Helix|e.HelixPi,T:e.Turn,S:e.Bend}}(tt||(tt={}));var et;!function(t){let e;function n(t){switch(t){case"covalent":return e.Covalent;case"metal-coordination":return e.MetallicCoordination;case"hydrogen-bond":return e.HydrogenBond;case"disulfide":return e.Disulfide;case"aromatic":return e.Aromatic;case"computed":return e.Computed}}t.is=r.N.has,function(t){t[t.None=0]="None",t[t.Covalent=1]="Covalent",t[t.MetallicCoordination=2]="MetallicCoordination",t[t.HydrogenBond=4]="HydrogenBond",t[t.Disulfide=8]="Disulfide",t[t.Aromatic=16]="Aromatic",t[t.Computed=32]="Computed"}(e=t.Flag||(t.Flag={})),t.create=function(t){return r.N.create(t)},t.isCovalent=function(e){return 0!==(e&t.Flag.Covalent)},t.isAll=function(t){return t===Math.pow(2,6)-1},t.Names={covalent:e.Covalent,"metal-coordination":e.MetallicCoordination,"hydrogen-bond":e.HydrogenBond,disulfide:e.Disulfide,aromatic:e.Aromatic,computed:e.Computed},t.isName=function(e){return e in t.Names},t.fromName=n,t.fromNames=function(t){let r=e.None;for(let e=0,o=t.length;e<o;++e)r|=n(t[e]);return r}}(et||(et={}));const nt={ALA:[.17,.5,.33],ARG:[.81,1.81,1],ASN:[.42,.85,.43],ASP:[1.23,3.64,2.41],ASH:[-.07,.43,.5],CYS:[-.24,-.02,.22],GLN:[.58,.77,.19],GLU:[2.02,3.63,1.61],GLH:[-.01,.11,.12],GLY:[.01,1.15,1.14],HIS:[.17,.11,-.06],ILE:[-.31,-1.12,-.81],LEU:[-.56,-1.25,-.69],LYS:[.99,2.8,1.81],MET:[-.23,-.67,-.44],PHE:[-1.13,-1.71,-.58],PRO:[.45,.14,-.31],SER:[.13,.46,.33],THR:[.14,.25,.11],TRP:[-1.85,-2.09,-.24],TYR:[-.94,-.71,.23],VAL:[.07,-.46,-.53],HSD:[.17,.11,-.06],HSE:[.17,.11,-.06],HSP:[.96,2.33,1.37],HID:[.17,.11,-.06],HIE:[.17,.11,-.06],HIP:[.96,2.33,1.37]}},52780:function(t,e,n){n.d(e,{E:function(){return r},g:function(){return s}});var r,o=n(51142),i=n(27125);function s(t,e){return{value:t,unit:e}}!function(t){t.create=function(t,e,n){const r=!!t[0].cell,i=!!t[0].velocities,s=!!t[0].forces;return{id:o.kk.create22(),frames:t,hasCell:r,hasVelocities:i,hasForces:s,deltaTime:e,timeOffset:n}},t.getAtomicConformation=function(t,e,u){var c,l;let{x:d,y:f,z:m}=t;return t.xyzOrdering.frozen?u?t.xyzOrdering.isIdentity?(d=s(d,u),f=s(f,u),m=s(m,u)):(0,o.af)(t.xyzOrdering.index,u)||(d=r(d,t.xyzOrdering.index,u),f=r(f,t.xyzOrdering.index,u),m=r(m,t.xyzOrdering.index,u)):t.xyzOrdering.isIdentity||(d=a(d,t.xyzOrdering.index),f=a(f,t.xyzOrdering.index),m=a(m,t.xyzOrdering.index)):u&&(t.xyzOrdering.isIdentity?(t.xyzOrdering.isIdentity=!1,t.xyzOrdering.index=u,n(d,u),n(f,u),n(m,u)):(0,o.af)(t.xyzOrdering.index,u)||(d=r(d,t.xyzOrdering.index,u),f=r(f,t.xyzOrdering.index,u),m=r(m,t.xyzOrdering.index,u))),t.xyzOrdering.frozen=!0,{id:o.kk.create22(),atomId:e.atomId,occupancy:null!==(c=e.occupancy)&&void 0!==c?c:i.VP.ofConst(1,t.elementCount,i.VP.Schema.int),B_iso_or_equiv:null!==(l=e.B_iso_or_equiv)&&void 0!==l?l:i.VP.ofConst(0,t.elementCount,i.VP.Schema.float),xyzDefined:!0,x:d,y:f,z:m}};const e=[.123];function n(t,n){const r=e;for(let e=0,o=t.length;e<o;e++)r[e]=t[n[e]];for(let e=0,o=t.length;e<o;e++)t[e]=r[e]}function r(t,e,n){const r=new Float32Array(t.length);for(let o=0,i=t.length;o<i;o++)r[o]=t[e[n[o]]];return r}function s(t,e){const n=new Float32Array(t.length);for(let r=0,o=t.length;r<o;r++)n[r]=t[e[r]];return n}function a(t,e){const n=new Float32Array(t.length);for(let r=0,o=t.length;r<o;r++)n[e[r]]=t[r];return n}}(r||(r={}))},54135:function(t,e,n){n.d(e,{bw:function(){return o},wl:function(){return i},th:function(){return u}});class r{add(t){const e=this.getHash(t);if(this.byHash.has(e)){const n=this.byHash.get(e);for(let e=0,r=n.length;e<r;e++)if(this.areEqual(t,n[e]))return!1;return n[n.length]=t,this.size++,!0}return this.byHash.set(e,[t]),this.size++,!0}has(t){const e=this.getHash(t);if(!this.byHash.has(e))return!1;const n=this.byHash.get(e);for(let r=0,o=n.length;r<o;r++)if(this.areEqual(t,n[r]))return!0;return!1}constructor(t,e){this.getHash=t,this.areEqual=e,this.size=0,this.byHash=new Map}}function o(t,e){return new r(t,e)}function i(){return new a}function s(t){return{previous:null,next:null,inList:!0,value:t}}class a{constructor(){this.count=0,this.first=null,this.last=null}addFirst(t){const e=s(t);return e.inList=!0,this.first&&(this.first.previous=e),e.next=this.first,this.first=e,this.count++,this.last||(this.last=e),e}addLast(t){const e=s(t);return null!==this.last&&(this.last.next=e),e.previous=this.last,this.last=e,null===this.first&&(this.first=e),e.inList=!0,this.count++,e}removeFirst(){const t=this.first;if(t)return this.remove(t),t.value}removeLast(){const t=this.last;if(t)return this.remove(t),t.value}remove(t){t.inList&&(t.inList=!1,null!==t.previous?t.previous.next=t.next:null===t.previous&&(this.first=t.next),null!==t.next?t.next.previous=t.previous:null===t.next&&(this.last=t.previous),t.next=null,t.previous=null,this.count--)}find(t){let e=this.first;for(;null!==e;){if(e.value===t)return e;e=e.next}}}var u;!function(t){t.create=function(){return{keys:new Set,array:[]}},t.add=function({keys:t,array:e},n,r){return!t.has(n)&&(t.add(n),e[e.length]=r,!0)},t.has=function({keys:t},e){return t.has(e)}}(u||(u={}))},55178:function(t,e,n){n.d(e,{E:function(){return c},V:function(){return r}});var r,o=n(70888),i=n(38530),s=n(17197),a=n(24832),u=n(83771);!function(t){function e(t,e){return{kind:"url",id:o.k.create22(),url:t,...e}}t.Url=e,t.File=function(t){return{kind:"file",id:o.k.create22(),name:t.name,file:t}},t.isUrl=function(t){return"url"===(null==t?void 0:t.kind)},t.isFile=function(t){return"file"===(null==t?void 0:t.kind)},t.Wrapper=function(t,e,n){return{data:t,dispose:()=>{n.release(e)}}},t.getUrl=function(t){return"string"==typeof t?t:t.url},t.getUrlAsset=function(t,n,r){if("string"==typeof n){return t.tryFindUrl(n,r)||e(n,{body:r})}return n}}(r||(r={}));class c{constructor(){this._assets=new Map}get assets(){return(0,i.ZR)(this._assets.values())}tryFindUrl(t,e){const n=this.assets.values();for(;;){const o=n.next();if(o.done)return;const i=o.value.asset;if(r.isUrl(i)&&i.url===t&&(i.body||"")===(e||""))return i}}tryFindFilename(t){const e=this._assets.values();for(;;){const{done:n,value:r}=e.next();if(n)break;if(r.file.name===t)return r.asset}}set(t,e,n){this._assets.set(t.id,{asset:t,file:e,refCount:0,tag:null==n?void 0:n.tag,isStatic:null==n?void 0:n.isStatic})}get(t){return this._assets.get(t.id)}delete(t){return this._assets.delete(t.id)}has(t){return this._assets.has(t.id)}resolve(t,e,n=!0){return r.isUrl(t)?a.YZ.create(`Download ${t.title||t.url}`,async o=>{if(this._assets.has(t.id)){const n=this._assets.get(t.id);return n.refCount++,r.Wrapper(await(0,s.dH)(n.file,e).runInContext(o),t,this)}if(!n)return r.Wrapper(await(0,s.hW)({...t,type:e}).runInContext(o),t,this);const i=await(0,s.hW)({...t,type:"binary"}).runInContext(o),a=new u.e([i],"raw-data");return this._assets.set(t.id,{asset:t,file:a,refCount:1}),r.Wrapper(await(0,s.dH)(a,e).runInContext(o),t,this)}):a.YZ.create(`Read ${t.name}`,async o=>{if(this._assets.has(t.id)){const n=this._assets.get(t.id);return n.refCount++,r.Wrapper(await(0,s.dH)(n.file,e).runInContext(o),t,this)}if(!(t.file instanceof u.e))throw new Error(`Cannot resolve file asset '${t.name}' (${t.id})`);return n&&this._assets.set(t.id,{asset:t,file:t.file,refCount:1}),r.Wrapper(await(0,s.dH)(t.file,e).runInContext(o),t,this)})}release(t){const e=this._assets.get(t.id);e&&(e.refCount--,e.refCount<=0&&!e.isStatic&&this._assets.delete(t.id))}clearTag(t){const e=Array.from(this._assets.keys());for(const n of e){const e=this._assets.get(n);e&&e.tag===t&&this._assets.delete(n)}}clear(){this._assets.clear()}dispose(){this.clear()}}},58247:function(t,e,n){n.d(e,{HK:function(){return u},IP:function(){return a},Kt:function(){return l},jU:function(){return c},l6:function(){return i}});var r=n(77936),o=n(65533);function i(t,e){if(0===e.length)return r.oE.Empty;if(1===e.length)return e[0];const n=new Map,i=new Set;for(const{units:r}of e)for(let e=0,s=r.length;e<s;e++){const s=r[e];if(n.has(s.id)){if(i.has(s.id))continue;const e=o.X9.union(n.get(s.id),s.elements);n.set(s.id,e),e.length===t.unitMap.get(s.id).elements.length&&i.add(s.id)}else n.set(s.id,s.elements),s.elements.length===t.unitMap.get(s.id).elements.length&&i.add(s.id)}const a=t.subsetBuilder(!0);return n.forEach(s,a),a.getStructure()}function s(t,e){this.setUnit(e,t)}function a(t,e){if(t===e)return!0;if(t.units.length!==e.units.length)return!1;const n=t.units,r=e.unitMap;for(let i=0,s=n.length;i<s;i++){const t=n[i];if(!r.has(t.id))return!1;const e=r.get(t.id);if(!o.X9.areEqual(t.elements,e.elements))return!1}return!0}function u(t,e){if(t===e)return!0;let n,r;t.units.length<e.units.length?(n=t,r=e):(n=e,r=t);const i=n.units,s=r.unitMap;for(let a=0,u=i.length;a<u;a++){const t=i[a];if(!s.has(t.id))continue;const e=s.get(t.id);if(o.X9.areIntersecting(t.elements,e.elements))return!0}return!1}function c(t,e){if(t===e)return t;if(!u(t,e))return r.oE.Empty;let n,i;t.units.length<e.units.length?(n=t,i=e):(n=e,i=t);const s=n.units,a=i.unitMap,c=[];for(let r=0,u=s.length;r<u;r++){const t=s[r];if(!a.has(t.id))continue;const e=a.get(t.id);if(o.X9.areIntersecting(t.elements,e.elements)){const n=o.X9.intersect(t.elements,e.elements);c[c.length]=t.getChild(n)}}return r.oE.create(c,{parent:t.parent||e.parent})}function l(t,e){if(t===e)return r.oE.Empty;if(!u(t,e))return t;const n=t.units,i=e.unitMap,s=[];for(let r=0,a=n.length;r<a;r++){const t=n[r];if(!i.has(t.id)){s[s.length]=t;continue}const e=i.get(t.id),a=o.X9.subtract(t.elements,e.elements);a.length>0&&(s[s.length]=t.getChild(a))}return r.oE.create(s,{parent:t.parent||e.parent})}},58392:function(t,e,n){n.d(e,{q:function(){return o}});class r{constructor(){this.map=new Map,this.applicable=new Map}add(t,e,n){this.map.set(t,e),n&&this.applicable.set(t,n)}remove(t){this.map.delete(t),this.applicable.delete(t)}get(t){return this.map.get(t)}isApplicable(t){if(!this.map.has(t.sourceData.kind))return!1;const e=this.applicable.get(t.sourceData.kind);return!e||e(t)}}var o;!function(t){t.create=function(t,e){const{name:n}=t,o=new r;return{descriptor:t,formatRegistry:o,isApplicable(t){return o.isApplicable(t)},get(r){const i=(null==e?void 0:e.asDynamic)?r._dynamicPropertyData:r._staticPropertyData;if(i[n])return i[n];if(r.customProperties.has(t))return;const s=o.get(r.sourceData.kind);return s?(i[n]=s(r),r.customProperties.add(t),i[n]):void 0},set(t,r){(null==e?void 0:e.asDynamic)?t._dynamicPropertyData[n]=r:t._staticPropertyData[n]=r},delete(t){(null==e?void 0:e.asDynamic)?delete t._dynamicPropertyData[n]:delete t._staticPropertyData[n]}}}}(o||(o={}))},58637:function(t,e,n){n.d(e,{O6:function(){return l},Yd:function(){return c},ZL:function(){return u},kD:function(){return r},on:function(){return d},v3:function(){return m}});const r={forceCompute:!1,noCompute:!1,maxRadius:4},o={H:0,h:0,D:0,d:0,T:0,t:0,He:2,HE:2,he:2,Li:3,LI:3,li:3,Be:4,BE:4,be:4,B:5,b:5,C:6,c:6,N:7,n:7,O:8,o:8,F:9,f:9,Ne:10,NE:10,ne:10,Na:11,NA:11,na:11,Mg:12,MG:12,mg:12,Al:13,AL:13,al:13,Si:14,SI:14,si:14,P:15,p:15,S:16,s:16,Cl:17,CL:17,cl:17,Ar:18,AR:18,ar:18,K:19,k:19,Ca:20,CA:20,ca:20,Sc:21,SC:21,sc:21,Ti:22,TI:22,ti:22,V:23,v:23,Cr:24,CR:24,cr:24,Mn:25,MN:25,mn:25,Fe:26,FE:26,fe:26,Co:27,CO:27,co:27,Ni:28,NI:28,ni:28,Cu:29,CU:29,cu:29,Zn:30,ZN:30,zn:30,Ga:31,GA:31,ga:31,Ge:32,GE:32,ge:32,As:33,AS:33,as:33,Se:34,SE:34,se:34,Br:35,BR:35,br:35,Kr:36,KR:36,kr:36,Rb:37,RB:37,rb:37,Sr:38,SR:38,sr:38,Y:39,y:39,Zr:40,ZR:40,zr:40,Nb:41,NB:41,nb:41,Mo:42,MO:42,mo:42,Tc:43,TC:43,tc:43,Ru:44,RU:44,ru:44,Rh:45,RH:45,rh:45,Pd:46,PD:46,pd:46,Ag:47,AG:47,ag:47,Cd:48,CD:48,cd:48,In:49,IN:49,in:49,Sn:50,SN:50,sn:50,Sb:51,SB:51,sb:51,Te:52,TE:52,te:52,I:53,i:53,Xe:54,XE:54,xe:54,Cs:55,CS:55,cs:55,Ba:56,BA:56,ba:56,La:57,LA:57,la:57,Ce:58,CE:58,ce:58,Pr:59,PR:59,pr:59,Nd:60,ND:60,nd:60,Pm:61,PM:61,pm:61,Sm:62,SM:62,sm:62,Eu:63,EU:63,eu:63,Gd:64,GD:64,gd:64,Tb:65,TB:65,tb:65,Dy:66,DY:66,dy:66,Ho:67,HO:67,ho:67,Er:68,ER:68,er:68,Tm:69,TM:69,tm:69,Yb:70,YB:70,yb:70,Lu:71,LU:71,lu:71,Hf:72,HF:72,hf:72,Ta:73,TA:73,ta:73,W:74,w:74,Re:75,RE:75,re:75,Os:76,OS:76,os:76,Ir:77,IR:77,ir:77,Pt:78,PT:78,pt:78,Au:79,AU:79,au:79,Hg:80,HG:80,hg:80,Tl:81,TL:81,tl:81,Pb:82,PB:82,pb:82,Bi:83,BI:83,bi:83,Po:84,PO:84,po:84,At:85,AT:85,at:85,Rn:86,RN:86,rn:86,Fr:87,FR:87,fr:87,Ra:88,RA:88,ra:88,Ac:89,AC:89,ac:89,Th:90,TH:90,th:90,Pa:91,PA:91,pa:91,U:92,u:92,Np:93,NP:93,np:93,Pu:94,PU:94,pu:94,Am:95,AM:95,am:95,Cm:96,CM:96,cm:96,Bk:97,BK:97,bk:97,Cf:98,CF:98,cf:98,Es:99,ES:99,es:99,Fm:100,FM:100,fm:100,Md:101,MD:101,md:101,No:102,NO:102,no:102,Lr:103,LR:103,lr:103,Rf:104,RF:104,rf:104,Db:105,DB:105,db:105,Sg:106,SG:106,sg:106,Bh:107,BH:107,bh:107,Hs:108,HS:108,hs:108,Mt:109,MT:109,mt:109},i={0:1.42,1:1.42,3:2.7,4:2.7,6:1.75,7:1.6,8:1.52,11:2.7,12:2.7,13:2.7,14:1.9,15:2,16:1.9,17:1.8,19:2.7,20:2.7,21:2.7,22:2.7,23:2.7,24:2.7,25:2.7,26:2.7,27:2.7,28:2.7,29:2.7,30:2.7,31:2.7,33:2.68,37:2.7,38:2.7,39:2.7,40:2.7,41:2.7,42:2.7,43:2.7,44:2.7,45:2.7,46:2.7,47:2.7,48:2.7,49:2.7,50:2.7,55:2.7,56:2.7,57:2.7,58:2.7,59:2.7,60:2.7,61:2.7,62:2.7,63:2.7,64:2.7,65:2.7,66:2.7,67:2.7,68:2.7,69:2.7,70:2.7,71:2.7,72:2.7,73:2.7,74:2.7,75:2.7,76:2.7,77:2.7,78:2.7,79:2.7,80:2.7,81:2.7,82:2.7,83:2.7,87:2.7,88:2.7,89:2.7,90:2.7,91:2.7,92:2.7,93:2.7,94:2.7,95:2.7,96:2.7,97:2.7,98:2.7,99:2.7,100:2.7,101:2.7,102:2.7,103:2.7,104:2.7,105:2.7,106:2.7,107:2.7,108:2.7,109:2.88},s={0:.8,20:1.31,27:1.2,35:1.15,44:1.1,54:1,60:1.84,72:1.88,84:1.75,85:1.56,86:1.76,98:1.6,99:1.68,100:1.63,112:1.6,113:1.59,114:1.36,129:1.45,135:1.47,144:1.6,152:1.45,170:1.4,180:1.55,202:2.4,222:2.24,224:1.91,225:1.98,243:2.02,269:2,293:1.9,316:1.8,420:2.37,480:2.3,512:2.3,544:2.3,612:2.1,629:1.54,665:1,813:2.6,854:2.27,894:1.93,896:2.1,937:2.05,938:2.06,981:1.62,1258:2.68,1309:2.33,1484:1,1763:2.14,1823:2.48,1882:2.1,1944:1.72,2380:2.34,3367:2.44,3733:2.11,3819:2.6,3821:2.36,4736:2.75,5724:2.73,5959:2.63,6519:2.84,6750:2.87,8991:2.81},a=2.001,u=function(){const t=["LI","NA","K","RB","CS","FR","BE","MG","CA","SR","BA","RA","AL","GA","IN","SN","TL","PB","BI","SC","TI","V","CR","MN","FE","CO","NI","CU","ZN","Y","ZR","NB","MO","TC","RU","RH","PD","AG","CD","LA","HF","TA","W","RE","OS","IR","PT","AU","HG","AC","RF","DB","SG","BH","HS","MT","CE","PR","ND","PM","SM","EU","GD","TB","DY","HO","ER","TM","YB","LU","TH","PA","U","NP","PU","AM","CM","BK","CF","ES","FM","MD","NO","LR"],e=new Set;for(const n of t)e.add(o[n]);return e}();function c(t){const e=o[t];return void 0===e?-1:e}function l(t){if(t<0)return a;const e=i[t];return void 0===e?a:e}function d(t,e,n,r){const o=function(t,e){if(t<0||e<0)return-1;const n=s[(r=t,o=e,r<o?(r+o)*(r+o+1)/2+o:(r+o)*(r+o+1)/2+r)];var r,o;return void 0===n?-1:n}(t,e);return o>0?o:e<0?n:(n+r)/1.95}const f=o.H;function m(t){return t===f}},58685:function(t,e,n){n.r(e),n.d(e,{atomicHet:function(){return m},atomicSequence:function(){return d},bundleElementImpl:function(){return p},bundleGenerator:function(){return g},defaultBondTest:function(){return l},spheres:function(){return h},water:function(){return f}});var r=n(65533),o=n(21547),i=n(77936),s=n(31960),a=n(99355),u=n(52500),c=n(88255);function l(t){return u.I$.isCovalent(t.atomicBond.type)}function d(){return function(t){const{inputStructure:e}=t,n=o.i.Location.create(e),u=[];for(const o of e.units){if(o.kind!==i.Nf.Kind.Atomic)continue;n.unit=o;const t=o.elements;if(n.element=t[0],"polymer"!==i.ZP.entity.type(n))continue;const e=r.hT.transientSegments(o.model.atomicHierarchy.residueAtomSegments,t);let s=0;for(;e.hasNext;)s++,e.move();s<8||u.push(o)}return a.c.Singletons(e,s.o.create(u,{parent:e}))}}function f(){return function(t){const{inputStructure:e}=t,n=o.i.Location.create(e),r=[];for(const o of e.units){if(o.kind!==i.Nf.Kind.Atomic)continue;n.unit=o;const t=o.elements;n.element=t[0],"water"===i.ZP.entity.type(n)&&r.push(o)}return a.c.Singletons(e,s.o.create(r,{parent:e}))}}function m(){return function(t){const{inputStructure:e}=t,n=o.i.Location.create(e),u=[];for(const o of e.units){if(o.kind!==i.Nf.Kind.Atomic)continue;n.unit=o;const t=o.elements;if(n.element=t[0],"water"!==i.ZP.entity.type(n)){if("polymer"===i.ZP.entity.type(n)){const e=r.hT.transientSegments(o.model.atomicHierarchy.residueAtomSegments,t);let n=0;for(;e.hasNext;)n++,e.move();if(n>=8)continue}u.push(o)}}return a.c.Singletons(e,s.o.create(u,{parent:e}))}}function h(){return function(t){const{inputStructure:e}=t,n=[];for(const r of e.units)r.kind===i.Nf.Kind.Spheres&&n.push(r);return a.c.Singletons(e,s.o.create(n,{parent:e}))}}function p(t,e,n){return{groupedUnits:t,ranges:e,set:n}}function g(t){return function(e){const n={hash:e.inputStructure.hashCode,elements:t};return a.c.Sequence(e.inputStructure,[c.N.toStructure(n,e.inputStructure)])}}},59530:function(t,e,n){n.d(e,{pm:function(){return l},yR:function(){return d},hM:function(){return c},Vs:function(){return f}});var r=n(80881),o=n(86143),i=n(9058),s=n(90644);const a="undefined"!=typeof performance&&!!performance.mark&&performance.measure&&s.g$;var u;function c(t,e,n=250){const r=h(t,e,n);return y(t,new C(r,r.root))}function l(t,e,n=250){const r=h(t,e,n);return new C(r,r.root)}function d(t,e){return y(e,t)}function f(t,e,n){return t.runChild(e,n)}function m(t){return{taskId:t.id,taskName:t.name,message:"",startedTime:0,canAbort:!0,isIndeterminate:!0,current:0,max:0}}function h(t,e,n){const r={abortRequested:!1,treeAborted:!1,reason:""};return{updateRateMs:n,lastNotified:(0,o.t)(),observer:e,abortToken:r,taskId:t.id,root:{progress:m(t),children:[]},tryAbort:(i=r,t=>{i.abortRequested=!0,i.reason=t||i.reason})};var i}function p(t){return{progress:{...t.progress},children:t.children.map(p)}}function g(t){return t.progress.canAbort&&t.children.every(g)}async function y(t,e){u.markStart(t),e.node.progress.startedTime=(0,o.t)();try{const n=await t.f(e);return u.markEnd(t),u.measure(t),e.info.abortToken.abortRequested&&_(e.info),n}catch(n){throw r.Y.isAbort(n)&&(e.isAborted=!0,e.node.children.length>0&&await new Promise(t=>{e.onChildrenFinished=t}),t.onAbort&&t.onAbort()),n}}function _(t){throw t.abortToken.treeAborted||(t.abortToken.treeAborted=!0,A(t.root),b(t,(0,o.t)())),r.Y.Aborted(t.abortToken.reason)}function A(t){const e=t.progress;e.isIndeterminate=!0,e.canAbort=!1,e.message="Aborting...";for(const n of t.children)A(n)}function b(t,e){t.lastNotified=e;const n=function(t){return{root:p(t.root),canAbort:g(t.root),requestAbort:t.tryAbort}}(t);t.observer(n)}!function(t){function e(t){return`startTask${t.id}`}function n(t){return`endTask${t.id}`}t.markStart=function(t){a&&performance.mark(e(t))},t.markEnd=function(t){a&&performance.mark(n(t))},t.measure=function(t){a&&performance.measure(` ${t.name}`,e(t),n(t))}}(u||(u={}));class C{checkAborted(){this.info.abortToken.abortRequested&&(this.isAborted=!0,_(this.info))}get shouldUpdate(){return this.checkAborted(),(0,o.t)()-this.lastUpdatedTime>this.info.updateRateMs}updateProgress(t){if(this.checkAborted(),!t)return;const e=this.node.progress;"string"==typeof t?(e.message=t,e.isIndeterminate=!0):(void 0!==t.canAbort&&(e.canAbort=t.canAbort),void 0!==t.message&&(e.message=t.message),void 0!==t.current&&(e.current=t.current),void 0!==t.max&&(e.max=t.max),e.isIndeterminate=void 0===e.current||void 0===e.max,void 0!==t.isIndeterminate&&(e.isIndeterminate=t.isIndeterminate))}update(t,e){if(this.lastUpdatedTime=(0,o.t)(),this.updateProgress(t),!e)return b(this.info,this.lastUpdatedTime),this.checkAborted(),i._.immediatePromise()}async runChild(t,e){this.updateProgress(e);const n={progress:m(t),children:[]},o=this.node.children;o.push(n);const i=new C(this.info,n);try{return await y(t,i)}catch(s){if(r.Y.isAbort(s)&&this.isAborted)return;throw s}finally{const t=o.indexOf(n);if(t>=0){for(let e=t,n=o.length-1;e<n;e++)o[e]=o[e+1];o.pop()}0===o.length&&this.onChildrenFinished&&this.onChildrenFinished()}}constructor(t,e){this.isSynchronous=!1,this.isExecuting=!0,this.lastUpdatedTime=0,this.onChildrenFinished=void 0,this.node=e,this.info=t}}},59663:function(t,e,n){n.d(e,{MR:function(){return l},Pd:function(){return c},nN:function(){return u}});var r,o=n(27125),i=n(73868),s=n(51142),a=n(64832);function u(t,e,n){const r={};for(const o of e.blocks)r[o.header]=c(t,o,n);return r}function c(t,e,n){return function(t,e,n){const r=Object.create(null);for(const o of Object.keys(t))r[o]=y(o,t[o],e,n);return o.Wm.ofTables(e.header,t,r)}(t,e,n)}function l(t,e){return new p(e,t,!0)}function d(t){switch(t.valueType){case"str":return(e,n,r)=>{return o=t,i=e,s=e.str,a=e.toStringArray,{schema:o,__array:i.__array,isDefined:i.isDefined,rowCount:i.rowCount,value:"lowercase"===o.transform?t=>s(t).toLowerCase():"uppercase"===o.transform?t=>s(t).toUpperCase():s,valueKind:i.valueKind,areValuesEqual:i.areValuesEqual,toArray:"lowercase"===o.transform?t=>Array.from(a(t)).map(t=>t.toLowerCase()):"uppercase"===o.transform?t=>Array.from(a(t)).map(t=>t.toUpperCase()):a};var o,i,s,a};case"int":return(e,n,r)=>f(t,e,e.int,e.toIntArray);case"float":return(e,n,r)=>f(t,e,e.float,e.toFloatArray);case"list":throw new Error("Use createListColumn instead.");case"tensor":throw new Error("Use createTensorColumn instead.")}}function f(t,e,n,r){return{schema:t,__array:e.__array,isDefined:e.isDefined,rowCount:e.rowCount,value:n,valueKind:e.valueKind,areValuesEqual:e.areValuesEqual,toArray:r}}function m(t,e,n){const r=t.separator,i=t.itemParse,a=e.getField(n),u=a?t=>a.str(t).split(r).map(t=>i(t.trim())).filter(t=>!!t):t=>[];return{schema:t,__array:void 0,isDefined:!!a,rowCount:e.rowCount,value:u,valueKind:a?a.valueKind:()=>o.VP.ValueKinds.NotPresent,areValuesEqual:(t,e)=>(0,s.af)(u(t),u(e)),toArray:t=>o.iu.createAndFillArray(e.rowCount,u,t)}}function h(t,e,n){const r=t.space,s=e.fieldNames.includes(`${n}[0]`)||e.fieldNames.includes(`${n}[0][0]`)||e.fieldNames.includes(`${n}[0][0][0]`),u=s?0:1,c=e.fieldNames.includes(`${n}_1`)||e.fieldNames.includes(`${n}_11`)||e.fieldNames.includes(`${n}_111`)?"underscore":"brackets",l=a.G(n,r.rank,s,c),d=e.getField(l(u,u,u))||o.VP.Undefined(e.rowCount,t),f=t=>a.cS(e,r,t,l);return{schema:t,__array:void 0,isDefined:d.isDefined,rowCount:e.rowCount,value:f,valueKind:d.valueKind,areValuesEqual:(t,e)=>i.qY.areEqualExact(f(t),f(e)),toArray:t=>o.iu.createAndFillArray(e.rowCount,f,t)}}!function(t){function e(t){return t.replace(".","_").replace(/\[/,"_").replace(/(\[|\])/g,"")}t.canonical=e,t.equal=function(t,n){return e(t)===e(n)},t.create=function(t,n,r=!1){const o=`${t}${n?`.${n}`:""}`;return r?e(o):o}}(r||(r={}));class p{constructor(t,e,n){this._isDefined=n;const r=Object.keys(e);this._rowCount=t.rowCount,this._columns=r,this._schema=e;const i=Object.create(null);for(const s of r)Object.defineProperty(this,s,{get:function(){if(i[s])return i[s];const n=e[s];if("list"===n.valueType)i[s]=m(n,t,s);else if("tensor"===n.valueType)i[s]=h(n,t,s);else{const e=d(n),r=t.getField(s);i[s]=r?e(r,t,s):o.VP.Undefined(t.rowCount,n)}return i[s]},enumerable:!0,configurable:!1})}}function g(t,e,n,o){const i=r.create(e,t),s=r.canonical(i);if(s in n)return n[s];if(o&&i in o)for(const a of o[i]){const t=r.canonical(a);if(t in n)return n[t]}}function y(t,e,n,o){let i=n.categories[t];if(o){const s=function(t){const e=Object.create(null);for(const n of Object.keys(t.categories))for(const o of t.categories[n].fieldNames)e[r.create(n,o,!0)]=t.categories[n].getField(o);return e}(n),a=Object.create(null),u=[];let c=0;for(const n of Object.keys(e)){const e=g(n,t,s,o);e&&(a[n]=e,u.push(n),c=e.rowCount)}i={rowCount:c,name:t,fieldNames:[...u],getField(t){return a[t]}}}return new p(i||a.xA.empty(t),e,!!i)}},59859:function(t,e,n){n.d(e,{e:function(){return o},v:function(){return i}});var r=n(51142);function o(t){return t}!function(t){t.getUUID=function(t){return t.__key||(t.__key=r.kk.create22()),t.__key}}(o||(o={}));class i{constructor(){this._list=[],this._set=new Set,this._refs=new Map,this._assets=new Map}get all(){return this._list}add(t){this._set.has(t)||(this._list.push(t),this._set.add(t))}reference(t,e){let n=this._refs.get(t)||0;n+=e?1:-1,this._refs.set(t,Math.max(n,0))}hasReference(t){return(this._refs.get(t)||0)>0}has(t){return this._set.has(t)}assets(t,e){const n=this._assets.get(t);if(n)for(const r of n)r.dispose();e?this._assets.set(t,e):this._assets.delete(t)}dispose(){this._assets.forEach(t=>{for(const e of t)e.dispose()})}}},60771:function(t,e,n){n.d(e,{D:function(){return s}});var r=n(65533),o=n(46291),i=n(98537);function s(){return s.zero()}!function(t){function e(){return{min:(0,i.e)(),max:(0,i.e)()}}function n(t,e){return i.e.copy(t.min,e.min),i.e.copy(t.max,e.max),t}t.create=function(t,e){return{min:t,max:e}},t.zero=e,t.copy=n,t.set=function(t,e,n){return i.e.copy(t.min,e),i.e.copy(t.max,n),t},t.clone=function(t){return n(e(),t)};const s=(0,i.e)();function a(t,e){for(let n=0,r=e.length;n<r;n++)f(t,e[n]);return t}function u(t,e){return d(t),a(t,e),t}function c(t,e){return i.e.sub(t,e.max,e.min)}t.fromSphere3D=function(t,e){return o.f.hasExtrema(e)&&e.extrema.length>=14?u(t,e.extrema):(i.e.set(s,e.radius,e.radius,e.radius),i.e.sub(t.min,e.center,s),i.e.add(t.max,e.center,s),t)},t.addVec3Array=a,t.fromVec3Array=u,t.addSphere3D=function(t,e){return o.f.hasExtrema(e)&&e.extrema.length>=14?a(t,e.extrema):(f(t,i.e.subScalar(s,e.center,e.radius)),f(t,i.e.addScalar(s,e.center,e.radius)),t)},t.addBox3D=function(t,e){return f(t,e.min),f(t,e.max),t},t.intersectsSphere3D=function(t,e){return i.e.clamp(s,e.center,t.min,t.max),i.e.squaredDistance(s,e.center)<=e.radius*e.radius},t.computeBounding=function(t){const e=i.e.create(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),n=i.e.create(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),{x:o,y:s,z:a,indices:u}=t;for(let i=0,c=r.CD.size(u);i<c;i++){const t=r.CD.getAt(u,i);e[0]=Math.min(o[t],e[0]),e[1]=Math.min(s[t],e[1]),e[2]=Math.min(a[t],e[2]),n[0]=Math.max(o[t],n[0]),n[1]=Math.max(s[t],n[1]),n[2]=Math.max(a[t],n[2])}return{min:e,max:n}},t.size=c;const l=(0,i.e)();function d(t){return i.e.set(t.min,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),i.e.set(t.max,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),t}function f(t,e){return i.e.min(t.min,t.min,e),i.e.max(t.max,t.max,e),t}t.volume=function(t){return c(l,t),l[0]*l[1]*l[2]},t.setEmpty=d,t.add=f,t.expand=function(t,e,n){return i.e.sub(t.min,e.min,n),i.e.add(t.max,e.max,n),t},t.expandUniformly=function(t,e,n){return i.e.subScalar(t.min,e.min,n),i.e.addScalar(t.max,e.max,n),t},t.scale=function(t,e,n){return i.e.scale(t.min,e.min,n),i.e.scale(t.max,e.max,n),t};const m=(0,i.e)();t.transform=function(t,e,n){const[r,o,s]=e.min,[a,u,c]=e.max;return d(t),f(t,i.e.transformMat4(m,i.e.set(m,r,o,s),n)),f(t,i.e.transformMat4(m,i.e.set(m,r,o,c),n)),f(t,i.e.transformMat4(m,i.e.set(m,r,u,s),n)),f(t,i.e.transformMat4(m,i.e.set(m,r,u,c),n)),f(t,i.e.transformMat4(m,i.e.set(m,a,o,s),n)),f(t,i.e.transformMat4(m,i.e.set(m,a,o,c),n)),f(t,i.e.transformMat4(m,i.e.set(m,a,u,s),n)),f(t,i.e.transformMat4(m,i.e.set(m,a,u,c),n)),t},t.containsVec3=function(t,e){return!(e[0]<t.min[0]||e[0]>t.max[0]||e[1]<t.min[1]||e[1]>t.max[1]||e[2]<t.min[2]||e[2]>t.max[2])},t.overlaps=function(t,e){return!(t.max[0]<e.min[0]||t.min[0]>e.max[0]||t.max[1]<e.min[1]||t.min[1]>e.max[1]||t.max[2]<e.min[2]||t.min[2]>e.max[2])},t.containsSphere3D=function(t,e){const n=e.center,r=e.radius;return!(n[0]-r<t.min[0]||n[0]+r>t.max[0]||n[1]-r<t.min[1]||n[1]+r>t.max[1]||n[2]-r<t.min[2]||n[2]+r>t.max[2])},t.center=function(t,e){return i.e.center(t,e.max,e.min)},t.exactEquals=function(t,e){return i.e.exactEquals(t.min,e.min)&&i.e.exactEquals(t.max,e.max)},t.equals=function(t,e){return i.e.equals(t.min,e.min)&&i.e.equals(t.max,e.max)}}(s||(s={}))},61198:function(t,e,n){function r(t,e,n,r){return{type:t,key:e,elements:n,getIndex:r}}n.d(e,{M:function(){return r}})},61217:function(t,e,n){n.d(e,{W:function(){return r}});var r,o=n(27125),i=n(26511),s=n(59859),a=n(75434);!function(t){function e(t){if(!i.K4.is(t.sourceData))return!1;const{pdbx_sifts_xref_db_name:e,pdbx_sifts_xref_db_acc:n,pdbx_sifts_xref_db_num:r,pdbx_sifts_xref_db_res:o}=t.sourceData.data.db.atom_site;return e.isDefined&&n.isDefined&&r.isDefined&&o.isDefined}function n(t){if(!i.K4.is(t.sourceData))return;const{pdbx_sifts_xref_db_name:e,pdbx_sifts_xref_db_acc:n,pdbx_sifts_xref_db_num:r,pdbx_sifts_xref_db_res:s}=t.sourceData.data.db.atom_site;if(!(e.isDefined&&n.isDefined&&r.isDefined&&s.isDefined))return;const{atomSourceIndex:a}=t.atomicHierarchy,{count:u,offsets:c}=t.atomicHierarchy.residueAtomSegments,l=new Array(u),d=new Array(u),f=new Array(u),m=new Array(u);for(let i=0;i<u;i++){const t=a.value(c[i]);e.valueKind(t)===o.VP.ValueKinds.Present?(l[i]=e.value(t),d[i]=n.value(t),f[i]=r.value(t),m[i]=s.value(t)):(l[i]="",d[i]="",f[i]="",m[i]="")}return{dbName:l,accession:d,num:f,residue:m}}t.Provider=a._.createProvider({label:"SIFTS Mapping",descriptor:(0,s.e)({name:"sifts_sequence_mapping"}),type:"static",defaultParams:{},getParams:()=>({}),isApplicable:t=>e(t),obtain:async(t,e)=>({value:n(e)})}),t.isAvailable=e,t.getKey=function(e){const n=e.unit.model,r=t.Provider.get(n).value;if(!r)return"";const o=n.atomicHierarchy.residueAtomSegments.index[e.element];return r.accession[o]},t.getLabel=function(e){const n=e.unit.model,r=t.Provider.get(n).value;if(!r)return;const o=n.atomicHierarchy.residueAtomSegments.index[e.element],i=r.dbName[o];return i?`${i} ${r.accession[o]} ${r.num[o]} ${r.residue[o]}`:void 0}}(r||(r={}))},62020:function(t,e,n){n.d(e,{h:function(){return r}});var r,o=n(12606),i=n(90790),s=n(87504);function a(t){const e=s.X.ofSortedArray(t),n=s.X.max(e),r=new Int32Array(n);for(let o=0,i=t.length-1;o<i;o++)for(let e=t[o],n=t[o+1];e<n;e++)r[e]=o;return{offsets:e,index:r,count:t.length-1}}function u(t,e){const n=i.I.start(e),r=new Int32Array(t.length+1);for(let o=0,i=t.length;o<i;o++)r[o]=t[o]-n;return r[t.length]=i.I.end(e)-n,a(r)}function c({count:t}){return t}function l({index:t},e){return t[e]}function d({offsets:t},e,n){const r=n>=o.C.max(t)?-1:o.C.findPredecessorIndex(t,n-1);return o.C.findRange(e,o.C.getAt(t,r),o.C.getAt(t,r+1)-1)}class f{move(){for(;this.hasNext;){if(this.updateValue()){this.value.index=this.segmentMin++,this.hasNext=this.segmentMax>=this.segmentMin&&i.I.size(this.setRange)>0;break}this.updateSegmentRange()}return this.value}updateValue(){const t=this.segments[this.segmentMin+1],e=o.C.findPredecessorIndexInInterval(this.set,t,this.setRange);return this.value.start=i.I.start(this.setRange),this.value.end=e,this.setRange=i.I.ofBounds(e,i.I.end(this.setRange)),e>this.value.start}updateSegmentRange(){const t=i.I.min(this.setRange),e=i.I.max(this.setRange);e<t?this.hasNext=!1:(this.segmentMin=this.segmentMap[o.C.getAt(this.set,t)],this.segmentMax=this.segmentMap[o.C.getAt(this.set,e)],this.hasNext=this.segmentMax>=this.segmentMin)}setSegment(t){this.setRange=i.I.ofBounds(t.start,t.end),this.updateSegmentRange()}constructor(t,e,n,r){this.segments=t,this.segmentMap=e,this.set=n,this.segmentMin=0,this.segmentMax=0,this.setRange=i.I.Empty,this.value={index:0,start:0,end:0},this.hasNext=!1,this.setRange=r,this.updateSegmentRange()}}function m(t,e,n){const r=void 0!==n?i.I.ofBounds(n.start,n.end):i.I.ofBounds(0,o.C.size(e));return new f(t.offsets,t.index,e,r)}!function(t){t.create=a,t.ofOffsets=u,t.count=c,t.getSegment=l,t.projectValue=d,t.transientSegments=m}(r||(r={}))},62601:function(t,e,n){n.d(e,{f:function(){return u}});class r{move(){return++this.index,this.lastValue=this.xs[this.index],this.hasNext=this.index<this.length-1,this.lastValue}constructor(t){this.xs=[],this.index=-1,this.length=0,this.hasNext=!1,this.length=t.length,this.hasNext=t.length>0,this.xs=t,this.index=-1,this.lastValue=t.length>0?t[0]:void 0}}class o{move(){return++this.value,this.hasNext=this.value<this.max,this.value}constructor(t,e){this.max=e,this.value=0,this.hasNext=!1,this.value=t-1,this.hasNext=e>=t}}class i{move(){return this.hasNext=!1,this.value}constructor(t){this.value=t,this.hasNext=!0}}class s{move(){const t=this.f(this.base.move());return this.hasNext=this.base.hasNext,t}constructor(t,e){this.base=t,this.f=e,this.hasNext=!1,this.hasNext=t.hasNext}}class a{move(){const t=this.next;return this.hasNext=this.findNext(),t}findNext(){for(;this.base.hasNext;)if(this.next=this.base.move(),this.p(this.next))return!0;return!1}constructor(t,e){this.base=t,this.p=e,this.hasNext=this.findNext()}}var u;!function(t){t.Empty=new o(0,-1),t.Array=function(t){return new r(t)},t.Value=function(t){return new i(t)},t.Range=function(t,e){return new o(t,e)},t.map=function(t,e){return new s(t,e)},t.filter=function(t,e){return new a(t,e)},t.forEach=function(t,e,n){for(;t.hasNext;){if(e(t.move(),n))return n}return n}}(u||(u={}))},62683:function(t,e,n){n.d(e,{Bm:function(){return u},EX:function(){return s},d3:function(){return r},ef:function(){return i},vy:function(){return a}});var r,o=n(50669);function i(t,e){const{description:n,isOptional:r=!1,isRest:o=!1,defaultValue:i}=e||{};return{type:t,isOptional:r,isRest:o,defaultValue:i,description:n}}function s(t,e,n,r){const i=function(t){return o.r.Apply(o.r.Symbol(i.id),t)};return i.info={namespace:"",name:t,description:r},i.id="",i.args=e,i.type=n,i}function a(t,e,n,i){const s=function(t){return o.r.Apply(o.r.Symbol(s.id),t)};return s.info={namespace:t,name:e,description:i},s.id=`${t}.${e}`,s.args=r.None,s.type=n,s}function u(t){const e=t;return"function"==typeof e&&!!e.info&&!!e.args&&"string"==typeof e.info.namespace&&!!e.type}!function(t){function e(t){return{kind:"dictionary",map:t,"@type":0}}t.None=e({}),t.Dictionary=e,t.List=function(t,e){const{nonEmpty:n=!1}=e||{};return{kind:"list",type:t,nonEmpty:n,"@type":0}}}(r||(r={}))},62769:function(t,e,n){n.d(e,{c:function(){return D}});var r,o,i,s=n(27125),a=n(38328),u=n(62601),c=n(18593),l=n(99487);function d(t){return(e,n)=>n[t].value(e)}function f(t){return(e,n)=>n[t].value(e).join(n[t].schema.separator)}function m(t,...e){return(n,r)=>r[t].schema.space.get(r[t].value(n),...e)}function h(t){return(e,n)=>n[t].valueKind(e)}function p(t,e){const n=[],o=r.Type.Float,i=h(t);if(1===e.rank){const r=e.dimensions[0];for(let e=0;e<r;e++){const r=`${t}[${e+1}]`;n.push({name:r,type:o,value:m(t,e),valueKind:i})}}else if(2===e.rank){const r=e.dimensions[0],s=e.dimensions[1];for(let e=0;e<r;e++)for(let r=0;r<s;r++){const s=`${t}[${e+1}][${r+1}]`;n.push({name:s,type:o,value:m(t,e,r),valueKind:i})}}else{if(3!==e.rank)throw new Error("Tensors with rank > 3 or rank 0 are currently not supported.");{const r=e.dimensions[0],s=e.dimensions[1],a=e.dimensions[2];for(let e=0;e<r;e++)for(let r=0;r<s;r++)for(let s=0;s<a;s++){const a=`${t}[${e+1}][${r+1}][${s+1}]`;n.push({name:a,type:o,value:m(t,e,r,s),valueKind:i})}}}return n}function g(t){const e=[];for(const n of Object.keys(t)){const o=t[n];"int"===o.valueType?e.push({name:n,type:r.Type.Int,value:d(n),valueKind:h(n)}):"float"===o.valueType?e.push({name:n,type:r.Type.Float,value:d(n),valueKind:h(n)}):"str"===o.valueType?e.push({name:n,type:r.Type.Str,value:d(n),valueKind:h(n)}):"list"===o.valueType?e.push({name:n,type:r.Type.Str,value:f(n),valueKind:h(n)}):"tensor"===o.valueType?e.push(...p(n,o.space)):(0,l.dr)(o.valueType)}return e}!function(t){let e;function n(t,n,r){return{name:t,type:e.Int,value:n,valueKind:r&&r.valueKind,defaultFormat:r?{encoder:r.encoder,typedArray:r.typedArray}:void 0,shouldInclude:r&&r.shouldInclude}}!function(t){t[t.Str=0]="Str",t[t.Int=1]="Int",t[t.Float=2]="Float"}(e=t.Type||(t.Type={})),t.str=function(t,n,r){return{name:t,type:e.Str,value:n,valueKind:r&&r.valueKind,defaultFormat:r&&r.encoder?{encoder:r.encoder}:void 0,shouldInclude:r&&r.shouldInclude}},t.int=n,t.float=function(t,n,r){return{name:t,type:e.Float,value:n,valueKind:r&&r.valueKind,defaultFormat:r?{encoder:r.encoder,typedArray:r.typedArray,digitCount:void 0!==r.digitCount?r.digitCount:void 0}:void 0,shouldInclude:r&&r.shouldInclude}},t.index=function(t){return n(t,(t,e,n)=>n+1,{typedArray:Int32Array,encoder:c.ND.by(c.ND.delta).and(c.ND.runLength).and(c.ND.integerPacking)})};class r{constructor(){this.fields=[]}index(e){return this.fields.push(t.index(e)),this}str(e,n,r){return this.fields.push(t.str(e,n,r)),this}int(e,n,r){return this.fields.push(t.int(e,n,r)),this}vec(e,n,r){for(let o=0;o<n.length;o++)this.fields.push(t.int(`${e}[${o+1}]`,n[o],r));return this}float(e,n,r){return this.fields.push(t.float(e,n,r)),this}many(t){for(let e=0;e<t.length;e++)this.fields.push(t[e]);return this}add(t){return this.fields.push(t),this}getFields(){return this.fields}}t.Builder=r,t.build=function(){return new r}}(r||(r={})),function(t){t.Empty={fields:[],source:[]},t.filterOf=function(t){const e=[],n=[],r=[],o=[];for(let s of t.split(/[\r\n]+/)){if(s=s.trim(),0===s.length)continue;const t=/^!/.test(s);t&&(s=s.substr(1));const i=s.split(/\./),a=i[1],u=t?a?o:n:a?r:e;u[u.length]=s,a&&!e.includes(i[0])&&(e[e.length]=i[0])}const i=r.map(t=>t.split(".")[0]);return{includeCategory(t){return!n.includes(t)&&(e.length<=0||-1!==e.indexOf(t))},includeField(t,e){const n=t+"."+e;return!o.includes(n)&&(!i.includes(t)||r.includes(n))}}},t.DefaultFilter={includeCategory(t){return!0},includeField(t,e){return!0}},t.DefaultFormatter={getFormat(t,e){}},t.ofTable=function(t,e){return e?{fields:g(t._schema),source:[{data:t,rowCount:e.length,keys:()=>u.f.Array(e)}]}:{fields:g(t._schema),source:[{data:t,rowCount:t._rowCount}]}}}(o||(o={})),function(t){function e(t,e,n){t.startDataBlock(e);for(const r of n._tableNames)t.writeCategory({name:r,instance:()=>o.ofTable(n[r])})}t.writeDatabase=e,t.writeDatabaseCollection=function(t,n){for(const r of Object.keys(n))e(t,r,n[r])}}(i||(i={}));n(65533),n(38530),n(54135);function y(t){return t.defaultFormat&&void 0!==t.defaultFormat.digitCount?Math.max(0,Math.min(t.defaultFormat.digitCount,16)):6}function _(t){return t.fields.some(t=>!!t.shouldInclude)?t.fields.filter(e=>!e.shouldInclude||t.source.some(t=>e.shouldInclude(t.data))):t.fields}function A(t,e){const n=t.instance(e),r=n.source.filter(t=>t.rowCount>0);if(!r.length)return{instance:n,rowCount:0,source:[]};return{instance:n,rowCount:r.reduce((t,e)=>t+e.rowCount,0),source:r.map(t=>({data:t.data,keys:()=>t.keys?t.keys():u.f.Range(0,t.rowCount-1),rowCount:t.rowCount}))}}class b{constructor(){this.builder=a.f.create(),this.encoded=!1,this.dataBlockCreated=!1,this.filter=o.DefaultFilter,this.formatter=o.DefaultFormatter,this.isBinary=!1,this.binaryEncodingProvider=void 0}setFilter(t){this.filter=t||o.DefaultFilter}isCategoryIncluded(t){return this.filter.includeCategory(t)}setFormatter(t){this.formatter=t||o.DefaultFormatter}startDataBlock(t){this.dataBlockCreated=!0,a.f.write(this.builder,`data_${(t||"").replace(/[ \n\t]/g,"").toUpperCase()}\n#\n`)}writeCategory(t,e,n){if(this.encoded)throw new Error("The writer contents have already been encoded, no more writing.");if(!this.dataBlockCreated)throw new Error("No data block created.");if(!(null==n?void 0:n.ignoreFilter)&&!this.filter.includeCategory(t.name))return;const{instance:r,rowCount:i,source:s}=A(t,e);i&&(1===i?function(t,e,n,r,o,i){const s=_(e),u=n[0],c=u.data;let l=s.reduce((e,n)=>o.includeField(t.name,n.name)?Math.max(e,n.name.length):0,0);if(0===l)return;l+=t.name.length+6;const d=u.keys().move(),f=S(t.name,e.fields,i);for(let m=0;m<s.length;m++){const e=s[m];if(!o.includeField(t.name,e.name))continue;a.f.writePadRight(r,`_${t.name}.${e.name}`,l);C(r,c,d,e,f[m],0)||a.f.newline(r)}a.f.write(r,"#\n")}(t,r,s,this.builder,this.filter,this.formatter):function(t,e,n,r,i,s){const u=_(e),c=i===o.DefaultFilter?u:u.filter(e=>i.includeField(t.name,e.name)),l=c.length;if(0===l)return;const d=S(t.name,c,s);x(r,"loop_");for(let o=0;o<l;o++)x(r,`_${t.name}.${c[o].name}`);let f=0;for(let o=0;o<n.length;o++){const t=n[o],e=t.data;if(0===t.rowCount)continue;const i=t.keys();for(;i.hasNext;){const t=i.move();let n=!1;for(let o=0;o<l;o++)n=C(r,e,t,c[o],d[o],f);n||a.f.newline(r),f++}}a.f.write(r,"#\n")}(t,r,s,this.builder,this.filter,this.formatter))}encode(){this.encoded=!0}writeTo(t){const e=a.f.getChunks(this.builder);for(let n=0,r=e.length;n<r;n++)t.writeString(e[n])}getSize(){return a.f.getSize(this.builder)}getData(){return a.f.getString(this.builder)}}function C(t,e,n,o,i,u){const c=o.valueKind,l=c?c(n,e):s.VP.ValueKinds.Present;if(l!==s.VP.ValueKinds.Present)l===s.VP.ValueKinds.NotPresent?function(t){a.f.writeSafe(t,". ")}(t):function(t){a.f.writeSafe(t,"? ")}(t);else{const s=o.value(n,e,u),c=o.type;if(c===r.Type.Str)return"string"==typeof(d=s)&&d.indexOf("\n")>=0?(v(t,s),!0):function(t,e){if(!e)return a.f.writeSafe(t,". "),!1;const n=e.charCodeAt(0);let r=!1,o=0,i=!1,s=!1;for(let a=0,u=e.length-1;a<=u;a++){switch(e.charCodeAt(a)){case 9:case 32:r=!0;break;case 10:return v(t,e),!0;case 34:if(a&&a===u)break;if(i)return v(t,e),!0;s=!0,r=!0,o=0;break;case 39:if(a&&a===u)break;if(s)return v(t,e),!0;i=!0,r=!0,o=1}}r||35!==n&&36!==n&&59!==n&&91!==n&&93!==n&&95!==n||(r=!0);r?(a.f.writeSafe(t,o?'"':"'"),a.f.writeSafe(t,e),a.f.writeSafe(t,o?'" ':"' ")):(a.f.writeSafe(t,e),a.f.writeSafe(t," "));return!1}(t,s);c===r.Type.Int?function(t,e){a.f.writeInteger(t,e),a.f.whitespace1(t)}(t,s):function(t,e,n){a.f.writeFloat(t,e,n),a.f.whitespace1(t)}(t,s,i)}var d;return!1}function S(t,e,n){const o=[];for(const i of e){const e=n.getFormat(t,i.name);e&&void 0!==e.digitCount?o[o.length]=i.type===r.Type.Float?Math.pow(10,Math.max(0,Math.min(e.digitCount,15))):0:o[o.length]=i.type===r.Type.Float?Math.pow(10,y(i)):0}return o}function x(t,e){a.f.write(t,e),a.f.newline(t)}function v(t,e){a.f.writeSafe(t,"\n;"+e),a.f.writeSafe(t,"\n;\n")}var B=n(86242);function I(t){const e=new ArrayBuffer(w(t)),n=new DataView(e),r=new Uint8Array(e);return P(t,n,r,0),r}function w(t){const e=typeof t;if("string"===e){const e=(0,B.VH)(t);if(e<32)return 1+e;if(e<256)return 2+e;if(e<65536)return 3+e;if(e<4294967296)return 5+e}if(t instanceof Uint8Array){const e=t.byteLength;if(e<256)return 2+e;if(e<65536)return 3+e;if(e<4294967296)return 5+e}if("number"===e){if(Math.floor(t)!==t)return 9;if(t>=0){if(t<128)return 1;if(t<256)return 2;if(t<65536)return 3;if(t<4294967296)return 5;throw new Error("Number too big 0x"+t.toString(16))}if(t>=-32)return 1;if(t>=-128)return 2;if(t>=-32768)return 3;if(t>=-2147483648)return 5;throw new Error("Number too small -0x"+t.toString(16).substr(1))}if("boolean"===e||null==t)return 1;if("object"===e){let e,n=0;if(Array.isArray(t)){e=t.length;for(let r=0;r<e;r++)n+=w(t[r])}else{const r=Object.keys(t);e=r.length;for(let o=0;o<e;o++){const e=r[o];n+=w(e)+w(t[e])}}if(e<16)return 1+n;if(e<65536)return 3+n;if(e<4294967296)return 5+n;throw new Error("Array or object too long 0x"+e.toString(16))}throw new Error("Unknown type "+e)}function P(t,e,n,r){const o=typeof t;if("string"===o){const o=(0,B.VH)(t);if(o<32)return e.setUint8(r,160|o),(0,B.rj)(n,r+1,t),1+o;if(o<256)return e.setUint8(r,217),e.setUint8(r+1,o),(0,B.rj)(n,r+2,t),2+o;if(o<65536)return e.setUint8(r,218),e.setUint16(r+1,o),(0,B.rj)(n,r+3,t),3+o;if(o<4294967296)return e.setUint8(r,219),e.setUint32(r+1,o),(0,B.rj)(n,r+5,t),5+o}if(t instanceof Uint8Array){const n=t.byteLength,o=new Uint8Array(e.buffer);if(n<256)return e.setUint8(r,196),e.setUint8(r+1,n),o.set(t,r+2),2+n;if(n<65536)return e.setUint8(r,197),e.setUint16(r+1,n),o.set(t,r+3),3+n;if(n<4294967296)return e.setUint8(r,198),e.setUint32(r+1,n),o.set(t,r+5),5+n}if("number"===o){if(!isFinite(t))throw new Error("Number not finite: "+t);if(Math.floor(t)!==t)return e.setUint8(r,203),e.setFloat64(r+1,t),9;if(t>=0){if(t<128)return e.setUint8(r,t),1;if(t<256)return e.setUint8(r,204),e.setUint8(r+1,t),2;if(t<65536)return e.setUint8(r,205),e.setUint16(r+1,t),3;if(t<4294967296)return e.setUint8(r,206),e.setUint32(r+1,t),5;throw new Error("Number too big 0x"+t.toString(16))}if(t>=-32)return e.setInt8(r,t),1;if(t>=-128)return e.setUint8(r,208),e.setInt8(r+1,t),2;if(t>=-32768)return e.setUint8(r,209),e.setInt16(r+1,t),3;if(t>=-2147483648)return e.setUint8(r,210),e.setInt32(r+1,t),5;throw new Error("Number too small -0x"+(-t).toString(16).substr(1))}if(null==t)return e.setUint8(r,192),1;if("boolean"===o)return e.setUint8(r,t?195:194),1;if("object"===o){let o,i=0;const s=Array.isArray(t);let a;if(s?o=t.length:(a=Object.keys(t),o=a.length),o<16?(e.setUint8(r,o|(s?144:128)),i=1):o<65536?(e.setUint8(r,s?220:222),e.setUint16(r+1,o),i=3):o<4294967296&&(e.setUint8(r,s?221:223),e.setUint32(r+1,o),i=5),s)for(let u=0;u<o;u++)i+=P(t[u],e,n,r+i);else for(let u=0,c=a.length;u<c;u++){const o=a[u];i+=P(o,e,n,r+i),i+=P(t[o],e,n,r+i)}return i}throw new Error("Unknown type "+o)}var D,M=n(37631);class N{setFilter(t){this.filter=t||o.DefaultFilter}isCategoryIncluded(t){return this.filter.includeCategory(t)}setFormatter(t){this.formatter=t||o.DefaultFormatter}startDataBlock(t){this.dataBlocks.push({header:(t||"").replace(/[ \n\t]/g,"").toUpperCase(),categories:[]})}writeCategory(t,e,n){if(!this.data)throw new Error("The writer contents have already been encoded, no more writing.");if(!this.dataBlocks.length)throw new Error("No data block created.");if(!(null==n?void 0:n.ignoreFilter)&&!this.filter.includeCategory(t.name))return;const{instance:r,rowCount:o,source:i}=A(t,e);if(!o)return;const s={name:"_"+t.name,columns:[],rowCount:o},a=_(r);for(const u of a){if(!this.filter.includeField(t.name,u.name))continue;const e=this.formatter.getFormat(t.name,u.name);s.columns.push(E(t.name,u,i,o,e,this.binaryEncodingProvider,this.autoClassify))}s.columns.length&&this.dataBlocks[this.dataBlocks.length-1].categories.push(s)}encode(){this.encodedData||(this.encodedData=I(this.data),this.data=null,this.dataBlocks=null)}writeTo(t){t.writeBinary(this.encodedData)}getData(){return this.encode(),this.encodedData}getSize(){return this.encodedData.length}constructor(t,e,n){this.autoClassify=n,this.dataBlocks=[],this.filter=o.DefaultFilter,this.formatter=o.DefaultFormatter,this.isBinary=!0,this.binaryEncodingProvider=void 0,this.binaryEncodingProvider=e,this.data={encoder:t,version:c.xv,dataBlocks:this.dataBlocks}}}function E(t,e,n,o,i,a,u){const{array:l,allPresent:d,mask:f}=function(t,e,n,o){const i=t.type===r.Type.Str,a=new e(n),u=new Uint8Array(n),c=t.valueKind,l=t.value;let d=!0,f=0;for(let r=0;r<o.length;r++){const t=o[r].data,e=o[r].keys();for(;e.hasNext;){const n=e.move(),r=c?c(n,t):s.VP.ValueKinds.Present;if(r!==s.VP.ValueKinds.Present)u[f]=r,i&&(a[f]=""),d=!1;else{const e=l(n,t,f);"string"!=typeof e||e?u[f]=s.VP.ValueKinds.Present:(u[f]=s.VP.ValueKinds.NotPresent,d=!1),a[f]=e}f++}}return{array:a,allPresent:d,mask:u}}(e,function(t,e){return e&&e.typedArray?e.typedArray:t.defaultFormat&&t.defaultFormat.typedArray?t.defaultFormat.typedArray:t.type===r.Type.Str?Array:t.type===r.Type.Int?Int32Array:Float64Array}(e,i),o,n);let m;m=e.type===r.Type.Str?c.ar.by(c.ND.stringArray):function(t,e,n,r){return n&&n.encoder?n.encoder:e.defaultFormat&&e.defaultFormat.encoder?e.defaultFormat.encoder:r?r.get(t,e.name):void 0}(t,e,i,a),m||(u?m=function(t,e){return t===r.Type.Str?c.ar.by(c.ND.stringArray):t===r.Type.Int?(0,M.P)(e):(0,M.O)(e)}(e.type,l):m=e.type===r.Type.Str?c.ar.by(c.ND.stringArray):c.ar.by(c.ND.byteArray));const h=m.encode(l);let p;if(!d){const t=c.ar.by(c.ND.runLength).and(c.ND.byteArray).encode(f);p=t.data.length<f.length?t:c.ar.by(c.ND.byteArray).encode(f)}return{name:e.name,data:h,mask:p}}!function(t){t.Encoder=i,t.Category=o,t.Field=r,t.Encoding=c.ND,t.createEncoder=function(t){const{binary:e=!1,encoderName:n="mol*"}=t||{};return e?new N(n,t?t.binaryEncodingPovider:void 0,!!t&&!!t.binaryAutoClassifyEncoding):new b},t.fields=function(){return t.Field.build()};var e=t.Encoding;function n(t){const n=t.precision;if(void 0!==n){const r=Math.pow(10,n),o=e.by(e.fixedPoint(r));switch(t.encoding){case"pack":return o.and(e.integerPacking);case"rle":return o.and(e.runLength).and(e.integerPacking);case"delta":return o.and(e.delta).and(e.integerPacking);case"delta-rle":return o.and(e.delta).and(e.runLength).and(e.integerPacking)}}else switch(t.encoding){case"pack":return e.by(e.integerPacking);case"rle":return e.by(e.runLength).and(e.integerPacking);case"delta":return e.by(e.delta).and(e.integerPacking);case"delta-rle":return e.by(e.delta).and(e.runLength).and(e.integerPacking)}throw new Error("cannot be reached")}t.Encodings={deltaRLE:e.by(e.delta).and(e.runLength).and(e.integerPacking),fixedPoint2:e.by(e.fixedPoint(100)).and(e.delta).and(e.integerPacking),fixedPoint3:e.by(e.fixedPoint(1e3)).and(e.delta).and(e.integerPacking)},t.categoryInstance=function(t,e){return{fields:t,source:[e]}},t.createEncodingProviderFromCifFrame=function(t){return{get(e,n){const r=t.categories[e];if(!r)return;const o=r.getField(n);return o&&o.binaryEncoding?c.ar.fromEncoding(o.binaryEncoding):void 0}}},t.createEncodingProviderFromJsonConfig=function(t){return{get(e,r){for(let o=0;o<t.length;o++){const i=t[o];if(i.categoryName===e&&i.columnName===r)return n(i)}}}}}(D||(D={}))},63346:function(t,e,n){n.d(e,{X:function(){return ft}});var r=n(27125),o=n(70888),i=n(21544),s=n(59859),a=n(65533),u=n(59663),c=n(46031),l=n(73868),d=n(1071),f=n(15819),m=n(52500),h=n(3108),p=n(90644);var g=n(89851),y=n(38530);function _(t,e){return e?1===e.length?(0,y.m1)(e.charCodeAt(0),t):2===e.length?(0,y.m1)(e.charCodeAt(0),(0,y.m1)(e.charCodeAt(1),t)):`${t} ${e}`:t}function A(t,e,n,r){if(t.has(e)){const o=t.get(e);o.has(n)||o.set(n,r)}else{const o=new Map;t.set(e,o),o.set(n,r)}}function b(t){throw new Error(`Missing entity entry for entity id '${t}'.`)}const C=g.or.EmptyResidueKey();class S{getEntityFromChain(t){return this.map.chain_index_entity_index[t]}findEntity(t){const e=this.map.label_asym_id.get(t);return void 0!==e?e:-1}findChainLabel(t){const e=this.entityIndex(t.label_entity_id);if(e<0||!this.map.entity_index_label_asym_id.has(e))return-1;const n=this.map.entity_index_label_asym_id.get(e);return n&&n.has(t.label_asym_id)?n.get(t.label_asym_id):-1}findChainAuth(t){if(!this.map.auth_asym_id_auth_seq_id.has(t.auth_asym_id))return-1;const e=this.map.auth_asym_id_auth_seq_id.get(t.auth_asym_id);return e.has(t.auth_seq_id)?e.get(t.auth_seq_id):-1}findResidue(t,e,n,r){let o;1===arguments.length?o=t:(C.label_entity_id=t,C.label_asym_id=e,C.auth_seq_id=n,C.pdbx_PDB_ins_code=r,o=C);const i=this.findChainLabel(o);if(i<0)return-1;const s=this.map.chain_index_auth_seq_id.get(i),a=_(o.auth_seq_id,o.pdbx_PDB_ins_code||"");return s.has(a)?s.get(a):-1}findResidueLabel(t){const e=this.findChainLabel(t);if(e<0)return-1;const n=this.map.chain_index_label_seq_id.get(e),r=_(t.label_seq_id,t.pdbx_PDB_ins_code||"");return n.has(r)?n.get(r):-1}findResidueAuth(t){const e=this.findChainAuth(t);if(e<0)return-1;const n=this.map.chain_index_auth_seq_id.get(e),r=_(t.auth_seq_id,t.pdbx_PDB_ins_code||"");return n.has(r)?n.get(r):-1}findResidueInsertion(t){const e=this.findChainLabel(t);if(e<0)return-1;const n=this.map.chain_index_label_seq_id.get(e),r=_(t.label_seq_id,t.pdbx_PDB_ins_code||"");if(n.has(r))return n.get(r);const o=a.X9.findPredecessorIndex(this.map.label_seq_id,t.label_seq_id),i=g.vE.chainStartResidueIndex(this.map.segments,e);if(o<i)return i;const s=g.vE.chainEndResidueIndexExcl(this.map.segments,e)-1;return o>=s?s:o}findAtom(t){const e=this.findResidue(t);return e<0?-1:void 0===t.label_alt_id?x(this.residueOffsets[e],this.residueOffsets[e+1],this.map.label_atom_id,t.label_atom_id):v(this.residueOffsets[e],this.residueOffsets[e+1],this.map.label_atom_id,this.map.label_alt_id,t.label_atom_id,t.label_alt_id)}findAtomAuth(t){const e=this.findResidueAuth(t);return e<0?-1:void 0===t.label_alt_id?x(this.residueOffsets[e],this.residueOffsets[e+1],this.map.auth_atom_id,t.auth_atom_id):v(this.residueOffsets[e],this.residueOffsets[e+1],this.map.auth_atom_id,this.map.label_alt_id,t.auth_atom_id,t.label_alt_id)}findAtomOnResidue(t,e,n){return void 0===n?x(this.residueOffsets[t],this.residueOffsets[t+1],this.map.label_atom_id,e):v(this.residueOffsets[t],this.residueOffsets[t+1],this.map.label_atom_id,this.map.label_alt_id,e,n)}findAtomsOnResidue(t,e){return function(t,e,n,r){for(let o=t;o<e;o++)if(r.has(n.value(o)))return o;return-1}(this.residueOffsets[t],this.residueOffsets[t+1],this.map.label_atom_id,e)}findElementOnResidue(t,e){return function(t,e,n,r){for(let o=t;o<e;o++)if(n.value(o)===r)return o;return-1}(this.residueOffsets[t],this.residueOffsets[t+1],this.map.type_symbol,e)}constructor(t){this.map=t,this.entityIndex=t.entities.getEntityIndex,this.residueOffsets=this.map.segments.residueAtomSegments.offsets}}function x(t,e,n,r){for(let o=t;o<e;o++)if(n.value(o)===r)return o;return-1}function v(t,e,n,r,o,i){for(let s=t;s<e;s++)if(n.value(s)===o&&r.value(s)===i)return s;return-1}function B(t,e,n){const r=function(t,e,n){return{entities:t,segments:n,label_seq_id:a.X9.ofSortedArray(e.residues.label_seq_id.toArray({array:Int32Array})),label_atom_id:e.atoms.label_atom_id,auth_atom_id:e.atoms.auth_atom_id,label_alt_id:e.atoms.label_alt_id,type_symbol:e.atoms.type_symbol,chain_index_entity_index:new Int32Array(e.chains._rowCount),entity_index_label_asym_id:new Map,chain_index_label_seq_id:new Map,auth_asym_id_auth_seq_id:new Map,chain_index_auth_seq_id:new Map,label_asym_id:new Map}}(e,t,n),{label_seq_id:o,auth_seq_id:i,pdbx_PDB_ins_code:s}=t.residues,{label_entity_id:u,label_asym_id:c,auth_asym_id:l}=t.chains,d=a.IX.ofBounds(0,t.atoms._rowCount),f=a.hT.transientSegments(n.chainAtomSegments,d);for(;f.hasNext;){const t=f.move(),m=t.index,h=e.getEntityIndex(u.value(m));h<0&&b(u.value(m)),r.chain_index_entity_index[m]=h;const p=l.value(m);let g=r.auth_asym_id_auth_seq_id.get(p);g||(g=new Map,r.auth_asym_id_auth_seq_id.set(p,g));const y=c.value(m);r.label_asym_id.has(y)||r.label_asym_id.set(y,h),A(r.entity_index_label_asym_id,h,y,m);const C=new Map,S=new Map;r.chain_index_label_seq_id.set(m,C),r.chain_index_auth_seq_id.set(m,S);const x=a.hT.transientSegments(n.residueAtomSegments,d,t);for(;x.hasNext;){const t=x.move().index,e=i.value(t),n=s.value(t);C.set(_(o.value(t),n),t),S.set(_(e,n),t),g.set(e,m)}}return new S(r)}var I=n(31186),w=n(26511);function P(t,e,n){const o=r.XI.ofColumns(f.wi,{type_symbol:r.VP.ofArray({array:r.VP.mapToArray(t.type_symbol,m.F1),schema:r.VP.Schema.Aliased(r.VP.Schema.str)}),label_atom_id:t.label_atom_id,auth_atom_id:t.auth_atom_id,label_alt_id:t.label_alt_id,label_comp_id:t.label_comp_id,auth_comp_id:t.auth_comp_id,pdbx_formal_charge:t.pdbx_formal_charge}),i=r.XI.view(t,f.yA,n.residues),s=r.XI.view(t,f.c1,n.chains);if(!i.label_seq_id.isDefined){const t=new Int32Array(i.label_seq_id.rowCount),{residues:e,chains:o}=n;let s=0,a=0;for(let n=0,r=t.length;n<r;++n)e[n]>=o[s+1]&&(s+=1,a=0),t[n]=++a;i.label_seq_id=r.VP.ofIntArray(t)}r.XI.columnToArray(i,"label_seq_id",Int32Array),r.XI.columnToArray(i,"auth_seq_id",Int32Array);return{atoms:o,residues:i,chains:s,atomSourceIndex:e,residueSourceIndex:function(t,e,n){const o=new Uint32Array(e);for(let r=0;r<e;r++){const i=n[r],s=r+1<e?n[r+1]:t.rowCount;let a=t.value(i);for(let e=i+1;e<s;e++){const n=t.value(e);n<a&&(a=n)}o[r]=a}const i=(0,I.y1)(e).sort((t,e)=>o[t]-o[e]);for(let r=0;r<e;r++)o[i[r]]=r;return r.VP.ofIntArray(o)}(e,n.residues.length,n.residues)}}function D(t,e,n,o,i,s){const g=function(t){if(0===t._rowCount)return{residues:[],chains:[]};const e=t._rowCount,n=[0],r=[0],{label_entity_id:o,label_asym_id:i,label_seq_id:s,auth_seq_id:a,pdbx_PDB_ins_code:u}=t;for(let c=1;c<e;c++){const t=!o.areValuesEqual(c-1,c)||!i.areValuesEqual(c-1,c);(t||!s.areValuesEqual(c-1,c)||!a.areValuesEqual(c-1,c)||!u.areValuesEqual(c-1,c))&&(n[n.length]=c),t&&(r[r.length]=c)}return{residues:n,chains:r}}(t),y=P(t,e,g),_=function(t,e){const n=new Map;if(!w.K4.is(e))return n;const{molstar_atom_site_operator_mapping:o}=(0,u.Pd)(d.mQ,e.data.frame);if(0===o._rowCount)return n;const i=new Map,s=new Map;for(let u=0;u<o._rowCount;u++){const t=o.assembly_operator_id.valueKind(u)===r.VP.ValueKinds.Present?{id:o.assembly_id.value(u),operList:[],operId:o.assembly_operator_id.value(u)}:void 0,e=c.JX.create(o.operator_name.value(u),l.$I.identity(),{assembly:t,spgrOp:o.symmetry_operator_index.valueKind(u)===r.VP.ValueKinds.Present?o.symmetry_operator_index.value(u):void 0,hkl:l.eB.ofArray(o.symmetry_hkl.value(u)),ncsId:o.ncs_id.value(u)}),n=o.suffix.value(u),a=o.label_asym_id.value(u);i.set(`${a}${n}`,{name:a,operator:e});const d=o.auth_asym_id.value(u);s.set(`${d}${n}`,d)}const{label_asym_id:a,auth_asym_id:f}=t.chains,m=new Array(a.rowCount),h=new Array(a.rowCount);for(let r=0;r<a.rowCount;r++){const t=a.value(r),e=f.value(r);if(!i.has(t)){m[r]=t,h[r]=e;continue}const{name:o,operator:u}=i.get(t);n.set(r,u),m[r]=o,h[r]=s.get(e)||e}return t.chains.label_asym_id=r.VP.ofArray({array:m,valueKind:t.chains.label_asym_id.valueKind,schema:t.chains.label_asym_id.schema}),t.chains.auth_asym_id=r.VP.ofArray({array:h,valueKind:t.chains.auth_asym_id.valueKind,schema:t.chains.auth_asym_id.schema}),n}(y,i);if(s&&(A=s.atomicHierarchy,b=y,r.XI.areEqual(A.chains,b.chains)&&r.XI.areEqual(A.residues,b.residues)&&r.XI.areEqual(A.atoms,b.atoms)))return{sameAsPrevious:!0,hierarchy:s.atomicHierarchy,chainOperatorMapping:_};var A,b;const C={residueAtomSegments:a.hT.ofOffsets(g.residues,a.IX.ofBounds(0,t._rowCount)),chainAtomSegments:a.hT.ofOffsets(g.chains,a.IX.ofBounds(0,t._rowCount))},S=B(y,n,C),x=function(t,e,n,r){const{label_comp_id:o,type_symbol:i,_rowCount:s}=t.atoms,{_rowCount:a}=t.residues,{offsets:u}=e.residueAtomSegments,c=new Uint8Array(s);for(let m=0;m<s;++m)c[m]=(0,f.PR)(i.value(m));const l=new Int32Array(a),d=new Int32Array(a),g=new Int32Array(a),y=new Uint8Array(a),_=new Uint8Array(a),A=new Map,b=new Map;for(let f=0;f<a;++f){const t=o.value(u[f]),e=r;let i,s;if(A.has(t))i=A.get(t),s=b.get(t);else{let n;e.has(t)?n=e.get(t).type:(p.Zq||console.info("chemComp not found",t),n=(0,m.ut)(t)),i=(0,m.RN)(n,t),s=(0,m.nO)(n,i),A.set(t,i),b.set(t,s)}y[f]=i,_[f]=s;const a=(0,h.HQ)(s,"trace");let c=n.findAtomsOnResidue(f,a);if(-1===c){const t=(0,h.HQ)(s,"coarseBackbone");c=n.findAtomsOnResidue(f,t),-1===c&&(0,m.z7)(i)&&(c=n.findElementOnResidue(f,(0,m.F1)("C")))}l[f]=c;const C=(0,h.HQ)(s,"directionFrom");d[f]=n.findAtomsOnResidue(f,C);const S=(0,h.HQ)(s,"directionTo");g[f]=n.findAtomsOnResidue(f,S)}return{atom:{atomicNumber:c},residue:{traceElementIndex:l,directionFromElementIndex:d,directionToElementIndex:g,moleculeType:y,polymerType:_}}}(y,C,S,o);return{sameAsPrevious:!1,hierarchy:{...y,...C,index:S,derived:x},chainOperatorMapping:_}}function M(t,e,n,i,s,a){const{sameAsPrevious:u,hierarchy:c,chainOperatorMapping:l}=D(t,e,n,i,s,a),d=function(t){return{id:o.k.create22(),atomId:t.id,occupancy:t.occupancy.isDefined?t.occupancy:r.VP.ofConst(1,t._rowCount,r.VP.Schema.float),B_iso_or_equiv:t.B_iso_or_equiv,xyzDefined:t.Cartn_x.isDefined&&t.Cartn_y.isDefined&&t.Cartn_z.isDefined,x:t.Cartn_x.toArray({array:Float32Array}),y:t.Cartn_y.toArray({array:Float32Array}),z:t.Cartn_z.toArray({array:Float32Array})}}(t);return{sameAsPrevious:u,hierarchy:c,conformation:d,chainOperatorMapping:l}}var N=n(66231);function E(t){return new T(t)}const k=new class{findElement(t,e){return e.kind=void 0,e.index=-1,!1}findSphereElement(t){return-1}findGaussianElement(t){return-1}};class T{get sphereMapping(){return this._sphereMapping||(this._sphereMapping=R(this.data.spheres)),this._sphereMapping}get gaussianMapping(){return this._gaussianMapping||(this._gaussianMapping=R(this.data.gaussians)),this._gaussianMapping}findSphereElement(t){var e;let n=this.sphereMapping[t.label_entity_id];return n?(n=n[t.label_asym_id],n&&null!==(e=n[t.label_seq_id])&&void 0!==e?e:-1):-1}findGaussianElement(t){var e;let n=this.gaussianMapping[t.label_entity_id];return n?(n=n[t.label_asym_id],n&&null!==(e=n[t.label_seq_id])&&void 0!==e?e:-1):-1}findElement(t,e){const n=this.findSphereElement(t);if(n>=0)return e.kind="spheres",e.index=n,!0;const r=this.findGaussianElement(t);return r>=0&&(e.kind="gaussians",e.index=r,!0)}constructor(t){this.data=t,this._sphereMapping=void 0,this._gaussianMapping=void 0}}function R({count:t,entity_id:e,asym_id:n,seq_id_begin:r,seq_id_end:o}){const i={};for(let s=0;s<t;s++){const t=e.value(s),a=n.value(s);i[t]||(i[t]={}),i[t][a]||(i[t][a]={});const u=i[t][a],c=r.value(s),l=o.value(s);for(let e=c;e<=l;e++)u[e]=s}return i}const U={chainKey:[],entityKey:[],findSequenceKey:()=>-1,findChainKey:()=>-1,getEntityFromChain:()=>-1,count:0,entity_id:r.VP.Undefined(0,r.VP.Schema.str),asym_id:r.VP.Undefined(0,r.VP.Schema.str),seq_id_begin:r.VP.Undefined(0,r.VP.Schema.int),seq_id_end:r.VP.Undefined(0,r.VP.Schema.int),chainElementSegments:a.hT.create([]),polymerRanges:N.m.ofSortedRanges([]),gapRanges:N.m.ofSortedRanges([])};var H;function O(t,e,n){if(t.has(e))return t.get(e);const r=n.index++;return t.set(e,r),r}function F(t,e){if(t.has(e))return t.get(e);const n=new Map;return t.set(e,n),n}function G(t){throw new Error(`Missing entity entry for entity id '${t}'.`)}function L(t,e){const{entity_id:n,asym_id:r,seq_id_begin:o,seq_id_end:i,count:s,chainElementSegments:u}=t,c=new Map,l=new Map,d={index:0},f=new Int32Array(s),m=new Int32Array(s),h=new Int32Array(u.count);for(let a=0;a<s;a++)m[a]=e.getEntityIndex(n.value(a)),m[a]<0&&G(n.value(a));for(let a=0;a<u.count;a++){const t=u.offsets[a],e=u.offsets[a+1],n=m[t];h[a]=n;const s=O(F(l,n),r.value(t),d);for(let r=t;r<e;r++)f[r]=s;const p=[],g=[];for(let r=t;r<e;r++){const t=o.value(r),e=i.value(r);p.push(r),g.push(t,e)}const y={elementIndices:p,seqRanges:N.m.ofSortedRanges(g)};c.set(s,y)}const{findChainKey:p,findSequenceKey:g}=function(t,e,n){const r=t.getEntityIndex;return{findChainKey:(t,n)=>{const o=r(t);if(o<0)return-1;const i=e.get(o);return i.has(n)?i.get(n):-1},findSequenceKey:(t,o,i)=>{const s=r(t);if(s<0)return-1;const u=e.get(s);if(void 0===u)return-1;const c=u.get(o);if(void 0===c)return-1;const l=n.get(c),{elementIndices:d,seqRanges:f}=l,m=N.m.firstIntersectionIndex(f,a.CD.ofSingleton(i));return-1!==m?d[m]:-1}}}(e,l,c);return{chainKey:f,entityKey:m,findSequenceKey:g,findChainKey:p,getEntityFromChain:t=>h[t]}}!function(t){t.Empty={isDefined:!1,spheres:U,gaussians:U,index:k}}(H||(H={}));var V=n(51142);function Z(t,e){const n=[],r=[],o=a.hT.transientSegments(t.chainElementSegments,a.IX.ofBounds(0,t.count)),{seq_id_begin:i,seq_id_end:s}=t;for(;o.hasNext;){const{start:t,end:e}=o.move();let a=-1,u=-1;for(let o=t;o<e;++o){const c=s.value(o);o===t?(a=o,u=s.value(o)):i.value(o)-u>1&&(n.push(a,o-1),r.push(o-1,o),a=o),o===e-1&&n.push(a,o),u=c}}return{polymerRanges:N.m.ofSortedRanges(n),gapRanges:N.m.ofSortedRanges(r)}}var q=n(84796);const K={hierarchy:H.Empty,conformation:void 0};function X(t,e){const{ihm_sphere_obj_site:n,ihm_gaussian_obj_site:r}=t;if(0===n._rowCount&&0===r._rowCount)return K;const o=z(n),i=function(t){return{x:t.Cartn_x.toArray({array:Float32Array}),y:t.Cartn_y.toArray({array:Float32Array}),z:t.Cartn_z.toArray({array:Float32Array}),radius:t.object_radius.toArray({array:Float32Array}),rmsf:t.rmsf.toArray({array:Float32Array})}}(n),s=L(o,t.entities),a=Z(o),u=z(r),c=function(t){const e=q.e.ihm_gaussian_obj_site.covariance_matrix.space,n=[],{covariance_matrix:r}=t;for(let o=0,i=r.rowCount;o<i;o++)n[o]=l.qY.toMat3((0,l.U)(),e,r.value(o));return{x:t.mean_Cartn_x.toArray({array:Float32Array}),y:t.mean_Cartn_y.toArray({array:Float32Array}),z:t.mean_Cartn_z.toArray({array:Float32Array}),weight:t.weight.toArray({array:Float32Array}),covariance_matrix:n}}(r),d=L(u,t.entities),f=Z(u);return{hierarchy:{isDefined:!0,spheres:{...o,...s,...a},gaussians:{...u,...d,...f},index:E({spheres:o,gaussians:u})},conformation:{id:V.kk.create22(),spheres:i,gaussians:c}}}function Y(t,e,n){const r=[0];for(let o=1,i=t.rowCount;o<i;o++){!t.areValuesEqual(o-1,o)&&(r[r.length]=o)}return{chainElementSegments:a.hT.ofOffsets(r,a.IX.ofBounds(0,t.rowCount))}}function z(t){const{entity_id:e,seq_id_begin:n,seq_id_end:r,asym_id:o}=t;return{count:e.rowCount,entity_id:e,asym_id:o,seq_id_begin:n,seq_id_end:r,...Y(o)}}var $=n(32211),W=n(15387);function Q(t,e,n,o){if(!t.entity_poly_seq||!t.entity_poly_seq._rowCount)return $.V.fromHierarchy(e,n,o);const{entity_id:i,num:s,mon_id:a}=t.entity_poly_seq,u={},c=[],l=i.rowCount;let d=0;for(;d<l;){const t=d;for(;d<l-1&&i.areValuesEqual(d,d+1);)d++;d++;const n=i.value(t),o=r.VP.window(a,t,d),f=r.VP.window(s,t,d),m=e.getEntityIndex(n);u[m]={entityId:n,sequence:W.g.ofResidueNames(o,f)},c.push(u[m])}return{byEntityKey:u,sequences:c}}async function j(t,e,n,o){const i=(0,y.vc)(n,o-1),{label_entity_id:s,label_asym_id:a,label_seq_id:u}=e,c=(0,y.h3)(i,s.value);t.shouldUpdate&&await t.update();for(let l=0,d=c.length-1;l<d;l++){const e=(0,y.h3)(i,a.value,{start:c[l],end:c[l+1]});for(let n=0,o=e.length-1;n<o;n++){const o=e[n];u.valueKind(o)===r.VP.ValueKinds.Present&&((0,y.h3)(i,u.value,{sort:!0,start:o,end:e[n+1]}),t.shouldUpdate&&await t.update())}t.shouldUpdate&&await t.update()}return(0,I.qW)(i)&&i.length===e._rowCount?{atom_site:e,sourceIndex:r.VP.ofIntArray(i)}:{atom_site:r.XI.view(e,e._schema,i),sourceIndex:r.VP.ofIntArray(i)}}function J(t,e,n,r,o){const{polymerType:i,traceElementIndex:s,directionFromElementIndex:a,directionToElementIndex:u}=o.residue,c=i[t],d=i[e];if(c===m.XB.NA||d===m.XB.NA)return!1;if(-1===s[t]||-1===s[e])return!1;let f=r.findAtomsOnResidue(t,(0,h.HQ)(c,"backboneStart")),p=r.findAtomsOnResidue(e,(0,h.HQ)(d,"backboneEnd"));-1!==f&&-1!==p||(f=r.findAtomsOnResidue(t,(0,h.HQ)(c,"coarseBackbone")),p=r.findAtomsOnResidue(e,(0,h.HQ)(d,"coarseBackbone")));const{x:g,y:y,z:_}=n,A=l.eB.create(g[f],y[f],_[f]),b=l.eB.create(g[p],y[p],_[p]),C=-1===a[t]||-1===u[t]||-1===a[e]||-1===u[e];return l.eB.distance(A,b)<(C?10:3)}function tt(t,e,n,r){const o=[],i=[],s=new Map,u=a.hT.transientSegments(t.chainAtomSegments,a.IX.ofBounds(0,t.atoms._rowCount)),c=a.hT.transientSegments(t.residueAtomSegments,a.IX.ofBounds(0,t.atoms._rowCount)),{index:l,derived:d}=t,{label_seq_id:f}=t.residues,{label_entity_id:h}=t.chains,{moleculeType:p,traceElementIndex:g}=d.residue;let y,_,A,b;for(;u.hasNext;){const a=u.move();c.setSegment(a),y=-1,_=-1,A=-1,b=-1;const C=e.getEntityIndex(h.value(a.index)),S=r.byEntityKey[C],x=S?S.sequence.seqId.value(S.sequence.seqId.rowCount-1):-1,v=t.residueAtomSegments.index[a.start],B=t.residueAtomSegments.index[a.end-1],I=f.value(v),w=f.value(B);for(1===I&&w===x&&n.xyzDefined&&J(v,B,n,l,d)&&(s.set(v,B),s.set(B,v));c.hasNext;){const e=c.move(),r=e.index,s=f.value(r);if((0,m.z7)(p[r])&&-1!==g[r])if(-1!==b)if(s!==y+1)o.push(b,A-1),i.push(_,e.end-1),b=e.start;else if(c.hasNext){const r=t.residueAtomSegments.index[e.start],s=t.residueAtomSegments.index[A-1];n.xyzDefined&&!J(r,s,n,t.index,d)&&(o.push(b,A-1),i.push(_,e.end-1),b=e.start)}else o.push(b,e.end-1);else b=e.start;else-1!==b&&(o.push(b,A-1),b=-1);_=e.start,A=e.end,y=s}}return{polymerRanges:N.m.ofSortedRanges(o),gapRanges:N.m.ofSortedRanges(i),cyclicPolymerMap:s}}var et=n(92570);function nt(t){const e=new Map,n=(t,e,n)=>`${t}|${e}|${n}`,r=t.pdbx_unobs_or_zero_occ_residues;for(let o=0,i=r._rowCount;o<i;++o){const t=n(r.PDB_model_num.value(o),r.label_asym_id.value(o),r.label_seq_id.value(o));e.set(t,{polymer_flag:r.polymer_flag.value(o),occupancy_flag:r.occupancy_flag.value(o)})}return{has:(t,r,o)=>e.has(n(t,r,o)),get:(t,r,o)=>e.get(n(t,r,o)),size:e.size}}function rt(t){const e=new Map;if(t.chem_comp._rowCount>0){const{id:n}=t.chem_comp;for(let o=0,i=n.rowCount;o<i;++o)e.set(n.value(o),r.XI.getRow(t.chem_comp,o))}else{it(t).forEach(t=>{e.set(t,(0,m.bM)(t))})}return e}function ot(t){const e=new Map;if(t.pdbx_chem_comp_identifier._rowCount>0){const{comp_id:n,type:r,identifier:o}=t.pdbx_chem_comp_identifier;for(let t=0,i=n.rowCount;t<i;++t)if("SNFG CARBOHYDRATE SYMBOL"===r.value(t)||"SNFG CARB SYMBOL"===r.value(t)){const r=o.value(t),i=et.Dr.get(r);i?e.set(n.value(t),i):console.warn(`Unknown SNFG name '${r}'`)}}if(t.chem_comp._rowCount>0){const{id:n,type:r}=t.chem_comp;for(let t=0,o=n.rowCount;t<o;++t){const o=n.value(t);if(e.has(o))continue;const i=r.value(t);et.yt.has(o)?e.set(o,et.yt.get(o)):(0,m.RN)(i,o)===m.HX.Saccharide&&e.set(o,et.xY)}}else{const n=it(t);et.yt.forEach((t,r)=>{!e.has(r)&&n.has(r)&&e.set(r,t)})}return e}const it=(0,n(46867).E)(t=>{const e=new Set,{label_comp_id:n,auth_comp_id:r}=t.atom_site,o=n.isDefined?n:r;for(let i=0,s=o.rowCount;i<s;++i)e.add(o.value(i));return e});function st(t,e){const n=new Map,{auth_asym_id:r,label_asym_id:o,label_entity_id:i}=t.chains;for(let s=0,a=t.chains._rowCount;s<a;s++){const t=o.value(s);n.set(t,{id:t,auth_id:r.value(s),entity_id:i.value(s)})}if(null==e?void 0:e.struct_asym._rowCount){const{id:t,entity_id:r}=e.struct_asym;for(let e=0,o=t.rowCount;e<o;++e){const o=t.value(e);n.has(o)||n.set(o,{id:o,auth_id:"",entity_id:r.value(e)})}}return n}const at=r.VP.Schema.Aliased(r.VP.Schema.Str());function ut(t){let e;if(t.entity.id.isDefined)e=t.entity;else{const n=new Set,o=[],i=[],{label_entity_id:s,label_comp_id:a}=t.atom_site;for(let e=0,r=t.atom_site._rowCount;e<r;e++){const t=s.value(e);n.has(t)||(o.push(t),i.push((0,m.wZ)(a.value(e))),n.add(t))}const{entity_id:u}=t.ihm_sphere_obj_site;for(let e=0,r=t.ihm_sphere_obj_site._rowCount;e<r;e++){const t=u.value(e);n.has(t)||(o.push(t),i.push("polymer"),n.add(t))}const{entity_id:c}=t.ihm_gaussian_obj_site;for(let e=0,r=t.ihm_gaussian_obj_site._rowCount;e<r;e++){const t=c.value(e);n.has(t)||(o.push(t),i.push("polymer"),n.add(t))}e=r.XI.ofPartialColumns(q.e.entity,{id:r.VP.ofArray({array:o,schema:q.e.entity.id}),type:r.VP.ofArray({array:i,schema:q.e.entity.type})},o.length)}const n=r.VP.createIndexer(e.id),o=new Array(e._rowCount);o.fill("other");const i=new Set;let s=!1;if(t.entity_poly&&t.entity_poly.type.isDefined){const{entity_id:e,type:r,_rowCount:s}=t.entity_poly;for(let t=0;t<s;++t){const s=e.value(t);o[n(s)]=r.value(t),i.add(s)}}else s=!0;if(t.pdbx_entity_branch&&t.pdbx_entity_branch.entity_id.isDefined){const{entity_id:e,type:r,_rowCount:s}=t.pdbx_entity_branch;for(let t=0;t<s;++t){const s=e.value(t);o[n(s)]=r.value(t),i.add(s)}}else s=!0;if(i.size<o.length&&(s=!0),s){const e=new Map;if(t.chem_comp){const{id:n,type:r}=t.chem_comp;for(let o=0,i=t.chem_comp._rowCount;o<i;o++)e.set(n.value(o),r.value(o))}if(t.atom_site){const{label_entity_id:r,label_comp_id:s}=t.atom_site;for(let a=0,u=t.atom_site._rowCount;a<u;a++){const t=r.value(a);if(!i.has(t)){const r=s.value(a),u=e.get(r)||"other";o[n(t)]=(0,m.UC)(r,u),i.add(t)}}}}return{data:e,subtype:r.VP.ofArray({array:o,schema:at}),getEntityIndex:n}}function ct(t,e,n){var o;if(!t.pdbx_molecule||!t.pdbx_molecule.prd_id.isDefined)return e;const i=new Array(e.data._rowCount);i.fill("");const{asym_id:s,prd_id:a,_rowCount:u}=t.pdbx_molecule;for(let r=0;r<u;++r){const t=s.value(r),u=null===(o=n.get(t))||void 0===o?void 0:o.entity_id;void 0!==u&&(i[e.getEntityIndex(u)]=a.value(r))}const c=r.VP.ofArray({array:i,schema:r.VP.Schema.str});return{...e,prd_id:c}}var lt=n(72080),dt=n(8429);async function ft(t,e,n){const o=function(t){return{missingResidues:nt(t),chemicalComponentMap:rt(t),saccharideComponentMap:ot(t)}}(t),s=t.ihm_model_list._rowCount>0?await async function(t,e,n,o){const i=ut(e),s=e.atom_site.ihm_model_id.isDefined?e.atom_site.ihm_model_id:e.atom_site.pdbx_PDB_model_num,a=gt(e.atom_site,s),u=gt(e.ihm_sphere_obj_site,e.ihm_sphere_obj_site.model_id),c=gt(e.ihm_gaussian_obj_site,e.ihm_gaussian_obj_site.model_id),l=[];if(e.ihm_model_list){const{model_id:s,model_name:d}=e.ihm_model_list;for(let f=0;f<e.ihm_model_list._rowCount;f++){const m=s.value(f);let h,p;if(a.has(m)){const n=a.get(m),{atom_site:r,sourceIndex:o}=await j(t,e.atom_site,n.start,n.end);h=r,p=o}else h=r.XI.window(e.atom_site,e.atom_site._schema,0,0),p=r.VP.ofIntArray([]);const g=ht(e,{model_id:m,model_name:d.value(f),model_group_name:(0,lt.O)(m,e),entities:i,atom_site:h,atom_site_sourceIndex:p,ihm_sphere_obj_site:u.has(m)?u.get(m).table:r.XI.window(e.ihm_sphere_obj_site,e.ihm_sphere_obj_site._schema,0,0),ihm_gaussian_obj_site:c.has(m)?c.get(m).table:r.XI.window(e.ihm_gaussian_obj_site,e.ihm_gaussian_obj_site._schema,0,0)},n,o);l.push(g)}}return l}(n,t,o,e):await async function(t,e,n,r){const o=[];if(e.atom_site){const i=e.atom_site.id.rowCount,s=ut(e);let a=0;for(;a<i;){const i=pt(e.atom_site.pdbx_PDB_model_num,a),{atom_site:u,sourceIndex:c}=await j(t,e.atom_site,a,i),l=mt(e,u,c,s,n,r,o.length>0?o[o.length-1]:void 0);o.push(l),a=i}}return o}(n,t,o,e);for(let r=0;r<s.length;r++)i.K.TrajectoryInfo.set(s[r],{index:r,size:s.length});return new dt.P(s)}function mt(t,e,n,i,a,u,c){const l=M(e,n,i,a.chemicalComponentMap,u,c),d=e.pdbx_PDB_model_num.value(0);if(c&&l.sameAsPrevious)return{...c,id:o.k.create22(),modelNum:d,atomicConformation:l.conformation,_dynamicPropertyData:Object.create(null)};const f=K,m=Q(t,i,l.hierarchy,f.hierarchy),h=tt(l.hierarchy,i,l.conformation,m),p=st(l.hierarchy),g=t.entry.id.valueKind(0)===r.VP.ValueKinds.Present?t.entry.id.value(0):u.name,y=[];return g&&y.push(g),t.struct.title.valueKind(0)===r.VP.ValueKinds.Present&&y.push(t.struct.title.value(0)),{id:o.k.create22(),entryId:g,label:y.join(" | "),entry:g,sourceData:u,modelNum:d,parent:void 0,entities:ct(t,i,p),sequence:m,atomicHierarchy:l.hierarchy,atomicConformation:l.conformation,atomicRanges:h,atomicChainOperatorMappinng:l.chainOperatorMapping,coarseHierarchy:f.hierarchy,coarseConformation:f.conformation,properties:{...a,structAsymMap:p},customProperties:new s.v,_staticPropertyData:Object.create(null),_dynamicPropertyData:Object.create(null)}}function ht(t,e,n,i){const a=M(e.atom_site,e.atom_site_sourceIndex,e.entities,n.chemicalComponentMap,i),u=X(e,n.chemicalComponentMap),c=Q(t,e.entities,a.hierarchy,u.hierarchy),l=tt(a.hierarchy,e.entities,a.conformation,c),d=t.entry.id.valueKind(0)===r.VP.ValueKinds.Present?t.entry.id.value(0):i.name,f=[];d&&f.push(d),t.struct.title.valueKind(0)===r.VP.ValueKinds.Present&&f.push(t.struct.title.value(0)),e.model_name&&f.push(e.model_name),e.model_group_name&&f.push(e.model_group_name);const m=st(a.hierarchy,t);return{id:o.k.create22(),entryId:d,label:f.join(" | "),entry:d,sourceData:i,modelNum:e.model_id,parent:void 0,entities:ct(t,e.entities,m),sequence:c,atomicHierarchy:a.hierarchy,atomicConformation:a.conformation,atomicRanges:l,atomicChainOperatorMappinng:a.chainOperatorMapping,coarseHierarchy:u.hierarchy,coarseConformation:u.conformation,properties:{...n,structAsymMap:m},customProperties:new s.v,_staticPropertyData:Object.create(null),_dynamicPropertyData:Object.create(null)}}function pt(t,e){const n=t.rowCount;if(!t.isDefined)return n;let r=e+1;for(;r<n&&t.areValuesEqual(e,r);)r++;return r}function gt(t,e){const n=new Map,o=t._rowCount;let i=0;for(;i<o;){const o=pt(e,i),s=e.value(i);n.set(s,{table:r.XI.window(t,t._schema,i,o),start:i,end:o}),i=o}return n}},63590:function(t,e,n){n.d(e,{f$:function(){return yt},xA:function(){return o.xA},RF:function(){return o.RF}});var r,o=n(64832),i=n(5772),s=n(21002),a=n(24832);function u(t){for(;t.position<t.length;)switch(t.data.charCodeAt(t.position)){case 9:case 10:case 13:case 32:return void(t.tokenEnd=t.position);default:++t.position}t.tokenEnd=t.position}function c(t){return!(t.length-t.position<2)&&(39===t.data.charCodeAt(t.position+1)&&39===t.data.charCodeAt(t.position+2))}function l(t,e,n){let r;const o=n-e,i=t.tokenStart-e,s=t.tokenEnd-t.tokenStart;if(s<o)return!1;for(r=e;r<n;++r)if(t.data.charCodeAt(r)!==t.data.charCodeAt(r+i))return!1;return o===s||46===t.data.charCodeAt(r+i)}function d(t){let e;for(e=t.tokenStart;e<t.tokenEnd;++e)if(46===t.data.charCodeAt(e))return e;return e}function f(t,e){return t.data.substring(t.tokenStart,e)}function m(t){return t.data.substring(t.tokenStart,t.tokenEnd)}function h(t){const e=function(t){let e=10;for(;t.position<t.length;){const n=t.data.charCodeAt(t.position);switch(n){case 9:case 32:e=n,++t.position;break;case 10:13!==e&&++t.lineNumber,e=n,++t.position;break;case 13:e=n,++t.position,++t.lineNumber;break;default:return e}}return e}(t);if(t.position>=t.length)return void(t.tokenType=r.End);t.tokenStart=t.position,t.tokenEnd=t.position,t.isEscaped=!1;const n=t.data.charCodeAt(t.position);switch(n){case 35:!function(t){for(;t.position<t.length;){const e=t.data.charCodeAt(t.position);if(10===e||13===e)return;++t.position}}(t),t.tokenType=r.Comment;break;case 39:if(c(t)){!function(t){for(t.position+=3;t.position<t.length;){if(39===t.data.charCodeAt(t.position)&&c(t))return t.tokenStart+=3,t.tokenEnd=t.position,t.isEscaped=!0,void(t.position+=3);++t.position}t.tokenEnd=t.position}(t),t.tokenType=r.Value;break}case 34:!function(t,e){let n,r;for(++t.position;t.position<t.length;)if(r=t.data.charCodeAt(t.position),r===e)switch(n=t.data.charCodeAt(t.position+1),n){case 9:case 10:case 13:case 32:return t.tokenStart++,t.tokenEnd=t.position,t.isEscaped=!0,void++t.position;default:if(!Number.isFinite(n))return t.tokenStart++,t.tokenEnd=t.position,t.isEscaped=!0,void++t.position;++t.position}else{if(10===r||13===r)return void(t.tokenEnd=t.position);++t.position}t.tokenEnd=t.position}(t,n),t.tokenType=r.Value;break;case 59:10===e||13===e?function(t){let e,n=59,r=t.position+1;for(;r<t.length;){if(e=t.data.charCodeAt(r),59===e&&(10===n||13===n)){for(t.position=r+1,t.tokenStart++,r--,e=t.data.charCodeAt(r);10===e||13===e;)r--,e=t.data.charCodeAt(r);return t.tokenEnd=r+1,void(t.isEscaped=!0)}(13===e||10===e&&13!==n)&&t.lineNumber++,n=e,++r}t.position=r}(t):u(t),t.tokenType=r.Value;break;default:t.isImportGet?function(t){for(;t.position<t.length;){if(93===t.data.charCodeAt(t.position))return++t.position,t.tokenEnd=t.position,void(t.isImportGet=!1);++t.position}}(t):u(t),t.isEscaped?t.tokenType=r.Value:95===t.data.charCodeAt(t.tokenStart)?(t.inSaveFrame&&function(t){return t.tokenEnd-t.tokenStart===11&&105===t.data.charCodeAt(t.tokenStart+1)&&109===t.data.charCodeAt(t.tokenStart+2)&&112===t.data.charCodeAt(t.tokenStart+3)&&111===t.data.charCodeAt(t.tokenStart+4)&&114===t.data.charCodeAt(t.tokenStart+5)&&116===t.data.charCodeAt(t.tokenStart+6)&&46===t.data.charCodeAt(t.tokenStart+7)&&103===t.data.charCodeAt(t.tokenStart+8)&&101===t.data.charCodeAt(t.tokenStart+9)&&116===t.data.charCodeAt(t.tokenStart+10)}(t)&&(t.isImportGet=!0),t.tokenType=r.ColumnName):t.tokenEnd-t.tokenStart>=5&&95===t.data.charCodeAt(t.tokenStart+4)?!function(t){let e=t.data.charCodeAt(t.tokenStart);return!(68!==e&&100!==e||(e=t.data.charCodeAt(t.tokenStart+1),65!==e&&97!==e||(e=t.data.charCodeAt(t.tokenStart+2),84!==e&&116!==e||(e=t.data.charCodeAt(t.tokenStart+3),65!==e&&97!==e))))}(t)?!function(t){let e=t.data.charCodeAt(t.tokenStart);return!(83!==e&&115!==e||(e=t.data.charCodeAt(t.tokenStart+1),65!==e&&97!==e||(e=t.data.charCodeAt(t.tokenStart+2),86!==e&&118!==e||(e=t.data.charCodeAt(t.tokenStart+3),69!==e&&101!==e))))}(t)?!function(t){if(t.tokenEnd-t.tokenStart!==5)return!1;let e=t.data.charCodeAt(t.tokenStart);return!(76!==e&&108!==e||(e=t.data.charCodeAt(t.tokenStart+1),79!==e&&111!==e||(e=t.data.charCodeAt(t.tokenStart+2),79!==e&&111!==e||(e=t.data.charCodeAt(t.tokenStart+3),80!==e&&112!==e))))}(t)?t.tokenType=r.Value:t.tokenType=r.Loop:t.tokenType=r.Save:t.tokenType=r.Data:t.tokenType=r.Value}}function p(t){for(h(t);t.tokenType===r.Comment;)h(t)}function g(){return{categoryNames:[],categoryData:Object.create(null)}}function y(t,e){const n=Object.create(null);for(const r of t){const t=e[r];n[r]=o.xA(t.name,t.rowCount,t.fieldNames,t.fields)}return n}function _(t,e,n){return o.IU(t.categoryNames,y(t.categoryNames,t.categoryData),e,n)}function A(t,e){return o.IU(t.categoryNames,y(t.categoryNames,t.categoryData),e)}function b(t,e,n,r,o){if(e in t.categoryData){const n=t.categoryData[e];n.fieldNames.push(...r),Object.assign(n.fields,o)}else t.categoryData[e]={name:e,rowCount:n,fieldNames:r,fields:o},t.categoryNames.push(e)}function C(t,e){const n=t.tokenStart,i=d(t),s=f(t,i),a=Object.create(null),u=[];let c=!0;for(;c;){if(t.tokenType!==r.ColumnName||!l(t,n,i)){c=!1;break}const e=m(t).substring(s.length+1);if(p(t),t.tokenType!==r.Value)return{hasError:!0,errorLine:t.lineNumber,errorMessage:"Expected value."};a[e]=o.RF.ofTokens({data:t.data,indices:[t.tokenStart,t.tokenEnd],count:1}),u[u.length]=e,p(t)}return b(e,s.substr(1),1,u,a),{hasError:!1,errorLine:0,errorMessage:""}}function S(t,e){const{tokenizer:n,tokens:o,fieldCount:s}=e;let a=e.tokenCount,u=0;for(;n.tokenType===r.Value&&u<t;)i.tM.add(o[a++%s],n.tokenStart,n.tokenEnd),p(n),u++;return e.tokenCount=a,u}function x(t,e){return t.update({message:"Parsing...",current:e.tokenizer.position,max:e.tokenizer.data.length})}async function v(t,e){const n=t.lineNumber;p(t);const s=f(t,d(t)),u=function(t){let e;for(e=t.tokenStart;e<t.tokenEnd;++e)if(46===t.data.charCodeAt(e))return!1;return!0}(t),c=[];for(;t.tokenType===r.ColumnName;)c[c.length]=u?m(t):m(t).substring(s.length+1),p(t);const l="_atom_site"===s?t.data.length/100|0:32,h=[],g=c.length;for(let r=0;r<g;r++)h[r]=i.tM.create(t.data,l);const y={fieldCount:g,tokenCount:0,tokenizer:t,tokens:h};if(await(0,a.yB)(t.runtimeCtx,1e6,y,S,x),y.tokenCount%g!==0)return{hasError:!0,errorLine:t.lineNumber,errorMessage:`The number of values for loop starting at line ${n} is not a multiple of the number of columns.`};const _=y.tokenCount/g|0;if(u)for(let r=0;r<g;r++){const t={"":o.RF.ofTokens(h[r])};b(e,c[r].substr(1),_,[""],t)}else{const t=Object.create(null);for(let e=0;e<g;e++)t[c[e]]=o.RF.ofTokens(h[e]);b(e,s.substr(1),_,c,t)}return{hasError:!1,errorLine:0,errorMessage:""}}function B(t,e){return s.H.error(e,t)}async function I(t,e){const n=[],a=function(t,e){return{data:t,length:t.length,position:0,tokenStart:0,tokenEnd:0,tokenType:r.End,lineNumber:1,isEscaped:!1,isImportGet:!1,inSaveFrame:!1,runtimeCtx:e}}(t,e);let u="",c=g(),l=[],d=g();const f=o.p4(d.categoryNames,y(d.categoryNames,d.categoryData),"");let m="";for(e.update({message:"Parsing...",current:0,max:t.length}),p(a);a.tokenType!==r.End;){const e=a.tokenType;if(e===r.Data){if(a.inSaveFrame)return B(a.lineNumber,"Unexpected data block inside a save frame.");c.categoryNames.length>0&&n.push(_(c,u,l)),u=t.substring(a.tokenStart+5,a.tokenEnd),c=g(),l=[],p(a)}else if(e===r.Save){if(a.tokenEnd-a.tokenStart===5)d.categoryNames.length>0&&(l[l.length]=A(d,m)),a.inSaveFrame=!1;else{if(a.inSaveFrame)return B(a.lineNumber,"Save frames cannot be nested.");a.inSaveFrame=!0,m=t.substring(a.tokenStart+5,a.tokenEnd),d=g()}p(a)}else if(e===r.Loop){const t=await v(a,a.inSaveFrame?d:c);if(t.hasError)return B(t.errorLine,t.errorMessage)}else{if(e!==r.ColumnName)return console.log(a.tokenType,i._F.getTokenString(a)),B(a.lineNumber,"Unexpected token. Expected data_, loop_, or data name.");{const t=C(a,a.inSaveFrame?d:c);if(t.hasError)return B(t.errorLine,t.errorMessage)}}}return a.inSaveFrame?B(a.lineNumber,`Unfinished save frame (${f.header}).`):((c.categoryNames.length>0||l.length>0)&&n.push(_(c,u,l)),function(t){return s.H.success(t)}(o.jG(n)))}function w(t){return a.YZ.create("Parse CIF",async e=>await I(t,e))}!function(t){t[t.Data=0]="Data",t[t.Save=1]="Save",t[t.Loop=2]="Loop",t[t.Value=3]="Value",t[t.ColumnName=4]="ColumnName",t[t.Comment=5]="Comment",t[t.End=6]="End"}(r||(r={}));var P=n(27125),D=n(18593),M=n(94106);var N=n(65622);function E(t){const e=Object.create(null),n=Object.create(null);for(const r of t.columns)e[r.name]=r;return{rowCount:t.rowCount,name:t.name.substring(1),fieldNames:t.columns.map(t=>t.name),getField(t){const r=e[t];if(r)return n[t]||(n[t]=function(t){const e=t.mask?(0,D.D4)(t.mask):void 0,n=(0,D.D4)(t.data),r=P.iu.isTypedArray(n),o=r?e?t=>e[t]===P.VP.ValueKinds.Present?""+n[t]:"":t=>""+n[t]:e?t=>e[t]===P.VP.ValueKinds.Present?n[t]:"":t=>n[t],i=r?t=>n[t]:t=>{const e=n[t];return(0,M.H9)(e,0,e.length)},s=r?t=>n[t]:t=>{const e=n[t];return(0,M.sS)(e,0,e.length)},a=e?t=>e[t]:t=>P.VP.ValueKinds.Present,u=n.length;return{__array:n,binaryEncoding:t.data.encoding,isDefined:!0,rowCount:u,str:o,int:i,float:s,valueKind:a,areValuesEqual:(t,e)=>n[t]===n[e],toStringArray:t=>P.iu.createAndFillArray(u,o,t),toIntArray:r?t=>P.iu.typedArrayWindow(n,t):t=>P.iu.createAndFillArray(u,i,t),toFloatArray:r?t=>P.iu.typedArrayWindow(n,t):t=>P.iu.createAndFillArray(u,s,t)}}(r)),n[t]}}}function k(t){return a.YZ.create("Parse BinaryCIF",async e=>{const n=[0,3];try{const e=(0,N.J)(t);if(!function(t,e){for(let n=0;n<2;n++)if(t[n]>e[n])return!1;return!0}(n,e.version.match(/(\d)\.(\d)\.\d/).slice(1).map(t=>+t)))return s.H.error(`Unsupported format version. Current ${e.version}, required ${n.join(".")}.`);const r=o.jG(e.dataBlocks.map(t=>{const e=Object.create(null);for(const n of t.categories)e[n.name.substring(1)]=E(n);return o.IU(t.categories.map(t=>t.name.substring(1)),e,t.header)}));return s.H.success(r)}catch(r){return s.H.error(""+r)}})}var T=n(59663),R=n(784),U=P.VP.Schema;const H=U.str,O=U.float,F=U.List,G=U.lstr,L=U.Aliased,V=U.int,Z=U.coord,q={chem_comp:{formula:H,formula_weight:O,id:H,mon_nstd_parent_comp_id:F(",",t=>t),name:H,one_letter_code:H,three_letter_code:H,type:L(G),pdbx_synonyms:F(";",t=>t),pdbx_type:H,pdbx_ambiguous_flag:H,pdbx_replaced_by:H,pdbx_replaces:H,pdbx_formal_charge:V,pdbx_model_coordinates_details:H,pdbx_model_coordinates_db_code:H,pdbx_ideal_coordinates_details:H,pdbx_ideal_coordinates_missing_flag:L(G),pdbx_model_coordinates_missing_flag:L(G),pdbx_initial_date:H,pdbx_modified_date:H,pdbx_release_status:L(H),pdbx_processing_site:L(H)},chem_comp_atom:{alt_atom_id:H,atom_id:H,charge:V,model_Cartn_x:Z,model_Cartn_y:Z,model_Cartn_z:Z,comp_id:H,type_symbol:H,pdbx_align:V,pdbx_ordinal:V,pdbx_model_Cartn_x_ideal:Z,pdbx_model_Cartn_y_ideal:Z,pdbx_model_Cartn_z_ideal:Z,pdbx_stereo_config:L(G),pdbx_aromatic_flag:L(G),pdbx_leaving_atom_flag:L(G)},chem_comp_bond:{atom_id_1:H,atom_id_2:H,comp_id:H,value_order:L(G),pdbx_ordinal:V,pdbx_stereo_config:L(G),pdbx_aromatic_flag:L(G)},pdbx_chem_comp_descriptor:{comp_id:H,descriptor:H,type:L(G),program:H,program_version:H},pdbx_chem_comp_identifier:{comp_id:H,identifier:H,type:L(H),program:H,program_version:H}};var K=P.VP.Schema;const X=K.str,Y=K.float,z=K.lstr,$=K.Aliased,W=K.int,Q={pdbx_reference_molecule:{prd_id:X,formula_weight:Y,formula:X,type:$(z),type_evidence_code:X,class:$(z),class_evidence_code:X,name:X,represent_as:$(z),chem_comp_id:X,compound_details:X,description:X,representative_PDB_id_code:X,release_status:$(z),replaces:X,replaced_by:X},pdbx_reference_entity_list:{prd_id:X,ref_entity_id:X,type:$(z),details:X,component_id:W},pdbx_reference_entity_nonpoly:{prd_id:X,ref_entity_id:X,name:X,chem_comp_id:X},pdbx_reference_entity_link:{link_id:W,prd_id:X,details:X,ref_entity_id_1:X,ref_entity_id_2:X,entity_seq_num_1:W,entity_seq_num_2:W,comp_id_1:X,comp_id_2:X,atom_id_1:X,atom_id_2:X,value_order:$(z),component_1:W,component_2:W,link_class:$(X)},pdbx_reference_entity_poly_link:{link_id:W,prd_id:X,ref_entity_id:X,component_id:W,entity_seq_num_1:W,entity_seq_num_2:W,comp_id_1:X,comp_id_2:X,atom_id_1:X,atom_id_2:X,value_order:$(z)},pdbx_reference_entity_poly:{prd_id:X,ref_entity_id:X,type:$(X),db_code:X,db_name:X},pdbx_reference_entity_poly_seq:{prd_id:X,ref_entity_id:X,mon_id:X,parent_mon_id:X,num:W,observed:$(z),hetero:$(z)},pdbx_reference_entity_sequence:{prd_id:X,ref_entity_id:X,type:$(X),NRP_flag:$(X),one_letter_codes:X},pdbx_reference_entity_src_nat:{prd_id:X,ref_entity_id:X,ordinal:W,organism_scientific:X,taxid:X,db_code:X,db_name:X},pdbx_prd_audit:{prd_id:X,date:X,processing_site:$(X),action_type:$(X)}};var j=P.VP.Schema;const J=j.str,tt={datablock:{id:J,description:J},dictionary:{title:J,datablock_id:J,version:J},dictionary_history:{version:J,update:J,revision:J},sub_category:{id:J,description:J},category_group_list:{id:J,parent_id:J,description:J},item_type_list:{code:J,primitive_code:J,construct:J,detail:J},item_units_list:{code:J,detail:J},item_units_conversion:{from_code:J,to_code:J,operator:J,factor:j.float}};var et=P.VP.Schema;const nt=et.str,rt=et.int,ot=et.float,it=et.Aliased,st=et.Vector,at=(it(nt),it(nt),it(nt),it(nt),st(3),st(3),{volume_data_3d_info:{name:nt,axis_order:st(3,rt),origin:st(3),dimensions:st(3),sample_rate:rt,sample_count:st(3,rt),spacegroup_number:rt,spacegroup_cell_size:st(3),spacegroup_cell_angles:st(3),mean_source:ot,mean_sampled:ot,sigma_source:ot,sigma_sampled:ot,min_source:ot,min_sampled:ot,max_source:ot,max_sampled:ot},volume_data_3d:{values:ot}});var ut=P.VP.Schema;const ct=ut.float,lt=ut.str,dt=ut.int,ft={cell:{angle_alpha:ct,angle_beta:ct,angle_gamma:ct,formula_units_z:ct,length_a:ct,length_b:ct,length_c:ct,volume:ct},chemical:{melting_point:ct,name_common:lt,name_systematic:lt},chemical_formula:{moiety:lt,sum:lt,weight:ct},space_group:{crystal_system:lt,it_number:dt,"name_h-m_full":lt},space_group_symop:{operation_xyz:lt},geom_bond:{atom_site_label_1:lt,atom_site_label_2:lt,distance:ct,publ_flag:lt,site_symmetry_1:lt,site_symmetry_2:lt,valence:ct},audit:{block_doi:lt},database_code:{cod:lt,csd:lt,depnum_ccdc_archive:lt,depnum_ccdc_fiz:lt,icsd:lt,mdf:lt,nbs:lt},atom_site:{adp_type:lt,calc_flag:lt,disorder_assembly:lt,disorder_group:lt,fract_x:ct,fract_y:ct,fract_z:ct,label:lt,occupancy:ct,refinement_flags:lt,site_symmetry_multiplicity:dt,type_symbol:lt,u_iso_or_equiv:ct},atom_site_aniso:{label:lt,u_11:ct,u:(0,ut.Matrix)(3,3),u_12:ct,u_13:ct,u_22:ct,u_23:ct,u_33:ct},atom_type:{description:lt,symbol:lt},atom_type_scat:{dispersion_imag:ct,dispersion_real:ct,source:lt}},mt={"cell.formula_units_z":["cell_formula_units_Z"],"space_group.it_number":["space_group_IT_number","symmetry_Int_Tables_number"],"space_group.name_h-m_full":["symmetry_space_group_name_H-M"],"space_group_symop.operation_xyz":["symmetry_equiv_pos_as_xyz"],"geom_bond.atom_site_label_1":["geom_bond_atom_site_id_1"],"geom_bond.atom_site_label_2":["geom_bond_atom_site_id_2"],"geom_bond.distance":["geom_bond_dist"],"audit.block_doi":["audit_block_DOI"],"database_code.cod":["database_code_COD"],"database_code.csd":["database_code_CSD"],"database_code.depnum_ccdc_archive":["database_code_depnum_CCDC_archive"],"database_code.depnum_ccdc_fiz":["database_code_depnum_CCDC_fiz"],"database_code.icsd":["database_code_ICSD"],"database_code.mdf":["database_code_MDF"],"database_code.nbs":["database_code_NBS"],"atom_site.adp_type":["atom_site_ADP_type","atom_site_thermal_displace_type"],"atom_site.label":["atom_site_id"],"atom_site.site_symmetry_multiplicity":["atom_site_symmetry_multiplicity"],"atom_site.u_iso_or_equiv":["atom_site_U_iso_or_equiv"],"atom_site_aniso.label":["atom_site_anisotrop_id"],"atom_site_aniso.u_11":["atom_site_aniso_U_11","atom_site_anisotrop_U_11"],"atom_site_aniso.u_12":["atom_site_aniso_U_12","atom_site_anisotrop_U_12"],"atom_site_aniso.u_13":["atom_site_aniso_U_13","atom_site_anisotrop_U_13"],"atom_site_aniso.u_22":["atom_site_aniso_U_22","atom_site_anisotrop_U_22"],"atom_site_aniso.u_23":["atom_site_aniso_U_23","atom_site_anisotrop_U_23"],"atom_site_aniso.u_33":["atom_site_aniso_U_33","atom_site_anisotrop_U_33"]};const ht=P.VP.Schema.int,pt={volume_data_3d_info:at.volume_data_3d_info,segmentation_data_table:{set_id:ht,segment_id:ht},segmentation_data_3d:{values:ht}};var gt=n(94830);const yt={parse:t=>gt.LQ.is(t)?w(t):k(t),parseText:w,parseBinary:k,toDatabaseCollection:T.nN,toDatabase:T.Pd,schema:{mmCIF:t=>(0,T.Pd)(R.r,t),CCD:t=>(0,T.Pd)(q,t),BIRD:t=>(0,T.Pd)(Q,t),dic:t=>(0,T.Pd)(tt,t),cifCore:t=>(0,T.Pd)(ft,t,mt),densityServer:t=>(0,T.Pd)(at,t),segmentation:t=>(0,T.Pd)(pt,t)}}},63729:function(t,e,n){n.d(e,{X:function(){return r}});var r,o=n(52500),i=n(784),s=n(62769),a=n(27125),u=n(58392);!function(t){t.Descriptor={name:"chem_comp_bond",cifExport:{prefix:"",categories:[{name:"chem_comp_bond",instance(e){const n=t.Provider.get(e.firstModel);if(!n)return s.c.Category.Empty;const r=n.data;if(!r)return s.c.Category.Empty;const o=e.structures[0].uniqueResidueNames,{comp_id:i,_rowCount:a}=r,u=[];for(let t=0;t<a;t++)o.has(i.value(t))&&(u[u.length]=t);return s.c.Category.ofTable(r,u)}}]}},t.Provider=u.q.create(t.Descriptor),t.chemCompBondFromTable=function(t,e){return a.XI.pick(e,i.r.chem_comp_bond,n=>t.properties.chemicalComponentMap.has(e.comp_id.value(n)))},t.getEntriesFromChemCompBond=function(t){const n=new Map;function r(t){if(n.has(t))return n.get(t);const r=new e(t);return n.set(t,r),r}const{comp_id:i,atom_id_1:s,atom_id_2:a,value_order:u,pdbx_aromatic_flag:c,_rowCount:l,pdbx_ordinal:d}=t;let f=r(i.value(0));for(let e=0;e<l;e++){const t=i.value(e),n=s.value(e),l=a.value(e),m=u.value(e),h="y"===c.value(e),p=d.value(e);f.id!==t&&(f=r(t));let g=o.I$.Flag.Covalent,y=1;switch(h&&(g|=o.I$.Flag.Aromatic),m.toLowerCase()){case"delo":g|=o.I$.Flag.Aromatic;break;case"doub":y=2;break;case"trip":y=3;break;case"quad":y=4}f.add(n,l,y,g,p)}return n};class e{add(t,e,n,r,o,i=!0){const s=this.map.get(t);if(void 0!==s){void 0===s.get(e)&&s.set(e,{order:n,flags:r,key:o})}else{const i=new Map;i.set(e,{order:n,flags:r,key:o}),this.map.set(t,i)}i&&this.add(e,t,n,r,o,!1)}constructor(t){this.id=t,this.map=new Map}}t.Entry=e}(r||(r={}))},64059:function(t,e,n){n.d(e,{Z:function(){return g}});var r=n(69926),o=n(15819),i=n(52500),s=n(49191),a=n(46031);function u(){throw new Error("Property only available for atomic models.")}function c(t){if(t)throw new Error(`Property only available for coarse models (${t}).`);throw new Error("Property only available for coarse models.")}const l={key:t=>t.element,x:t=>t.unit.conformation.x(t.element),y:t=>t.unit.conformation.y(t.element),z:t=>t.unit.conformation.z(t.element),id:t=>r.N.isAtomic(t.unit)?t.unit.model.atomicConformation.atomId.value(t.element):u(),occupancy:t=>r.N.isAtomic(t.unit)?t.unit.model.atomicConformation.occupancy.value(t.element):u(),B_iso_or_equiv:t=>r.N.isAtomic(t.unit)?t.unit.model.atomicConformation.B_iso_or_equiv.value(t.element):u(),sourceIndex:t=>r.N.isAtomic(t.unit)?t.unit.model.atomicHierarchy.atomSourceIndex.value(t.element):t.element,type_symbol:t=>r.N.isAtomic(t.unit)?t.unit.model.atomicHierarchy.atoms.type_symbol.value(t.element):u(),label_atom_id:t=>r.N.isAtomic(t.unit)?t.unit.model.atomicHierarchy.atoms.label_atom_id.value(t.element):u(),auth_atom_id:t=>r.N.isAtomic(t.unit)?t.unit.model.atomicHierarchy.atoms.auth_atom_id.value(t.element):u(),label_alt_id:t=>r.N.isAtomic(t.unit)?t.unit.model.atomicHierarchy.atoms.label_alt_id.value(t.element):u(),label_comp_id:d,auth_comp_id:t=>r.N.isAtomic(t.unit)?t.unit.model.atomicHierarchy.atoms.auth_comp_id.value(t.element):u(),pdbx_formal_charge:t=>r.N.isAtomic(t.unit)?t.unit.model.atomicHierarchy.atoms.pdbx_formal_charge.value(t.element):u(),vdw_radius:t=>r.N.isAtomic(t.unit)?(0,o.sO)(t.unit.model.atomicHierarchy.atoms.type_symbol.value(t.element)):u()};function d(t){return r.N.isAtomic(t.unit)||u(),t.unit.model.atomicHierarchy.atoms.label_comp_id.value(t.element)}function f(t){return r.N.isAtomic(t.unit)?t.unit.model.atomicHierarchy.residues.label_seq_id.value(t.unit.residueIndex[t.element]):u()}function m(t){r.N.isAtomic(t.unit)||u();const e=t.unit.model.sequence.byEntityKey[h(t)];return e&&e.sequence.microHet.get(f(t))||[d(t)]}function h(t){switch(t.unit.kind){case r.N.Kind.Atomic:return t.unit.model.atomicHierarchy.index.getEntityFromChain(t.unit.chainIndex[t.element]);case r.N.Kind.Spheres:return t.unit.model.coarseHierarchy.spheres.entityKey[t.element];case r.N.Kind.Gaussians:return t.unit.model.coarseHierarchy.gaussians.entityKey[t.element]}}const p=[],g={constant:{true:t=>!0,false:t=>!1,zero:t=>0},atom:l,residue:{key:t=>r.N.isAtomic(t.unit)?t.unit.residueIndex[t.element]:u(),group_PDB:t=>r.N.isAtomic(t.unit)?t.unit.model.atomicHierarchy.residues.group_PDB.value(t.unit.residueIndex[t.element]):u(),label_seq_id:f,auth_seq_id:t=>r.N.isAtomic(t.unit)?t.unit.model.atomicHierarchy.residues.auth_seq_id.value(t.unit.residueIndex[t.element]):u(),pdbx_PDB_ins_code:t=>r.N.isAtomic(t.unit)?t.unit.model.atomicHierarchy.residues.pdbx_PDB_ins_code.value(t.unit.residueIndex[t.element]):u(),isNonStandard:t=>r.N.isAtomic(t.unit)?m(t).some(e=>"n"===t.unit.model.properties.chemicalComponentMap.get(e).mon_nstd_flag[0]):u(),hasMicroheterogeneity:function(t){r.N.isAtomic(t.unit)||u();const e=t.unit.model.sequence.byEntityKey[h(t)];return e&&e.sequence.microHet.has(f(t))},microheterogeneityCompIds:m,secondary_structure_type:t=>{var e;r.N.isAtomic(t.unit)||u();const n=null===(e=s.v.get(t.structure).value)||void 0===e?void 0:e.get(t.unit.invariantId);return n?n.type[n.getIndex(t.unit.residueIndex[t.element])]:i.gG.Flag.NA},secondary_structure_key:t=>{var e;r.N.isAtomic(t.unit)||u();const n=null===(e=s.v.get(t.structure).value)||void 0===e?void 0:e.get(t.unit.invariantId);return n?n.key[n.getIndex(t.unit.residueIndex[t.element])]:-1},chem_comp_type:t=>r.N.isAtomic(t.unit)?t.unit.model.properties.chemicalComponentMap.get(d(t)).type:u(),residueSourceIndex:t=>r.N.isAtomic(t.unit)?t.unit.model.atomicHierarchy.residueSourceIndex.value(t.unit.residueIndex[t.element]):u()},chain:{key:t=>r.N.isAtomic(t.unit)?t.unit.chainIndex[t.element]:u(),label_asym_id:t=>r.N.isAtomic(t.unit)?t.unit.model.atomicHierarchy.chains.label_asym_id.value(t.unit.chainIndex[t.element]):t.unit.coarseElements.asym_id.value(t.element),auth_asym_id:t=>r.N.isAtomic(t.unit)?t.unit.model.atomicHierarchy.chains.auth_asym_id.value(t.unit.chainIndex[t.element]):u(),label_entity_id:t=>r.N.isAtomic(t.unit)?t.unit.model.atomicHierarchy.chains.label_entity_id.value(t.unit.chainIndex[t.element]):t.unit.coarseElements.entity_id.value(t.element)},entity:{key:h,id:t=>t.unit.model.entities.data.id.value(h(t)),type:t=>t.unit.model.entities.data.type.value(h(t)),src_method:t=>t.unit.model.entities.data.src_method.value(h(t)),pdbx_description:t=>t.unit.model.entities.data.pdbx_description.value(h(t)),formula_weight:t=>t.unit.model.entities.data.formula_weight.value(h(t)),pdbx_number_of_molecules:t=>t.unit.model.entities.data.pdbx_number_of_molecules.value(h(t)),details:t=>t.unit.model.entities.data.details.value(h(t)),pdbx_mutation:t=>t.unit.model.entities.data.pdbx_mutation.value(h(t)),pdbx_fragment:t=>t.unit.model.entities.data.pdbx_fragment.value(h(t)),pdbx_ec:t=>t.unit.model.entities.data.pdbx_ec.value(h(t)),pdbx_parent_entity_id:t=>t.unit.model.entities.data.pdbx_parent_entity_id.value(h(t)),subtype:t=>t.unit.model.entities.subtype.value(h(t)),prd_id:t=>{var e,n;return null!==(n=null===(e=t.unit.model.entities.prd_id)||void 0===e?void 0:e.value(h(t)))&&void 0!==n?n:""}},unit:{id:t=>t.unit.id,chainGroupId:t=>t.unit.chainGroupId,multiChain:t=>r.N.Traits.is(t.unit.traits,r.N.Trait.MultiChain),object_primitive:t=>t.unit.objectPrimitive,operator_name:t=>t.unit.conformation.operator.name,instance_id:t=>t.unit.conformation.operator.instanceId,operator_key:t=>t.unit.conformation.operator.key,model_index:t=>t.unit.model.modelNum,model_label:t=>t.unit.model.label,model_entry_id:t=>t.unit.model.entryId,hkl:t=>t.unit.conformation.operator.hkl,spgrOp:t=>t.unit.conformation.operator.spgrOp,model_num:t=>t.unit.model.modelNum,pdbx_struct_assembly_id:t=>{var e;return(null===(e=t.unit.conformation.operator.assembly)||void 0===e?void 0:e.id)||a.JX.DefaultName},pdbx_struct_oper_list_ids:t=>{var e;return(null===(e=t.unit.conformation.operator.assembly)||void 0===e?void 0:e.operList)||p},struct_ncs_oper_id:t=>t.unit.conformation.operator.ncsId},coarse:{key:l.key,entityKey:t=>r.N.isCoarse(t.unit)?t.unit.coarseElements.entityKey[t.element]:c(),x:l.x,y:l.y,z:l.z,asym_id:t=>r.N.isCoarse(t.unit)?t.unit.coarseElements.asym_id.value(t.element):c(),entity_id:t=>r.N.isCoarse(t.unit)?t.unit.coarseElements.entity_id.value(t.element):c(),seq_id_begin:t=>r.N.isCoarse(t.unit)?t.unit.coarseElements.seq_id_begin.value(t.element):c(),seq_id_end:t=>r.N.isCoarse(t.unit)?t.unit.coarseElements.seq_id_end.value(t.element):c(),sphere_radius:t=>r.N.isSpheres(t.unit)?t.unit.coarseConformation.radius[t.element]:c("spheres"),sphere_rmsf:t=>r.N.isSpheres(t.unit)?t.unit.coarseConformation.rmsf[t.element]:c("spheres"),gaussian_weight:t=>r.N.isGaussians(t.unit)?t.unit.coarseConformation.weight[t.element]:c("gaussians"),gaussian_covariance_matrix:t=>r.N.isGaussians(t.unit)?t.unit.coarseConformation.covariance_matrix[t.element]:c("gaussians")}}},64096:function(t,e,n){n.d(e,{S:function(){return l}});var r=n(13636),o=n(88255),i=n(1342);function s(t){const e=[];return u(t,t=>e.push(function(t){const{and:e}=r.J.core.logic,{eq:n,gre:o,lte:i}=r.J.core.rel,{macromolecular:s,ihm:u,core:c}=r.J.struct.atomProperty,l={};a(t.label_entity_id)&&(l["entity-test"]=n([s.label_entity_id(),t.label_entity_id]));const d=[];a(t.operator_name)&&d.push(n([c.operatorName(),t.operator_name])),a(t.instance_id)&&d.push(n([c.instanceId(),t.instance_id])),a(t.label_asym_id)&&d.push(n([s.label_asym_id(),t.label_asym_id])),a(t.auth_asym_id)&&d.push(n([s.auth_asym_id(),t.auth_asym_id])),1===d.length?l["chain-test"]=d[0]:d.length>1&&(l["chain-test"]=e(d));const f=[];a(t.label_seq_id)&&f.push(u.hasSeqId({0:t.label_seq_id})),a(t.auth_seq_id)&&f.push(n([s.auth_seq_id(),t.auth_seq_id])),a(t.residue_index)&&f.push(n([s.residueSourceIndex(),t.residue_index])),a(t.pdbx_PDB_ins_code)&&f.push(n([s.pdbx_PDB_ins_code(),t.pdbx_PDB_ins_code])),(a(t.beg_label_seq_id)||a(t.end_label_seq_id))&&f.push(u.overlapsSeqIdRange({beg:t.beg_label_seq_id,end:t.end_label_seq_id})),a(t.beg_auth_seq_id)&&f.push(o([s.auth_seq_id(),t.beg_auth_seq_id])),a(t.end_auth_seq_id)&&f.push(i([s.auth_seq_id(),t.end_auth_seq_id])),1===f.length?l["residue-test"]=f[0]:f.length>1&&(l["residue-test"]=e(f));const m=[];return a(t.label_comp_id)&&m.push(n([s.label_comp_id(),t.label_comp_id])),a(t.auth_comp_id)&&m.push(n([s.auth_comp_id(),t.auth_comp_id])),a(t.atom_id)&&m.push(n([s.id(),t.atom_id])),a(t.atom_index)&&m.push(n([r.J.struct.atomProperty.core.sourceIndex(),t.atom_index])),a(t.label_atom_id)&&m.push(n([s.label_atom_id(),t.label_atom_id])),a(t.auth_atom_id)&&m.push(n([s.auth_atom_id(),t.auth_atom_id])),a(t.type_symbol)&&m.push(n([r.J.struct.atomProperty.core.elementSymbol(),t.type_symbol.toUpperCase()])),1===m.length?l["atom-test"]=m[0]:m.length>1&&(l["atom-test"]=e(m)),r.J.struct.generator.atomGroups(l)}(t))),1===e.length?e[0]:function(t){return r.J.struct.combinator.merge(t.map(t=>r.J.struct.modifier.union([t])))}(e)}function a(t){return null!=t}function u(t,e){if(function(t){return!!t.items}(t))if(Array.isArray(t.items))if(t.prefix)for(const n of t.items)e(Object.assign({},t.prefix,n));else for(const n of t.items)e(n);else{const n={...t.prefix},r=Object.keys(t.items),o=t.items[r[0]].length;for(let i=0;i<o;i++){for(const e of r)n[e]=t.items[e][i];e(n)}}else e(t)}function c(t,e,n){const r=s(e);return i.Q.fromExpression(t,r,n)}const l={forEachItem:u,toExpression:s,toLoci:c,toBundle:function(t,e,n){const r=c(t,e,n);return o.N.fromLoci(r)}}},64832:function(t,e,n){n.d(e,{G:function(){return d},IU:function(){return u},RF:function(){return r},cS:function(){return f},jG:function(){return a},p4:function(){return c},xA:function(){return l}});var r,o=n(27125),i=n(94106),s=n(47925);function a(t,e){return{name:e,blocks:t}}function u(t,e,n,r=[]){return{categoryNames:t,header:n,categories:e,saveFrames:r,getField(t){const[n,r]=t.split(".");return e[n].getField(r||"")}}}function c(t,e,n){return{categoryNames:t,header:n,categories:e}}function l(t,e,n,r){return{rowCount:e,name:t,fieldNames:[...n],getField(t){return r[t]}}}function d(t,e,n,r){const o=n?0:1;switch(e){case 1:return"brackets"===r?e=>`${t}[${e+o}]`:e=>`${t}_${e+o}`;case 2:return"brackets"===r?(e,n)=>`${t}[${e+o}][${n+o}]`:(e,n)=>`${t}_${e+o}${n+o}`;case 3:return"brackets"===r?(e,n,r)=>`${t}[${e+o}][${n+o}][${r+o}]`:(e,n,r)=>`${t}_${e+o}${n+o}${r+o}`;default:throw new Error("Tensors with rank > 3 or rank 0 are currently not supported.")}}function f(t,e,n,r){const o=e.create();if(1===e.rank){const i=e.dimensions[0];for(let s=0;s<i;s++){const i=t.getField(r(s));e.set(o,s,i?i.float(n):0)}}else if(2===e.rank){const i=e.dimensions[0],s=e.dimensions[1];for(let a=0;a<i;a++)for(let i=0;i<s;i++){const s=t.getField(r(a,i));e.set(o,a,i,s?s.float(n):0)}}else{if(3!==e.rank)throw new Error("Tensors with rank > 3 or rank 0 are currently not supported.");{const i=e.dimensions[0],s=e.dimensions[1],a=e.dimensions[2];for(let u=0;u<i;u++)for(let i=0;i<s;i++)for(let s=0;s<a;s++){const a=t.getField(r(u,i,s));e.set(o,u,i,s,a?a.float(n):0)}}}return o}!function(t){function e(t,e){const n=Object.keys(e);return{rowCount:n.length>0?e[n[0]].rowCount:0,name:t,fieldNames:n,getField(t){return e[t]}}}t.empty=function(t){return{rowCount:0,name:t,fieldNames:[],getField(t){}}},t.ofFields=e,t.ofTable=function(t,n){const o={};for(const e of n._columns)o[e]=r.ofColumn(n[e]);return e(t,o)}}(l||(l={})),function(t){function e(t){const e=t.length,n=e=>{const n=t[e];return n&&"."!==n&&"?"!==n?n:""},r=e=>{const n=t[e];return(0,i.H9)(n,0,n.length)||0},s=e=>{const n=t[e];return(0,i.sS)(n,0,n.length)||0};return{__array:void 0,binaryEncoding:void 0,isDefined:!0,rowCount:e,str:n,int:r,float:s,valueKind:e=>{const n=t[e],r=n.length;if(r>1)return o.VP.ValueKinds.Present;if(0===r)return o.VP.ValueKinds.NotPresent;const i=n.charCodeAt(0);return 46===i?o.VP.ValueKinds.NotPresent:63===i?o.VP.ValueKinds.Unknown:o.VP.ValueKinds.Present},areValuesEqual:(e,n)=>t[e]===t[n],toStringArray:r=>r?o.iu.createAndFillArray(e,n,r):t,toIntArray:t=>o.iu.createAndFillArray(e,r,t),toFloatArray:t=>o.iu.createAndFillArray(e,s,t)}}function n(t){const{rowCount:e,valueKind:n,areValuesEqual:r,isDefined:s}=t;let a,u,c;switch(t.schema.valueType){case"float":case"int":a=e=>""+t.value(e),u=t.value,c=t.value;break;case"str":a=t.value,u=e=>{const n=t.value(e);return(0,i.H9)(n,0,n.length)||0},c=e=>{const n=t.value(e);return(0,i.sS)(n,0,n.length)||0};break;case"list":const{separator:e}=t.schema;a=n=>t.value(n).join(e),u=t=>NaN,c=t=>NaN;break;default:throw new Error(`unsupported valueType '${t.schema.valueType}'`)}return{__array:void 0,binaryEncoding:void 0,isDefined:s,rowCount:e,str:a,int:u,float:c,valueKind:n,areValuesEqual:r,toStringArray:t=>o.iu.createAndFillArray(e,a,t),toIntArray:t=>o.iu.createAndFillArray(e,u,t),toFloatArray:t=>o.iu.createAndFillArray(e,c,t)}}t.ofString=function(t){return e([t])},t.ofStrings=e,t.ofNumbers=function(t){const e=t.length,n=e=>""+t[e],r=e=>t[e],i=n=>!n||n.array&&t instanceof n.array?t:o.iu.createAndFillArray(e,r,n);return{__array:void 0,binaryEncoding:void 0,isDefined:!0,rowCount:e,str:n,int:r,float:r,valueKind:t=>o.VP.ValueKinds.Present,areValuesEqual:(e,n)=>t[e]===t[n],toStringArray:t=>o.iu.createAndFillArray(e,n,t),toIntArray:i,toFloatArray:i}},t.ofTokens=function(t){const{data:e,indices:n,count:r}=t,a=t=>{const r=e.substring(n[2*t],n[2*t+1]);return"."===r||"?"===r?"":r},u=t=>(0,i.H9)(e,n[2*t],n[2*t+1])||0,c=t=>(0,i.sS)(e,n[2*t],n[2*t+1])||0;return{__array:void 0,binaryEncoding:void 0,isDefined:!0,rowCount:r,str:a,int:u,float:c,valueKind:t=>{const r=n[2*t],i=n[2*t+1]-r;if(i>1)return o.VP.ValueKinds.Present;if(0===i)return o.VP.ValueKinds.NotPresent;const s=e.charCodeAt(r);return 46===s?o.VP.ValueKinds.NotPresent:63===s?o.VP.ValueKinds.Unknown:o.VP.ValueKinds.Present},areValuesEqual:(0,s.k5)(t),toStringArray:t=>o.iu.createAndFillArray(r,a,t),toIntArray:t=>o.iu.createAndFillArray(r,u,t),toFloatArray:t=>o.iu.createAndFillArray(r,c,t)}},t.ofColumn=n,t.ofUndefined=function(t,e){return n(o.VP.Undefined(t,e))}}(r||(r={}))},65533:function(t,e,n){n.d(e,{Yz:function(){return c},IX:function(){return r.I},YB:function(){return a},CD:function(){return o.C},hT:function(){return i.h},X9:function(){return s.X}});var r=n(90790),o=n(12606),i=n(62020),s=n(87504);n(4543);function a(t){return new u(t)}class u{remove(t){const{prev:e,next:n}=this,r=e[t],o=n[t];r>=0&&(n[r]=o,e[t]=-1),o>=0&&(e[o]=r,n[t]=-1),t===this.head&&(this.head=r<0?o:r)}has(t){return this.prev[t]>=0||this.next[t]>=0||this.head===t}constructor(t){this.head=t>0?0:-1,this.prev=new Int32Array(t),this.next=new Int32Array(t);for(let e=0;e<t;e++)this.next[e]=e+1,this.prev[e]=e-1;this.prev[0]=-1,this.next[t-1]=-1}}var c,l=n(38530);!function(t){function e(){return new Map}t.Empty=new Map,t.keyArray=function(t){return(0,l.ZR)(t.keys())},t.Mutable=e,t.asImmutable=function(t){return t},t.copy=function(t){const n=e(),r=t.keys();for(;;){const{done:e,value:o}=r.next();if(e)break;n.set(o,t.get(o))}return n},t.addFrom=function(t,e){const n=e.keys();for(;;){const{done:r,value:o}=n.next();if(r)break;t.set(o,e.get(o))}return t}}(c||(c={}));n(62601)},65622:function(t,e,n){n.d(e,{J:function(){return o}});var r=n(86242);function o(t){return c({buffer:t,offset:0,dataView:new DataView(t.buffer)})}function i(t,e){const n={};for(let r=0;r<e;r++){n[c(t)]=c(t)}return n}function s(t,e){const n=new Uint8Array(e),r=t.offset;for(let o=0;o<e;o++)n[o]=t.buffer[o+r];return t.offset+=e,n}function a(t,e){const n=(0,r.ss)(t.buffer,t.offset,e);return t.offset+=e,n}function u(t,e){const n=new Array(e);for(let r=0;r<e;r++)n[r]=c(t);return n}function c(t){const e=t.buffer[t.offset];let n,r;if(!(128&e))return t.offset++,e;if(128==(240&e))return r=15&e,t.offset++,i(t,r);if(144==(240&e))return r=15&e,t.offset++,u(t,r);if(160==(224&e))return r=31&e,t.offset++,a(t,r);if(!(224&~e))return n=t.dataView.getInt8(t.offset),t.offset++,n;switch(e){case 192:return t.offset++,null;case 194:return t.offset++,!1;case 195:return t.offset++,!0;case 196:return r=t.dataView.getUint8(t.offset+1),t.offset+=2,s(t,r);case 197:return r=t.dataView.getUint16(t.offset+1),t.offset+=3,s(t,r);case 198:return r=t.dataView.getUint32(t.offset+1),t.offset+=5,s(t,r);case 202:return n=t.dataView.getFloat32(t.offset+1),t.offset+=5,n;case 203:return n=t.dataView.getFloat64(t.offset+1),t.offset+=9,n;case 204:return n=t.buffer[t.offset+1],t.offset+=2,n;case 205:return n=t.dataView.getUint16(t.offset+1),t.offset+=3,n;case 206:return n=t.dataView.getUint32(t.offset+1),t.offset+=5,n;case 208:return n=t.dataView.getInt8(t.offset+1),t.offset+=2,n;case 209:return n=t.dataView.getInt16(t.offset+1),t.offset+=3,n;case 210:return n=t.dataView.getInt32(t.offset+1),t.offset+=5,n;case 217:return r=t.dataView.getUint8(t.offset+1),t.offset+=2,a(t,r);case 218:return r=t.dataView.getUint16(t.offset+1),t.offset+=3,a(t,r);case 219:return r=t.dataView.getUint32(t.offset+1),t.offset+=5,a(t,r);case 220:return r=t.dataView.getUint16(t.offset+1),t.offset+=3,u(t,r);case 221:return r=t.dataView.getUint32(t.offset+1),t.offset+=5,u(t,r);case 222:return r=t.dataView.getUint16(t.offset+1),t.offset+=3,i(t,r);case 223:return r=t.dataView.getUint32(t.offset+1),t.offset+=5,i(t,r)}throw new Error("Unknown type 0x"+e.toString(16))}},66231:function(t,e,n){n.d(e,{m:function(){return r}});var r,o=n(65533);!function(t){function e(t){return t[t.length-1]}function n(t){return t.length/2}function r(t,e){return t[2*e]}function i(t,e){return t[2*e+1]+1}function s(t,e){return t[2*e]}function a(t,e){return t[2*e+1]}function u(t,e){return c(t,e,0)}function c(t,r,i){if(s(t,i)>o.CD.max(r)||e(t)<o.CD.min(r))return-1;for(let e=i,u=n(t);e<u;++e){const n=o.IX.ofRange(s(t,e),a(t,e));if(o.CD.areIntersecting(n,r))return e}return-1}t.ofSortedRanges=function(t){return o.X9.ofSortedArray(t)},t.start=function(t){return t[0]},t.end=function(t){return t[t.length-1]+1},t.min=function(t){return t[0]},t.max=e,t.size=function(t){let e=0;for(let n=0,r=t.length;n<r;n+=2)e+=t[n+1]-t[n]+1;return e},t.count=n,t.startAt=r,t.endAt=i,t.minAt=s,t.maxAt=a,t.areEqual=function(t,e){if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;++n)if(t[n]!==e[n])return!1;return!0},t.forEach=function(t,e){let n=0;for(let r=0,o=t.length;r<o;r+=2)for(let i=t[r],s=t[r+1];i<=s;++i)e(i,n),++n},t.has=function(t,e){return-1!==u(t,e)},t.hasFrom=function(t,e,n){return-1!==c(t,e,n)},t.firstIntersectionIndex=u,t.firstIntersectionIndexFrom=c,t.transientSegments=function(t,e){return new l(t,e)};class l{updateValue(){this.value.index=this.curIndex,this.value.start=o.CD.findPredecessorIndex(this.set,r(this.ranges,this.curIndex)),this.value.end=o.CD.findPredecessorIndex(this.set,i(this.ranges,this.curIndex))}move(){return this.hasNext&&(this.updateValue(),this.curIndex=c(this.ranges,this.set,this.curIndex+1),this.hasNext=-1!==this.curIndex),this.value}constructor(t,e){this.ranges=t,this.set=e,this.value={index:0,start:0,end:0},this.curIndex=0,this.hasNext=!1,this.curIndex=u(t,e),this.hasNext=-1!==this.curIndex}}t.Iterator=l}(r||(r={}))},68223:function(t,e,n){var r;n.d(e,{Z:function(){return r}}),function(t){function e(t,e,n){return{kind:"value",namespace:t,name:e,parent:n}}function n(t,e,n,r){const o=Object.create(null);for(const i of r)o[i]=!0;return{kind:"oneof",namespace:t,name:e,type:n,values:o}}t.Variable=function(t,e,n){return{kind:"variable",name:t,type:e,isConstraint:n}},t.Value=e,t.Container=function(t,e,n,r){return{kind:"container",namespace:t,name:e,child:n,alias:r}},t.Union=function(t){return{kind:"union",types:t}},t.OneOf=n,t.Any={kind:"any"},t.AnyValue={kind:"any-value"},t.Num=e("","Number"),t.Str=e("","String"),t.Bool=n("","Bool",t.Str,["true","false"]),t.oneOfValues=function({values:t}){return Object.keys(t).sort()}}(r||(r={}))},69926:function(t,e,n){n.d(e,{N:function(){return w}});var r=n(22463),o=n(10486),i=n(46031),s=n(9239),a=n(15819),u=n(51142),c=n(93818),l=n(65533),d=n(38530),f=n(28243),m=n(66231),h=n(52500);var p=n(75847),g=n(73868);const y=(0,g.eB)();function _(t){const e=function(t){const{elements:e,conformation:n}=t,r=new Float32Array(3*e.length);for(let o=0,i=e.length;o<i;o++)n.invariantPosition(e[o],y),g.eB.toArray(y,r,3*o);return r}(t);return p.c.ofPositions(e)}var A=n(71626),b=n(94901);class C{constructor(){this.data=new Map}get(t){const e=l.X9.hashCode(t);if(this.data.has(e))for(const[n,r]of this.data.get(e))if(l.X9.areEqual(t,n))return r}set(t,e){const n=l.X9.hashCode(t);if(this.data.has(n)){const r=this.data.get(n);for(const n of r)if(l.X9.areEqual(t,n[0]))return void(n[1]=e);r.push([t,e])}else this.data.set(n,[[t,e]])}static get(t){return t._dynamicPropertyData.ElementSetIntraBondCache||(t._dynamicPropertyData.ElementSetIntraBondCache=new C),t._dynamicPropertyData.ElementSetIntraBondCache}}var S=n(35256),x=n(87504);const v={delocalizedTriplets:{getThirdElement:()=>{},getTripletIndices:()=>{},triplets:[]}};function B(t){return w.Traits.is(t.traits,w.Trait.Water)||w.Traits.is(t.traits,w.Trait.CoarseGrained)?v:{delocalizedTriplets:I(t)}}function I(t){const e=t.bonds,{b:n,edgeProps:r,offset:o}=e,{order:i,flags:s}=r,{elementAromaticRingIndices:a}=t.rings,u=[],c=new Map,l=new Map,f=(t,e,n)=>{const r=u.length;u.push(x.X.ofUnsortedArray([t,e,n])),c.set((0,d.bd)(t,e),n),l.has(t)?l.get(t).push(r):l.set(t,[r])};for(let d=0;d<t.elements.length;d++){if(a.has(d))continue;if(o[d+1]-o[d]+1<2)continue;const t=[];for(let e=o[d],r=o[d+1];e<r;e++){const r=s[e];h.I$.is(r,h.I$.Flag.Aromatic)&&t.push(n[e])}if(t.length>=2){f(d,t[0],t[1]);for(let e=1,n=t.length;e<n;e++)f(d,t[e],t[0])}}return{getThirdElement:(t,e)=>c.get((0,d.bd)(t,e)),getTripletIndices:t=>l.get(t),triplets:u}}var w;!function(t){let e,n,p,y;function x(t){const e=[];for(let n=0,r=t.length;n<r;n++)e.push(t[n].id);return(0,d.TI)(e)}function v(t){const e={};return{elements:t[0].elements,units:t,get unitIndexMap(){return e.unitIndexMap||(e.unitIndexMap=function(t){const e=l.Yz.Mutable();for(let n=0,r=t.length;n<r;n++)e.set(t[n].id,n);return e}(t)),e.unitIndexMap},hashCode:I(t[0]),transformHash:x(t)}}function I(t){return(0,d.vb)(t.invariantId,l.X9.hashCode(t.elements))}function w(t){const e=t.atomicHierarchy.atoms.type_symbol.value;return t=>(0,a.sO)(e(t))}function P(t){const e=t.coarseConformation.spheres.radius;return t=>e[t]}!function(t){t[t.Atomic=0]="Atomic",t[t.Spheres=1]="Spheres",t[t.Gaussians=2]="Gaussians"}(e=t.Kind||(t.Kind={})),function(t){t[t.Atomic=0]="Atomic",t[t.Spheres=1]="Spheres",t[t.Gaussians=2]="Gaussians"}(n=t.Kinds||(t.Kinds={})),t.isAtomic=function(t){return t.kind===e.Atomic},t.isCoarse=function(t){return t.kind===e.Spheres||t.kind===e.Gaussians},t.isSpheres=function(t){return t.kind===e.Spheres},t.isGaussians=function(t){return t.kind===e.Gaussians},t.create=function(t,n,o,i,s,a,u,c,l){switch(s){case e.Atomic:return new D(t,n,o,i,a,c,r.J.createMapping(u,a.atomicConformation,w(a)),null!=l?l:M());case e.Spheres:return T(t,n,o,i,a,e.Spheres,c,r.J.createMapping(u,a.coarseConformation.spheres,P(a)),null!=l?l:k());case e.Gaussians:return T(t,n,o,i,a,e.Gaussians,c,r.J.createMapping(u,a.coarseConformation.gaussians,t=>0),null!=l?l:k())}},t.SymmetryGroup=v,function(t){t.areInvariantElementsEqual=function(t,e){return t.hashCode===e.hashCode&&l.X9.areEqual(t.elements,e.elements)},t.getUnitSymmetryGroupsIndexMap=function(t){const e=l.Yz.Mutable();for(let n=0,r=t.length;n<r;++n){const r=t[n];for(let t=0,o=r.units.length;t<o;++t)e.set(r.units[t].id,n)}return e}}(v=t.SymmetryGroup||(t.SymmetryGroup={})),t.conformationId=function(e){return t.isAtomic(e)?e.model.atomicConformation.id:e.model.coarseConformation.id},t.hashUnit=I,function(t){t[t.None=0]="None",t[t.MultiChain=1]="MultiChain",t[t.Partitioned=2]="Partitioned",t[t.FastBoundary=4]="FastBoundary",t[t.Water=8]="Water",t[t.CoarseGrained=16]="CoarseGrained"}(p=t.Trait||(t.Trait={})),function(t){t.is=u.NJ.has,t.create=u.NJ.create}(y=t.Traits||(t.Traits={}));class D{get transientCache(){return void 0===this._transientCache&&(this._transientCache=new Map),this._transientCache}getChild(t){return t.length===this.elements.length?this:new D(this.id,this.invariantId,this.chainGroupId,this.traits,this.model,t,this.conformation,M())}getCopy(t,e,n,r){const o=new D(t,e,n,this.traits,this.model,this.elements,this.conformation,this.props);return(null==r?void 0:r.propagateTransientCache)&&(o._transientCache=this._transientCache),o}applyOperator(t,e,n=!1){const o=n?e:r.J.compose(this.conformation.operator,e);return new D(t,this.invariantId,this.chainGroupId,this.traits,this.model,this.elements,r.J.createMapping(o,this.model.atomicConformation,this.conformation.r),this.props)}remapModel(e,n,s){var a,u;s||(s={...this.props,bonds:n&&!(null===(u=null===(a=this.props.bonds)||void 0===a?void 0:a.props)||void 0===u?void 0:u.canRemap)?void 0:R(this,this.props.bonds,e,n)},t.isSameConformation(this,e)||(s.boundary=void 0,s.lookup3d=void 0,s.principalAxes=void 0));let c=this.conformation.operator;const l=S.i.Provider.get(e);if(-1!==c.spgrOp&&l&&l!==S.i.Provider.get(this.model)){const[t,n,r]=c.hkl,{toFractional:s}=l.spacegroup.cell,a=g.eB.transformMat4((0,g.eB)(),o.Kx.getCenter(e),s);c=i.is.getSymmetryOperatorRef(l.spacegroup,c.spgrOp,t,n,r,a)}const d=this.model.atomicConformation!==e.atomicConformation||c!==this.conformation.operator?r.J.createMapping(c,e.atomicConformation,w(e)):this.conformation;return new D(this.id,this.invariantId,this.chainGroupId,this.traits,e,this.elements,d,s)}get boundary(){if(this.props.boundary)return this.props.boundary;const{x:t,y:e,z:n}=this.model.atomicConformation,r=o.Kx.getAtomicRadii(this.model);return this.props.boundary=y.is(this.traits,p.FastBoundary)?(0,A.b)({x:t,y:e,z:n,radius:r,indices:this.elements}):(0,A.r)({x:t,y:e,z:n,radius:r,indices:this.elements}),this.props.boundary}get lookup3d(){if(this.props.lookup3d)return this.props.lookup3d;const{x:t,y:e,z:n}=this.model.atomicConformation;return this.props.lookup3d=(0,i.Eh)({x:t,y:e,z:n,indices:this.elements},this.boundary),this.props.lookup3d}get principalAxes(){return this.props.principalAxes||(this.props.principalAxes=_(this)),this.props.principalAxes}get bonds(){var t;if(this.props.bonds)return this.props.bonds;const e=C.get(this.model);let n=e.get(this.elements);return n||(n=(0,s.MQ)(this),(null===(t=n.props)||void 0===t?void 0:t.cacheable)&&e.set(this.elements,n)),this.props.bonds=n,this.props.bonds}get rings(){return this.props.rings||(this.props.rings=c.g.create(this)),this.props.rings}get resonance(){return this.props.resonance||(this.props.resonance=B(this)),this.props.resonance}get polymerElements(){return this.props.polymerElements||(this.props.polymerElements=function(t){const e=[],{elements:n,model:r}=t,{residueAtomSegments:o}=t.model.atomicHierarchy,{traceElementIndex:i}=r.atomicHierarchy.derived.residue,s=m.m.transientSegments(t.model.atomicRanges.polymerRanges,n),a=l.hT.transientSegments(o,n);for(;s.hasNext;){const t=s.move();for(a.setSegment(t);a.hasNext;){const t=a.move(),{start:r,end:s,index:u}=t;if(l.CD.areIntersecting(l.IX.ofRange(n[r],n[s-1]),n)){const t=i[u];e.push(-1===t?o.offsets[u]:t)}}}return l.X9.ofSortedArray(e)}(this)),this.props.polymerElements}get gapElements(){return this.props.gapElements||(this.props.gapElements=function(t){const e=[],{elements:n,model:r,residueIndex:o}=t,{residueAtomSegments:i}=t.model.atomicHierarchy,{traceElementIndex:s}=r.atomicHierarchy.derived.residue,a=m.m.transientSegments(t.model.atomicRanges.gapRanges,t.elements);for(;a.hasNext;){const t=a.move(),r=o[n[t.start]],u=o[n[t.end-1]],c=s[r],l=s[u];e.push(-1===c?i.offsets[r]:c),e.push(-1===l?i.offsets[u]:l)}return l.X9.ofSortedArray(e)}(this)),this.props.gapElements}get nucleotideElements(){return this.props.nucleotideElements||(this.props.nucleotideElements=function(t){const e=[],{elements:n,model:r}=t,{chainAtomSegments:o,residueAtomSegments:i}=r.atomicHierarchy,{moleculeType:s,traceElementIndex:a}=r.atomicHierarchy.derived.residue,u=l.hT.transientSegments(o,n),c=l.hT.transientSegments(i,n);for(;u.hasNext;)for(c.setSegment(u.move());c.hasNext;){const{index:t}=c.move();if((0,h.OV)(s[t])){const n=a[t];e.push(-1===n?i.offsets[t]:n)}}return l.X9.ofSortedArray(e)}(this)),this.props.nucleotideElements}get proteinElements(){return this.props.proteinElements||(this.props.proteinElements=function(t){const e=[],{elements:n,model:r}=t,{chainAtomSegments:o,residueAtomSegments:i}=r.atomicHierarchy,{moleculeType:s,traceElementIndex:a}=r.atomicHierarchy.derived.residue,u=l.hT.transientSegments(o,n),c=l.hT.transientSegments(i,n);for(;u.hasNext;)for(c.setSegment(u.move());c.hasNext;){const{index:t}=c.move();if((0,h.iu)(s[t])){const n=a[t];e.push(-1===n?i.offsets[t]:n)}}return l.X9.ofSortedArray(e)}(this)),this.props.proteinElements}get residueCount(){if(void 0!==this.props.residueCount)return this.props.residueCount;let t=0;const e=l.hT.transientSegments(this.model.atomicHierarchy.residueAtomSegments,this.elements);for(;e.hasNext;)e.move(),t+=1;return this.props.residueCount=t,this.props.residueCount}getResidueIndex(t){return this.residueIndex[this.elements[t]]}constructor(t,n,r,o,i,s,a,u){this.kind=e.Atomic,this.objectPrimitive="atomistic",this._transientCache=void 0,this.id=t,this.invariantId=n,this.chainGroupId=r,this.traits=o,this.model=i,this.elements=s,this.conformation=a,this.residueIndex=i.atomicHierarchy.residueAtomSegments.index,this.chainIndex=i.atomicHierarchy.chainAtomSegments.index,this.props=u}}function M(){return{}}t.Atomic=D;class N{get transientCache(){return void 0===this._transientCache&&(this._transientCache=new Map),this._transientCache}getChild(t){return t.length===this.elements.length?this:T(this.id,this.invariantId,this.chainGroupId,this.traits,this.model,this.kind,t,this.conformation,k())}getCopy(t,e,n,r){const o=T(t,e,n,this.traits,this.model,this.kind,this.elements,this.conformation,this.props);return(null==r?void 0:r.propagateTransientCache)&&(o._transientCache=this._transientCache),o}applyOperator(t,e,n=!1){const o=n?e:r.J.compose(this.conformation.operator,e);return T(t,this.invariantId,this.chainGroupId,this.traits,this.model,this.kind,this.elements,r.J.createMapping(o,this.getCoarseConformation(),this.conformation.r),this.props)}remapModel(e,n,o){const i=this.getCoarseConformation(),s=E(this.kind,e);o||(o={...this.props},t.isSameConformation(this,e)||(o.boundary=void 0,o.lookup3d=void 0,o.principalAxes=void 0));const a=i!==s?r.J.createMapping(this.conformation.operator,s,this.kind===t.Kind.Spheres?P(e):t=>0):this.conformation;return new N(this.id,this.invariantId,this.chainGroupId,this.traits,e,this.kind,this.elements,a,o)}get boundary(){if(this.props.boundary)return this.props.boundary;const{x:t,y:e,z:n}=this.getCoarseConformation(),r=this.getCoarseRadii();return this.props.boundary=y.is(this.traits,p.FastBoundary)?(0,A.b)({x:t,y:e,z:n,radius:r,indices:this.elements}):(0,A.r)({x:t,y:e,z:n,radius:r,indices:this.elements}),this.props.boundary}get lookup3d(){if(this.props.lookup3d)return this.props.lookup3d;const{x:t,y:e,z:n}=this.getCoarseConformation();return this.props.lookup3d=(0,i.Eh)({x:t,y:e,z:n,indices:this.elements},this.boundary),this.props.lookup3d}get principalAxes(){return this.props.principalAxes||(this.props.principalAxes=_(this)),this.props.principalAxes}get polymerElements(){return this.props.polymerElements||(this.props.polymerElements=function(t){const e=[],{elements:n,model:r}=t,{spheres:o,gaussians:i}=r.coarseHierarchy,s=f.Nf.isSpheres(t)?o.polymerRanges:i.polymerRanges,a=m.m.transientSegments(s,n);for(;a.hasNext;){const{start:t,end:r}=a.move();for(let o=t;o<r;++o)e.push(n[o])}return l.X9.ofSortedArray(e)}(this)),this.props.polymerElements}get gapElements(){return this.props.gapElements||(this.props.gapElements=function(t){const e=[],{elements:n,model:r}=t,{spheres:o,gaussians:i}=r.coarseHierarchy,s=f.Nf.isSpheres(t)?o.gapRanges:i.gapRanges,a=m.m.transientSegments(s,n);for(;a.hasNext;){const{start:t,end:r}=a.move();e.push(n[t],n[r-1])}return l.X9.ofSortedArray(e)}(this)),this.props.gapElements}getCoarseConformation(){return E(this.kind,this.model)}getCoarseRadii(){return t=this.kind,n=this.model,t===e.Spheres?n.coarseConformation.spheres.radius:void 0;var t,n}constructor(t,n,r,o,i,s,a,u,c){this._transientCache=void 0,this.kind=s,this.objectPrimitive=s===e.Spheres?"sphere":"gaussian",this.id=t,this.invariantId=n,this.chainGroupId=r,this.traits=o,this.model=i,this.elements=a,this.conformation=u,this.coarseElements=s===e.Spheres?i.coarseHierarchy.spheres:i.coarseHierarchy.gaussians,this.coarseConformation=s===e.Spheres?i.coarseConformation.spheres:i.coarseConformation.gaussians,this.props=c}}function E(t,n){return t===e.Spheres?n.coarseConformation.spheres:n.coarseConformation.gaussians}function k(){return{}}t.Spheres=class extends N{};function T(t,e,n,r,o,i,s,a,u){return new N(t,e,n,r,o,i,s,a,u)}function R(t,e,n,r){var o;if(!e)return;if(t.model.atomicConformation.id===n.atomicConformation.id)return e;const i=b.z.Provider.get(t.model);if(i){const t=b.z.Provider.get(n);return t&&i!==t?void 0:e}return(null===(o=e.props)||void 0===o?void 0:o.canRemap)||!r||U(t,n)?e:void 0}function U(t,e){const n=o.Kx.CoordinatesHistory.get(o.Kx.getRoot(e));if(n)return n.areEqual(t.elements,t.kind,e);const r=t.elements,{x:i,y:s,z:a}=t.conformation.coordinates,{x:u,y:c,z:l}=H(t.kind,e);for(let o=0,d=r.length;o<d;o++){const t=r[o];if(i[t]!==u[t]||s[t]!==c[t]||a[t]!==l[t])return!1}return!0}function H(t,n){return t===e.Atomic?n.atomicConformation:t===e.Spheres?n.coarseConformation.spheres:n.coarseConformation.gaussians}function O(t,n){return t===e.Atomic?n.atomicHierarchy:t===e.Spheres?n.coarseHierarchy.spheres:n.coarseHierarchy.gaussians}t.Gaussians=class extends N{},t.areSameChainOperatorGroup=function(t,e){return t.chainGroupId===e.chainGroupId&&t.conformation.operator.name===e.conformation.operator.name},t.areOperatorsEqual=function(t,e){return g.$I.areEqual(t.conformation.operator.matrix,e.conformation.operator.matrix,1e-6)},t.areConformationsEqual=function(t,e){return t===e||!!l.X9.areEqual(t.elements,e.elements)&&U(t,e.model)},t.isSameConformation=U,t.getModelConformationOfKind=H,t.getConformation=function(t){return H(t.kind,t.model)},t.getModelHierarchyOfKind=O,t.getHierarchy=function(t){return O(t.kind,t.model)}}(w||(w={}))},70318:function(t,e,n){n.d(e,{V:function(){return s}});var r=n(52500),o=n(27125),i=n(84796);class s{constructor(){this.count=0,this.ids=[],this.types=[],this.descriptions=[],this.compoundsMap=new Map,this.namesMap=new Map,this.heteroMap=new Map,this.chainMap=new Map}set(t,e){this.count+=1,this.ids.push(`${this.count}`),this.types.push(t),this.descriptions.push([e])}getEntityId(t,e,n,o){return e===r.HX.Water?(void 0===this.waterId&&(this.set("water",(null==o?void 0:o.customName)||"Water"),this.waterId=`${this.count}`),this.waterId):(0,r.z7)(e)?this.compoundsMap.has(n)?this.compoundsMap.get(n):(this.chainMap.has(n)||(this.set("polymer",(null==o?void 0:o.customName)||`Polymer ${this.chainMap.size+1}`),this.chainMap.set(n,`${this.count}`)),this.chainMap.get(n)):(this.heteroMap.has(t)||(this.set("non-polymer",(null==o?void 0:o.customName)||this.namesMap.get(t)||t),this.heteroMap.set(t,`${this.count}`)),this.heteroMap.get(t))}getEntityTable(){return o.XI.ofPartialColumns(i.e.entity,{id:o.VP.ofStringArray(this.ids),type:o.VP.ofStringAliasArray(this.types),pdbx_description:o.VP.ofStringListArray(this.descriptions)},this.count)}setCompounds(t){for(let e=0,n=t.length;e<n;++e){const{chains:n,description:r}=t[e];this.set("polymer",r);for(let t=0,e=n.length;t<e;++t)this.compoundsMap.set(n[t],`${this.count}`)}}setNames(t){t.forEach(t=>this.namesMap.set(t[0],t[1]))}}},70888:function(t,e,n){n.d(e,{k:function(){return r}});var r,o=n(86143);!function(t){const e="undefined"!=typeof btoa?btoa:t=>Buffer.from(t).toString("base64"),n=[];t.create22=function(){let t=+new Date+(0,o.t)();for(let e=0;e<16;e++)n[e]=String.fromCharCode((t+255*Math.random())%255|0),t=Math.floor(t/255);return e(n.join("")).replace(/\+/g,"-").replace(/\//g,"_").substr(0,22)},t.createv4=function(){let t=+new Date+(0,o.t)();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?n:3&n|8).toString(16)})},t.is=function(t){return"string"==typeof t}}(r||(r={}))},71460:function(t,e,n){n.d(e,{A:function(){return r}});var r,o=n(52500),i=n(27125),s=n(65533),a=n(62769),u=n(38818),c=n(58392);!function(t){function e({units:t},e){for(let n=0,r=t.length;n<r;n++)if(s.X9.indexOf(t[n].elements,e)>=0)return!0;return!1}t.Descriptor={name:"struct_conn",cifExport:{prefix:"",categories:[{name:"struct_conn",instance(n){const r=t.Provider.get(n.firstModel);if(!r||0===r.entries.length)return a.c.Category.Empty;const o=n.structures[0],i=[];for(const t of r.entries)e(o,t.partnerA.atomIndex)&&e(o,t.partnerB.atomIndex)&&(i[i.length]=t.rowIndex);return a.c.Category.ofTable(r.data,i)}}]}},t.Provider=c.q.create(t.Descriptor),t.isExhaustive=function(e){const n=t.Provider.get(e);return!!n&&n.entries.length/e.atomicConformation.atomId.rowCount>.95},t.getAtomIndexFromEntries=function(t){const e=new Map;for(const n of t){const{partnerA:{atomIndex:t},partnerB:{atomIndex:r}}=n;e.has(t)?e.get(t).push(n):e.set(t,[n]),e.has(r)?e.get(r).push(n):e.set(r,[n])}return e},t.getEntriesFromStructConn=function(t,e){const{conn_type_id:n,pdbx_dist_value:r,pdbx_value_order:s}=t,a={label_asym_id:t.ptnr1_label_asym_id,label_seq_id:t.ptnr1_label_seq_id,auth_seq_id:t.ptnr1_auth_seq_id,label_atom_id:t.ptnr1_label_atom_id,label_alt_id:t.pdbx_ptnr1_label_alt_id,ins_code:t.pdbx_ptnr1_PDB_ins_code,symmetry:t.ptnr1_symmetry},c={label_asym_id:t.ptnr2_label_asym_id,label_seq_id:t.ptnr2_label_seq_id,auth_seq_id:t.ptnr2_auth_seq_id,label_atom_id:t.ptnr2_label_atom_id,label_alt_id:t.pdbx_ptnr2_label_alt_id,ins_code:t.pdbx_ptnr2_PDB_ins_code,symmetry:t.ptnr2_symmetry},l=Array.from(e.entities.data.id.toArray()),d=(t,n)=>{if(n.label_asym_id.valueKind(t)!==i.VP.ValueKinds.Present)return;const r=n.label_asym_id.value(t),o=n.label_atom_id.value(t);if(!o)return;const s=n.auth_seq_id.valueKind(t)===i.VP.ValueKind.Present?n.auth_seq_id.value(t):n.label_seq_id.value(t),a=n.ins_code.value(t),u=n.label_alt_id.value(t);for(const i of l){const c=e.atomicHierarchy.index.findResidue(i,r,s,a);if(c<0)continue;const l=e.atomicHierarchy.index.findAtomOnResidue(c,o,u);if(!(l<0))return{residueIndex:c,atomIndex:l,symmetry:n.symmetry.value(t)}}},f=[];for(let i=0;i<t._rowCount;i++){const e=d(i,a),l=d(i,c);if(void 0===e||void 0===l)continue;const m=n.value(i),h=s.value(i)||"";let p=o.I$.Flag.None,g=1;switch(h){case"sing":g=1;break;case"doub":g=2;break;case"trip":g=3;break;case"quad":g=4;break;default:g=(0,u.m)(t.ptnr1_label_comp_id.value(i),t.ptnr1_label_atom_id.value(i),t.ptnr2_label_comp_id.value(i),t.ptnr2_label_atom_id.value(i))}switch(m){case"covale":p=o.I$.Flag.Covalent;break;case"disulf":p=o.I$.Flag.Covalent|o.I$.Flag.Disulfide;break;case"hydrog":p=o.I$.Flag.HydrogenBond;break;case"metalc":p=o.I$.Flag.MetallicCoordination}f.push({rowIndex:i,flags:p,order:g,distance:r.value(i),partnerA:e,partnerB:l})}return f}}(r||(r={}))},71490:function(t,e,n){function r(t){return{kind:"table-legend",table:t}}function o(t,e,n){return{kind:"scale-legend",minLabel:t,maxLabel:e,colors:n}}n.d(e,{A:function(){return o},h:function(){return r}})},71626:function(t,e,n){n.d(e,{b:function(){return d},r:function(){return m}});var r=n(73868),o=n(65533),i=n(51195),s=n(60771),a=n(46291);const u=r.eB.set,c=new i.Z("14"),l=new i.Z("98");function d(t){const e=s.D.computeBounding(t);return{box:e,sphere:a.f.fromBox3D((0,a.f)(),e)}}const f=(0,r.eB)();function m(t){const{x:e,y:n,z:i,radius:s,indices:m}=t,h=o.CD.size(m);if(h>25e4)return d(t);const p=h>1e4?c:l;p.reset();for(let r=0;r<h;r++){const t=o.CD.getAt(m,r);u(f,e[t],n[t],i[t]),p.includePositionRadius(f,s&&s[t]||0)}p.finishedIncludeStep();for(let r=0;r<h;r++){const t=o.CD.getAt(m,r);u(f,e[t],n[t],i[t]),p.radiusPositionRadius(f,s&&s[t]||0)}const g=p.getSphere();if(!s&&a.f.hasExtrema(g)&&h<=g.extrema.length){const t=[];for(let s=0;s<h;s++){const a=o.CD.getAt(m,s);t.push(r.eB.create(e[a],n[a],i[a]))}a.f.setExtrema(g,t)}return{box:p.getBox(),sphere:g}}},71746:function(t,e,n){function r(t,e,n){return t[e]-t[n]}function o(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function i(t,e,n,r){const o=n+r>>1;return e(t,n,r)>0?e(t,n,o)>0?e(t,o,r)>0?o:r:n:e(t,r,o)>0?e(t,o,n)>0?o:n:r}function s(t,e,n){const{cmp:r,swap:o,data:s,parts:a}=t;let u=e+1,c=n;for(o(s,e,i(s,r,e,n));r(s,c,e)>0;)--c;for(let i=e+1;i<=c;i++){const t=r(s,i,e);if(t>0){for(o(s,i,c),--c;r(s,c,e)>0;)--c;i--}else 0===t&&(o(s,i,u),u++)}for(let i=e;i<u;i++)o(s,i,e+c-i);a[0]=c-u+e+1,a[1]=c}function a({data:t,cmp:e,swap:n},r,o){for(let i=r+1;i<=o;i++){let o=i-1;for(;o>=r&&e(t,o,o+1)>0;)n(t,o,o+1),o-=1}}function u(t,e,n){const{parts:r}=t;for(;e<n;){if(n-e<16)return void a(t,e,n);s(t,e,n);const o=r[0],i=r[1];o-e<n-i?(u(t,e,o-1),e=i+1):(u(t,i+1,n),n=o-1)}}function c(t,e,n,s){let a=n+1,u=s;o(t,n,i(t,r,n,s));const c=t[n];for(;t[u]>c;)--u;for(let r=n+1;r<=u;r++){const e=t[r];if(e>c){for(o(t,r,u),--u;t[u]>c;)--u;r--}else e===c&&(o(t,r,a),++a)}for(let r=n;r<a;r++)o(t,r,n+u-r);e[0]=u-a+n+1,e[1]=u}function l(t,e,n){for(let r=e+1;r<=n;r++){const n=t[r];let o=r-1;for(;o>=e&&t[o]>n;)t[o+1]=t[o],o-=1;t[o+1]=n}}function d(t,e,n,r){for(;n<r;){if(r-n<16)return void l(t,n,r);c(t,e,n,r);const o=e[0],i=e[1];o-n<r-i?(d(t,e,n,o-1),n=i+1):(d(t,e,i+1,r),r=o-1)}}function f(t,e=r){return function(t,e,n,i=r){i===r?d(t,[0,0],e,n-1):u({data:t,cmp:i,swap:o,parts:[0,0]},e,n-1);return t}(t,0,t.length,e)}function m(t,e,n,r,o){return u({data:t,cmp:r,swap:o,parts:[0,0]},e,n-1),t}n.d(e,{VE:function(){return o},di:function(){return m},eh:function(){return f}})},72028:function(t,e,n){n.d(e,{E:function(){return l}});var r=n(98277),o=n(60771),i=n(73868),s=n(65533),a=n(41054),u=n(46867),c=n(42966);function l(t,e,n){return new d(t,e,n)}class d{find(t,e,n,r,o){this.ctx.x=t,this.ctx.y=e,this.ctx.z=n,this.ctx.radius=r,this.ctx.isCheck=!1;const i=null!=o?o:this.result;return m(this.ctx,i),i}nearest(t,e,n,a=1,u,l){this.ctx.x=t,this.ctx.y=e,this.ctx.z=n,this.ctx.k=a,this.ctx.stopIf=u;const d=null!=l?l:this.result;return function(t,e){const{min:n,expandedBox:a,boundingSphere:{center:u},size:[l,d,f],bucketOffset:m,bucketCounts:h,bucketArray:S,grid:x,data:{x:v,y:B,z:I,indices:w,radius:P},delta:D,maxRadius:M}=t.grid,{x:N,y:E,z:k,k:T,stopIf:R}=t,U=s.CD.size(w);if(r.Q.reset(e),0===U||T<=0)return!1;let H,O,F,G,L=!1,V=1,Z=!0,q=0,K=_,X=A,Y=0,z=!0,$=!1;const W=b,Q=M*M;K.length=0,W.length=0,g.clear(),C.clear(),i.eB.set(p.origin,N,E,k),o.D.containsVec3(a,p.origin)?(H=Math.floor((N-n[0])/D[0]),O=Math.floor((E-n[1])/D[1]),F=Math.floor((k-n[2])/D[2])):(c.U.targetTo(p,p,u),c.U.intersectBox3D(p.origin,p,a),H=Math.max(0,Math.min(l-1,Math.floor((p.origin[0]-n[0])/D[0]))),O=Math.max(0,Math.min(d-1,Math.floor((p.origin[1]-n[1])/D[1]))),F=Math.max(0,Math.min(f-1,Math.floor((p.origin[2]-n[2])/D[2]))));const j=0!==M?Math.max(1,Math.min(l-1,Math.ceil(M/D[0]))):1,J=0!==M?Math.max(1,Math.min(d-1,Math.ceil(M/D[1]))):1,tt=0!==M?Math.max(1,Math.min(f-1,Math.ceil(M/D[2]))):1;K.push(H,O,F,(H*d+O)*f+F);for(;e.count<U;){const t=4*V;for(let e=0;e<t;e+=4)if(G=K[e+3],!g.has(G)){g.add(G),$=g.size>=x.length;const t=x[G];if(0!==t){const e=Y,n=t-1,r=m[n],o=r+h[n];for(let t=r;t<o;t++){const e=S[t],n=s.CD.getAt(w,e),r=v[n]-N,o=B[n]-E,i=I[n]-k;let a=r*r+o*o+i*i;if(0!==M){const t=P[n];a-=t*t}z&&a>Y&&(Y=a),C.insert(a,e)}e<Y&&(z=!1)}}X.length=0,q=0,y.clear();for(let e=0;e<t;e+=4){H=K[e],O=K[e+1],F=K[e+2];for(let t=-j;t<=j;t++){const e=H+t;if(!(e<0||e>=l))for(let t=-J;t<=J;t++){const r=O+t;if(!(r<0||r>=d))for(let t=-tt;t<=tt;t++){const o=F+t;if(!(o<0||o>=f)&&(G=(e*d+r)*f+o,!y.has(G)&&(y.add(G),!g.has(G)))){if(!Z){const t=n[0]+e*D[0]-N,i=n[1]+r*D[1]-E,s=n[2]+o*D[2]-k;if(t*t+i*i+s*s-Q>Y){W.push(e,r,o,G);continue}}X.push(e,r,o,G),q++}}}}}if(Z=!1,0===q){if(1===T){const t=C.findMinimum();if(t){const{key:n,value:o}=t;return r.Q.add(e,o,n),!0}}else for(;!C.isEmpty()&&($||C.findMinimum().key<=Y)&&e.count<T;){const t=C.extractMinimum(),n=t.key,o=t.value;r.Q.add(e,o,n),R&&!L&&(L=R(o,n))}if(e.count>=T||L||e.count>=U)return e.count>0;if(Z=!0,z=!0,W.length>0){for(let t=0,e=W.length;t<e;t++)K.push(W[t]);W.length=0,V=K.length}}else{const t=K;K=X,X=t,V=q}}e.count}(this.ctx,d),d}check(t,e,n,r){return this.ctx.x=t,this.ctx.y=e,this.ctx.z=n,this.ctx.radius=r,this.ctx.isCheck=!0,m(this.ctx,this.result)}approxNearest(t,e,n,o,i){this.ctx.x=t,this.ctx.y=e,this.ctx.z=n,this.ctx.radius=o,this.ctx.isCheck=!1;const a=null!=i?i:this.result;return function(t,e){const{min:n,size:[o,i,a],bucketOffset:u,bucketCounts:c,bucketArray:l,grid:d,data:{x:f,y:m,z:p,indices:g},delta:y}=t.grid,{radius:_,x:A,y:b,z:C}=t,S=_*_;r.Q.reset(e);const x=Math.max(0,Math.floor((A-_-n[0])/y[0])),v=Math.max(0,Math.floor((b-_-n[1])/y[1])),B=Math.max(0,Math.floor((C-_-n[2])/y[2])),I=Math.min(o-1,Math.floor((A+_-n[0])/y[0])),w=Math.min(i-1,Math.floor((b+_-n[1])/y[1])),P=Math.min(a-1,Math.floor((C+_-n[2])/y[2]));if(x>I||v>w||B>P)return!1;const D=Math.floor((A-n[0])/y[0]),M=Math.floor((b-n[1])/y[1]),N=Math.floor((C-n[2])/y[2]),E=h(Math.max(I-x,w-v,P-B)+1);for(let h=0,k=E.length;h<k;h+=3){const t=D+E[h],n=M+E[h+1],o=N+E[h+2];if(t<x||t>I||n<v||n>w||o<B||o>P)continue;const y=d[(t*i+n)*a+o];if(0===y)continue;const _=y-1,k=u[_],T=k+c[_];let R=Number.MAX_VALUE;for(let i=k;i<T;i++){const t=s.CD.getAt(g,l[i]),n=f[t]-A,o=m[t]-b,a=p[t]-C,u=n*n+o*o+a*a;u<=S&&u<R&&(r.Q.add(e,l[i],u),R=u)}if(R!==Number.MAX_VALUE)return!0}e.count}(this.ctx,a),a}constructor(t,e,n){const a=function(t,e,n){const r=o.D.expand((0,o.D)(),e.box,i.eB.create(.5,.5,.5)),{indices:a}=t,u=o.D.size((0,i.eB)(),r);let c,l;const d=s.CD.size(a),m="number"==typeof n?n:32,h=Array.isArray(n)&&n;if(h&&!i.eB.isZero(h))l=[Math.ceil(u[0]/h[0]),Math.ceil(u[1]/h[1]),Math.ceil(u[2]/h[2])],c=h;else if(d>0){const t=Math.ceil(d/m),e=Math.pow(t/(u[0]*u[1]*u[2]),1/3);l=[Math.ceil(u[0]*e),Math.ceil(u[1]*e),Math.ceil(u[2]*e)],c=[u[0]/l[0],u[1]/l[1],u[2]/l[2]]}else c=u,l=[1,1,1];const p=l[0]*l[1]*l[2];if(p>f){const t=Math.cbrt(p/f);l=[Math.ceil(l[0]/t),Math.ceil(l[1]/t),Math.ceil(l[2]/t)],c=[u[0]/l[0],u[1]/l[1],u[2]/l[2]]}const g={x:t.x,y:t.y,z:t.z,indices:a,radius:t.radius},y={size:l,data:g,expandedBox:r,boundingBox:e.box,boundingSphere:e.sphere,elementCount:d,delta:c};return function(t){const{expandedBox:e,size:[n,r,o],data:{x:i,y:a,z:u,radius:c,indices:l},elementCount:d,delta:f}=t,m=n*r*o,{min:[h,p,g]}=e;let y=0,_=0;const A=new Uint32Array(m),b=new Int32Array(d);for(let B=0;B<d;B++){const t=s.CD.getAt(l,B),e=(Math.floor((i[t]-h)/f[0])*r+Math.floor((a[t]-p)/f[1]))*o+Math.floor((u[t]-g)/f[2]);1===(A[e]+=1)&&(_+=1),b[B]=e}if(c)for(let B=0;B<d;B++){const t=s.CD.getAt(l,B);c[t]>y&&(y=c[t])}const C=new Int32Array(_);for(let s=0,B=0;s<m;s++){const t=A[s];t>0&&(A[s]=B+1,C[B]=t,B+=1)}const S=new Uint32Array(_);for(let s=1;s<_;++s)S[s]+=S[s-1]+C[s-1];const x=new Int32Array(_),v=new Int32Array(d);for(let s=0;s<d;s++){const t=A[b[s]];if(t>0){const e=t-1;v[S[e]+x[e]]=s,x[e]+=1}}return{size:t.size,bucketArray:v,bucketCounts:C,bucketOffset:S,grid:A,delta:f,min:t.expandedBox.min,data:t.data,maxRadius:y,expandedBox:t.expandedBox,boundingBox:t.boundingBox,boundingSphere:t.boundingSphere}}(y)}(t,e,n);this.ctx={grid:a,x:.1,y:.1,z:.1,k:1,stopIf:void 0,radius:.1,isCheck:!1},this.boundary={box:a.boundingBox,sphere:a.boundingSphere},this.buckets={offset:a.bucketOffset,count:a.bucketCounts,array:a.bucketArray},this.result=r.Q.create()}}const f=2**24;function m(t,e){const{min:n,size:[o,i,a],bucketOffset:u,bucketCounts:c,bucketArray:l,grid:d,data:{x:f,y:m,z:h,indices:p,radius:g},delta:y,maxRadius:_}=t.grid,{radius:A,isCheck:b,x:C,y:S,z:x}=t,v=A+_,B=v*v;r.Q.reset(e);const I=Math.max(0,Math.floor((C-v-n[0])/y[0])),w=Math.max(0,Math.floor((S-v-n[1])/y[1])),P=Math.max(0,Math.floor((x-v-n[2])/y[2])),D=Math.min(o-1,Math.floor((C+v-n[0])/y[0])),M=Math.min(i-1,Math.floor((S+v-n[1])/y[1])),N=Math.min(a-1,Math.floor((x+v-n[2])/y[2]));if(I>D||w>M||P>N)return!1;for(let E=I;E<=D;E++)for(let t=w;t<=M;t++)for(let n=P;n<=N;n++){const o=d[(E*i+t)*a+n];if(0===o)continue;const y=o-1,v=u[y],I=v+c[y];for(let t=v;t<I;t++){const n=s.CD.getAt(p,l[t]),o=f[n]-C,i=m[n]-S,a=h[n]-x,u=o*o+i*i+a*a;if(u<=B){if(_>0&&Math.sqrt(u)-g[n]>A)continue;if(b)return!0;r.Q.add(e,l[t],u)}}}return e.count>0}const h=(0,u.E)(function(t){const e=[],n=2*t+1;for(let r=0;r<n;++r)for(let o=0;o<n;++o)for(let s=0;s<n;++s)e.push(i.eB.create(r-t,o-t,s-t));return e.sort((t,e)=>i.eB.squaredMagnitude(t)-i.eB.squaredMagnitude(e)),e.flat()});const p=(0,c.U)(),g=new Set,y=new Set,_=[.1],A=[.1],b=[.1],C=new a.h},72080:function(t,e,n){n.d(e,{O:function(){return o},W:function(){return a}});var r=n(27125);function o(t,e){const{ihm_model_group:n,ihm_model_group_link:o}=e,i=r.XI.pickRow(o,e=>o.model_id.value(e)===t);if(i){const t=r.XI.pickRow(n,t=>n.id.value(t)===i.group_id);if(t)return t.name}return""}function i(t){for(let e=0,n=t.rowCount;e<n;e++)if(t.valueKind(e)===r.VP.ValueKinds.Present)return!0;return!1}function s(t,e,n){t[e].isDefined&&i(t[e])||(t[e]=t[n]),t[n].isDefined&&i(t[n])||(t[n]=t[e])}function a(t){const e=r.XI.ofColumns(t._schema,t);return s(e,"label_atom_id","auth_atom_id"),s(e,"label_comp_id","auth_comp_id"),s(e,"label_seq_id","auth_seq_id"),s(e,"label_asym_id","auth_asym_id"),s(e,"label_entity_id","label_asym_id"),e}},73150:function(t,e,n){n.d(e,{RT:function(){return At},cY:function(){return h},Oz:function(){return u},cv:function(){return c.c}});var r={};n.r(r),n.d(r,{all:function(){return x},atoms:function(){return P},bondedAtomicPairs:function(){return E},chains:function(){return B},none:function(){return S},querySelection:function(){return N},residues:function(){return v},rings:function(){return M}});var o={};n.r(o),n.d(o,{exceptBy:function(){return $},expandProperty:function(){return Q},includeConnected:function(){return j},includeSurroundings:function(){return X},intersectBy:function(){return z},querySelection:function(){return Y},surroundingLigands:function(){return tt},union:function(){return W},wholeResidues:function(){return L}});var i={};n.r(i),n.d(i,{areIntersectedBy:function(){return dt},first:function(){return ut},getCurrentStructureProperties:function(){return ct},isConnectedTo:function(){return mt},pick:function(){return at},withSameAtomProperties:function(){return lt},within:function(){return ft}});var s={};n.r(s),n.d(s,{intersect:function(){return pt},merge:function(){return ht}});var a={};n.r(a),n.d(a,{atomCount:function(){return gt},countQuery:function(){return yt},propertySet:function(){return _t}});var u,c=n(99355),l=n(77936),d=n(86143),f=n(52500),m=n(58685);class h{pushCurrentElement(){return this.currentElementStack[this.currentElementStack.length]=this.element,this.element=l.iZ.Location.create(void 0),this.element}popCurrentElement(){this.element=this.currentElementStack.pop()}pushCurrentBond(){return this.atomicBond&&this.currentAtomicBondStack.push(this.atomicBond),this.atomicBond=new p,this.atomicBond}popCurrentBond(){this.currentAtomicBondStack.length>0?this.atomicBond=this.currentAtomicBondStack.pop():this.atomicBond=void 0}pushCurrentStructure(){this.currentStructure&&this.currentStructureStack.push(this.currentStructure)}popCurrentStructure(){this.currentStructureStack.length?this.currentStructure=this.currentStructureStack.pop():this.currentStructure=void 0}pushInputStructure(t){this.inputStructureStack.push(this.inputStructure),this.inputStructure=t}popInputStructure(){if(0===this.inputStructureStack.length)throw new Error("Must push before pop.");this.inputStructure=this.inputStructureStack.pop()}throwIfTimedOut(){if(0!==this.timeoutMs&&(0,d.t)()-this.timeCreated>this.timeoutMs)throw new Error(`The query took too long to execute (> ${this.timeoutMs/1e3}s).`)}tryGetCurrentSelection(){if(!this.currentSelection)throw new Error("The current selection is not assigned.");return this.currentSelection}constructor(t,e){this.currentElementStack=[],this.currentAtomicBondStack=[],this.currentStructureStack=[],this.inputStructureStack=[],this.timeCreated=(0,d.t)(),this.element=l.iZ.Location.create(void 0),this.currentStructure=void 0,this.atomicBond=new p,this.currentSelection=void 0,this.inputStructure=t,this.timeoutMs=e&&e.timeoutMs||0,this.currentSelection=e&&e.currentSelection}}class p{constructor(){this.a=l.iZ.Location.create(void 0),this.aIndex=0,this.b=l.iZ.Location.create(void 0),this.bIndex=0,this.type=f.I$.Flag.None,this.order=0,this.key=-1,this.testFn=m.defaultBondTest}setStructure(t){this.a.structure=t,this.b.structure=t}setTestFn(t){this.testFn=t||m.defaultBondTest}test(t,e){return!!this.testFn(t)||!!e&&(this.swap(),this.testFn(t))}swap(){const t=this.aIndex;this.aIndex=this.bIndex,this.bIndex=t;const e=this.a.unit;this.a.unit=this.b.unit,this.b.unit=e;const n=this.a.element;this.a.element=this.b.element,this.b.element=n}get length(){return l.iZ.Location.distance(this.a,this.b)}}!function(t){t.run=function(t,e,n){return t(new h(e,n))},t.loci=function(t,e,n){const r=t(new h(e,n));return c.c.toLociWithSourceUnits(r)}}(u||(u={}));var g=n(54135),y=n(65533),_=n(31960),A=n(58247);class b{add(t){t.elementCount&&(1!==t.elementCount&&(this.allSingletons=!1),this.set.add(t)&&(this.structures[this.structures.length]=t))}getSelection(){return this.allSingletons?c.c.Singletons(this.source,(0,A.l6)(this.source,this.structures)):c.c.Sequence(this.source,this.structures)}constructor(t){this.source=t,this.set=(0,g.bw)(l.oE.hashCode,l.oE.areUnitIdsAndIndicesEqual),this.structures=[],this.allSingletons=!0}}class C{add(t,e,n){let r=this.builderMap.get(t);r||(r=this.source.subsetBuilder(!0),this.builders[this.builders.length]=r,this.builderMap.set(t,r)),r.addToUnit(e,n)}allSingletons(){for(let t=0,e=this.builders.length;t<e;t++)if(this.builders[t].elementCount>1)return!1;return!0}singletonSelection(){const t=this.source.subsetBuilder(!0),e=l.iZ.Location.create(this.source);for(let n=0,r=this.builders.length;n<r;n++)this.builders[n].setSingletonLocation(e),t.addToUnit(e.unit.id,e.element);return c.c.Singletons(this.source,t.getStructure())}fullSelection(){const t=new Array(this.builders.length);for(let e=0,n=this.builders.length;e<n;e++)t[e]=this.builders[e].getStructure();return c.c.Sequence(this.source,t)}getSelection(){return 0===this.builders.length?c.c.Empty(this.source):this.allSingletons()?this.singletonSelection():this.fullSelection()}constructor(t){this.source=t,this.builders=[],this.builderMap=new Map}}const S=t=>c.c.Sequence(t.inputStructure,[]),x=t=>c.c.Singletons(t.inputStructure,t.inputStructure);function v(t){return P({...t,groupBy:t=>l.ZP.residue.key(t.element)})}function B(t){return P({...t,groupBy:t=>l.ZP.chain.key(t.element)})}function I(t){return!0}function w(t){return 0}function P(t){if(!(t&&(t.atomTest||t.residueTest||t.chainTest||t.entityTest||t.unitTest||t.groupBy)))return x;if(t.atomTest&&!t.residueTest&&!t.chainTest&&!t.entityTest&&!t.unitTest&&!t.groupBy)return e=t.atomTest,function(t){const{inputStructure:n}=t,{units:r}=n,o=t.pushCurrentElement(),i=n.subsetBuilder(!0);o.structure=n;for(const s of r){o.unit=s;const n=s.elements;i.beginUnit(s.id);for(let r=0,s=n.length;r<s;r++)o.element=n[r],e(t)&&i.addElement(o.element);i.commitUnit(),t.throwIfTimedOut()}return t.popCurrentElement(),c.c.Singletons(n,i.getStructure())};var e;const n={unitTest:t.unitTest||I,entityTest:t.entityTest||I,chainTest:t.chainTest||I,residueTest:t.residueTest||I,atomTest:t.atomTest||I,groupBy:t.groupBy||w};return t.groupBy?function({unitTest:t,entityTest:e,chainTest:n,residueTest:r,atomTest:o,groupBy:i}){return function(s){const{inputStructure:a}=s,{units:u}=a,c=s.pushCurrentElement(),d=new C(a);c.structure=a;for(const f of u){if(c.unit=f,!t(s))continue;const{elements:a,model:u}=f;if(f.kind===l.Nf.Kind.Atomic){const t=y.hT.transientSegments(u.atomicHierarchy.chainAtomSegments,a),l=y.hT.transientSegments(u.atomicHierarchy.residueAtomSegments,a);for(;t.hasNext;){const u=t.move();if(c.element=a[u.start],e(s)&&n(s))for(l.setSegment(u);l.hasNext;){const t=l.move();if(c.element=a[t.start],r(s))for(let e=t.start,n=t.end;e<n;e++)c.element=a[e],o(s)&&d.add(i(s),f.id,c.element)}}}else{const{chainElementSegments:t}=f.kind===l.Nf.Kind.Spheres?u.coarseHierarchy.spheres:u.coarseHierarchy.gaussians,o=y.hT.transientSegments(t,a);for(;o.hasNext;){const t=o.move();if(c.element=a[t.start],e(s)&&n(s))for(let e=t.start,n=t.end;e<n;e++)c.element=a[e],r(s)&&d.add(i(s),f.id,c.element)}}s.throwIfTimedOut()}return s.popCurrentElement(),d.getSelection()}}(n):function({unitTest:t,entityTest:e,chainTest:n,residueTest:r,atomTest:o}){return function(i){const{inputStructure:s}=i,{units:a}=s,u=i.pushCurrentElement(),d=s.subsetBuilder(!0),f=r===I&&o===I,m=o===I;u.structure=s;for(const c of a){if(u.unit=c,!t(i))continue;const{elements:s,model:a}=c;if(d.beginUnit(c.id),c.kind===l.Nf.Kind.Atomic){const t=y.hT.transientSegments(c.model.atomicHierarchy.chainAtomSegments,s),a=y.hT.transientSegments(c.model.atomicHierarchy.residueAtomSegments,s);for(;t.hasNext;){const c=t.move();if(u.element=s[c.start],e(i)&&n(i))if(f)d.addElementRange(s,c.start,c.end);else for(a.setSegment(c);a.hasNext;){const t=a.move();if(u.element=s[t.start],r(i))if(m)d.addElementRange(s,t.start,t.end);else for(let e=t.start,n=t.end;e<n;e++)u.element=s[e],o(i)&&d.addElement(u.element)}}}else{const{chainElementSegments:t}=c.kind===l.Nf.Kind.Spheres?a.coarseHierarchy.spheres:a.coarseHierarchy.gaussians,o=y.hT.transientSegments(t,s);for(;o.hasNext;){const t=o.move();if(u.element=s[t.start],e(i)&&n(i))if(f)d.addElementRange(s,t.start,t.end);else for(let e=t.start,n=t.end;e<n;e++)u.element=s[e],r(i)&&d.addElement(u.element)}}d.commitUnit(),i.throwIfTimedOut()}return i.popCurrentElement(),c.c.Singletons(s,d.getStructure())}}(n)}function D(t,e,n){const r=new Int32Array(e.length);for(let o=0,i=e.length;o<i;o++)r[o]=t.elements[e[o]];return _.o.create([t.getChild(y.X9.ofSortedArray(r))],{parent:n})}function M(t,e){return function(n){const{units:r}=n.inputStructure,o=c.c.LinearBuilder(n.inputStructure);if(t&&0!==t.length){const i=g.th.create();for(let e=0;e<t.length;e++)g.th.add(i,t[e],t[e]);for(const t of r){if(!l.Nf.isAtomic(t))continue;const r=t.rings;for(const s of i.array)if(r.byFingerprint.has(s))for(const i of r.byFingerprint.get(s))e&&!r.aromaticRings.includes(i)||o.add(D(t,r.all[i],n.inputStructure))}}else for(const t of r)if(l.Nf.isAtomic(t))if(e)for(const e of t.rings.aromaticRings)o.add(D(t,t.rings.all[e],n.inputStructure));else for(const e of t.rings.all)o.add(D(t,e,n.inputStructure));return o.getSelection()}}function N(t,e,n=!1){return function(r){const o=t(r);if(0===c.c.structureCount(o))return o;const i=n?(0,A.Kt)(r.inputStructure,c.c.unionStructure(o)):c.c.unionStructure(o);if(0===i.elementCount)return c.c.Empty(r.inputStructure);r.throwIfTimedOut(),r.pushInputStructure(i);const s=e(r);return r.popInputStructure(),c.c.withInputStructure(s,r.inputStructure)}}function E(t){return function(e){const n=e.inputStructure,r=n.interUnitBonds,o=c.c.UniqueBuilder(e.inputStructure);e.pushCurrentBond();const i=e.atomicBond;i.setTestFn(t),i.setStructure(n);for(const t of n.units){if(t.kind!==l.Nf.Kind.Atomic)continue;const{offset:r,b:s,edgeProps:{flags:a,order:u,key:c}}=t.bonds;i.a.unit=t,i.b.unit=t;for(let l=0,d=t.elements.length;l<d;l++){i.aIndex=l,i.a.element=t.elements[l];for(let d=r[l],f=r[l+1];d<f;d++)if(i.bIndex=s[d],i.b.element=t.elements[s[d]],i.type=a[d],i.order=u[d],i.key=c[d],i.test(e,!1)){const e=n.subsetBuilder(!1);e.beginUnit(t.id),e.addElement(i.a.element),e.addElement(i.b.element),e.commitUnit(),o.add(e.getStructure())}}}for(const t of r.edges)if(i.a.unit=n.unitMap.get(t.unitA),i.a.element=i.a.unit.elements[t.indexA],i.aIndex=t.indexA,i.b.unit=n.unitMap.get(t.unitB),i.b.element=i.b.unit.elements[t.indexB],i.bIndex=t.indexB,i.order=t.props.order,i.type=t.props.flag,i.key=t.props.key,i.test(e,!1)){const t=n.subsetBuilder(!1);t.addToUnit(i.a.unit.id,i.a.element),t.addToUnit(i.b.unit.id,i.b.element),o.add(t.getStructure())}return e.popCurrentBond(),o.getSelection()}}var k=n(38530),T=n(19600);class R{addToUnit(t,e){const n=this.unitMap.get(t);if(n)g.th.add(n,e,e)&&this.elementCount++;else{const n=g.th.create();g.th.add(n,e,e),this.unitMap.set(t,n),this.ids[this.ids.length]=t,this.elementCount++}}has(t,e){const n=this.unitMap.get(t);return!!n&&g.th.has(n,e)}beginUnit(t){this.parentId=t,this.unitMap.has(t)?this.currentUnit=this.unitMap.get(t):this.currentUnit=this.currentUnit.array.length>0?g.th.create():this.currentUnit}addElement(t){g.th.add(this.currentUnit,t,t)&&this.elementCount++}commitUnit(){0===this.currentUnit.array.length||this.unitMap.has(this.parentId)||(this.ids[this.ids.length]=this.parentId,this.unitMap.set(this.parentId,this.currentUnit),this.parentId=-1)}getStructure(){if(this.isEmpty)return _.o.Empty;const t=[];(0,k.eh)(this.ids);const e=T.u.UnitEquivalenceBuilder();for(let n=0,r=this.ids.length;n<r;n++){const r=this.ids[n],o=this.parent.unitMap.get(r),i=this.unitMap.get(r).array,s=i.length;if(i.length===o.elements.length){t[t.length]=o,e.add(o.id,o);continue}s>1&&(0,k.eh)(i);let a=o.getChild(y.X9.ofSortedArray(i));const u=e.add(a.id,a);a!==u&&(a=u.applyOperator(a.id,a.conformation.operator,!0)),t[t.length]=a}return _.o.create(t,{parent:this.parent})}get isEmpty(){return 0===this.elementCount}constructor(t){this.parent=t,this.ids=[],this.unitMap=y.Yz.Mutable(),this.parentId=-1,this.currentUnit=g.th.create(),this.elementCount=0}}var U=n(21547),H=n(64059);class O{add(t){let e=this.index.get(t.label_asym_id);e||(e=new Map,this.index.set(t.label_asym_id,e));let n=e.get(t.label_seq_id);n||(n=[],e.set(t.label_seq_id,n));return!this._find(t,n)&&(n.push(t),!0)}hasLabelAsymId(t){return this.index.has(t)}has(t){var e,n;const r=this._asym_id(t);if(!this.index.has(r))return;const o=this.index.get(r),i=this._seq_id(t);if(!o.has(i))return;const s=o.get(i),a=this._comp_id(t),u=this._alt_id(t),c=this._ins_code(t),l=null!==(e=this._op_name(t))&&void 0!==e?e:"1_555";for(const d of s)if(d.label_comp_id===a&&d.label_alt_id===u&&d.ins_code===c&&(!this.checkOperator||(null!==(n=d.operator_name)&&void 0!==n?n:"1_555")===l))return d}static getLabel(t,e=!1){var n;return`${t.label_asym_id} ${t.label_comp_id} ${t.label_seq_id}:${t.ins_code}:${t.label_alt_id}${e?" "+(null!==(n=t.operator_name)&&void 0!==n?n:"1_555"):""}`}static getEntryFromLocation(t){var e;return{label_asym_id:H.Z.chain.label_asym_id(t),label_comp_id:H.Z.atom.label_comp_id(t),label_seq_id:H.Z.residue.label_seq_id(t),label_alt_id:H.Z.atom.label_alt_id(t),ins_code:H.Z.residue.pdbx_PDB_ins_code(t),operator_name:null!==(e=H.Z.unit.operator_name(t))&&void 0!==e?e:"1_555"}}_find(t,e){var n,r;for(const o of e)if(o.label_comp_id===t.label_comp_id&&o.label_alt_id===t.label_alt_id&&o.ins_code===t.ins_code&&(!this.checkOperator||(null!==(n=o.operator_name)&&void 0!==n?n:"1_555")===(null!==(r=t.operator_name)&&void 0!==r?r:"1_555")))return!0;return!1}constructor(t){var e;this.index=new Map,this.checkOperator=!1,this._asym_id=H.Z.chain.label_asym_id,this._seq_id=H.Z.residue.label_seq_id,this._comp_id=H.Z.atom.label_comp_id,this._alt_id=H.Z.atom.label_alt_id,this._ins_code=H.Z.residue.pdbx_PDB_ins_code,this._op_name=H.Z.unit.operator_name,this.checkOperator=null!==(e=null==t?void 0:t.checkOperator)&&void 0!==e&&e}}var F=n(31186);function G(t,e,n){const r=e.subsetBuilder(!0);for(const o of n.units){if(o.kind!==l.Nf.Kind.Atomic){r.setUnit(o.id,o.elements);continue}const{residueAtomSegments:n}=o.model.atomicHierarchy,i=e.unitMap.get(o.id).elements,s=o.elements;r.beginUnit(o.id);const a=y.hT.transientSegments(n,s);for(;a.hasNext;){const t=a.move().index;for(let e=n.offsets[t],o=n.offsets[t+1];e<o;e++)y.X9.has(i,e)&&r.addElement(e)}r.commitUnit(),t.throwIfTimedOut()}return r.getStructure()}function L(t){return function(e){const n=t(e);if(c.c.isSingleton(n))return c.c.Singletons(e.inputStructure,G(e,e.inputStructure,n.structure));{const t=new b(e.inputStructure);for(const r of n.structures)t.add(G(e,e.inputStructure,r));return t.getSelection()}}}function V(t,e,n,r){const o=new R(e),i=e.lookup3d,s=r.radius;for(const a of n.units){const e=a.conformation,n=a.elements;for(let t=0,r=n.length;t<r;t++){const r=n[t];i.findIntoBuilder(e.x(r),e.y(r),e.z(r),s,o)}t.throwIfTimedOut()}return r.wholeResidues?G(t,e,o.getStructure()):o.getStructure()}function Z(t,e,n,r){const o=new R(e),i=e.lookup3d,{elementRadius:s,elementRadiusClosure:a,sourceMaxRadius:u,radius:c}=r;t.pushCurrentElement(),t.element.structure=n;for(const l of n.units){t.element.unit=l;const e=l.conformation,n=l.elements;for(let r=0,l=n.length;r<l;r++){const l=n[r];t.element.element=l;const d=s(t);i.findIntoBuilderWithRadius(e.x(l),e.y(l),e.z(l),d,u,c,a,o)}t.throwIfTimedOut()}return t.popCurrentElement(),r.wholeResidues?G(t,e,o.getStructure()):o.getStructure()}function q(t,e){return n=>(t.element.structure=n.structure,t.element.unit=n.unit,t.element.element=n.element,e(t))}function K(t,e){let n=0;t.element.structure=t.inputStructure;for(const r of t.inputStructure.units){t.element.unit=r;const o=r.elements;for(let r=0,i=o.length;r<i;r++){const i=o[r];t.element.element=i;const s=e(t);s>n&&(n=s)}}return t.throwIfTimedOut(),n}function X(t,e){return function(n){const r=t(n);if(e.elementRadius){const t={...e,elementRadius:e.elementRadius,elementRadiusClosure:q(n,e.elementRadius),sourceMaxRadius:K(n,e.elementRadius)};if(c.c.isSingleton(r)){const e=Z(n,n.inputStructure,r.structure,t);return c.c.Singletons(n.inputStructure,e)}{const e=new b(n.inputStructure);for(const o of r.structures)e.add(Z(n,n.inputStructure,o,t));return e.getSelection()}}if(c.c.isSingleton(r)){const t=V(n,n.inputStructure,r.structure,e);return c.c.Singletons(n.inputStructure,t)}{const t=new b(n.inputStructure);for(const o of r.structures)t.add(V(n,n.inputStructure,o,e));return t.getSelection()}}}function Y(t,e){return function(n){const r=t(n);if(0===c.c.structureCount(r))return r;const o=c.c.UniqueBuilder(n.inputStructure),i=t=>o.add(t);return c.c.forEach(r,(t,r)=>{n.pushInputStructure(t),c.c.forEach(e(n),i),n.popInputStructure(),r%10==0&&n.throwIfTimedOut()}),o.getSelection()}}function z(t,e){return function(n){const r=t(n);if(0===c.c.structureCount(r))return r;const o=e(n);if(0===c.c.structureCount(o))return c.c.Empty(n.inputStructure);const i=c.c.unionStructure(o),s=c.c.UniqueBuilder(n.inputStructure);return c.c.forEach(r,(t,e)=>{const r=(0,A.jU)(i,t);0!==r.elementCount&&s.add(r),e%50==0&&n.throwIfTimedOut()}),s.getSelection()}}function $(t,e){return function(n){const r=t(n);if(0===c.c.structureCount(r))return r;const o=e(n);if(0===c.c.structureCount(o))return r;const i=c.c.unionStructure(o),s=c.c.UniqueBuilder(n.inputStructure);return c.c.forEach(r,(t,e)=>{const r=(0,A.Kt)(t,i);0!==r.elementCount&&s.add(r),e%50==0&&n.throwIfTimedOut()}),s.getSelection()}}function W(t){return function(e){const n=c.c.LinearBuilder(e.inputStructure);return n.add(c.c.unionStructure(t(e))),n.getSelection()}}function Q(t,e){return function(n){const r=t(n),o=new Map,i=[];n.pushCurrentElement(),c.c.forEach(r,(t,r)=>{n.element.structure=t;for(const i of t.units){n.element.unit=i;const t=i.elements;for(let i=0,s=t.length;i<s;i++){n.element.element=t[i];const s=e(n);let a;o.has(s)?a=o.get(s):(a=g.th.create(),o.set(s,a)),g.th.add(a,r,r)}}i[r]=n.inputStructure.subsetBuilder(!0),r%10==0&&n.throwIfTimedOut()}),n.element.structure=n.inputStructure;for(const t of n.inputStructure.units){n.element.unit=t;const r=t.elements;for(let s=0,a=r.length;s<a;s++){n.element.element=r[s];const a=e(n);if(!o.has(a))continue;const u=o.get(a).array;for(let e=0,n=u.length;e<n;e++)i[u[e]].addToUnit(t.id,r[s])}}n.popCurrentElement();const s=c.c.UniqueBuilder(n.inputStructure);for(const t of i)s.add(t.getStructure());return s.getSelection()}}function j({query:t,layerCount:e,wholeResidues:n,bondTest:r,fixedPoint:o}){const i=Math.max(e,0);return function(e){const s=c.c.UniqueBuilder(e.inputStructure),a=t(e);return e.pushCurrentBond(),e.atomicBond.setTestFn(r),c.c.forEach(a,(t,r)=>{let a=t;if(o)for(;;){const t=a.elementCount;if(a=J(e,n,a),a.elementCount===t)break}else for(let o=0;o<i;o++)a=J(e,n,a);s.add(a),r%10==0&&e.throwIfTimedOut()}),e.popCurrentBond(),s.getSelection()}}function J(t,e,n){const r=function(t,e){const n=t.inputStructure,r=n.interUnitBonds,o=new R(n),i=t.atomicBond;for(const s of e.units){if(s.kind!==l.Nf.Kind.Atomic){o.beginUnit(s.id);for(let t=0,e=s.elements.length;t<e;t++)o.addElement(s.elements[t]);o.commitUnit();continue}const a=n.unitMap.get(s.id),{offset:u,b:c,edgeProps:{flags:d,order:f,key:m}}=a.bonds;i.setStructure(n),i.a.unit=a,i.b.unit=a;for(let e=0,n=s.elements.length;e<n;e++){o.addToUnit(s.id,s.elements[e]);const n=y.X9.indexOf(a.elements,s.elements[e]);for(let r=u[n],l=u[n+1];r<l;r++){const u=c[r],l=a.elements[u];y.X9.has(s.elements,l)||o.has(s.id,l)||(i.aIndex=n,i.a.element=s.elements[e],i.bIndex=u,i.b.element=l,i.type=d[r],i.order=f[r],i.key=m[r],i.test(t,!0)&&o.addToUnit(s.id,l))}}for(const l of r.getConnectedUnits(a.id)){const r=e.unitMap.get(l.unitB),u=n.unitMap.get(l.unitB);for(const e of l.connectedIndices)if(y.X9.has(s.elements,a.elements[e]))for(const n of l.getEdges(e)){const s=u.elements[n.indexB];r&&y.X9.has(r.elements,s)||o.has(l.unitB,s)||(i.a.unit=a,i.aIndex=e,i.a.element=a.elements[e],i.b.unit=u,i.bIndex=n.indexB,i.b.element=s,i.type=n.props.flag,i.order=n.props.order,i.key=n.props.key,i.test(t,!0)&&o.addToUnit(l.unitB,s))}}}return o.getStructure()}(t,n);return e?G(t,t.inputStructure,r):r}function tt({query:t,radius:e,includeWater:n}){const r=H.Z.entity.type;function o(t){return"water"===r(t)}return function(r){const i=c.c.unionStructure(t(r)),s=G(r,r.inputStructure,V(r,r.inputStructure,i,{radius:e})),a=function(t){var e;const n=t.models[0],r=new Set;if("mmCIF"!==(null===(e=n.sourceData)||void 0===e?void 0:e.kind))return r;const{_rowCount:o,asym_id:i}=n.sourceData.data.db.pdbx_molecule;for(let s=0;s<o;s++)r.add(i.value(s));return r}(r.inputStructure),u=function(t){var e,n,r;const o=t.models[0],i=new et;if("mmCIF"!==(null===(e=o.sourceData)||void 0===e?void 0:e.kind))return i;const s=o.sourceData.data.db.struct_conn,{conn_type_id:a}=s,{ptnr1_label_asym_id:u,ptnr1_label_comp_id:c,ptnr1_label_seq_id:l,ptnr1_symmetry:d,pdbx_ptnr1_label_alt_id:f,pdbx_ptnr1_PDB_ins_code:m}=s,{ptnr2_label_asym_id:h,ptnr2_label_comp_id:p,ptnr2_label_seq_id:g,ptnr2_symmetry:y,pdbx_ptnr2_label_alt_id:_,pdbx_ptnr2_PDB_ins_code:A}=s;for(let b=0;b<s._rowCount;b++){const t=a.value(b);if("covale"!==t&&"metalc"!==t)continue;const e={label_asym_id:u.value(b),label_comp_id:c.value(b),label_seq_id:l.value(b),label_alt_id:f.value(b),ins_code:m.value(b),operator_name:null!==(n=d.value(b))&&void 0!==n?n:"1_555"},o={label_asym_id:h.value(b),label_comp_id:p.value(b),label_seq_id:g.value(b),label_alt_id:_.value(b),ins_code:A.value(b),operator_name:null!==(r=y.value(b))&&void 0!==r?r:"1_555"};i.addEdge(e,o)}return i}(r.inputStructure),d=U.i.Location.create(s),f=new Map,m=new O({checkOperator:!0});for(const t of s.units){if(t.kind!==l.Nf.Kind.Atomic)continue;d.unit=t;const{elements:e}=t,n=y.hT.transientSegments(t.model.atomicHierarchy.chainAtomSegments,e),o=y.hT.transientSegments(t.model.atomicHierarchy.residueAtomSegments,e);for(;n.hasNext;){const t=n.move();d.element=e[t.start];const r=H.Z.chain.label_asym_id(d),i=H.Z.unit.operator_name(d);if(a.has(r)){f.has(r)?(0,F.Z2)(f.get(r),i):f.set(r,[i]);continue}const s=H.Z.entity.type(d);if("water"!==s&&"polymer"!==s)for(o.setSegment(t);o.hasNext;){const t=o.move();d.element=e[t.start],u.addComponent(O.getEntryFromLocation(d),m)}}r.throwIfTimedOut()}const h=r.inputStructure.subsetBuilder(!0);for(const t of r.inputStructure.units){if(t.kind!==l.Nf.Kind.Atomic)continue;d.unit=t;const{elements:e}=t,n=y.hT.transientSegments(t.model.atomicHierarchy.chainAtomSegments,e),o=y.hT.transientSegments(t.model.atomicHierarchy.residueAtomSegments,e);for(h.beginUnit(t.id);n.hasNext;){const t=n.move();d.element=e[t.start];const r=H.Z.chain.label_asym_id(d),i=H.Z.unit.operator_name(d);if(f.has(r)&&f.get(r).indexOf(i)>=0)h.addElementRange(e,t.start,t.end);else if(m.hasLabelAsymId(r))for(o.setSegment(t);o.hasNext;){const t=o.move();d.element=e[t.start],m.has(d)&&h.addElementRange(e,t.start,t.end)}}h.commitUnit(),r.throwIfTimedOut()}const p=(0,A.l6)(r.inputStructure,[h.getStructure(),i]);if(n){const t=new R(r.inputStructure),n=r.inputStructure.lookup3d;for(const i of p.units){const s=i.conformation,a=i.elements;for(let r=0,u=a.length;r<u;r++){const u=a[r];n.findIntoBuilderIf(s.x(u),s.y(u),s.z(u),e,t,o),t.addToUnit(i.id,u)}r.throwIfTimedOut()}return c.c.Sequence(r.inputStructure,[t.getStructure()])}return c.c.Sequence(r.inputStructure,[p])}}class et{constructor(){this.vertices=new Map,this.edges=new Map}addVertex(t,e){this.vertices.has(e)||(this.vertices.set(e,t),this.edges.set(e,[]))}addEdge(t,e){const n=O.getLabel(t),r=O.getLabel(e);this.addVertex(t,n),this.addVertex(e,r),(0,F.Z2)(this.edges.get(n),r),(0,F.Z2)(this.edges.get(r),n)}addComponent(t,e){const n=O.getLabel(t);if(!this.vertices.has(n))return void e.add(t);const r=new Set,o=new Set,i=[n];for(o.add(n),e.add(t);i.length>0;){const n=i.pop();r.add(n);const s=this.vertices.get(n);for(const a of this.edges.get(n)){if(r.has(a))continue;if(i.push(a),o.has(a))continue;o.add(a);const n=this.vertices.get(a);s.operator_name===n.operator_name?e.add({...n,operator_name:t.operator_name}):e.add(n)}}}}var nt,rt,ot,it=n(24303),st=n(73868);function at(t,e){return n=>{const r=t(n),o=c.c.LinearBuilder(n.inputStructure);return n.pushCurrentElement(),c.c.forEach(r,(t,r)=>{n.currentStructure=t,e(n)&&o.add(t),r%100&&n.throwIfTimedOut()}),n.popCurrentStructure(),o.getSelection()}}function ut(t){return e=>{const n=t(e),r=c.c.LinearBuilder(e.inputStructure);if("singletons"===n.kind){if(n.structure.elementCount>0){const t=n.structure.units[0],o=_.o.create([t.getChild(y.X9.ofSingleton(t.elements[0]))],{parent:e.inputStructure});r.add(o)}}else n.structures.length>0&&r.add(n.structures[0]);return r.getSelection()}}function ct(t,e,n){const{units:r}=t.currentStructure,o=t.pushCurrentElement();o.structure=t.currentStructure;for(const i of r){o.unit=i;const r=i.elements,s=e;if(s){for(let e=0,i=r.length;e<i;e++)o.element=r[e],n.add(s(t));t.throwIfTimedOut()}}return t.popCurrentElement(),n}function lt(t,e,n){return r=>{const o=t(r),i=function(t,e,n){const r=new Set,o=e(t);return t.pushCurrentElement(),c.c.forEach(o,(e,o)=>{t.currentStructure=e,ct(t,n,r),o%10&&t.throwIfTimedOut()}),t.popCurrentElement(),r}(r,e,n),s=c.c.LinearBuilder(r.inputStructure);return r.pushCurrentStructure(),c.c.forEach(o,(t,e)=>{r.currentStructure=t;const o=ct(r,n,new Set);it.M.isSuperset(i,o)&&s.add(t),e%10&&r.throwIfTimedOut()}),r.popCurrentStructure(),s.getSelection()}}function dt(t,e){return n=>{const r=c.c.unionStructure(e(n)),o=c.c.LinearBuilder(n.inputStructure);return c.c.forEach(t(n),(t,e)=>{(0,A.HK)(r,t)&&o.add(t),e%10&&n.throwIfTimedOut()}),o.getSelection()}}function ft(t){return e=>{const n={queryCtx:e,selection:t.query(e),target:t.target(e),maxRadius:t.maxRadius,minRadius:t.minRadius?Math.max(0,t.minRadius):0,elementRadius:t.elementRadius,invert:!!t.invert};return 0===n.minRadius&&void 0===t.minRadius?function({queryCtx:t,selection:e,target:n,maxRadius:r,invert:o}){const i=c.c.unionStructure(n).lookup3d,s=c.c.LinearBuilder(t.inputStructure),a=st.eB.zero();return c.c.forEach(e,(e,n)=>{const{units:u}=e;let c=!1;for(let t=0,o=u.length;t<o;t++){const e=u[t],{elements:n,conformation:o}=e;for(let t=0,s=n.length;t<s;t++){const e=n[t];if(o.position(e,a),i.check(a[0],a[1],a[2],r+o.r(e))){c=!0;break}}if(c)break}o&&(c=!c),c&&s.add(e),n%10==0&&t.throwIfTimedOut()}),s.getSelection()}(n):0===n.minRadius?function({queryCtx:t,selection:e,target:n,maxRadius:r,invert:o,elementRadius:i}){const s=c.c.unionStructure(n),a=c.c.LinearBuilder(t.inputStructure);return t.pushCurrentElement(),c.c.forEach(e,(e,n)=>{let u=function(t,e,n,r,o){return 0===e.elementCount||0===n.elementCount||(e.elementCount<=n.elementCount?rt.check(t,e,n,r,o):rt.check(t,n,e,r,o))}(t,s,e,r,i);o&&(u=!u),u&&a.add(e),n%10==0&&t.throwIfTimedOut()}),t.popCurrentElement(),a.getSelection()}(n):function({queryCtx:t,selection:e,target:n,minRadius:r,maxRadius:o,invert:i,elementRadius:s}){const a=c.c.unionStructure(n),u=c.c.LinearBuilder(t.inputStructure);return t.pushCurrentElement(),c.c.forEach(e,(e,n)=>{let c=function(t,e,n,r,o,i){return 0===e.elementCount||0===n.elementCount||(e.elementCount<=n.elementCount?nt.check(t,e,n,r,o,i):nt.check(t,n,e,r,o,i))}(t,a,e,r,o,s);i&&(c=!c),c&&u.add(e),n%10==0&&t.throwIfTimedOut()}),t.popCurrentElement(),u.getSelection()}(n)}}function mt({query:t,target:e,disjunct:n,invert:r,bondTest:o}){return i=>{const s=e(i);if(c.c.isEmpty(s))return s;const a=t(i);if(c.c.isEmpty(a))return a;const u={queryCtx:i,input:i.inputStructure,disjunct:n,target:c.c.unionStructure(s)},d=c.c.LinearBuilder(i.inputStructure);return i.pushCurrentBond(),i.atomicBond.setTestFn(o),c.c.forEach(a,(t,e)=>{!function(t,e){const{queryCtx:n,input:r,target:o,disjunct:i}=t,s=n.atomicBond,a=r.interUnitBonds;s.setStructure(r);for(const u of e.units){if(!l.Nf.isAtomic(u))continue;const t=r.unitMap.get(u.id),{offset:c,b:d,edgeProps:{flags:f,order:m,key:h}}=t.bonds,p=a.getConnectedUnits(u.id),g=p.length,_=u.elements,A=t.elements;for(let a=0,l=_.length;a<l;a++){const l=y.X9.indexOf(A,_[a]);s.a.unit=t,s.b.unit=t;for(let e=c[l],r=c[l+1];e<r;e++)if(s.b.element=t.elements[d[e]],(!i||!y.X9.has(u.elements,s.b.element))&&o.hasElement(s.b)&&(s.aIndex=l,s.a.element=_[a],s.bIndex=d[e],s.type=f[e],s.order=m[e],s.key=h[e],s.test(n,!0)))return!0;for(let u=0;u<g;u++){const c=p[u],d=r.unitMap.get(c.unitB),f=d.elements,m=c.getEdges(l);for(let r=0,u=m.length;r<u;r++){const u=m[r];if(s.b.unit=d,s.b.element=f[u.indexB],o.hasElement(s.b)&&(!i||!e.hasElement(s.b))&&(s.a.unit=t,s.aIndex=l,s.a.element=_[a],s.bIndex=u.indexB,s.type=u.props.flag,s.order=u.props.order,s.key=u.props.key,s.test(n,!0)))return!0}}}}return!1}(u,t)?r&&d.add(t):d.add(t),e%5==0&&i.throwIfTimedOut()}),i.popCurrentBond(),d.getSelection()}}function ht(t){return 0===t.length?S:1===t.length?t[0]:e=>{const n=c.c.UniqueBuilder(e.inputStructure);for(let r=0;r<t.length;r++)c.c.forEach(t[r](e),(t,o)=>{n.add(t),r%100&&e.throwIfTimedOut()});return n.getSelection()}}function pt(t){return 0===t.length?S:1===t.length?t[0]:e=>{const n=[];for(let a=0;a<t.length;a++)n.push(t[a](e));let r=0,o=c.c.structureCount(n[0]);for(let t=1;t<n.length;t++){const e=c.c.structureCount(n[t]);e<o&&(r=t,o=e)}e.throwIfTimedOut();const i=(0,g.bw)(t=>t.hashCode,l.oE.areUnitIdsAndIndicesEqual);c.c.forEach(n[r],t=>i.add(t));const s=c.c.UniqueBuilder(e.inputStructure);for(let t=0;t<n.length;t++)t!==r&&(c.c.forEach(n[t],t=>{i.has(t)&&s.add(t)}),e.throwIfTimedOut());return s.getSelection()}}function gt(t){return t.currentStructure.elementCount}function yt(t){return e=>{const n=t(e);return c.c.structureCount(n)}}function _t(t){return e=>{const n=new Set;return ct(e,t,n)}}!function(t){let e;!function(t){t[t.BelowMin=0]="BelowMin",t[t.WithinMax=1]="WithinMax",t[t.Miss=2]="Miss"}(e||(e={}));const n=(0,st.eB)();function r(t,r,o,i,s,a,u){const{elements:c,conformation:l}=r,d=n;t.element.unit=r;let f=!1;for(let n=0,m=c.length;n<m;n++){const r=c[n];t.element.element=r;const m=Math.max(0,st.eB.distance(o,l.position(r,d))-i-u(t));if(m<s)return e.BelowMin;m<a&&(f=!0)}return f?e.WithinMax:e.Miss}function o(t,n,o,i,s,a,u){const{units:c}=n;let l=!1;for(let d=0,f=c.length;d<f;d++){const n=r(t,c[d],o,i,s,a,u);if(n===e.BelowMin)return e.BelowMin;n===e.WithinMax&&(l=!0)}return l?e.WithinMax:e.Miss}const i=(0,st.eB)();t.check=function(t,n,r,s,a,u){if(0===n.elementCount||0===r.elementCount)return 0;const{units:c}=n;let l=!1;t.element.structure=n;for(let d=0,f=c.length;d<f;d++){const n=c[d],{elements:f,conformation:m}=n;t.element.unit=n;for(let c=0,d=f.length;c<d;c++){const n=f[c];t.element.element=n;const d=o(t,r,m.position(n,i),u(t),s,a,u);if(d===e.BelowMin)return!1;d===e.WithinMax&&(l=!0)}}return l}}(nt||(nt={})),function(t){const e=(0,st.eB)();function n(t,n,r,o,i,s){const{elements:a,conformation:u}=n,c=e;t.element.unit=n;for(let e=0,l=a.length;e<l;e++){const n=a[e];if(t.element.element=n,Math.max(0,st.eB.distance(r,u.position(n,c))-o-s(t))<=i)return!0}return!1}function r(t,e,r,o,i,s){const{units:a}=e;for(let u=0,c=a.length;u<c;u++)if(n(t,a[u],r,o,i,s))return!0;return!1}const o=(0,st.eB)();t.check=function(t,e,n,i,s){if(0===e.elementCount||0===n.elementCount)return 0;const{units:a}=e;t.element.structure=e;for(let u=0,c=a.length;u<c;u++){const e=a[u];t.element.unit=e;const{elements:c,conformation:l}=e;for(let a=0,u=c.length;a<u;a++){const e=c[a];if(t.element.element=e,r(t,n,l.position(e,o),s(t),i,s))return!0}}return!1}}(rt||(rt={})),function(t){function e(t){return!0}function n(t){return!1}t.eq=function(t,e){return n=>t(n)===e},t.lt=function(t,e){return n=>t(n)<e},t.lte=function(t,e){return n=>t(n)<=e},t.gt=function(t,e){return n=>t(n)>e},t.gte=function(t,e){return n=>t(n)>=e},t.inSet=function(t,e){if((r=e)&&r.has)return n=>e.has(t(n));{if(0===e.length)return n;const r=new Set;for(let t=0;t<e.length;t++)r.add(e[t]);return e=>r.has(t(e))}var r},t.and=function(...t){switch(t.length){case 0:return e;case 1:return t[0];case 2:{const e=t[0],n=t[1];return t=>e(t)&&n(t)}case 3:{const e=t[0],n=t[1],r=t[2];return t=>e(t)&&n(t)&&r(t)}case 4:{const e=t[0],n=t[1],r=t[2],o=t[3];return t=>e(t)&&n(t)&&r(t)&&o(t)}case 5:{const e=t[0],n=t[1],r=t[2],o=t[3],i=t[4];return t=>e(t)&&n(t)&&r(t)&&o(t)&&i(t)}case 6:{const e=t[0],n=t[1],r=t[2],o=t[3],i=t[4],s=t[5];return t=>e(t)&&n(t)&&r(t)&&o(t)&&i(t)&&s(t)}default:{const e=t.length;return n=>{for(let r=0;r<e;r++)if(!t[r])return!1;return!0}}}},t.or=function(...t){switch(t.length){case 0:return n;case 1:return t[0];case 2:{const e=t[0],n=t[1];return t=>e(t)||n(t)}case 3:{const e=t[0],n=t[1],r=t[2];return t=>e(t)||n(t)||r(t)}case 4:{const e=t[0],n=t[1],r=t[2],o=t[3];return t=>e(t)||n(t)||r(t)||o(t)}case 5:{const e=t[0],n=t[1],r=t[2],o=t[3],i=t[4];return t=>e(t)||n(t)||r(t)||o(t)||i(t)}case 6:{const e=t[0],n=t[1],r=t[2],o=t[3],i=t[4],s=t[5];return t=>e(t)||n(t)||r(t)||o(t)||i(t)||s(t)}default:{const e=t.length;return n=>{for(let r=0;r<e;r++)if(t[r])return!0;return!1}}}}}(ot||(ot={}));const At={generators:r,filters:i,modifiers:o,combinators:s,pred:ot,internal:m,atomset:a}},73868:function(t,e,n){n.d(e,{p8:function(){return l.p},U:function(){return i.U},$I:function(){return o.$},k:function(){return c.k},qY:function(){return r},ZY:function(){return s.Z},eB:function(){return a.e},Zb:function(){return u.Z}});var r,o=n(95156),i=n(22753),s=n(28026),a=n(98537),u=n(7548),c=n(78605),l=n(35695);!function(t){function e(t,e,o){const i=function(t,e,n){const r=[];for(let i=0;i<e.length;i++)r[i]=e[e.length-i-1];const o=[1];for(let i=1;i<t.length;i++)o[i]=t[r[i-1]];return{dimensions:t,axisOrderFastToSlow:r,axisOrderSlowToFast:e,accessDimensions:o,defaultCtor:n||Float64Array}}(t,e,o),{get:s,set:a,add:u,dataOffset:c,getCoords:l}=n(i);return{rank:t.length,dimensions:t,axisOrderSlowToFast:e,create:r(i),get:s,set:a,add:u,dataOffset:c,getCoords:l}}function n(t){const{dimensions:e,axisOrderFastToSlow:n}=t;switch(e.length){case 1:return{get:(t,e)=>t[e],set:(t,e,n)=>t[e]=n,add:(t,e,n)=>t[e]+=n,dataOffset:t=>t,getCoords:(t,e)=>(e[0]=t,e)};case 2:if(0===n[0]&&1===n[1]){const t=e[0];return{get:(e,n,r)=>e[r*t+n],set:(e,n,r,o)=>e[r*t+n]=o,add:(e,n,r,o)=>e[r*t+n]+=o,dataOffset:(e,n)=>n*t+e,getCoords:(e,n)=>(n[0]=e%t,n[1]=Math.floor(e/t),n)}}if(1===n[0]&&0===n[1]){const t=e[1];return{get:(e,n,r)=>e[n*t+r],set:(e,n,r,o)=>e[n*t+r]=o,add:(e,n,r,o)=>e[n*t+r]+=o,dataOffset:(e,n)=>e*t+n,getCoords:(e,n)=>(n[0]=Math.floor(e/t),n[1]=e%t,n)}}throw new Error("bad axis order");case 3:if(0===n[0]&&1===n[1]&&2===n[2]){const t=e[0],n=e[1],r=t*n;return{get:(e,n,o,i)=>e[n+o*t+i*r],set:(e,n,o,i,s)=>e[n+o*t+i*r]=s,add:(e,n,o,i,s)=>e[n+o*t+i*r]+=s,dataOffset:(e,n,o)=>e+n*t+o*r,getCoords:(e,r)=>{const o=Math.floor(e/t);return r[0]=e%t,r[1]=o%n,r[2]=Math.floor(o/n),r}}}if(0===n[0]&&2===n[1]&&1===n[2]){const t=e[0],n=e[2],r=t*n;return{get:(e,n,o,i)=>e[n+i*t+o*r],set:(e,n,o,i,s)=>e[n+i*t+o*r]=s,add:(e,n,o,i,s)=>e[n+i*t+o*r]+=s,dataOffset:(e,n,o)=>e+o*t+n*r,getCoords:(e,r)=>{const o=Math.floor(e/t);return r[0]=e%t,r[1]=Math.floor(o/n),r[2]=o%n,r}}}if(1===n[0]&&0===n[1]&&2===n[2]){const t=e[1],n=e[0],r=t*n;return{get:(e,n,o,i)=>e[o+n*t+i*r],set:(e,n,o,i,s)=>e[o+n*t+i*r]=s,add:(e,n,o,i,s)=>e[o+n*t+i*r]+=s,dataOffset:(e,n,o)=>n+e*t+o*r,getCoords:(e,r)=>{const o=Math.floor(e/t);return r[0]=o%n,r[1]=e%t,r[2]=Math.floor(o/n),r}}}if(1===n[0]&&2===n[1]&&0===n[2]){const t=e[1],n=e[2],r=t*n;return{get:(e,n,o,i)=>e[o+i*t+n*r],set:(e,n,o,i,s)=>e[o+i*t+n*r]=s,add:(e,n,o,i,s)=>e[o+i*t+n*r]+=s,dataOffset:(e,n,o)=>n+o*t+e*r,getCoords:(e,r)=>{const o=Math.floor(e/t);return r[0]=Math.floor(o/n),r[1]=e%t,r[2]=o%n,r}}}if(2===n[0]&&0===n[1]&&1===n[2]){const t=e[2],n=e[0],r=t*n;return{get:(e,n,o,i)=>e[i+n*t+o*r],set:(e,n,o,i,s)=>e[i+n*t+o*r]=s,add:(e,n,o,i,s)=>e[i+n*t+o*r]+=s,dataOffset:(e,n,o)=>o+e*t+n*r,getCoords:(e,r)=>{const o=Math.floor(e/t);return r[0]=o%n,r[1]=Math.floor(o/n),r[2]=e%t,r}}}if(2===n[0]&&1===n[1]&&0===n[2]){const t=e[2],n=e[1],r=t*n;return{get:(e,n,o,i)=>e[i+o*t+n*r],set:(e,n,o,i,s)=>e[i+o*t+n*r]=s,add:(e,n,o,i,s)=>e[i+o*t+n*r]+=s,dataOffset:(e,n,o)=>o+n*t+e*r,getCoords:(e,r)=>{const o=Math.floor(e/t);return r[0]=Math.floor(o/n),r[1]=o%n,r[2]=e%t,r}}}throw new Error("bad axis order");default:return{get:(e,...n)=>e[s(t,n)],set:(e,...n)=>e[s(t,n)]=n[n.length-1],add:(e,...n)=>e[s(t,n)]+=n[n.length-1],dataOffset:(...e)=>s(t,e),getCoords:(e,n)=>function(t,e,n){const{dimensions:r,axisOrderFastToSlow:o}=t,i=r.length;let s=e;for(let a=0;a<i;a++){const t=r[o[a]];n[o[a]]=s%t,s=Math.floor(s/t)}return n[o[i+1]]=s,n}(t,e,n)}}}function r(t){const{dimensions:e}=t;let n=1;for(let r=0,o=e.length;r<o;r++)n*=e[r];return e=>new(e||t.defaultCtor)(n)}function s(t,e){const{accessDimensions:n,axisOrderFastToSlow:r}=t,o=n.length-1;let i=n[o]*e[r[o]];for(let s=o-1;s>=0;s--)i=(i+e[r[s]])*n[s];return i}function a(t,e){const n=[];for(let r=0;r<t.length;r++)n[r]=t[e[r]];return n}t.create=function(t,e){return{space:t,data:e}},t.Space=e,t.Data1=function(t){return t},t.Vector=function(t,n){return e([t],[0],n)},t.ColumnMajorMatrix=function(t,n,r){return e([t,n],[1,0],r)},t.RowMajorMatrix=function(t,n,r){return e([t,n],[0,1],r)},t.toMat4=function(t,e,n){if(2!==e.rank)throw new Error("Invalid tensor rank");const r=Math.min(4,e.dimensions[0]),i=Math.min(4,e.dimensions[1]);for(let s=0;s<r;s++)for(let r=0;r<i;r++)o.$.setValue(t,s,r,e.get(n,s,r));return t},t.toMat3=function(t,e,n){if(2!==e.rank)throw new Error("Invalid tensor rank");const r=Math.min(3,e.dimensions[0]),o=Math.min(3,e.dimensions[1]);for(let s=0;s<r;s++)for(let r=0;r<o;r++)i.U.setValue(t,s,r,e.get(n,s,r));return t},t.toVec3=function(t,e,n){if(1!==e.rank)throw new Error("Invalid tensor rank");const r=Math.min(3,e.dimensions[0]);for(let o=0;o<r;o++)t[o]=n[o];return t},t.toVec4=function(t,e,n){if(1!==e.rank)throw new Error("Invalid tensor rank");const r=Math.min(4,e.dimensions[0]);for(let o=0;o<r;o++)t[o]=n[o];return t},t.areEqualExact=function(t,e){const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0},t.invertAxisOrder=function(t){const e=[];for(let n=0;n<t.length;n++)e[n]=t[t.length-n-1];return e},t.convertToCanonicalAxisIndicesFastToSlow=function(t){const e=new Int32Array(t.length);for(let n=0;n<t.length;n++)e[t[n]]=n;return t=>a(t,e)},t.convertToCanonicalAxisIndicesSlowToFast=function(t){const e=new Int32Array(t.length);for(let n=0;n<t.length;n++)e[t[t.length-n-1]]=n;return t=>a(t,e)}}(r||(r={}))},75301:function(t,e,n){n.d(e,{O:function(){return r},q:function(){return l}});var r,o=n(68223),i=n(45010),s=n(62683),a=n(82346);!function(t){t.ElementSymbol=o.Z.Value("Structure","ElementSymbol"),t.AtomName=o.Z.Value("Structure","AtomName"),t.BondFlag=o.Z.OneOf("Structure","BondFlag",o.Z.Str,["covalent","metallic","ion","hydrogen","sulfide","computed","aromatic"]),t.BondFlags=i.Or.Flags(t.BondFlag,"BondFlags"),t.SecondaryStructureFlag=o.Z.OneOf("Structure","SecondaryStructureFlag",o.Z.Str,["alpha","beta","3-10","pi","sheet","strand","helix","turn","none"]),t.SecondaryStructureFlags=i.Or.Flags(t.SecondaryStructureFlag,"SecondaryStructureFlag"),t.RingFingerprint=o.Z.Value("Structure","RingFingerprint"),t.EntityType=o.Z.OneOf("Structure","EntityType",o.Z.Str,["polymer","non-polymer","water","branched"]),t.EntitySubtype=o.Z.OneOf("Structure","EntitySubtype",o.Z.Str,["other","polypeptide(D)","polypeptide(L)","polydeoxyribonucleotide","polyribonucleotide","polydeoxyribonucleotide/polyribonucleotide hybrid","cyclic-pseudo-peptide","peptide nucleic acid","oligosaccharide"]),t.ObjectPrimitive=o.Z.OneOf("Structure","ObjectPrimitive",o.Z.Str,["atomistic","sphere","gaussian","other"]),t.ResidueId=o.Z.Value("Structure","ResidueId"),t.ElementSet=o.Z.Value("Structure","ElementSet"),t.ElementSelection=o.Z.Value("Structure","ElementSelection"),t.ElementReference=o.Z.Value("Structure","ElementReference"),t.ElementSelectionQuery=i.Or.Fn(t.ElementSelection,"ElementSelectionQuery")}(r||(r={}));function u(t,e){return(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(r.ElementReference,{isOptional:!0,defaultValue:"slot.current-atom"})}),t,e)}function c(t,e){return(0,a.HR)(s.d3.None,t,e)}const l={"@header":"Structure Queries",type:{"@header":"Types",elementSymbol:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(o.Z.Str)}),r.ElementSymbol,"Create element symbol representation from a string value."),atomName:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(o.Z.AnyValue)}),r.AtomName,"Convert a value to an atom name."),entityType:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(r.EntityType)}),r.EntityType,`Create normalized representation of entity type: ${o.Z.oneOfValues(r.EntityType).join(", ")}.`),bondFlags:(0,a.HR)(s.d3.List(r.BondFlag),r.BondFlags,`Create bond flags representation from a list of strings. Allowed flags: ${o.Z.oneOfValues(r.BondFlag).join(", ")}.`),ringFingerprint:(0,a.HR)(s.d3.List(r.ElementSymbol,{nonEmpty:!0}),r.RingFingerprint,"Create ring fingerprint from the supplied atom element list."),secondaryStructureFlags:(0,a.HR)(s.d3.List(r.SecondaryStructureFlag),r.SecondaryStructureFlags,`Create secondary structure flags representation from a list of strings. Allowed flags: ${o.Z.oneOfValues(r.SecondaryStructureFlag).join(", ")}.`),authResidueId:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(o.Z.Str,{description:"auth_asym_id"}),1:(0,s.ef)(o.Z.Num,{description:"auth_seq_id"}),2:(0,s.ef)(o.Z.Str,{description:"pdbx_PDB_ins_code",isOptional:!0})}),r.ResidueId,'Residue identifier based on "auth_" annotation.'),labelResidueId:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(o.Z.Str,{description:"label_entity_id"}),1:(0,s.ef)(o.Z.Str,{description:"label_asym_id"}),2:(0,s.ef)(o.Z.Num,{description:"label_seq_id"}),3:(0,s.ef)(o.Z.Str,{description:"pdbx_PDB_ins_code",isOptional:!0})}),r.ResidueId,'Residue identifier based on mmCIF\'s "label_" annotation.')},slot:{"@header":"Iteration Slots",element:(0,a.HR)(s.d3.None,r.ElementReference,"A reference to the current element."),elementSetReduce:(0,a.HR)(s.d3.None,o.Z.Variable("a",o.Z.AnyValue,!0),"Current value of the element set reducer.")},generator:{"@header":"Generators",all:(0,a.HR)(s.d3.None,r.ElementSelectionQuery,"The entire structure."),atomGroups:(0,a.HR)(s.d3.Dictionary({"entity-test":(0,s.ef)(o.Z.Bool,{isOptional:!0,defaultValue:!0,description:"Test for the 1st atom of every entity"}),"chain-test":(0,s.ef)(o.Z.Bool,{isOptional:!0,defaultValue:!0,description:"Test for the 1st atom of every chain"}),"residue-test":(0,s.ef)(o.Z.Bool,{isOptional:!0,defaultValue:!0,description:"Test for the 1st atom every residue"}),"atom-test":(0,s.ef)(o.Z.Bool,{isOptional:!0,defaultValue:!0}),"group-by":(0,s.ef)(o.Z.Any,{isOptional:!0,defaultValue:"atom-key",description:"Group atoms to sets based on this property. Default: each atom has its own set"})}),r.ElementSelectionQuery,"Return all atoms for which the tests are satisfied, grouped into sets."),bondedAtomicPairs:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(o.Z.Bool,{isOptional:!0,defaultValue:"true for covalent bonds",description:"Test each bond with this predicate. Each bond is visited twice with swapped atom order."})}),r.ElementSelectionQuery,"Return all pairs of atoms for which the test is satisfied."),rings:(0,a.HR)(s.d3.Dictionary({fingerprint:(0,s.ef)(r.RingFingerprint,{isOptional:!0}),"only-aromatic":(0,s.ef)(o.Z.Bool,{isOptional:!0,defaultValue:!1})}),r.ElementSelectionQuery,"Return all rings or those with the specified fingerprint and/or only aromatic rings."),queryInSelection:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(r.ElementSelectionQuery),query:(0,s.ef)(r.ElementSelectionQuery),"in-complement":(0,s.ef)(o.Z.Bool,{isOptional:!0,defaultValue:!1})}),r.ElementSelectionQuery,"Executes query only on atoms that are in the source selection."),empty:(0,a.HR)(s.d3.None,r.ElementSelectionQuery,"Nada.")},modifier:{"@header":"Selection Modifications",queryEach:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(r.ElementSelectionQuery),query:(0,s.ef)(r.ElementSelectionQuery)}),r.ElementSelectionQuery,"Query every atom set in the input selection separately."),intersectBy:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(r.ElementSelectionQuery),by:(0,s.ef)(r.ElementSelectionQuery)}),r.ElementSelectionQuery,"Intersect each atom set from the first sequence from atoms in the second one."),exceptBy:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(r.ElementSelectionQuery),by:(0,s.ef)(r.ElementSelectionQuery)}),r.ElementSelectionQuery,"Remove all atoms from 'selection' that occur in 'by'."),unionBy:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(r.ElementSelectionQuery),by:(0,s.ef)(r.ElementSelectionQuery)}),r.ElementSelectionQuery,"For each atom set A in the orginal sequence, combine all atoms sets in the target selection that intersect with A."),union:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(r.ElementSelectionQuery)}),r.ElementSelectionQuery,"Collects all atom sets in the sequence into a single atom set."),cluster:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(r.ElementSelectionQuery),"min-distance":(0,s.ef)(o.Z.Num,{isOptional:!0,defaultValue:0}),"max-distance":(0,s.ef)(o.Z.Num),"min-size":(0,s.ef)(o.Z.Num,{description:"Minimal number of sets to merge, must be at least 2",isOptional:!0,defaultValue:2}),"max-size":(0,s.ef)(o.Z.Num,{description:"Maximal number of sets to merge, if not set, no limit",isOptional:!0})}),r.ElementSelectionQuery,"Combines atom sets that have mutual distance in the interval [min-radius, max-radius]. Minimum/maximum size determines how many atom sets can be combined."),includeSurroundings:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(r.ElementSelectionQuery),radius:(0,s.ef)(o.Z.Num),"atom-radius":(0,s.ef)(o.Z.Num,{isOptional:!0,defaultValue:0,description:"Value added to each atom before the distance check, for example VDW radius. Using this argument is computationally demanding."}),"as-whole-residues":(0,s.ef)(o.Z.Bool,{isOptional:!0})}),r.ElementSelectionQuery,"For each atom set in the selection, include all surrouding atoms/residues that are within the specified radius."),surroundingLigands:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(r.ElementSelectionQuery),radius:(0,s.ef)(o.Z.Num),"include-water":(0,s.ef)(o.Z.Bool,{isOptional:!0,defaultValue:!0})}),r.ElementSelectionQuery,"Find all ligands components around the source query."),includeConnected:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(r.ElementSelectionQuery),"bond-test":(0,s.ef)(o.Z.Bool,{isOptional:!0,defaultValue:"true for covalent bonds"}),"layer-count":(0,s.ef)(o.Z.Num,{isOptional:!0,defaultValue:1,description:"Number of bonded layers to include."}),"fixed-point":(0,s.ef)(o.Z.Bool,{isOptional:!0,defaultValue:!1,description:"Continue adding layers as long as new connections exist."}),"as-whole-residues":(0,s.ef)(o.Z.Bool,{isOptional:!0})}),r.ElementSelectionQuery,"Pick all atom sets that are connected to the target."),wholeResidues:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(r.ElementSelectionQuery)}),r.ElementSelectionQuery,"Expand the selection to whole residues."),expandProperty:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(r.ElementSelectionQuery),property:(0,s.ef)(o.Z.AnyValue)}),r.ElementSelectionQuery,"To each atom set in the selection, add all atoms that have the same property value that was already present in the set.")},filter:{"@header":"Selection Filters",pick:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(r.ElementSelectionQuery),test:(0,s.ef)(o.Z.Bool)}),r.ElementSelectionQuery,"Pick all atom sets that satisfy the test."),first:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(r.ElementSelectionQuery)}),r.ElementSelectionQuery,"Take the 1st atom set in the sequence."),withSameAtomProperties:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(r.ElementSelectionQuery),source:(0,s.ef)(r.ElementSelectionQuery),property:(0,s.ef)(o.Z.Any)}),r.ElementSelectionQuery,"Pick all atom sets for which the set of given atom properties is a subset of the source properties."),intersectedBy:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(r.ElementSelectionQuery),by:(0,s.ef)(r.ElementSelectionQuery)}),r.ElementSelectionQuery,"Pick all atom sets that have non-zero intersection with the target."),within:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(r.ElementSelectionQuery),target:(0,s.ef)(r.ElementSelectionQuery),"min-radius":(0,s.ef)(o.Z.Num,{isOptional:!0,defaultValue:0}),"max-radius":(0,s.ef)(o.Z.Num),"atom-radius":(0,s.ef)(o.Z.Num,{isOptional:!0,defaultValue:0,description:"Value added to each atom before the distance check, for example VDW radius. Using this argument is computationally demanding."}),invert:(0,s.ef)(o.Z.Bool,{isOptional:!0,defaultValue:!1,description:"If true, pick only atom sets that are further than the specified radius."})}),r.ElementSelectionQuery,"Pick all atom sets from selection that have any atom within the radius of any atom from target."),isConnectedTo:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(r.ElementSelectionQuery),target:(0,s.ef)(r.ElementSelectionQuery),"bond-test":(0,s.ef)(o.Z.Bool,{isOptional:!0,defaultValue:"true for covalent bonds"}),disjunct:(0,s.ef)(o.Z.Bool,{isOptional:!0,defaultValue:!0,description:"If true, there must exist a bond to an atom that lies outside the given atom set to pass test."}),invert:(0,s.ef)(o.Z.Bool,{isOptional:!0,defaultValue:!1,description:"If true, return atom sets that are not connected."})}),r.ElementSelectionQuery,"Pick all atom sets that are connected to the target.")},combinator:{"@header":"Selection Combinators",intersect:(0,a.HR)(s.d3.List(r.ElementSelectionQuery),r.ElementSelectionQuery,"Return all unique atom sets that appear in all of the source selections."),merge:(0,a.HR)(s.d3.List(r.ElementSelectionQuery),r.ElementSelectionQuery,"Merges multiple selections into a single one. Only unique atom sets are kept."),distanceCluster:(0,a.HR)(s.d3.Dictionary({matrix:(0,s.ef)(i.Or.List(i.Or.List(o.Z.Num)),{description:"Distance matrix, represented as list of rows (num[][])). Lower triangle is min distance, upper triangle is max distance."}),selections:(0,s.ef)(i.Or.List(r.ElementSelectionQuery),{description:"A list of held selections."})}),r.ElementSelectionQuery,"Pick combinations of atom sets from the source sequences that are mutually within distances specified by a matrix.")},atomSet:{"@header":"Atom Sets",atomCount:(0,a.HR)(s.d3.None,o.Z.Num),countQuery:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(r.ElementSelectionQuery)}),o.Z.Num,"Counts the number of occurences of a specific query inside the current atom set."),reduce:(0,a.HR)(s.d3.Dictionary({initial:(0,s.ef)(o.Z.Variable("a",o.Z.AnyValue,!0),{description:"Initial value assigned to slot.atom-set-reduce. Current atom is set to the 1st atom of the current set for this."}),value:(0,s.ef)(o.Z.Variable("a",o.Z.AnyValue,!0),{description:"Expression executed for each atom in the set"})}),o.Z.Variable("a",o.Z.AnyValue,!0),"Execute the value expression for each atom in the current atom set and return the result. Works the same way as Array.reduce in JavaScript (``result = value(value(...value(initial)))``)"),propertySet:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(i.Or.ConstrainedVar)}),i.Or.Set(i.Or.ConstrainedVar),"Returns a set with all values of the given property in the current atom set.")},atomProperty:{"@header":"Atom Properties",core:{"@header":"Core Properties",elementSymbol:u(r.ElementSymbol),vdw:u(o.Z.Num,"Van der Waals radius"),mass:u(o.Z.Num,"Atomic weight"),atomicNumber:u(o.Z.Num,"Atomic number"),x:u(o.Z.Num,"Cartesian X coordinate"),y:u(o.Z.Num,"Cartesian Y coordinate"),z:u(o.Z.Num,"Cartesian Z coordinate"),atomKey:u(o.Z.AnyValue,"Unique value for each atom. Main use case is grouping of atoms."),bondCount:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(r.ElementReference,{isOptional:!0,defaultValue:"slot.current-atom"}),flags:(0,s.ef)(r.BondFlags,{isOptional:!0,defaultValue:"covalent"})}),o.Z.Num,"Number of bonds (by default only covalent bonds are counted)."),sourceIndex:u(o.Z.Num,"Index of the atom/element in the input file."),operatorName:u(o.Z.Str,"Name of the symmetry operator applied to this element."),instanceId:u(o.Z.Str,"Canonical name of the symmetry operator applied to this element."),operatorKey:u(o.Z.Num,"Key of the symmetry operator applied to this element."),modelIndex:u(o.Z.Num,"Index of the model in the input file."),modelLabel:u(o.Z.Str,"Label/header of the model in the input file."),modelEntryId:u(o.Z.Str,"Entry ID of the model (e.g., PDB ID).")},topology:{connectedComponentKey:u(o.Z.AnyValue,"Unique value for each connected component.")},macromolecular:{"@header":"Macromolecular Properties (derived from the mmCIF format)",authResidueId:u(r.ResidueId,"type.auth-residue-id symbol executed on current atom's residue"),labelResidueId:u(r.ResidueId,"type.label-residue-id symbol executed on current atom's residue"),residueKey:u(o.Z.AnyValue,"Unique value for each tuple ``(label_entity_id,auth_asym_id, auth_seq_id, pdbx_PDB_ins_code)``, main use case is grouping of atoms"),chainKey:u(o.Z.AnyValue,"Unique value for each tuple ``(label_entity_id, auth_asym_id)``, main use case is grouping of atoms"),entityKey:u(o.Z.AnyValue,"Unique value for each tuple ``label_entity_id``, main use case is grouping of atoms"),isHet:u(o.Z.Bool,"Equivalent to atom_site.group_PDB !== ATOM"),id:u(o.Z.Num,"_atom_site.id"),label_atom_id:u(r.AtomName),label_alt_id:u(o.Z.Str),label_comp_id:u(o.Z.Str),label_asym_id:u(o.Z.Str),label_entity_id:u(o.Z.Str),label_seq_id:u(o.Z.Num),auth_atom_id:u(r.AtomName),auth_comp_id:u(o.Z.Str),auth_asym_id:u(o.Z.Str),auth_seq_id:u(o.Z.Num),residueSourceIndex:u(o.Z.Num),pdbx_PDB_ins_code:u(o.Z.Str),pdbx_formal_charge:u(o.Z.Num),occupancy:u(o.Z.Num),B_iso_or_equiv:u(o.Z.Num),entityType:u(r.EntityType,"Type of the entity as defined in mmCIF (polymer, non-polymer, branched, water)"),entitySubtype:u(r.EntitySubtype,"Subtype of the entity as defined in mmCIF _entity_poly.type and _pdbx_entity_branch.type (other, polypeptide(D), polypeptide(L), polydeoxyribonucleotide, polyribonucleotide, polydeoxyribonucleotide/polyribonucleotide hybrid, cyclic-pseudo-peptide, peptide nucleic acid, oligosaccharide)"),entityPrdId:u(o.Z.Str,"The PRD ID of the entity."),entityDescription:u(i.Or.List(o.Z.Str)),objectPrimitive:u(r.ObjectPrimitive,"Type of the primitive object used to model this segment as defined in mmCIF/IHM (atomistic, sphere, gaussian, other)"),secondaryStructureKey:u(o.Z.AnyValue,"Unique value for each secondary structure element."),secondaryStructureFlags:u(r.SecondaryStructureFlags),isModified:u(o.Z.Bool,"True if the atom belongs to modification of a standard residue."),modifiedParentName:u(o.Z.Str,"'3-letter' code of the modifed parent residue."),isNonStandard:u(o.Z.Bool,"True if this is a non-standard residue."),chemCompType:u(o.Z.Str,"Type of the chemical component as defined in mmCIF.")},ihm:{hasSeqId:(0,a.HR)(s.d3.Dictionary({0:(0,s.ef)(o.Z.Num)}),o.Z.Bool,"Checks if the current element represents a given sequence id"),overlapsSeqIdRange:(0,a.HR)(s.d3.Dictionary({beg:(0,s.ef)(o.Z.Num),end:(0,s.ef)(o.Z.Num)}),o.Z.Bool,"Checks if the current element overlaps with the specified residue range")}},bondProperty:{"@header":"Bond Properties",flags:c(r.BondFlags),order:c(o.Z.Num),key:c(o.Z.Num),length:c(o.Z.Num),atomA:c(r.ElementReference),atomB:c(r.ElementReference)}}},75434:function(t,e,n){n.d(e,{_:function(){return r}});var r,o=n(9422),i=n(51142),s=n(59859),a=n(78850);!function(t){function e(t){const e=t.descriptor.name,n="static"===t.type?"_staticPropertyData":"_dynamicPropertyData",r=r=>(e in r[n]||(r[n][e]={props:{...o.t.getDefaultValues(t.getParams(r))},data:i.xv.create(void 0)}),r[n][e]),s=(t,o,s)=>{const a=r(t);t[n][e]={props:o,data:i.xv.withValue(a.data,s)}};return{label:t.label,descriptor:t.descriptor,isHidden:t.isHidden,getParams:e=>{const n=o.t.clone(t.getParams(e));return o.t.setDefaultValues(n,r(e).props),n},defaultParams:t.defaultParams,isApplicable:t.isApplicable,attach:async(e,n,i={},a)=>{a&&n.customProperties.reference(t.descriptor,!0);const u=r(n),c=o.t.merge(t.defaultParams,u.props,i);if(u.data.value&&o.t.areEqual(t.defaultParams,u.props,c))return;const{value:l,assets:d}=await t.obtain(e,n,c);n.customProperties.add(t.descriptor),n.customProperties.assets(t.descriptor,d),s(n,c,l)},ref:(e,n)=>e.customProperties.reference(t.descriptor,n),get:t=>{var e;return null===(e=r(t))||void 0===e?void 0:e.data},set:(e,n={},i)=>{const a=r(e),u=o.t.merge(t.defaultParams,a.props,n);o.t.areEqual(t.defaultParams,a.props,u)||(s(e,u,i),e.customProperties.assets(t.descriptor))},props:t=>r(t).props}}t.createProvider=e,t.createSimple=function(t,n,r){const i={value:o.t.Value(r,{isHidden:!0})};return e({label:(0,a.Mk)(t),descriptor:(0,s.e)({name:t}),isHidden:!0,type:n,defaultParams:i,getParams:()=>({value:o.t.Value(r,{isHidden:!0})}),isApplicable:()=>!0,obtain:async(t,e,n)=>({...o.t.getDefaultValues(i),...n})})}}(r||(r={}))},75847:function(t,e,n){n.d(e,{c:function(){return u}});var r=n(93273),o=n(98537);function i(t,e,n,r){r=t[e],t[e]=t[n],t[n]=r}function s(t,e){return(t=Math.abs(t))>(e=Math.abs(e))?(e/=t,t*Math.sqrt(1+e*e)):e>0?(t/=e,e*Math.sqrt(1+t*t)):0}function a(t,e,n,o){let a=0,u=0;const c=t.rows,l=t.cols;let d=c,f=l;d<f&&(a=1,u=d,d=f,f=u);const m=r.u.create(d,d),h=r.u.create(1,f),p=r.u.create(f,f);if(0===a)r.u.transpose(m,t);else{for(u=0;u<l*c;u++)m.data[u]=t.data[u];for(;u<f*d;u++)m.data[u]=0}if(function(t,e,n,r,o,a,u,c){let l=0,d=0,f=0,m=0;const h=Math.max(a,30);let p=0,g=0,y=0,_=0,A=0,b=0,C=0,S=0,x=0,v=0,B=0,I=0,w=0,P=0,D=0,M=0,N=0,E=4660,k=0,T=0,R=0;const U=new Float64Array(u<<3);for(;l<u;l++){for(f=0,B=0;f<a;f++)S=t[l*e+f],B+=S*S;if(U[l]=B,r){for(f=0;f<u;f++)r[l*o+f]=0;r[l*o+l]=1}}for(;m<h;m++){for(A=0,l=0;l<u-1;l++)for(d=l+1;d<u;d++){for(p=l*e|0,g=d*e|0,D=U[l],M=0,N=U[d],f=2,M+=t[p]*t[g],M+=t[p+1]*t[g+1];f<a;f++)M+=t[p+f]*t[g+f];if(!(Math.abs(M)<=2.384185792e-7*Math.sqrt(D*N))){for(M*=2,I=D-N,w=s(M,I),I<0?(P=.5*(w-I),C=Math.sqrt(P/w),b=M/(w*C*2)):(b=Math.sqrt((w+I)/(2*w)),C=M/(w*b*2)),D=0,N=0,f=2,x=b*t[p]+C*t[g],v=-C*t[p]+b*t[g],t[p]=x,t[g]=v,D+=x*x,N+=v*v,x=b*t[p+1]+C*t[g+1],v=-C*t[p+1]+b*t[g+1],t[p+1]=x,t[g+1]=v,D+=x*x,N+=v*v;f<a;f++)x=b*t[p+f]+C*t[g+f],v=-C*t[p+f]+b*t[g+f],t[p+f]=x,t[g+f]=v,D+=x*x,N+=v*v;if(U[l]=D,U[d]=N,A=1,r)for(y=l*o|0,_=d*o|0,f=2,x=b*r[y]+C*r[_],v=-C*r[y]+b*r[_],r[y]=x,r[_]=v,x=b*r[y+1]+C*r[_+1],v=-C*r[y+1]+b*r[_+1],r[y+1]=x,r[_+1]=v;f<u;f++)x=b*r[y+f]+C*r[_+f],v=-C*r[y+f]+b*r[_+f],r[y+f]=x,r[_+f]=v}}if(0===A)break}for(l=0;l<u;l++){for(f=0,B=0;f<a;f++)S=t[l*e+f],B+=S*S;U[l]=Math.sqrt(B)}for(l=0;l<u-1;l++){for(d=l,f=l+1;f<u;f++)U[d]<U[f]&&(d=f);if(l!==d&&(i(U,l,d,B),r)){for(f=0;f<a;f++)i(t,l*e+f,d*e+f,S);for(f=0;f<u;f++)i(r,l*o+f,d*o+f,S)}}for(l=0;l<u;l++)n[l]=U[l];if(r)for(l=0;l<c;l++){for(B=l<u?U[l]:0;B<=1e-37;){for(T=1/a,f=0;f<a;f++)E=214013*E+2531011,k=256&E>>16?T:-T,t[l*e+f]=k;for(m=0;m<2;m++)for(d=0;d<l;d++){for(B=0,f=0;f<a;f++)B+=t[l*e+f]*t[d*e+f];for(R=0,f=0;f<a;f++)S=t[l*e+f]-B*t[d*e+f],t[l*e+f]=S,R+=Math.abs(S);for(R=R?1/R:0,f=0;f<a;f++)t[l*e+f]*=R}for(B=0,f=0;f<a;f++)S=t[l*e+f],B+=S*S;B=Math.sqrt(B)}for(C=1/B,f=0;f<a;f++)t[l*e+f]*=C}}(m.data,d,h.data,p.data,f,d,f,d),e){for(u=0;u<f;u++)e.data[u]=h.data[u];for(;u<l;u++)e.data[u]=0}0===a?(n&&r.u.transpose(n,m),o&&r.u.transpose(o,p)):(n&&r.u.transpose(n,p),o&&r.u.transpose(o,m))}var u,c=n(2007),l=n(35695);!function(t){function e(t){if(3===t.length)return c.n.create(o.e.fromArray((0,o.e)(),t,0),o.e.create(1,0,0),o.e.create(0,1,0),o.e.create(0,0,1));const e=r.u.fromArray(t,3,t.length/3),n=e.rows,i=n/3,s=r.u.create(3,3),u=r.u.create(1,3),l=r.u.create(3,3),d=r.u.create(3,3),f=r.u.meanRows(e),m=r.u.subRows(r.u.clone(e),f),h=r.u.transpose(r.u.create(n,3),m);r.u.multiplyABt(s,h,h),a(s,u,l,d);const p=o.e.create(f[0],f[1],f[2]),g=o.e.create(l.data[0],l.data[3],l.data[6]),y=o.e.create(l.data[1],l.data[4],l.data[7]),_=o.e.create(l.data[2],l.data[5],l.data[8]);return o.e.scale(g,g,Math.sqrt(u.data[0]/i)),o.e.scale(y,y,Math.sqrt(u.data[1]/i)),o.e.scale(_,_,Math.sqrt(u.data[2]/i)),c.n.create(p,g,y,_)}function n(t){const e=c.n.clone(t);return o.e.magnitude(e.dirC)<l.p&&o.e.cross(e.dirC,e.dirA,e.dirB),c.n.normalize(e,e)}t.ofPositions=function(t){const n=e(t);return{momentsAxes:n,boxAxes:s(t,n)}},t.calculateMomentsAxes=e,t.calculateNormalizedAxes=n;const i=(0,o.e)();function s(t,e){if(3===t.length)return c.n.clone(e);let r=-1/0,s=-1/0,a=-1/0,u=-1/0,l=-1/0,d=-1/0;const f=(0,o.e)(),m=(0,o.e)(),h=e.origin,p=n(e);for(let n=0,i=t.length;n<i;n+=3){o.e.projectPointOnVector(f,o.e.fromArray(f,t,n),p.dirA,h);const e=o.e.dot(p.dirA,o.e.normalize(m,o.e.sub(m,f,h))),i=o.e.distance(f,h);e>0?i>r&&(r=i):i>s&&(s=i),o.e.projectPointOnVector(f,o.e.fromArray(f,t,n),p.dirB,h);const c=o.e.dot(p.dirB,o.e.normalize(m,o.e.sub(m,f,h))),g=o.e.distance(f,h);c>0?g>a&&(a=g):g>u&&(u=g),o.e.projectPointOnVector(f,o.e.fromArray(f,t,n),p.dirC,h);const y=o.e.dot(p.dirC,o.e.normalize(m,o.e.sub(m,f,h))),_=o.e.distance(f,h);y>0?_>l&&(l=_):_>d&&(d=_)}const g=o.e.setMagnitude((0,o.e)(),p.dirA,(r+s)/2),y=o.e.setMagnitude((0,o.e)(),p.dirB,(a+u)/2),_=o.e.setMagnitude((0,o.e)(),p.dirC,(l+d)/2),A=o.e.isFinite(g),b=o.e.isFinite(y),C=o.e.isFinite(_),S=(0,o.e)(),x=function(t,e,n){o.e.copy(i,h),A&&o.e.scaleAndAdd(i,i,p.dirA,t),b&&o.e.scaleAndAdd(i,i,p.dirB,e),C&&o.e.scaleAndAdd(i,i,p.dirC,n),o.e.add(S,S,i)};return x(r,a,l),x(r,a,-d),x(r,-u,-d),x(r,-u,l),x(-s,-u,-d),x(-s,-u,l),x(-s,a,l),x(-s,a,-d),o.e.scale(S,S,1/8),c.n.create(S,g,y,_)}t.calculateBoxAxes=s}(u||(u={}))},75849:function(t,e,n){n.d(e,{H:function(){return s},N7:function(){return c},TY:function(){return u},fC:function(){return r},k4:function(){return l},pu:function(){return i},r6:function(){return a}});const r=Math.PI/2,o=Math.PI/180;function i(t){return t*o}function s(t){return t/o}function a(t){return 0!==t&&!(t&t-1)}function u(...t){let e=0,n=0;for(let r=0,o=t.length;r<o;++r){const o=t[r],i=Math.abs(o);i>n&&(e=o,n=i)}return e}function c(t,e){return t*e}function l(t){let e=0,n=0,r=0,o=-1;const i=2*t+1,s=i/2,a=[];for(let u=Math.pow(i,2);u>0;--u){if(-s<e&&e<=s&&-s<n&&n<=s&&a.push([e,n]),e===n||e<0&&e===-n||e>0&&e===1-n){const t=r;r=-o,o=t}e+=r,n+=o}return a}},77427:function(t,e,n){n.d(e,{W:function(){return o},x:function(){return r}});const r="0.3.0";var o;!function(t){let e,n;!function(t){t[t.Int8=1]="Int8",t[t.Int16=2]="Int16",t[t.Int32=3]="Int32",t[t.Uint8=4]="Uint8",t[t.Uint16=5]="Uint16",t[t.Uint32=6]="Uint32"}(e=t.IntDataType||(t.IntDataType={})),function(t){t[t.Float32=32]="Float32",t[t.Float64=33]="Float64"}(n=t.FloatDataType||(t.FloatDataType={})),t.getDataType=function(e){let n;return n=e instanceof Int8Array?t.IntDataType.Int8:e instanceof Int16Array?t.IntDataType.Int16:e instanceof Int32Array?t.IntDataType.Int32:e instanceof Uint8Array?t.IntDataType.Uint8:e instanceof Uint16Array?t.IntDataType.Uint16:e instanceof Uint32Array?t.IntDataType.Uint32:e instanceof Float32Array?t.FloatDataType.Float32:e instanceof Float64Array?t.FloatDataType.Float64:t.IntDataType.Int32,n},t.isSignedIntegerDataType=function(t){if(t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array)return!0;for(let e=0,n=t.length;e<n;e++)if(e<0)return!1;return!0}}(o||(o={}))},77866:function(t,e,n){n.d(e,{Z:function(){return i}});var r=n(54135),o=n(38530);class i{getConnectedUnits(t){return this.map.has(t)?this.map.get(t):s}getEdgeIndex(t,e,n,r){const o=this.edgeKeyIndex.get(i.getEdgeUnitKey(e,r));if(void 0===o)return-1;const s=o.get(i.getEdgeIndexKey(t,n));return void 0!==s?s:-1}hasEdge(t,e,n,r){return-1!==this.getEdgeIndex(t,e,n,r)}getEdge(t,e,n,r){const o=this.getEdgeIndex(t,e,n,r);return-1!==o?this.edges[o]:void 0}getEdgeIndices(t,e){return this.vertexKeyIndex.get(i.getVertexKey(t,e))||[]}constructor(t){this.map=t;let e=0;const n=[],r=new Map,o=new Map;this.map.forEach(t=>{t.forEach(t=>{e+=t.edgeCount,t.connectedIndices.forEach(e=>{t.getEdges(e).forEach(s=>{const{unitA:a,unitB:u}=t,c=i.getEdgeIndexKey(a,u),l=i.getEdgeIndexKey(e,s.indexB),d=r.get(c);void 0===d?r.set(c,new Map([[l,n.length]])):d.set(l,n.length);const f=i.getVertexKey(e,a),m=o.get(f);void 0===m?o.set(f,[n.length]):m.push(n.length),n.push({...s,indexA:e,unitA:a,unitB:u})})})})}),this.edgeCount=e,this.edges=n,this.edgeKeyIndex=r,this.vertexKeyIndex=o}}!function(t){class e{hasEdges(t){return this.edgeMap.has(t)}getEdges(t){return this.edgeMap.has(t)?this.edgeMap.get(t):s}get areUnitsOrdered(){return this.unitA<this.unitB}constructor(t,e,n,r,o){this.unitA=t,this.unitB=e,this.edgeCount=n,this.connectedIndices=r,this.edgeMap=o}}function n(t,e,n){t.has(e)?t.get(e).push(n):t.set(e,[n])}t.UnitPairEdges=e,t.getEdgeUnitKey=function(t,e){return(0,o.m1)(t,e)},t.getEdgeIndexKey=function(t,e){return(0,o.m1)(t,e)},t.getVertexKey=function(t,e){return(0,o.m1)(t,e)};t.Builder=class{constructor(){this.map=new Map}startUnitPair(t,e){this.uA=t,this.uB=e,this.mapAB=new Map,this.mapBA=new Map,this.linkedA=r.th.create(),this.linkedB=r.th.create(),this.linkCount=0}finishUnitPair(){0!==this.linkCount&&(n(this.map,this.uA,new e(this.uA,this.uB,this.linkCount,this.linkedA.array,this.mapAB)),n(this.map,this.uB,new e(this.uB,this.uA,this.linkCount,this.linkedB.array,this.mapBA)))}add(t,e,o){n(this.mapAB,t,{indexB:e,props:o}),n(this.mapBA,e,{indexB:t,props:o}),r.th.add(this.linkedA,t,t),r.th.add(this.linkedB,e,e),this.linkCount+=1}getMap(){return this.map}}}(i||(i={}));const s=[]},77936:function(t,e,n){n.d(e,{gn:function(){return a.gn},oE:function(){return o.o},iZ:function(){return r.i},ZP:function(){return u.Z},us:function(){return s.u},Nf:function(){return i.N},X$:function(){return c.X}});var r=n(21547),o=n(31960),i=n(69926),s=n(19600),a=n(9239),u=n(64059),c=n(93818),l=n(62769),d=n(26511);n(61217),l.c.Field,l.c.Encodings;n(65533);var f=n(27125);n(93739),l.c.Field;n(24303);var m=n(54135),h=n(38530);n(63590);function p(t,e){if(d.K4.is(t.sourceData))return t.sourceData.data.db[e]}function g(t){if(0===t.length)return[];if(1===t.length)return t[0].entityIndices;const e=m.th.create();for(const n of t)for(const t of n.entityIndices)m.th.add(e,t,t);return(0,h.eh)(e.array),e.array}l.c.Category;var y=l.c.Category;_("struct_asym"),_("entity_poly"),_("entity_poly_seq");function _(t){return{name:t,instance({structures:e,cache:n}){return function(t,e,n){const r=p(t[0].model,e);if(!r)return y.Empty;const{entity_id:o}=r,i=n.uniqueEntityIds||(n.uniqueEntityIds=function(t){if(0===t.length)return new Set;const e=t[0].model.entities.data.id;return new Set(g(t).map(t=>e.value(t)))}(t)),s=f.VP.indicesOf(o,t=>i.has(t));return y.ofTable(r,s)}(e,t,n)}}}var A;n(59859),n(1071),n(49e3),l.c.Category;!function(t){t.create=function(t){const e=Array.isArray(t)?t:[t];return{structures:e,firstModel:e[0].model,cache:Object.create(null)}}}(A||(A={}));var b;!function(t){t.AtomSitePositionsFieldNames=new Set(["id","Cartn_x","Cartn_y","Cartn_z"])}(b||(b={}))},78012:function(t,e,n){n.d(e,{a:function(){return r}});var r,o=n(73868);!function(t){function e(t,e,n){return{kind:"element-location",structure:t,unit:e,element:n||0}}t.create=e,t.clone=function(t){return e(t.structure,t.unit,t.element)},t.set=function(t,e,n,r){return e&&(t.structure=e),n&&(t.unit=n),void 0!==r&&(t.element=r),t},t.copy=function(t,e){return t.unit=e.unit,t.element=e.element,t},t.is=function(t){return!!t&&"element-location"===t.kind},t.areEqual=function(t,e){return t.unit===e.unit&&t.element===e.element};const n=(0,o.eB)(),r=(0,o.eB)();t.distance=function(t,e){return t.unit.conformation.position(t.element,n),e.unit.conformation.position(e.element,r),o.eB.distance(n,r)},t.position=function(t,e){return e.unit.conformation.position(e.element,t)},t.residueIndex=function(t){return t.unit.model.atomicHierarchy.residueAtomSegments.index[t.element]},t.chainIndex=function(t){return t.unit.model.atomicHierarchy.chainAtomSegments.index[t.element]}}(r||(r={}))},78605:function(t,e,n){n.d(e,{k:function(){return c}});var r=n(22753),o=n(98537),i=n(35695),s=n(99487),a=n(95156),u=n(41430);function c(){return c.zero()}!function(t){function e(){const t=[.1,0,0,0];return t[0]=0,t}function n(){const t=e();return t[3]=1,t}function c(t,e,r,o){const i=n();return i[0]=t,i[1]=e,i[2]=r,i[3]=o,i}function l(t,e,n){n*=.5;const r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function d(t,e,n,r){const o=e[0],i=e[1],s=e[2],a=e[3];let u,c,l,d,f,m=n[0],h=n[1],p=n[2],g=n[3];return c=o*m+i*h+s*p+a*g,c<0&&(c=-c,m=-m,h=-h,p=-p,g=-g),1-c>1e-6?(u=Math.acos(c),l=Math.sin(u),d=Math.sin((1-r)*u)/l,f=Math.sin(r*u)/l):(d=1-r,f=r),t[0]=d*o+f*m,t[1]=d*i+f*h,t[2]=d*s+f*p,t[3]=d*a+f*g,t}function f(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function m(t,e){const n=e[0]+e[4]+e[8];let r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{let n=0;e[4]>e[0]&&(n=1),e[8]>e[3*n+n]&&(n=2);const o=(n+1)%3,i=(n+2)%3;r=Math.sqrt(e[3*n+n]-e[3*o+o]-e[3*i+i]+1),t[n]=.5*r,r=.5/r,t[3]=(e[3*o+i]-e[3*i+o])*r,t[o]=(e[3*o+n]+e[3*n+o])*r,t[i]=(e[3*i+n]+e[3*n+i])*r}return t}t.zero=e,t.identity=n,t.setIdentity=function(t){t[0]=0,t[1]=0,t[2]=0,t[3]=1},t.hasNaN=function(t){return Number.isNaN(t[0])||Number.isNaN(t[1])||Number.isNaN(t[2])||Number.isNaN(t[3])},t.create=c,t.setAxisAngle=l,t.getAxisAngle=function(t,e){const n=2*Math.acos(e[3]),r=Math.sin(n/2);return 0!==r?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n},t.multiply=function(t,e,n){const r=e[0],o=e[1],i=e[2],s=e[3],a=n[0],u=n[1],c=n[2],l=n[3];return t[0]=r*l+s*a+o*c-i*u,t[1]=o*l+s*u+i*a-r*c,t[2]=i*l+s*c+r*u-o*a,t[3]=s*l-r*a-o*u-i*c,t},t.rotateX=function(t,e,n){n*=.5;const r=e[0],o=e[1],i=e[2],s=e[3],a=Math.sin(n),u=Math.cos(n);return t[0]=r*u+s*a,t[1]=o*u+i*a,t[2]=i*u-o*a,t[3]=s*u-r*a,t},t.rotateY=function(t,e,n){n*=.5;const r=e[0],o=e[1],i=e[2],s=e[3],a=Math.sin(n),u=Math.cos(n);return t[0]=r*u-i*a,t[1]=o*u+s*a,t[2]=i*u+r*a,t[3]=s*u-o*a,t},t.rotateZ=function(t,e,n){n*=.5;const r=e[0],o=e[1],i=e[2],s=e[3],a=Math.sin(n),u=Math.cos(n);return t[0]=r*u+o*a,t[1]=o*u-r*a,t[2]=i*u+s*a,t[3]=s*u-i*a,t},t.calculateW=function(t,e){const n=e[0],r=e[1],o=e[2];return t[0]=n,t[1]=r,t[2]=o,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-o*o)),t},t.slerp=d,t.invert=function(t,e){const n=e[0],r=e[1],o=e[2],i=e[3],s=n*n+r*r+o*o+i*i,a=s?1/s:0;return t[0]=-n*a,t[1]=-r*a,t[2]=-o*a,t[3]=i*a,t},t.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},t.dot=f,t.fromMat3=m;const h=[0,0,0,0,0,0,0,0,0,0,0,0];function p(t,e){return r.U.fromMat4(h,e),m(t,h)}t.fromMat4=p,t.fromEuler=function(t,e,n){const[r,o,i]=e,a=Math.cos(r/2),u=Math.cos(o/2),c=Math.cos(i/2),l=Math.sin(r/2),d=Math.sin(o/2),f=Math.sin(i/2);switch(n){case"XYZ":t[0]=l*u*c+a*d*f,t[1]=a*d*c-l*u*f,t[2]=a*u*f+l*d*c,t[3]=a*u*c-l*d*f;break;case"YXZ":t[0]=l*u*c+a*d*f,t[1]=a*d*c-l*u*f,t[2]=a*u*f-l*d*c,t[3]=a*u*c+l*d*f;break;case"ZXY":t[0]=l*u*c-a*d*f,t[1]=a*d*c+l*u*f,t[2]=a*u*f+l*d*c,t[3]=a*u*c-l*d*f;break;case"ZYX":t[0]=l*u*c-a*d*f,t[1]=a*d*c+l*u*f,t[2]=a*u*f-l*d*c,t[3]=a*u*c+l*d*f;break;case"YZX":t[0]=l*u*c+a*d*f,t[1]=a*d*c+l*u*f,t[2]=a*u*f-l*d*c,t[3]=a*u*c-l*d*f;break;case"XZY":t[0]=l*u*c-a*d*f,t[1]=a*d*c-l*u*f,t[2]=a*u*f+l*d*c,t[3]=a*u*c+l*d*f;break;default:(0,s.dr)(n)}return t};const g=[0,0,0];t.fromUnitVec3=function(t,e,n){let r=o.e.dot(e,n)+1;return r<i.p?(r=0,Math.abs(e[0])>Math.abs(e[2])?o.e.set(g,-e[1],e[0],0):o.e.set(g,0,-e[2],e[1])):o.e.cross(g,e,n),t[0]=g[0],t[1]=g[1],t[2]=g[2],t[3]=r,_(t,t),t};const y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];function _(t,e){const n=e[0],r=e[1],o=e[2],i=e[3];let s=n*n+r*r+o*o+i*i;return s>0&&(s=1/Math.sqrt(s),t[0]=n*s,t[1]=r*s,t[2]=o*s,t[3]=i*s),t}t.fromBasis=function(t,e,n,r){return a.$.fromBasis(y,e,n,r),p(t,y)},t.clone=function(t){const n=e();return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n},t.fromObj=function(t){return c(t.x,t.y,t.z,t.w)},t.toObj=function(t){return{x:t[0],y:t[1],z:t[2],w:t[3]}},t.toArray=function(t,e,n){return e[n+0]=t[0],e[n+1]=t[1],e[n+2]=t[2],e[n+3]=t[3],e},t.fromArray=function(t,e,n){return t[0]=e[n+0],t[1]=e[n+1],t[2]=e[n+2],t[3]=e[n+3],t},t.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},t.set=function(t,e,n,r,o){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t},t.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},t.equals=function(t,e){const n=t[0],r=t[1],o=t[2],s=t[3],a=e[0],u=e[1],c=e[2],l=e[3];return Math.abs(n-a)<=i.p*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-u)<=i.p*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(o-c)<=i.p*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(s-l)<=i.p*Math.max(1,Math.abs(s),Math.abs(l))},t.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},t.magnitude=function(t){const e=t[0],n=t[1],r=t[2],o=t[3];return Math.sqrt(e*e+n*n+r*r+o*o)},t.squaredMagnitude=function(t){const e=t[0],n=t[1],r=t[2],o=t[3];return e*e+n*n+r*r+o*o},t.angle=function(t,e){return 2*Math.acos(Math.abs((0,u.qE)(f(t,e),-1,1)))},t.normalize=_;const A=[0,0,0],b=[1,0,0],C=[0,1,0];t.rotationTo=function(t,e,n){const r=o.e.dot(e,n);return r<-.999999?(o.e.cross(A,b,e),o.e.magnitude(A)<1e-6&&o.e.cross(A,C,e),o.e.normalize(A,A),l(t,A,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(o.e.cross(A,e,n),t[0]=A[0],t[1]=A[1],t[2]=A[2],t[3]=1+r,_(t,t))};const S=e(),x=e();t.sqlerp=function(t,e,n,r,o,i){return d(S,e,o,i),d(x,n,r,i),d(t,S,x,2*i*(1-i)),t};const v=[0,0,0,0,0,0,0,0,0];t.setAxes=function(t,e,n,r){return v[0]=n[0],v[3]=n[1],v[6]=n[2],v[1]=r[0],v[4]=r[1],v[7]=r[2],v[2]=-e[0],v[5]=-e[1],v[8]=-e[2],_(t,m(t,v))},t.toString=function(t,e){return`[${t[0].toPrecision(e)} ${t[1].toPrecision(e)} ${t[2].toPrecision(e)}  ${t[3].toPrecision(e)}]`},t.Identity=n()}(c||(c={}))},78739:function(t,e,n){n.d(e,{Q1:function(){return r.Q1},_j:function(){return r._j},wC:function(){return o.w}});var r=n(98391),o=n(25261)},78850:function(t,e,n){n.d(e,{GW:function(){return f},Hh:function(){return o},Kq:function(){return m},LX:function(){return d},Mk:function(){return l},Nt:function(){return h},ZH:function(){return a},r4:function(){return s}});function r(t,e=" "){return t.replace(/([a-z\xE0-\xFF])([A-Z\xC0\xDF])/g,`$1${e}$2`)}function o(t){return a(r(t))}const i=t=>t.toUpperCase();function s(t){return t?"string"==typeof t?t.toUpperCase():`${t}`.toUpperCase():""}function a(t){return t.toLowerCase().replace(/^\w|\s\w/g,i)}function u(t){return t.replace(/_/g," ")}function c(t){return t.replace(/-/g," ")}function l(t){return a(r(u(c(t))))}function d(t,e,n,r){const o=r.length;if(o>n-e)return!1;for(let i=0;i<o;i++)if(t.charCodeAt(e+i)!==r.charCodeAt(i))return!1;return!0}function f(t,e){const n=Object.keys(e),r=Object.values(e);return new Function(...n,`return \`${t}\`;`)(...r)}function m(t){return t.replace(/<\/?[^>]+>/g,"")}function h(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}},80881:function(t,e,n){n.d(e,{Y:function(){return r}});var r,o=n(59530),i=n(92510),s=n(84729);!function(t){class e{run(t,e=250){return t?(0,o.hM)(this,t,e):this.f(i.f)}runAsChild(t,e){return t.isSynchronous?this.f(i.f):(0,o.Vs)(t,this,e)}runInContext(t){return t.isSynchronous?this.f(i.f):(0,o.yR)(t,this)}constructor(t,e,n){this.name=t,this.f=e,this.onAbort=n,this.id=a()}}function n(t){const e=t;return!!t&&"number"==typeof e.id&&"string"==typeof e.name&&!!e.run}function r(t,n,r){return new e(t,n,r)}t.is=n,t.isAbort=function(t){return!!t&&!!t.isAborted},t.Aborted=function(t){return{isAborted:!0,reason:t,toString(){return"Aborted"+(t?": "+t:"")}}},t.create=r,t.constant=function(t,e){return r(t,async t=>e)},t.empty=function(){return r("",async t=>{})},t.fail=function(t,e){return r(t,async t=>{throw new Error(e)})},t.resolveInContext=function(t,e){return n(t)?e?t.runInContext(e):t.run():t};const a=(0,s.q)(0,1073741823)}(r||(r={}))},82346:function(t,e,n){n.d(e,{HR:function(){return o},br:function(){return s},ec:function(){return i}});var r=n(62683);function o(t,e,n){return(0,r.EX)("",t,e,n)}function i(t){u("","",t)}function s(t){const e=[];return c(t,e),e}function a(t){const e=/([a-z])([A-Z])([a-z]|$)/g;return t.replace(e,(t,e,n,r)=>`${e}-${n.toLocaleLowerCase()}${r}`).replace(e,(t,e,n,r)=>`${e}-${n.toLocaleLowerCase()}${r}`)}function u(t,e,n){if((0,r.Bm)(n))return n.info.namespace=t,n.info.name=n.info.name||a(e),void(n.id=`${n.info.namespace}.${n.info.name}`);const o=`${n["@namespace"]||a(e)}`,i=t?`${t}.${o}`:o;for(const s of Object.keys(n))("object"==typeof n[s]||(0,r.Bm)(n[s]))&&u(i,s,n[s])}function c(t,e){if((0,r.Bm)(t))e.push(t);else for(const n of Object.keys(t))("object"==typeof t[n]||(0,r.Bm)(t[n]))&&c(t[n],e)}},83448:function(t,e,n){n.d(e,{_:function(){return u}});var r=n(784),o=n(62769),i=n(58392),s=n(26511);const a={U:r.r.atom_site_anisotrop.U,U_esd:r.r.atom_site_anisotrop.U_esd};var u;!function(t){t.Schema=a,t.Descriptor={name:"atom_site_anisotrop",cifExport:{prefix:"",categories:[{name:"atom_site_anisotrop",instance(e){return t.Provider.get(e.firstModel)&&s.K4.is(e.firstModel.sourceData)?o.c.Category.ofTable(e.firstModel.sourceData.data.db.atom_site_anisotrop):o.c.Category.Empty}}]}},t.Provider=i.q.create(t.Descriptor),t.getElementToAnsiotrop=function(t,e){const n=new Int32Array(t.rowCount);n.fill(-1);for(let o=0,i=t.rowCount;o<i;o++)n[t.value(o)]=o;const r=new Int32Array(t.rowCount);r.fill(-1);for(let o=0,i=e.rowCount;o<i;++o){const t=n[e.value(o)];-1!==t&&(r[t]=o)}return r},t.getElementToAnsiotropFromLabel=function(t,e){const n={};for(let o=0,i=t.rowCount;o<i;o++)n[t.value(o)]=o;const r=new Int32Array(t.rowCount);r.fill(-1);for(let o=0,i=e.rowCount;o<i;++o){const t=n[e.value(o)];void 0!==t&&(r[t]=o)}return r}}(u||(u={}))},83771:function(t,e,n){n.d(e,{K:function(){return r},e:function(){return o}});const r="undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node,o=function(){if("undefined"==typeof File||r){class t{arrayBuffer(){return this.blob.arrayBuffer()}slice(t,e,n){return this.blob.slice(t,e,n)}stream(){return this.blob.stream()}text(){return this.blob.text()}bytes(){return this.blob.bytes()}constructor(t,e,n){var r;this.blob=new Blob(t,n),this.size=this.blob.size,this.type=this.blob.type,this.name=e,this.lastModified=null!==(r=null==n?void 0:n.lastModified)&&void 0!==r?r:0,this.webkitRelativePath=""}}return t}return File}()},84729:function(t,e,n){function r(t=0,e=Number.MAX_SAFE_INTEGER){let n=t;return()=>{const t=n;return n=(n+1)%e,t}}n.d(e,{q:function(){return r}})},84796:function(t,e,n){n.d(e,{e:function(){return a},z:function(){return u}});var r=n(784),o=n(27125);r.r.atom_site.label_comp_id,r.r.atom_site.label_seq_id,r.r.atom_site.pdbx_PDB_ins_code,r.r.atom_site.label_asym_id,r.r.atom_site.label_entity_id,r.r.atom_site.auth_atom_id,r.r.atom_site.auth_seq_id,r.r.atom_site.auth_asym_id,r.r.chem_comp_bond,o.VP.Schema.Str();const i={...r.r.chem_comp,type:o.VP.Schema.Aliased(o.VP.Schema.str)};var s=n(72080);const a={entry:r.r.entry,struct:r.r.struct,struct_asym:r.r.struct_asym,ihm_model_list:r.r.ihm_model_list,ihm_model_group:r.r.ihm_model_group,ihm_model_group_link:r.r.ihm_model_group_link,entity:r.r.entity,entity_poly:r.r.entity_poly,entity_poly_seq:r.r.entity_poly_seq,pdbx_entity_branch:r.r.pdbx_entity_branch,chem_comp:i,pdbx_chem_comp_identifier:r.r.pdbx_chem_comp_identifier,atom_site:r.r.atom_site,ihm_sphere_obj_site:r.r.ihm_sphere_obj_site,ihm_gaussian_obj_site:r.r.ihm_gaussian_obj_site,pdbx_unobs_or_zero_occ_residues:r.r.pdbx_unobs_or_zero_occ_residues,pdbx_molecule:r.r.pdbx_molecule};function u(t,e=!1){const n=Object.create(null);for(const r of Object.keys(a))n[r]=r in t?t[r]:o.XI.ofUndefinedColumns(a[r],0);return e&&(n.atom_site=(0,s.W)(n.atom_site)),n}},86143:function(t,e,n){n.d(e,{H:function(){return o},t:function(){return r}});const r=function(){if("undefined"!=typeof window&&window.performance){const t=window.performance;return()=>t.now()}return"undefined"!=typeof process&&"undefined"!==process.hrtime&&"function"==typeof process.hrtime?()=>{const t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:Date.now?()=>Date.now():()=>+new Date}();function o(t,e=!0){if(isNaN(t))return"n/a";const n=Math.floor(t/36e5),r=Math.floor(t/6e4%60),o=Math.floor(t/1e3%60);let i=Math.floor(t%1e3).toString();for(;i.length<3;)i="0"+i;for(;!e&&i.length>1&&"0"===i[i.length-1];)i=i.substr(0,i.length-1);return n>0?`${n}h${r}m${o}.${i}s`:r>0?`${r}m${o}.${i}s`:o>0?`${o}.${i}s`:`${t.toFixed(0)}ms`}},86242:function(t,e,n){n.d(e,{VH:function(){return l},rj:function(){return o},ss:function(){return u},uu:function(){return c}});var r=n(94830);function o(t,e,n){for(let r=0,o=n.length;r<o;r++){const o=n.charCodeAt(r);if(o<128)t[e++]=o>>>0&127;else if(o<2048)t[e++]=o>>>6&31|192,t[e++]=o>>>0&63|128;else if(o<65536)t[e++]=o>>>12&15|224,t[e++]=o>>>6&63|128,t[e++]=o>>>0&63|128;else{if(!(o<1114112))throw new Error("bad codepoint "+o);t[e++]=o>>>18&7|240,t[e++]=o>>>12&63|128,t[e++]=o>>>6&63|128,t[e++]=o>>>0&63|128}}}const i=function(){const t=[];for(let e=0;e<1024;e++)t[e]=String.fromCharCode(e);return t}();function s(t){throw new Error(t)}const a="undefined"!=typeof TextDecoder?new TextDecoder:void 0;function u(t,e=0,n=t.length){if(a){const r=e||n!==t.length?t.subarray(e,e+n):t;return a.decode(r)}return function(t,e,n){const r=i;let o,a=0;const u=[];for(let i=e,c=e+n;i<c;i++){const e=t[i];128&e?192==(224&e)?u[a++]=r[(15&e)<<6|63&t[++i]]:224==(240&e)?u[a++]=String.fromCharCode((15&e)<<12|(63&t[++i])<<6|63&t[++i]):240==(248&e)?u[a++]=String.fromCharCode((7&e)<<18|(63&t[++i])<<12|(63&t[++i])<<6|63&t[++i]):s("Invalid byte "+e.toString(16)):u[a++]=r[e],512===a&&(o=o||[],o[o.length]=u.join(""),a=0)}return o?(a>0&&(o[o.length]=u.slice(0,a).join("")),o.join("")):u.slice(0,a).join("")}(t,e,n)}function c(t,e=0,n=t.length){if(n<=r.Mx)return u(t,e,n);const o=r.Sn.fromUtf8Data(t,e,e+n);return o.length<=r.Mx?o.toString():o}function l(t){let e=0;for(let n=0,r=t.length;n<r;n++){const r=t.charCodeAt(n);r<128?e+=1:r<2048?e+=2:r<65536?e+=3:r<1114112?e+=4:s("bad codepoint "+r)}return e}},87504:function(t,e,n){n.d(e,{X:function(){return G}});var r=n(38530),o=n(90790);const i=[];function s(t){return[t]}function a(t){return t}function u(t){return(0,r.eh)(t),t}function c(t,e){if(e<t)return[];const n=new Int32Array(e-t+1);for(let r=t;r<=e;r++)n[r-t]=r;return n}function l(t){return t&&(Array.isArray(t)||!!t.buffer)}function d(t){return t[t.length-1]-t[0]+1===t.length}function f(t){return t[0]}function m(t){return t[t.length-1]+1}function h(t){return t[0]}function p(t){return t[t.length-1]}function g(t){return t.length}function y(t){const e=t.length;return e?e>2?(0,r.hX)(e,t[0],t[e-1],t[e>>1]):(0,r.CP)(e,t[0],t[e-1]):0}function _(t){const e=t.length;return e>5?`[${t[0]}, ${t[1]}, ..., ${t[e-1]}], length ${e}`:`[${t.join(", ")}]`}function A(t,e){const n=t.length;return 0===n?-1:t[0]<=e&&e<=t[n-1]?w(t,e,0,n):-1}function b(t,e,n){return C(t,e,o.I.start(n),o.I.end(n))}function C(t,e,n,r){return 0===t.length||r<=n?-1:t[n]<=e&&e<=t[r-1]?w(t,e,n,r):-1}function S(t,e){return A(t,e)>=0}function x(t,e){if(t===e)return!0;let n=t.length;if(n!==e.length||t[0]!==e[0]||t[n-1]!==e[n-1])return!1;if(d(t))return!0;n--;for(let r=1;r<n;r++)if(t[r]!==e[r])return!1;return!0}function v(t,e){return P(t,e,0,t.length)}function B(t,e,n){return P(t,e,o.I.start(n),o.I.end(n))}function I(t,e,n){return o.I.ofBounds(v(t,e),v(t,n+1))}function w(t,e,n,r){let o=n,i=r-1;for(;o<=i;){if(o+11>i){for(let n=o;n<=i;n++)if(e===t[n])return n;return-1}const n=o+i>>1,r=t[n];if(e<r)i=n-1;else{if(!(e>r))return n;o=n+1}}return-1}function P(t,e,n,r){if(n===r)return n;if(t[n]>=e)return n;if(t[r-1]<e)return r;let o=n,i=r;for(;i-o>4;){const n=o+i>>1;t[n]>=e?i=n:o=n+1}for(let s=o;s<i;s++)if(t[s]>=e)return s;return i}function D(t,e){if(t===e)return!0;let{startI:n,startJ:r,endI:o,endJ:i}=F(t,e);for(;n<o&&r<i;){const o=t[n],i=e[r];if(o<i)n++;else{if(!(o>i))return!0;r++}}return!1}function M(t,e){if(t===e)return!0;const n=e.length;let{startI:r,startJ:o,endI:i,endJ:s}=F(t,e);if(s-o<n||i-r<n)return!1;let a=0;for(;r<i&&o<s;){const n=t[r],i=e[o];n<i?r++:n>i?o++:(r++,o++,a++)}return a===n}function N(t,e){if(t===e)return t;const n=t.length,r=e.length;if(0===n)return e;if(0===r)return t;if(t[0]>e[0])return N(e,t);const{startI:o,startJ:i,endI:s,endJ:a}=F(t,e),u=k(t,e,o,i,s,a);if(u===n&&u===r||u===r)return t;if(u===n)return e;const c=new Int32Array(n+r-u);let l=0,d=0,f=0;for(l=0;l<o;l++)c[f++]=t[l];for(;d<a&&t[o]>e[d];)c[f++]=e[d++];for(;l<s&&d<a;){const n=t[l],r=e[d];n<r?(c[f++]=n,l++):n>r?(c[f++]=r,d++):(c[f++]=n,l++,d++)}for(;l<s;l++)c[f++]=t[l];for(;d<a;d++)c[f++]=e[d];for(;l<n;l++)c[f++]=t[l];for(;d<r;d++)c[f++]=e[d];return c}function E(t,e){if(t===e)return g(t);const{startI:n,startJ:r,endI:o,endJ:i}=F(t,e);return k(t,e,n,r,o,i)}function k(t,e,n,r,o,i){let s=n,a=r,u=0;for(;s<o&&a<i;){const n=t[s],r=e[a];n<r?s++:n>r?a++:(s++,a++,u++)}return u}function T(t,e){if(t===e)return t;const{startI:n,startJ:r,endI:o,endJ:s}=F(t,e),a=k(t,e,n,r,o,s),u=t.length,c=e.length;if(!a)return i;if(a===u&&a===c||a===c)return e;if(a===u)return t;const l=new Int32Array(a);let d=0,f=n,m=r;for(;f<o&&m<s;){const n=t[f],r=e[m];n<r?f++:(n>r||(l[d++]=n,f++),m++)}return l}function R(t,e){if(t===e)return i;const n=t.length,{startI:r,startJ:o,endI:s,endJ:a}=F(t,e);let u=r,c=o,l=0;for(;u<s&&c<a;){const n=t[u],r=e[c];n<r?u++:n>r?c++:(u++,c++,l++)}if(!l)return t;if(l>=n)return i;const d=new Int32Array(n-l);let f=0;for(let i=0;i<r;i++)d[f++]=t[i];for(u=r,c=o;u<s&&c<a;){const n=t[u],r=e[c];n<r?(d[f++]=n,u++):(n>r||u++,c++)}for(;u<n;u++)d[f++]=t[u];return d}function U(t){if(t.length<2)return t;let e=1;for(let o=0,i=t.length-1;o<i;o++)t[o]!==t[o+1]&&e++;if(e===t.length)return t;const n=new Int32Array(e);let r=0;for(let o=0,i=t.length-1;o<i;o++)t[o]!==t[o+1]&&(n[r++]=t[o]);return n[r]=t[t.length-1],n}function H(t,e){if(x(t,e))return(0,r.vc)(0,t.length-1);const{startI:n,startJ:o,endI:s,endJ:a}=F(t,e);let u=n,c=o,l=0;for(;u<s&&c<a;){const n=t[u],r=e[c];n<r?u++:n>r?c++:(u++,c++,l++)}const d=t.length;if(!l)return i;if(l===d)return(0,r.vc)(0,t.length-1);const f=new Int32Array(l);let m=0;for(u=n,c=o;u<s&&c<a;){const n=t[u],r=e[c];n<r?u++:(n>r||(f[m++]=u,u++),c++)}return f}const O={startI:0,startJ:0,endI:0,endJ:0};function F(t,e){const n=t.length,r=e.length,o=n/r;return n>=128||r>=128||o<=.34||o>=2.99?(O.startI=v(t,f(e)),O.startJ=v(e,f(t)),O.endI=v(t,m(e)),O.endJ=v(e,m(t))):(O.startI=0,O.startJ=0,O.endI=n,O.endJ=r),O}var G;!function(t){t.Empty=i,t.ofUnsortedArray=u,t.ofSingleton=s,t.ofSortedArray=a,t.ofRange=c,t.ofBounds=(t,e)=>c(t,e-1),t.is=l,t.isRange=d,t.has=S,t.indexOf=A,t.indexOfInInterval=b,t.indexOfInRange=C,t.start=f,t.end=m,t.min=h,t.max=p,t.size=g,t.hashCode=y,t.toString=_,t.areEqual=x,t.areIntersecting=D,t.isSubset=M,t.union=N,t.intersect=T,t.subtract=R,t.findPredecessorIndex=v,t.findPredecessorIndexInInterval=B,t.findRange=I,t.intersectionSize=E,t.deduplicate=U,t.indicesOf=H}(G||(G={}))},88255:function(t,e,n){n.d(e,{N:function(){return r}});var r,o=n(65533),i=n(31960),s=n(38530),a=n(66231),u=n(1342),c=n(13636),l=n(73150),d=n(64096);!function(t){function e(t){const e=[];for(const i of t.elements){const{unit:t,indices:n}=i;if(0===o.CD.size(n))continue;const r=[],s=[];if(o.CD.isInterval(n))1===o.CD.size(n)?s.push(o.IX.min(n)):r.push(o.IX.min(n),o.IX.max(n));else{let t=0;const e=n.length;for(;t<e;){const o=t;for(t++;t<e&&n[t-1]+1===n[t];)t++;const i=t;if(i-o>2)r.push(n[o],n[i-1]);else for(let t=o;t<i;t++)s[s.length]=n[t]}}e.push({unit:t,set:o.X9.ofSortedArray(s),ranges:a.m.ofSortedRanges(r)})}const n=new Map;for(let o=0,i=e.length;o<i;++o){const t=e[o],r=(0,s.vb)((0,s.TI)(t.ranges),(0,s.TI)(t.set));if(n.has(r)){const{groupedUnits:e}=n.get(r);e.has(t.unit.invariantId)?e.get(t.unit.invariantId).push(t.unit.id):e.set(t.unit.invariantId,[t.unit.id])}else{const e=new Map;e.set(t.unit.invariantId,[t.unit.id]),n.set(r,{groupedUnits:e,set:t.set,ranges:t.ranges})}}const r=[];return n.forEach(t=>{const e=[];t.groupedUnits.forEach(t=>e.push(o.X9.ofUnsortedArray(t))),e.sort((t,e)=>t[0]-e[0]),r.push({groupedUnits:e,set:t.set,ranges:t.ranges})}),{hash:t.structure.hashCode,elements:r}}function n(t,e){const n=[];for(let r=0,o=t.length;r<o;++r){const o=t[r];e.unitMap.has(o)&&n.push(e.unitMap.get(o))}return n}function r(t){return c.J.internal.generator.bundleElement({groupedUnits:c.J.core.type.list(t.groupedUnits.map(t=>c.J.core.type.list(t))),ranges:c.J.core.type.list(t.ranges),set:c.J.core.type.list(t.set)})}t.Empty={hash:-1,elements:[]},t.fromSubStructure=function(t,n){return e(l.cv.toLociWithSourceUnits(l.cv.Singletons(t,n)))},t.fromSelection=function(t){return e(l.cv.toLociWithSourceUnits(t))},t.fromExpression=function(t,n,r){return e(u.Q.fromExpression(t,n,r))},t.fromQuery=function(t,n,r){return e(u.Q.fromQuery(t,n,r))},t.fromSchema=function(t,e,n){return d.S.toBundle(t,e,n)},t.fromLoci=e,t.toLoci=function(t,e){-1!==t.hash&&t.hash!==e.hashCode&&new Error("Bundle not compatible with given structure");const r=[];for(const i of t.elements)for(const t of i.groupedUnits){const s=n(t,e);if(0===s.length)continue;let u;if(0===i.ranges.length)u=i.set;else if(0===i.set.length)if(2===i.ranges.length)u=o.IX.ofRange(i.ranges[0],i.ranges[1]);else{const t=new Int32Array(a.m.size(i.ranges));a.m.forEach(i.ranges,(e,n)=>t[n]=e),u=o.X9.ofSortedArray(t)}else{const t=a.m.size(i.ranges),e=new Int32Array(i.set.length+t);a.m.forEach(i.ranges,(t,n)=>e[n]=t),e.set(i.set,t),u=o.X9.ofUnsortedArray(e)}for(const t of s)r.push({unit:t,indices:u})}return(0,u.Q)(e,r)},t.toStructure=function(t,e){-1!==t.hash&&t.hash!==e.hashCode&&new Error("Bundle not compatible with given structure");const r=[];for(const i of t.elements)for(const t of i.groupedUnits){const s=n(t,e);if(0===s.length)continue;const u=s[0].elements,c=a.m.size(i.ranges),l=i.set.length,d=new Int32Array(l+c);let f;if(0===c){for(let t=0,e=l;t<e;++t)d[t]=u[i.set[t]];f=o.X9.ofSortedArray(d)}else if(0===l)a.m.forEach(i.ranges,(t,e)=>d[e]=u[t]),f=o.X9.ofSortedArray(d);else if(o.X9.min(i.set)>a.m.max(i.ranges)){a.m.forEach(i.ranges,(t,e)=>d[e]=u[t]);for(let t=0,e=l;t<e;++t)d[t+c]=u[i.set[t]];f=o.X9.ofSortedArray(d)}else if(a.m.min(i.ranges)>o.X9.max(i.set)){for(let t=0,e=l;t<e;++t)d[t]=u[i.set[t]];a.m.forEach(i.ranges,(t,e)=>d[e+l]=u[t]),f=o.X9.ofSortedArray(d)}else{a.m.forEach(i.ranges,(t,e)=>d[e]=u[t]);for(let t=0,e=l;t<e;++t)d[t+c]=u[i.set[t]];f=o.X9.ofUnsortedArray(d)}for(const t of s)r.push(t.getChild(f))}return i.o.create(r,{parent:e})},t.toExpression=function(t){return c.J.internal.generator.bundle({elements:c.J.core.type.list(t.elements.map(r))})},t.areEqual=function(t,e){if(t.elements.length!==e.elements.length)return!1;for(let n=0,r=t.elements.length;n<r;++n){const r=t.elements[n],i=e.elements[n];if(r.groupedUnits.length!==i.groupedUnits.length)return!1;for(let t=0,e=i.groupedUnits.length;t<e;++t)if(!o.X9.areEqual(r.groupedUnits[t],i.groupedUnits[t]))return!1;if(!o.X9.areEqual(r.set,i.set))return!1;if(!a.m.areEqual(r.ranges,i.ranges))return!1}return!0}}(r||(r={}))},89851:function(t,e,n){n.d(e,{c1:function(){return a},or:function(){return u},vE:function(){return c},wi:function(){return i},yA:function(){return s}});var r=n(27125),o=n(784);const i={type_symbol:r.VP.Schema.Aliased(o.r.atom_site.type_symbol),label_atom_id:o.r.atom_site.label_atom_id,auth_atom_id:o.r.atom_site.auth_atom_id,label_alt_id:o.r.atom_site.label_alt_id,label_comp_id:o.r.atom_site.label_comp_id,auth_comp_id:o.r.atom_site.auth_comp_id,pdbx_formal_charge:o.r.atom_site.pdbx_formal_charge},s={group_PDB:o.r.atom_site.group_PDB,label_seq_id:o.r.atom_site.label_seq_id,auth_seq_id:o.r.atom_site.auth_seq_id,pdbx_PDB_ins_code:o.r.atom_site.pdbx_PDB_ins_code},a={label_asym_id:o.r.atom_site.label_asym_id,auth_asym_id:o.r.atom_site.auth_asym_id,label_entity_id:o.r.atom_site.label_entity_id};var u,c;!function(t){t.EmptyResidueKey=function(){return{label_entity_id:"",label_asym_id:"",auth_seq_id:0,pdbx_PDB_ins_code:void 0}}}(u||(u={})),function(t){function e(t,e){return t.residueAtomSegments.index[t.chainAtomSegments.offsets[e]]}function n(t,e){return t.residueAtomSegments.index[t.chainAtomSegments.offsets[e+1]-1]+1}t.chainStartResidueIndex=e,t.chainEndResidueIndexExcl=n,t.chainResidueCount=function(t,r){return n(t,r)-e(t,r)},t.residueFirstAtomIndex=function(t,e){return t.residueAtomSegments.offsets[e]},t.atomChainIndex=function(t,e){return t.chainAtomSegments.index[e]},t.residueChainIndex=function(t,e){return t.chainAtomSegments.index[t.residueAtomSegments.offsets[e]]}}(c||(c={}))},90644:function(t,e,n){n.d(e,{Bb:function(){return o},EF:function(){return u},Zq:function(){return r},fv:function(){return a},g$:function(){return i}});let r=function(){try{return!0}catch(t){return!1}}(),o=function(){try{const t={}.DEBUG;return"*"===t||"molstar"===t}catch(t){return!1}}(),i=!1;const s=[];function a(t){s.includes(t)||s.push(t)}function u(t){const e=s.indexOf(t);-1!==e&&s.splice(e,1)}},90790:function(t,e,n){n.d(e,{I:function(){return P}});var r=n(4543);const o=r.U.Zero;function i(t,e){return e<t?r.U.create(t,t):r.U.create(t,e+1)}function s(t,e){return e<=t?r.U.create(t,t):r.U.create(t,e)}function a(t){return t<0?r.U.create(0,0):r.U.create(0,t)}const u=r.U.is,c=r.U.fst,l=r.U.snd,d=r.U.fst;function f(t){return r.U.snd(t)-1}const m=r.U.diff,h=r.U.hashCode,p=r.U.toString;function g(t,e){return r.U.fst(t)<=e&&e<r.U.snd(t)}function y(t,e){const n=c(t);return e>=n&&e<l(t)?e-n:-1}function _(t,e){return r.U.fst(t)+e}const A=r.U.areEqual;function b(t,e){const n=m(t),r=m(e);return 0===n&&0===r||n>0&&r>0&&f(t)>=d(e)&&d(t)<=f(e)}function C(t,e){return m(t)?!m(e)||c(t)<=c(e)&&l(t)>=l(e):0===m(e)}function S(t,e){const n=c(t);if(e<=n)return 0;const r=l(t);return e>=r?r-n:e-n}function x(t,e,n){const r=c(n),o=c(t);if(e<=r+o)return r;const i=l(n);return e>=i+o?i:e-o}function v(t,e,n){return s(S(t,e),S(t,n+1))}function B(t,e){return b(t,e)?s(Math.max(c(t),c(e)),Math.min(l(t),l(e))):o}function I(t,e){return m(v(t,d(e),f(e)))}function w(t,e){return r.U.create(c(t)+e,l(t)+e)}var P;!function(t){t.Empty=o,t.ofSingleton=t=>i(t,t),t.ofRange=i,t.ofBounds=s,t.ofLength=a,t.is=u,t.has=g,t.indexOf=y,t.getAt=_,t.start=c,t.end=l,t.min=d,t.max=f,t.size=m,t.hashCode=h,t.toString=p,t.areEqual=A,t.areIntersecting=b,t.isSubInterval=C,t.findPredecessorIndex=S,t.findPredecessorIndexInInterval=x,t.findRange=v,t.intersectionSize=I,t.intersect=B,t.offset=w}(P||(P={}))},92510:function(t,e,n){n.d(e,{f:function(){return r}});const r=new class{constructor(){this.shouldUpdate=!1,this.isSynchronous=!0}update(t,e){}}},92570:function(t,e,n){n.d(e,{dV:function(){return m},G7:function(){return s},yt:function(){return b},RP:function(){return i},Dr:function(){return f},xY:function(){return l},N0:function(){return c},GW:function(){return A}});var r=n(78739);const o=new Set(["145","147","149","289","291","293","445","475","491","510","604","045","05L","07E","07Y","08U","09X","0AT","0BD","0H0","0HX","0LP","0MK","0NZ","0TS","0UB","0V4","0WK","0XY","0YT","10M","12E","14T","15L","16F","16G","16O","17T","18D","18O","18T","1AR","1BW","1CF","1FT","1GL","1GN","1JB","1LL","1NA","1S3","1S4","1SD","1X4","20S","20X","22O","22S","23V","24S","25E","26M","26O","26Q","26R","26V","26W","26Y","27C","2DG","2DR","2F8","2FG","2FL","2FP","2GL","2GS","2H5","2HA","2M4","2M5","2M8","2OS","2SI","2WP","2WS","32O","34V","38J","3BU","3CM","3DO","3DY","3FM","3GR","3HD","3J3","3J4","3LJ","3LR","3MF","3MG","3MK","3R3","3S6","3SA","3YW","40J","42D","44S","46D","46M","46Z","48Z","49A","49S","49T","49V","4AM","4CQ","4GC","4GL","4GP","4JA","4N2","4NN","4QY","4R1","4RS","4SG","4U0","4U1","4U2","4UZ","4V5","50A","51N","56N","57S","5DI","5GF","5GO","5II","5KQ","5KS","5KT","5KV","5L2","5L3","5LS","5LT","5MM","5N6","5QP","5RP","5SA","5SP","5TH","5TJ","5TK","5TM","61J","62I","64K","66O","6BG","6C2","6DM","6GB","6GP","6GR","6K3","6KH","6KL","6KS","6KU","6KW","6LA","6LS","6LW","6MJ","6MN","6PG","6PY","6PZ","6S2","6SA","6UD","6Y6","6YR","6ZC","73E","79J","7CV","7D1","7GP","7JZ","7K2","7K3","7NU","7SA","83Y","89Y","8B7","8B9","8EX","8GA","8GG","8GP","8I4","8LM","8LR","8OQ","8PK","8S0","8YV","95Z","96O","98U","9AM","9C1","9CD","9GP","9KJ","9MR","9OK","9PG","9QG","9QZ","9RN","9S7","9SG","9SJ","9SM","9SP","9T1","9T7","9VP","9WJ","9WN","9WZ","9YW","A0K","A1AIO","A1APB","A1APC","A1APD","A1CCV","A1CCW","A1EAX","A1EFW","A1EGT","A1EGV","A1EGW","A1EGX","A1EGY","A1EJ0","A1EJ2","A1EKO","A1EN6","A1H03","A1H0P","A1H0Z","A1H10","A1H1B","A1H1F","A1H1V","A1I9U","A1ID6","A1IH4","A1IZL","A1JAQ","A1L1P","A1Q","A2G","A5C","A6P","AAL","AAO","ABC","ABD","ABE","ABF","ABL","AC1","ACG","ACR","ACX","ADA","ADG","ADR","AF1","AFD","AFL","AFO","AFP","AFR","AGC","AGH","AGL","AGR","AH2","AH8","AHG","AHM","AHR","AIG","ALL","ALX","AMG","AMN","AMU","AMV","ANA","AOG","AOS","AQA","ARA","ARB","ARE","ARI","ARW","ASC","ASG","ASO","AXP","AXR","AY9","AZC","B0D","B16","B1H","B1N","B2G","B4G","B6D","B7G","B8D","B9D","BBK","BBV","BCD","BCW","BDF","BDG","BDP","BDR","BDZ","BEM","BFN","BFP","BG6","BG8","BGC","BGL","BGN","BGP","BGS","BHG","BM3","BM7","BMA","BMX","BND","BNG","BNX","BO1","BOG","BQY","BRI","BS7","BTG","BTU","BW3","BWG","BXF","BXP","BXX","BXY","BZD","C3B","C3G","C3X","C4B","C4W","C4X","C5X","CAP","CBF","CBI","CBK","CDR","CE5","CE6","CE8","CEG","CEX","CEY","CEZ","CGF","CJB","CKB","CKP","CNP","CR1","CR6","CRA","CT3","CTO","CTR","CTT","D0N","D1M","D5E","D6G","DAF","DAG","DAN","DDA","DDB","DDL","DEG","DEL","DFR","DFX","DG0","DGC","DGD","DGM","DGO","DGS","DGU","DIG","DJB","DJE","DK4","DKX","DKZ","DL6","DLD","DLF","DLG","DMU","DNO","DO8","DOM","DP5","DPC","DQQ","DQR","DR2","DR3","DR4","DR5","DRI","DSR","DT6","DVC","DYM","E3M","E4P","E5G","EAG","EBG","EBQ","ED6","EEN","EEQ","EGA","EJT","EMP","EMZ","EPG","EQP","EQV","ERE","ERI","ETT","EUS","F1P","F1X","F55","F58","F6P","F8X","FBP","FCA","FCB","FCT","FDP","FDQ","FFC","FFX","FIF","FIX","FK9","FKD","FMF","FMO","FNG","FNY","FRU","FSA","FSI","FSM","FSR","FSW","FU4","FUB","FUC","FUD","FUF","FUL","FUY","FVQ","FX1","FYJ","G0S","G16","G1P","G20","G28","G2F","G3F","G3I","G4D","G4S","G6D","G6P","G6S","G7P","G8Z","GAA","GAC","GAD","GAF","GAL","GAT","GBH","GC1","GC4","GC9","GCB","GCD","GCN","GCO","GCS","GCT","GCU","GCV","GCW","GDA","GDL","GE1","GE3","GFP","GIV","GL0","GL1","GL2","GL4","GL5","GL6","GL7","GL9","GLA","GLB","GLC","GLD","GLF","GLG","GLO","GLP","GLS","GLT","GLW","GM0","GMB","GMH","GMT","GMZ","GN1","GN4","GNS","GNX","GP0","GP1","GP4","GPH","GPK","GPM","GPO","GPQ","GPU","GPV","GPW","GQ1","GRF","GRX","GS1","GS4","GS9","GSA","GSD","GTE","GTH","GTK","GTM","GTR","GU0","GU1","GU2","GU3","GU4","GU5","GU6","GU8","GU9","GUF","GUL","GUP","GUZ","GXL","GXV","GYE","GYG","GYP","GYU","GYV","GZL","H1M","H1S","H2P","H3S","H53","H6Q","H6Z","HBZ","HD4","HDL","HLA","HMS","HNV","HNW","HSG","HSH","HSJ","HSQ","HSR","HSU","HSX","HSY","HSZ","HTG","HTM","HVC","I57","IAB","IDC","IDF","IDG","IDR","IDS","IDT","IDU","IDX","IDY","IEM","IN1","IPT","ISD","ISL","ISX","IVG","IXD","J5B","JFZ","JHM","JLT","JRV","JS2","JSV","JV4","JVA","JVS","JZR","K5B","K99","KBA","KBG","KD5","KDA","KDB","KDD","KDE","KDF","KDM","KDN","KDO","KDR","KFN","KG1","KGM","KHP","KME","KO1","KO2","KOT","KQC","KTU","L1L","L6N","L6S","L6T","LAG","LAH","LAI","LAK","LAO","LAT","LB2","LBS","LBT","LCN","LDY","LEC","LER","LFC","LFR","LGC","LGU","LKA","LKS","LM2","LMO","LMT","LMU","LNV","LOG","LOX","LPK","LRH","LSM","LTG","LTM","LVO","LVZ","LXB","LXC","LXZ","LZ0","M1F","M1P","M2F","M3M","M3N","M55","M6D","M6P","M7B","M7P","M8C","MA1","MA2","MA3","MA8","MAB","MAF","MAG","MAL","MAN","MAT","MAV","MAW","MBE","MBF","MBG","MCU","MDA","MDP","MFA","MFB","MFU","MG5","MGA","MGC","MGL","MGS","MJJ","MLB","MLR","MMA","MMN","MN0","MNA","MQG","MQT","MRH","MRP","MSX","MTT","MUB","MUG","MUR","MVP","MXY","MXZ","MYG","N1L","N3U","N9S","NA1","NAA","NAG","NBG","NBX","NBY","NDG","NED","NFG","NG1","NG6","NGA","NGB","NGC","NGE","NGF","NGK","NGL","NGR","NGS","NGY","NGZ","NHF","NLC","NM6","NM9","NNG","NOJ","NPF","NSQ","NT1","NTF","NTO","NTP","NXD","NYT","O1G","OAK","OEL","OI7","OPM","ORP","OSU","OTG","OTN","OTU","OX2","P53","P6P","P8E","PA1","PA5","PAV","PDX","PH5","PKM","PNA","PNG","PNJ","PNW","PPC","PRP","PSG","PSJ","PSV","PTQ","PUF","PZU","QDK","QIF","QKH","QPS","QV4","R1P","R1X","R2B","R2G","R5P","RAA","RAE","RAF","RAM","RAO","RAT","RB5","RBL","RCD","RDP","REL","RER","RF5","RG1","RGG","RHA","RHC","RI2","RIB","RIP","RM4","RNS","RNT","ROB","ROR","RP3","RP5","RP6","RPA","RR7","RRJ","RRY","RST","RTG","RTV","RUB","RUG","RUU","RV7","RVG","RVM","RWI","RY7","RZM","S6P","S7P","S81","SA0","SCG","SCR","SDD","SDY","SEJ","SF6","SF9","SFJ","SFU","SG4","SG5","SG6","SG7","SGA","SGC","SGD","SGN","SGS","SHB","SHD","SHG","SI3","SIA","SID","SIO","SIZ","SLB","SLM","SLT","SMD","SN5","SNG","SOE","SOG","SOL","SOR","SR1","SSG","SSH","STW","STZ","SUC","SUP","SUS","SWE","SZZ","T68","T6D","T6P","T6T","TA6","TAG","TCB","TCG","TDG","TEU","TF0","TFU","TGA","TGK","TGR","TGY","TH1","TM5","TM6","TM9","TMR","TMX","TNX","TOA","TOC","TQY","TRE","TRV","TS8","TT7","TTV","TTZ","TU4","TUG","TUJ","TUP","TUR","TVD","TVG","TVM","TVS","TVV","TVY","TW7","TWA","TWD","TWG","TWJ","TWY","TXB","TY6","TYV","U1Y","U2A","U2D","U63","U8V","U97","U9A","U9D","U9G","U9J","U9M","UAP","UBH","UBO","UCD","UDC","UEA","V3M","V3P","V71","VDF","VG1","VJ1","VJ4","VKN","VTB","W9T","WIA","WKO","WKT","WOO","WT8","WUN","WZ1","WZ2","WZ4","X0X","X1P","X1X","X2F","X2Y","X34","X4S","X5S","X6N","X6X","X6Y","X6Z","XBP","XDP","XDX","XGP","XIL","XIQ","XKJ","XLF","XLS","XMM","XS2","XUL","XXM","XXR","XXX","XY6","XY9","XYB","XYF","XYL","XYP","XYS","XYT","XYZ","YDR","YIO","YJM","YKR","YO5","YX0","YX1","YYB","YYD","YYH","YYJ","YYK","YYM","YYQ","YYR","YZ0","YZT","Z0F","Z15","Z16","Z2D","Z2T","Z3K","Z3L","Z3Q","Z3U","Z4K","Z4R","Z4S","Z4U","Z4V","Z4W","Z4Y","Z57","Z5J","Z5L","Z61","Z6G","Z6H","Z6J","Z6W","Z8H","Z8T","Z9D","Z9E","Z9H","Z9K","Z9L","Z9M","Z9N","Z9W","ZB0","ZB1","ZB2","ZB3","ZCD","ZCZ","ZD0","ZDC","ZDM","ZDO","ZEE","ZEL","ZGE","ZMR","UMQ","SQD"]);var i;!function(t){t[t.FilledSphere=0]="FilledSphere",t[t.FilledCube=1]="FilledCube",t[t.CrossedCube=2]="CrossedCube",t[t.DividedDiamond=3]="DividedDiamond",t[t.FilledCone=4]="FilledCone",t[t.DevidedCone=5]="DevidedCone",t[t.FlatBox=6]="FlatBox",t[t.FilledStar=7]="FilledStar",t[t.FilledDiamond=8]="FilledDiamond",t[t.FlatDiamond=9]="FlatDiamond",t[t.FlatHexagon=10]="FlatHexagon",t[t.Pentagon=11]="Pentagon",t[t.DiamondPrism=12]="DiamondPrism",t[t.PentagonalPrism=13]="PentagonalPrism",t[t.HexagonalPrism=14]="HexagonalPrism",t[t.HeptagonalPrism=15]="HeptagonalPrism"}(i||(i={}));const s=(0,r._j)({Blue:37052,Green:42577,Yellow:16765952,Orange:16021792,Pink:16162465,Purple:10830745,LightBlue:9424105,Brown:10582605,Red:15539236,Secondary:15854817});var a;!function(t){t[t.Hexose=0]="Hexose",t[t.HexNAc=1]="HexNAc",t[t.Hexosamine=2]="Hexosamine",t[t.Hexuronate=3]="Hexuronate",t[t.Deoxyhexose=4]="Deoxyhexose",t[t.DeoxyhexNAc=5]="DeoxyhexNAc",t[t.DiDeoxyhexose=6]="DiDeoxyhexose",t[t.Pentose=7]="Pentose",t[t.Deoxynonulosonate=8]="Deoxynonulosonate",t[t.DiDeoxynonulosonate=9]="DiDeoxynonulosonate",t[t.Unknown=10]="Unknown",t[t.Assigned=11]="Assigned"}(a||(a={}));a.Hexose,a.HexNAc,a.Hexosamine,a.Hexuronate,a.Deoxyhexose,a.DeoxyhexNAc,a.DiDeoxyhexose,a.Pentose,a.Deoxynonulosonate,a.DiDeoxynonulosonate,a.Unknown,a.Assigned;const u={[a.Hexose]:i.FilledSphere,[a.HexNAc]:i.FilledCube,[a.Hexosamine]:i.CrossedCube,[a.Hexuronate]:i.DividedDiamond,[a.Deoxyhexose]:i.FilledCone,[a.DeoxyhexNAc]:i.DevidedCone,[a.DiDeoxyhexose]:i.FlatBox,[a.Pentose]:i.FilledStar,[a.Deoxynonulosonate]:i.FilledDiamond,[a.DiDeoxynonulosonate]:i.FlatDiamond,[a.Unknown]:i.FlatHexagon,[a.Assigned]:i.Pentagon};function c(t,e){return t===a.Unknown?4===e?i.DiamondPrism:5===e?i.PentagonalPrism:6===e?i.HexagonalPrism:7===e?i.HeptagonalPrism:i.FlatHexagon:u[t]}const l={abbr:"Unk",name:"Unknown",color:s.Secondary,type:a.Unknown},d=[{abbr:"Glc",name:"Glucose",color:s.Blue,type:a.Hexose},{abbr:"Man",name:"Mannose",color:s.Green,type:a.Hexose},{abbr:"Gal",name:"Galactose",color:s.Yellow,type:a.Hexose},{abbr:"Gul",name:"Gulose",color:s.Orange,type:a.Hexose},{abbr:"Alt",name:"Altrose",color:s.Pink,type:a.Hexose},{abbr:"All",name:"Allose",color:s.Purple,type:a.Hexose},{abbr:"Tal",name:"Talose",color:s.LightBlue,type:a.Hexose},{abbr:"Ido",name:"Idose",color:s.Brown,type:a.Hexose},{abbr:"GlcNAc",name:"N-Acetyl Glucosamine",color:s.Blue,type:a.HexNAc},{abbr:"ManNAc",name:"N-Acetyl Mannosamine",color:s.Green,type:a.HexNAc},{abbr:"GalNAc",name:"N-Acetyl Galactosamine",color:s.Yellow,type:a.HexNAc},{abbr:"GulNAc",name:"N-Acetyl Gulosamine",color:s.Orange,type:a.HexNAc},{abbr:"AltNAc",name:"N-Acetyl Altrosamine",color:s.Pink,type:a.HexNAc},{abbr:"AllNAc",name:"N-Acetyl Allosamine",color:s.Purple,type:a.HexNAc},{abbr:"TalNAc",name:"N-Acetyl Talosamine",color:s.LightBlue,type:a.HexNAc},{abbr:"IdoNAc",name:"N-Acetyl Idosamine",color:s.Brown,type:a.HexNAc},{abbr:"GlcN",name:"Glucosamine",color:s.Blue,type:a.Hexosamine},{abbr:"ManN",name:"Mannosamine",color:s.Green,type:a.Hexosamine},{abbr:"GalN",name:"Galactosamine",color:s.Yellow,type:a.Hexosamine},{abbr:"GulN",name:"Gulosamine",color:s.Orange,type:a.Hexosamine},{abbr:"AltN",name:"Altrosamine",color:s.Pink,type:a.Hexosamine},{abbr:"AllN",name:"Allosamine",color:s.Purple,type:a.Hexosamine},{abbr:"TalN",name:"Talosamine",color:s.LightBlue,type:a.Hexosamine},{abbr:"IdoN",name:"Idosamine",color:s.Brown,type:a.Hexosamine},{abbr:"GlcNS",name:"N-sulfo Glucosamine",color:s.Blue,type:a.Hexosamine},{abbr:"GlcA",name:"Glucuronic Acid",color:s.Blue,type:a.Hexuronate},{abbr:"ManA",name:"Mannuronic Acid",color:s.Green,type:a.Hexuronate},{abbr:"GalA",name:"Galacturonic Acid",color:s.Yellow,type:a.Hexuronate},{abbr:"GulA",name:"Guluronic Acid",color:s.Orange,type:a.Hexuronate},{abbr:"AltA",name:"Altruronic Acid",color:s.Pink,type:a.Hexuronate},{abbr:"AllA",name:"Alluronic Acid",color:s.Purple,type:a.Hexuronate},{abbr:"TalA",name:"Taluronic Acid",color:s.LightBlue,type:a.Hexuronate},{abbr:"IdoA",name:"Iduronic Acid",color:s.Brown,type:a.Hexuronate},{abbr:"Qui",name:"Quinovose",color:s.Blue,type:a.Deoxyhexose},{abbr:"Rha",name:"Rhamnose",color:s.Green,type:a.Deoxyhexose},{abbr:"6dGul",name:"6-Deoxy Gulose",color:s.Orange,type:a.Deoxyhexose},{abbr:"6dAlt",name:"6-Deoxy Altrose",color:s.Pink,type:a.Deoxyhexose},{abbr:"6dTal",name:"6-Deoxy Talose",color:s.LightBlue,type:a.Deoxyhexose},{abbr:"Fuc",name:"Fucose",color:s.Red,type:a.Deoxyhexose},{abbr:"QuiNAc",name:"N-Acetyl Quinovosamine",color:s.Blue,type:a.DeoxyhexNAc},{abbr:"RhaNAc",name:"N-Acetyl Rhamnosamine",color:s.Green,type:a.DeoxyhexNAc},{abbr:"6dAltNAc",name:"N-Acetyl 6-Deoxy Altrosamine",color:s.Pink,type:a.DeoxyhexNAc},{abbr:"6dTalNAc",name:"N-Acetyl 6-Deoxy Talosamine",color:s.LightBlue,type:a.DeoxyhexNAc},{abbr:"FucNAc",name:"N-Acetyl Fucosamine",color:s.Red,type:a.DeoxyhexNAc},{abbr:"AAT",name:"AAT",color:s.Red,type:a.DeoxyhexNAc},{abbr:"Oli",name:"Olivose",color:s.Blue,type:a.DiDeoxyhexose},{abbr:"Tyv",name:"Tyvelose",color:s.Green,type:a.DiDeoxyhexose},{abbr:"Abe",name:"Abequose",color:s.Orange,type:a.DiDeoxyhexose},{abbr:"Par",name:"Paratose",color:s.Pink,type:a.DiDeoxyhexose},{abbr:"Dig",name:"Digitoxose",color:s.Purple,type:a.DiDeoxyhexose},{abbr:"Col",name:"Colitose",color:s.LightBlue,type:a.DiDeoxyhexose},{abbr:"Ara",name:"Arabinose",color:s.Green,type:a.Pentose},{abbr:"Lyx",name:"Lyxose",color:s.Yellow,type:a.Pentose},{abbr:"Xyl",name:"Xylose",color:s.Orange,type:a.Pentose},{abbr:"Rib",name:"Ribose",color:s.Pink,type:a.Pentose},{abbr:"Kdn",name:"Keto-Deoxy Nonulonic Acid",color:s.Green,type:a.Deoxynonulosonate},{abbr:"Neu5Ac",name:"N-Acetyl Neuraminic Acid",color:s.Purple,type:a.Deoxynonulosonate},{abbr:"Neu5Gc",name:"N-Glycolyl Neuraminic Acid",color:s.LightBlue,type:a.Deoxynonulosonate},{abbr:"Neu",name:"Neuraminic Acid",color:s.Brown,type:a.Deoxynonulosonate},{abbr:"Sia",name:"Sialic acid",color:s.Red,type:a.Deoxynonulosonate},{abbr:"Pse",name:"Pseudaminic Acid",color:s.Green,type:a.DiDeoxynonulosonate},{abbr:"Leg",name:"Legionaminic Acid",color:s.Yellow,type:a.DiDeoxynonulosonate},{abbr:"Aci",name:"Acinetaminic Acid",color:s.Pink,type:a.DiDeoxynonulosonate},{abbr:"4eLeg",name:"4-Epilegionaminic Acid",color:s.LightBlue,type:a.DiDeoxynonulosonate},{abbr:"Bac",name:"Bacillosamine",color:s.Blue,type:a.Unknown},{abbr:"LDmanHep",name:"L-Glycero-D-Manno Heptose",color:s.Green,type:a.Unknown},{abbr:"Kdo",name:"Keto-Deoxy Octulonic Acid",color:s.Yellow,type:a.Unknown},{abbr:"Dha",name:"3-Deoxy Lyxo-Heptulosaric Acid",color:s.Orange,type:a.Unknown},{abbr:"DDmanHep",name:"D-Glycero-D-Manno-Heptose",color:s.Pink,type:a.Unknown},{abbr:"MurNAc",name:"N-Acetyl Muramic Acid",color:s.Purple,type:a.Unknown},{abbr:"MurNGc",name:"N-Glycolyl Muramic Acid",color:s.LightBlue,type:a.Unknown},{abbr:"Mur",name:"Muramic Acid",color:s.Brown,type:a.Unknown},{abbr:"K3O",name:"D-glycero-a-D-talo-oct-2-Ulosonic Acid",color:s.Red,type:a.Unknown},{abbr:"dUA",name:"4-deoxy-4,5-didehydro iduronic acid",color:s.Secondary,type:a.Unknown},{abbr:"Api",name:"Apicose",color:s.Green,type:a.Assigned},{abbr:"Fru",name:"Fructose",color:s.Green,type:a.Assigned},{abbr:"Tag",name:"Tagatose",color:s.Yellow,type:a.Assigned},{abbr:"Sor",name:"Sorbose",color:s.Orange,type:a.Assigned},{abbr:"Psi",name:"Psicose",color:s.Pink,type:a.Assigned}],f=function(){const t=new Map;for(let e=0,n=d.length;e<n;++e){const n=d[e];t.set(n.abbr,n)}return t}(),m=[["Glc-family",s.Blue],["Man-family",s.Green],["Gal-family",s.Yellow],["Gul-family",s.Orange],["Alt-family",s.Pink],["All-family",s.Purple],["Tal-family",s.LightBlue],["Ido-family",s.Brown],["Fuc-family",s.Red],["Generic/Unknown/Secondary",s.Secondary]],h={Glc:["GLC","BGC","Z8T","TRE","MLR"],Man:["MAN","BMA"],Gal:["GLA","GAL","GZL","GXL","GIV"],Gul:["4GL","GL0","GUP","Z8H"],Alt:["Z6H","3MK","SHD"],All:["AFD","ALL","WOO","Z2D"],Tal:["ZEE","A5C","SDY"],Ido:["ZCD","Z0F","4N2"],GlcNAc:["NDG","NAG","NGZ"],ManNAc:["BM3","BM7"],GalNAc:["A2G","NGA","YYQ"],GulNAc:["LXB"],AltNAc:[],AllNAc:["NAA"],TalNAc:[],IdoNAc:["LXZ","HSQ"],GlcN:["PA1","GCS"],ManN:["95Z"],GalN:["X6X","1GN"],GulN:[],AltN:[],AllN:[],TalN:[],IdoN:[],GlcA:["GCU","BDP"],ManA:["MAV","BEM"],GalA:["ADA","GTR","GTK"],GulA:["LGU"],AltA:[],AllA:[],TalA:["X1X","X0X"],IdoA:["IDR"],Qui:["G6D","YYK"],Rha:["RAM","RM4","XXR"],"6dGul":["66O"],"6dAlt":[],"6dTal":[],Fuc:["FUC","FUL","FCA","FCB","GYE"],QuiNAc:["Z9W"],RhaNAc:[],"6dAltNAc":[],"6dTalNAc":[],FucNAc:["49T"],Oli:["DDA","RAE","Z5J"],Tyv:["TYV"],Abe:["ABE"],Par:["PZU"],Dig:["Z3U"],Col:[],Ara:["64K","ARA","ARB","AHR","FUB","BXY","BXX","SEJ"],Lyx:["LDY","Z4W"],Xyl:["XYS","XYP","XYZ","HSY","LXC"],Rib:["YYM","RIP","RIB","BDR","0MK","Z6J","32O"],Kdn:["KDM","KDN"],Neu5Ac:["SIA","SLB"],Neu5Gc:["NGC","NGE"],Neu:[],Sia:[],Pse:[],Leg:[],Aci:[],"4eLeg":[],Bac:[],LDmanHep:["GMH"],Kdo:["KDO"],Dha:[],DDmanHep:["289"],MurNAc:["MUB","AMU"],MurNGc:[],Mur:["1S4","MUR"],Api:["XXM"],Fru:["BDF","Z9N","FRU","LFR"],Tag:["T6T"],Sor:["SOE","UEA"],Psi:["PSV","SF6","SF9","TTV"]},p={Glc:["AGLC","BGLC"],GlcNAc:["AGLCNA","BGLCNA","BGLCN0"],GlcA:["AGLCA","BGLCA","BGLCA0"],Man:["AMAN","BMAN"],Rha:["ARHM","BRHM"],Ara:["AARB","BARB"],Gal:["AGAL","BGAL"],GalNAc:["AGALNA","BGALNA"],Gul:["AGUL","BGUL"],Alt:["AALT","BALT"],All:["AALL","BALL"],Tal:["ATAL","BTAL"],Ido:["AIDO","BIDO"],IdoA:["AIDOA","BIDOA"],Fuc:["AFUC","BFUC"],Lyx:["ALYF","BLYF"],Xyl:["AXYL","BXYL","AXYF","BXYF"],Rib:["ARIB","BRIB"],Fru:["AFRU","BFRU"],Neu5Ac:["ANE5AC","BNE5AC"]},g={Glc:["0GA","0GB","1GA","1GB","2GA","2GB","3GA","3GB","4GA","4GB","6GA","6GB","ZGA","ZGB","YGA","YGB","XGA","XGB","WGA","WGB","VGA","VGB","UGA","UGB","TGA","TGB","SGA","SGB","RGA","RGB","QGA","QGB","PGA","PGB","0gA","0gB","1gA","1gB","2gA","2gB","3gA","3gB","4gA","4gB","6gA","6gB","ZgA","ZgB","YgA","YgB","XgA","XgB","WgA","WgB","VgA","VgB","UgA","UgB","TgA","TgB","SgA","SgB","RgA","RgB","QgA","QgB","PgA","PgB"],GlcNAc:["0YA","0YB","1YA","1YB","3YA","3YB","4YA","4YB","6YA","6YB","WYA","WYB","VYA","VYB","UYA","UYB","QYA","QYB","0yA","0yB","1yA","1yB","3yA","3yB","4yA","4yB","6yA","6yB","WyA","WyB","VyA","VyB","UyA","UyB","QyA","QyB","0YS","0Ys","3YS","3Ys","4YS","4Ys","6YS","6Ys","QYS","QYs","UYS","UYs","VYS","VYs","WYS","WYs","0yS","0ys","3yS","3ys","4yS","4ys"],GlcA:["0ZA","0ZB","1ZA","1ZB","2ZA","2ZB","3ZA","3ZB","4ZA","4ZB","ZZA","ZZB","YZA","YZB","WZA","WZB","TZA","TZB","0zA","0zB","1zA","1zB","2zA","2zB","3zA","3zB","4zA","4zB","ZzA","ZzB","YzA","YzB","WzA","WzB","TzA","TzB","TZBP","WZBP","YZBP","4ZBP","ZZBP","3ZBP","2ZBP","1ZBP","0ZBP","0ZF","1ZF","4ZF","0Zf","1Zf","4Zf"],GlcN:["0YN","3YN","4YN","6YN","WYN","VYN","UYN","QYN","3Yn","4Yn","WYn","0Yn","0YP","3YP","4YP","6YP","WYP","VYP","UYP","QYP","0Yp","3Yp","4Yp","WYp","QYN","WYN","VYN","3YN","UYN","4YN","6YN","1YN","0YN","QYn","VYn","WYn","3Yn","UYn","6Yn","4Yn","1Yn","0Yn","QYNP","WYNP","VYNP","3YNP","UYNP","4YNP","6YNP","1YNP","0YNP","QYnP","UYnP","VYnP","6YnP","WYnP","4YnP","3YnP","1YnP","0YnP"],Man:["0MA","0MB","1MA","1MB","2MA","2MB","3MA","3MB","4MA","4MB","6MA","6MB","ZMA","ZMB","YMA","YMB","XMA","XMB","WMA","WMB","VMA","VMB","UMA","UMB","TMA","TMB","SMA","SMB","RMA","RMB","QMA","QMB","PMA","PMB","0mA","0mB","1mA","1mB","2mA","2mB","3mA","3mB","4mA","4mB","6mA","6mB","ZmA","ZmB","YmA","YmB","XmA","XmB","WmA","WmB","VmA","VmB","UmA","UmB","TmA","TmB","SmA","SmB","RmA","RmB","QmA","QmB","PmA","PmB"],ManNAc:["0WA","0WB","1WA","1WB","3WA","3WB","4WA","4WB","6WA","6WB","WWA","WWB","VWA","VWB","UWA","UWB","QWA","QWB","0wA","0wB","1wA","1wB","3wA","3wB","4wA","4wB","6wA","6wB","WwA","WwB","VwA","VwB","UwA","UwB","QwA","QwB"],Ara:["0AA","0AB","1AA","1AB","2AA","2AB","3AA","3AB","4AA","4AB","ZAA","ZAB","YAA","YAB","WAA","WAB","TAA","TAB","0AD","0AU","1AD","1AU","2AD","2AU","3AD","3AU","5AD","5AU","ZAD","ZAU","0aA","0aB","1aA","1aB","2aA","2aB","3aA","3aB","4aA","4aB","ZaA","ZaB","YaA","YaB","WaA","WaB","TaA","TaB","0aD","0aU","1aD","1aU","2aD","2aU","3aD","3aU","5aD","5aU","ZaD","ZaU"],Gal:["0LA","0LB","1LA","1LB","2LA","2LB","3LA","3LB","4LA","4LB","6LA","6LB","ZLA","ZLB","YLA","YLB","XLA","XLB","WLA","WLB","VLA","VLB","ULA","ULB","TLA","TLB","SLA","SLB","RLA","RLB","QLA","QLB","PLA","PLB","0lA","0lB","1lA","1lB","2lA","2lB","3lA","3lB","4lA","4lB","6lA","6lB","ZlA","ZlB","YlA","YlB","XlA","XlB","WlA","WlB","VlA","VlB","UlA","UlB","TlA","TlB","SlA","SlB","RlA","RlB","QlA","QlB","PlA","PlB"],GalNAc:["0VA","0VB","1VA","1VB","3VA","3VB","4VA","4VB","6VA","6VB","WVA","WVB","VVA","VVB","UVA","UVB","QVA","QVB","0vA","0vB","1vA","1vB","3vA","3vB","4vA","4vB","6vA","6vB","WvA","WvB","VvA","VvB","UvA","UvB","QvA","QvB"],GalA:["0OA","0OB","1OA","1OB","2OA","2OB","3OA","3OB","4OA","4OB","ZOA","ZOB","YOA","YOB","WOA","WOB","TOA","TOB","0oA","0oB","1oA","1oB","2oA","2oB","3oA","3oB","4oA","4oB","ZoA","ZoB","YoA","YoB","WoA","WoB","ToA","ToB"],Gul:["0KA","0KB","1KA","1KB","2KA","2KB","3KA","3KB","4KA","4KB","6KA","6KB","ZKA","ZKB","YKA","YKB","XKA","XKB","WKA","WKB","VKA","VKB","UKA","UKB","TKA","TKB","SKA","SKB","RKA","RKB","QKA","QKB","PKA","PKB","0kA","0kB","1kA","1kB","2kA","2kB","3kA","3kB","4kA","4kB","6kA","6kB","ZkA","ZkB","YkA","YkB","XkA","XkB","WkA","WkB","VkA","VkB","UkA","UkB","TkA","TkB","SkA","SkB","RkA","RkB","QkA","QkB","PkA","PkB"],Alt:["0EA","0EB","1EA","1EB","2EA","2EB","3EA","3EB","4EA","4EB","6EA","6EB","ZEA","ZEB","YEA","YEB","XEA","XEB","WEA","WEB","VEA","VEB","UEA","UEB","TEA","TEB","SEA","SEB","REA","REB","QEA","QEB","PEA","PEB","0eA","0eB","1eA","1eB","2eA","2eB","3eA","3eB","4eA","4eB","6eA","6eB","ZeA","ZeB","YeA","YeB","XeA","XeB","WeA","WeB","VeA","VeB","UeA","UeB","TeA","TeB","SeA","SeB","ReA","ReB","QeA","QeB","PeA","PeB"],All:["0NA","0NB","1NA","1NB","2NA","2NB","3NA","3NB","4NA","4NB","6NA","6NB","ZNA","ZNB","YNA","YNB","XNA","XNB","WNA","WNB","VNA","VNB","UNA","UNB","TNA","TNB","SNA","SNB","RNA","RNB","QNA","QNB","PNA","PNB","0nA","0nB","1nA","1nB","2nA","2nB","3nA","3nB","4nA","4nB","6nA","6nB","ZnA","ZnB","YnA","YnB","XnA","XnB","WnA","WnB","VnA","VnB","UnA","UnB","TnA","TnB","SnA","SnB","RnA","RnB","QnA","QnB","PnA","PnB"],Tal:["0TA","0TB","1TA","1TB","2TA","2TB","3TA","3TB","4TA","4TB","6TA","6TB","ZTA","ZTB","YTA","YTB","XTA","XTB","WTA","WTB","VTA","VTB","UTA","UTB","TTA","TTB","STA","STB","RTA","RTB","QTA","QTB","PTA","PTB","0tA","0tB","1tA","1tB","2tA","2tB","3tA","3tB","4tA","4tB","6tA","6tB","ZtA","ZtB","YtA","YtB","XtA","XtB","WtA","WtB","VtA","VtB","UtA","UtB","TtA","TtB","StA","StB","RtA","RtB","QtA","QtB","PtA","PtB"],Ido:["0IA","0IB","1IA","1IB","2IA","2IB","3IA","3IB","4IA","4IB","6IA","6IB","ZIA","ZIB","YIA","YIB","XIA","XIB","WIA","WIB","VIA","VIB","UIA","UIB","TIA","TIB","SIA","SIB","RIA","RIB","QIA","QIB","PIA","PIB","0iA","0iB","1iA","1iB","2iA","2iB","3iA","3iB","4iA","4iB","6iA","6iB","ZiA","ZiB","YiA","YiB","XiA","XiB","WiA","WiB","ViA","ViB","UiA","UiB","TiA","TiB","SiA","SiB","RiA","RiB","QiA","QiB","PiA","PiB"],IdoA:["0UA","0UB","1UA","1UB","2UA","2UB","3UA","3UB","4UA","4UB","ZUA","ZUB","YUA","YUB","WUA","WUB","TUA","TUB","0uA","0uB","1uA","1uB","2uA","2uB","3uA","3uB","4uA","4uB","ZuA","ZuB","YuA","YuB","WuA","WuB","TuA","TuB","YuAP"],Fuc:["0FA","0FB","1FA","1FB","2FA","2FB","3FA","3FB","4FA","4FB","ZFA","ZFB","YFA","YFB","WFA","WFB","TFA","TFB","0fA","0fB","1fA","1fB","2fA","2fB","3fA","3fB","4fA","4fB","ZfA","ZfB","YfA","YfB","WfA","WfB","TfA","TfB"],Rha:["0HA","0HB","1HA","1HB","2HA","2HB","3HA","3HB","4HA","4HB","ZHA","ZHB","YHA","YHB","WHA","WHB","THA","THB","0hA","0hB","1hA","1hB","2hA","2hB","3hA","3hB","4hA","4hB","ZhA","ZhB","YhA","YhB","WhA","WhB","ThA","ThB"],Qui:["0QA","0QB","1QA","1QB","2QA","2QB","3QA","3QB","4QA","4QB","ZQA","ZQB","YQA","YQB","WQA","WQB","TQA","TQB","0qA","0qB","1qA","1qB","2qA","2qB","3qA","3qB","4qA","4qB","ZqA","ZqB","YqA","YqB","WqA","WqB","TqA","TqB"],Lyx:["0DA","0DB","1DA","1DB","2DA","2DB","3DA","3DB","4DA","4DB","ZDA","ZDB","YDA","YDB","WDA","WDB","TDA","TDB","0DD","0DU","1DD","1DU","2DD","2DU","3DD","3DU","5DD","5DU","ZDD","ZDU","0dA","0dB","1dA","1dB","2dA","2dB","3dA","3dB","4dA","4dB","ZdA","ZdB","YdA","YdB","WdA","WdB","TdA","TdB","0dD","0dU","1dD","1dU","2dD","2dU","3dD","3dU","5dD","5dU","ZdD","ZdU"],Xyl:["0XA","0XB","1XA","1XB","2XA","2XB","3XA","3XB","4XA","4XB","ZXA","ZXB","YXA","YXB","WXA","WXB","TXA","TXB","0XD","0XU","1XD","1XU","2XD","2XU","3XD","3XU","5XD","5XU","ZXD","ZXU","0xA","0xB","1xA","1xB","2xA","2xB","3xA","3xB","4xA","4xB","ZxA","ZxB","YxA","YxB","WxA","WxB","TxA","TxB","0xD","0xU","1xD","1xU","2xD","2xU","3xD","3xU","5xD","5xU","ZxD","ZxU"],Rib:["0RA","0RB","1RA","1RB","2RA","2RB","3RA","3RB","4RA","4RB","ZRA","ZRB","YRA","YRB","WRA","WRB","TRA","TRB","0RD","0RU","1RD","1RU","2RD","2RU","3RD","3RU","5RD","5RU","ZRD","ZRU","0rA","0rB","1rA","1rB","2rA","2rB","3rA","3rB","4rA","4rB","ZrA","ZrB","YrA","YrB","WrA","WrB","TrA","TrB","0rD","0rU","1rD","1rU","2rD","2rU","3rD","3rU","5rD","5rU","ZrD","ZrU"],Fru:["0CA","0CB","1CA","1CB","2CA","2CB","3CA","3CB","4CA","4CB","5CA","5CB","WCA","WCB","0CD","0CU","1CD","1CU","2CD","2CU","3CD","3CU","4CD","4CU","6CD","6CU","WCD","WCU","VCD","VCU","UCD","UCU","QCD","QCU","0cA","0cB","1cA","1cB","2cA","2cB","3cA","3cB","4cA","4cB","5cA","5cB","WcA","WcB","0cD","0cU","1cD","1cU","2cD","2cU","3cD","3cU","4cD","4cU","6cD","6cU","WcD","WcU","VcD","VcU","UcD","UcU","QcD","QcU"],Tag:["0JA","0JB","1JA","1JB","2JA","2JB","3JA","3JB","4JA","4JB","5JA","5JB","WJA","WJB","0JD","0JU","1JD","1JU","2JD","2JU","3JD","3JU","4JD","4JU","6JD","6JU","WJD","WJU","VJD","VJU","UJD","UJU","QJD","QJU","0jA","0jB","1jA","1jB","2jA","2jB","3jA","3jB","4jA","4jB","5jA","5jB","WjA","WjB","0jD","0jU","1jD","1jU","2jD","2jU","3jD","3jU","4jD","4jU","6jD","6jU","WjD","WjU","VjD","VjU","UjD","UjU","QjD","QjU"],Sor:["0BA","0BB","1BA","1BB","2BA","2BB","3BA","3BB","4BA","4BB","5BA","5BB","WBA","WBB","0BD","0BU","1BD","1BU","2BD","2BU","3BD","3BU","4BD","4BU","6BD","6BU","WBD","WBU","VBD","VBU","UBD","UBU","QBD","QBU","0bA","0bB","1bA","1bB","2bA","2bB","3bA","3bB","4bA","4bB","5bA","5bB","WbA","WbB","0bD","0bU","1bD","1bU","2bD","2bU","3bD","3bU","4bD","4bU","6bD","6bU","WbD","WbU","VbD","VbU","UbD","UbU","QbD","QbU"],Psi:["0PA","0PB","1PA","1PB","2PA","2PB","3PA","3PB","4PA","4PB","5PA","5PB","WPA","WPB","0PD","0PU","1PD","1PU","2PD","2PU","3PD","3PU","4PD","4PU","6PD","6PU","WPD","WPU","VPD","VPU","UPD","UPU","QPD","QPU","0pA","0pB","1pA","1pB","2pA","2pB","3pA","3pB","4pA","4pB","5pA","5pB","WpA","WpB","0pD","0pU","1pD","1pU","2pD","2pU","3pD","3pU","4pD","4pU","6pD","6pU","WpD","WpU","VpD","VpU","UpD","UpU","QpD","QpU"],Neu5Ac:["0SA","0SB","4SA","4SB","7SA","7SB","8SA","8SB","9SA","9SB","ASA","ASB","BSA","BSB","CSA","CSB","DSA","DSB","ESA","ESB","FSA","FSB","GSA","GSB","HSA","HSB","ISA","ISB","JSA","JSB","KSA","KSB","0sA","0sB","4sA","4sB","7sA","7sB","8sA","8sB","9sA","9sB","AsA","AsB","BsA","BsB","CsA","CsB","DsA","DsB","EsA","EsB","FsA","FsB","GsA","GsB","HsA","HsB","IsA","IsB","JsA","JsB","KsA","KsB"],Neu5Gc:["0GL","4GL","7GL","8GL","9GL","CGL","DGL","EGL","FGL","GGL","HGL","IGL","JGL","KGL","0gL","4gL","7gL","8gL","9gL","AgL","BgL","CgL","DgL","EgL","FgL","GgL","HgL","IgL","JgL","KgL"],Tyv:["YTV","4TV","2TV","1TV","0TV","YTv","4Tv","2Tv","1Tv","0Tv"],Abe:["YAE","2AE","4AE","1AE","0AE","YAe","4Ae","2Ae","1Ae","0Ae"],Bac:["0BC","1BC","3BC","0bC","1bC","3bC"],Kdn:["0KN","4KN","5KN","7KN","8KN","9KN","AKN","BKN","CKN","DKN","EKN","FKN","GKN","HKN","IKN","JKN","KKN","LKN","MKN","NKN","OKN","PKN","QKN","RKN","SKN","TKN","UKN","VKN","WKN","XKN","YKN","0Kn","4Kn","5Kn","7Kn","8Kn","9Kn","AKn","BKn","CKn","DKn","EKn","FKn","GKn","HKn","IKn","JKn","KKn","LKn","MKn","NKn","OKn","PKn","QKn","RKn","SKn","TKn","UKn","VKn","WKn","XKn","YKn"],Kdo:["0KO","4KO","5KO","7KO","8KO","AKO","BKO","CKO","DKO","EKO","FKO","GKO","HKO","IKO","JKO","KKO","0Ko","4Ko","5Ko","7Ko","8Ko","AKo","BKo","CKo","DKo","EKo","FKo","GKo","HKo","IKo","JKo","KKo"],QuiNAc:["0QF","1QF","3QF","0Qf","1Qf","3Qf"],AAT:["0FC","1FC","3FC","0Fc","1Fc","3Fc"],Ara4N:["ZaN","3aN","2aN","1aN","0aN","Zan","3an","2an","1an","0an"],Aci:["JeC","8eC","4eC","2eC","0eC","Jec","8ec","4ec","2ec","0ec"],Leg:["JLG","8LG","4LG","2LG","0LG","JLg","8Lg","4Lg","2Lg","0Lg"],Pse:["JmP","8mP","4mP","2mP","0mP","Jmp","8mp","4mp","2mp","0mp"],Fus:["EgF","HgF","JgF","8gF","KgF","7gF","4gF","2gF","0gF","Egf","Hgf","Jgf","8gf","Kgf","7gf","4gf","2gf","0gf"],DDmanpHep:["ODH","NDH","LDH","MDH","KDH","7DH","PDH","SDH","RDH","XDH","QDH","VDH","UDH","6DH","TDH","ZDH","YDH","2DH","WDH","3DH","4DH","1DH","ODh","NDh","LDh","MDh","KDh","7Dh","PDh","SDh","RDh","XDh","QDh","VDh","UDh","6Dh","TDh","ZDh","YDh","2Dh","WDh","3Dh","4Dh","1Dh"],LDmanpHep:["OLH","NLH","LLH","MLH","KLH","7LH","PLH","SLH","RLH","XLH","QLH","VLH","ULH","6LH","TLH","ZLH","YLH","2LH","WLH","3LH","4LH","1LH","OLh","NLh","LLh","MLh","KLh","7Lh","PLh","SLh","RLh","XLh","QLh","VLh","ULh","6Lh","TLh","ZLh","YLh","2Lh","WLh","3Lh","4Lh","1Lh"],K3O:["dKX","EKX","hKX","HKX","jKX","JKX","pKX","8KX","MKX","kKX","KKX","qKX","7KX","xKX","WKX","tKX","3KX","sKX","4KX","5KX","2KX","0KX","dKx","EKx","hKx","HKx","jKx","JKx","pKx","8Kx","MKx","kKx","KKx","qKx","7Kx","xKx","WKx","tKx","3Kx","sKx","4Kx","5Kx","2Kx","0Kx"],MurNAc:["UMR","4MR","6MR","1MR","0MR","UMr","4Mr","6Mr","1Mr","0Mr"],Oli:["WdR","4dR","3dR","1dR","0dR"],dUA:["Z45","345","245","145","045"],GlcNS:["QYS","UYS","VYS","6YS","WYS","4YS","3YS","1YS","0YS","QYs","UYs","VYs","6Ys","WYs","4Ys","3Ys","1Ys","0Ys","QyS","UyS","VyS","6yS","WyS","4yS","3yS","1yS","0yS","Qys","Uys","Vys","6ys","Wys","4ys","3ys","1ys","0ys"]},y=function(){const t=new Map;for(let e=0,n=d.length;e<n;++e){const n=d[e],r=h[n.abbr];if(r)for(let e=0,i=r.length;e<i;++e)t.set(r[e],n);const o=p[n.abbr];if(o)for(let e=0,i=o.length;e<i;++e)t.set(o[e],n)}return o.forEach(e=>{t.has(e)||t.set(e,l)}),t}(),_=function(){const t=new Map;for(let e=0,n=d.length;e<n;++e){const n=d[e],r=h[n.abbr];if(r)for(let e=0,s=r.length;e<s;++e)t.set(r[e],n);const o=p[n.abbr];if(o)for(let e=0,s=o.length;e<s;++e)t.set(o[e],n);const i=g[n.abbr];if(i)for(let e=0,s=i.length;e<s;++e)t.has(i[e])||t.set(i[e],n)}return o.forEach(e=>{t.has(e)||t.set(e,l)}),t}();function A(t){b="default"===t?y:_}let b=y},93273:function(t,e,n){var r;n.d(e,{u:function(){return r}}),function(t){t.create=function(t,e,n=Float32Array){const r=t*e;return{data:new n(r),size:r,cols:t,rows:e}},t.get=function(t,e,n){return t.data[t.rows*n+e]},t.set=function(t,e,n,r){return t.data[t.rows*n+e]=r,t},t.add=function(t,e,n,r){return t.data[t.rows*n+e]+=r,t},t.makeZero=function(t){return t.data.fill(0),t},t.clone=function(t){return{data:t.data.slice(),size:t.size,cols:t.cols,rows:t.rows}},t.fromArray=function(t,e,n){return{data:t,size:e*n,cols:e,rows:n}},t.transpose=function(t,e){if(t.cols!==e.rows||t.rows!==e.cols)throw new Error("transpose: matrix dimensions incompatible");if(t.data===e.data)throw new Error("transpose: matrices share memory");const n=e.rows,r=e.cols,o=e.data,i=t.data;for(let s=0,a=0,u=0;s<n;u+=1,a+=r,++s){let t=u;for(let e=0;e<r;t+=n,e++)i[t]=o[a+e]}return t},t.multiplyABt=function(t,e,n){const r=e.cols,o=e.rows,i=n.rows,s=e.data,a=n.data,u=t.data;for(let c=0,l=0,d=0;c<o;l+=r,c++)for(let t=0,e=0;e<i;d++,e++){let e=0,n=l;for(let o=0;o<r;n++,t++,o++)e+=s[n]*a[t];u[d]=e}return t},t.meanRows=function(t){const e=t.rows,n=t.cols,r=t.data,o=new Array(n);for(let i=0;i<n;++i)o[i]=0;for(let i=0,s=0;i<e;++i)for(let t=0;t<n;++t,++s)o[t]+=r[s];for(let i=0;i<n;++i)o[i]/=e;return o},t.subRows=function(t,e){const n=t.rows,r=t.cols,o=t.data;for(let i=0,s=0;i<n;++i)for(let t=0;t<r;++t,++s)o[s]-=e[t];return t}}(r||(r={}))},93739:function(t,e,n){n.d(e,{v:function(){return r}});var r,o=n(52500),i=n(15819),s=n(61198),a=n(27125),u=n(58392);function c(t,e,n,r,o,i){const{auth_seq_id:s,label_seq_id:a,pdbx_PDB_ins_code:u}=t.residues,{endSeqId:c,endInsCode:l,key:d,type:f}=n,m="label"===e?a:s;let h=r;for(;h<o;){const t=m.value(h);if(i.type[h]=f,i.key[h]=d,t>c||t===c&&u.value(h)===l)break;h++}}!function(t){t.Descriptor={name:"model_secondary_structure"},t.Provider=u.q.create(t.Descriptor),t.fromStruct=function(t,e,n){const r=new Map,u=[{kind:"none"}],l=function(t,e){if(t._rowCount>0){if(t.beg_label_seq_id.valueKind(0)!==a.VP.ValueKinds.Present||t.end_label_seq_id.valueKind(0)!==a.VP.ValueKinds.Present)return"auth"}else if(e&&(e.beg_label_seq_id.valueKind(0)!==a.VP.ValueKinds.Present||e.end_label_seq_id.valueKind(0)!==a.VP.ValueKinds.Present))return"auth";return"label"}(t,e);!function(t,e,n,r){if(!t._rowCount)return;const{beg_label_asym_id:i,beg_label_seq_id:s,beg_auth_seq_id:u,pdbx_beg_PDB_ins_code:c}=t,{end_label_seq_id:l,end_auth_seq_id:d,pdbx_end_PDB_ins_code:f}=t,{pdbx_PDB_helix_class:m,conf_type_id:h,details:p}=t,g="label"===e?s:u,y="label"===e?l:d;for(let _=0,A=t._rowCount;_<A;_++){const t=o.gG.create(m.valueKind(_)===a.VP.ValueKinds.Present?o.gG.SecondaryStructurePdb[m.value(_)]:h.valueKind(_)===a.VP.ValueKinds.Present?o.gG.SecondaryStructureMmcif[h.value(_)]:o.gG.Flag.NA),e={kind:"helix",flags:t,type_id:h.valueKind(_)===a.VP.ValueKinds.Present?h.value(_):"helx_p",helix_class:m.value(_),details:p.valueKind(_)===a.VP.ValueKinds.Present?p.value(_):void 0},s={startSeqId:g.value(_),startInsCode:c.value(_),endSeqId:y.value(_),endInsCode:f.value(_),type:t,key:r.length};r[r.length]=e;const u=i.value(_);if(n.has(u)){const t=n.get(u);t.has(s.startSeqId)?t.get(s.startSeqId).push(s):t.set(s.startSeqId,[s])}else n.set(u,new Map([[s.startSeqId,[s]]]))}}(t,l,r,u),function(t,e,n,r,i){if(!t._rowCount)return;const{beg_label_asym_id:s,beg_label_seq_id:a,beg_auth_seq_id:u,pdbx_beg_PDB_ins_code:c}=t,{end_label_seq_id:l,end_auth_seq_id:d,pdbx_end_PDB_ins_code:f}=t,{sheet_id:m}=t,h="label"===e?a:u,p="label"===e?l:d,g=new Map;let y=r+1;for(let _=0,A=t._rowCount;_<A;_++){const t=m.value(_);let e;g.has(t)?e=g.get(t):(e=y++,g.set(t,e));const r=o.gG.create(o.gG.Flag.Beta|o.gG.Flag.BetaSheet),a={kind:"sheet",flags:r,sheet_id:t,symmetry:void 0},u={startSeqId:h.value(_),startInsCode:c.value(_),endSeqId:p.value(_),endInsCode:f.value(_),type:r,key:i.length};i[i.length]=a;const l=s.value(_);if(n.has(l)){const t=n.get(l);t.has(u.startSeqId)?t.get(u.startSeqId).push(u):t.set(u.startSeqId,[u])}else n.set(l,new Map([[u.startSeqId,[u]]]))}}(e,l,r,t._rowCount,u);const d=n.residues._rowCount,f={type:new Int32Array(d),key:new Int32Array(d),elements:u};return r.size>0&&function(t,e,n,r){const{count:o}=t.chainAtomSegments,{label_asym_id:s}=t.chains,{auth_seq_id:a,label_seq_id:u,pdbx_PDB_ins_code:l}=t.residues,d="label"===e?u:a;for(let f=0;f<o;f++){const o=i.vE.chainStartResidueIndex(t,f),a=i.vE.chainEndResidueIndexExcl(t,f),u=s.value(f);if(n.has(u)){const i=n.get(u);for(let n=o;n<a;n++){const o=d.value(n);if(i.has(o)){const s=i.get(o);for(const o of s){const i=l.value(n);o.startInsCode===i&&c(t,e,o,n,a,r)}}}}}}(n,l,r,f),(0,s.M)(f.type,f.key,f.elements,t=>t)}}(r||(r={}))},93818:function(t,e,n){n.d(e,{X:function(){return _},g:function(){return v}});var r,o=n(65533),i=n(40319),s=n(52500),a=n(38530),u=n(31186);function c(t){const e=function(t){const e=o.hT.transientSegments(t.model.atomicHierarchy.residueAtomSegments,t.elements);let n=0;for(;e.hasNext;){const t=e.move();n=Math.max(n,t.end-t.start)}return n}(t),n=function(t,e){return{startVertex:0,endVertex:0,count:0,isRingAtom:new Int32Array(e),marked:new Int32Array(e),queue:new Int32Array(e),pred:new Int32Array(e),depth:new Int32Array(e),left:new Int32Array(r.MaxDepth),right:new Int32Array(r.MaxDepth),color:new Int32Array(e),currentColor:0,currentAltLoc:"",hasAltLoc:!1,rings:[],currentRings:[],unit:t,bonds:t.bonds,altLoc:t.model.atomicHierarchy.atoms.label_alt_id}}(t,e),i=o.hT.transientSegments(t.model.atomicHierarchy.residueAtomSegments,t.elements);for(;i.hasNext;){const t=i.move();m(n,t.start,t.end)}return n.rings}function l(t){t.count=t.endVertex-t.startVertex;const{isRingAtom:e,pred:n,color:r,depth:o,marked:i}=t;for(let s=0;s<t.count;s++)e[s]=0,n[s]=-1,i[s]=-1,r[s]=0,o[s]=0;t.currentColor=0,t.currentAltLoc="",t.hasAltLoc=!1}function d(t){const{depth:e}=t;for(let n=0;n<t.count;n++)e[n]=t.count+1}function f(t,e){const n=t.bonds.offset,r=t.startVertex+e,o=n[r],i=n[r+1]-o;return!(i<=1||t.isRingAtom[e]&&2===i)}function m(t,e,n){if(t.startVertex=e,t.endVertex=n,t.endVertex-t.startVertex<3)return;t.currentRings=[];const{elements:r}=t.unit,o=[];for(let s=t.startVertex;s<t.endVertex;s++){const e=t.altLoc.value(r[s]);(0,u.Z2)(o,e)}(0,u.K3)(o,"");let i=1;if(0===o.length){l(t);for(let e=0;e<t.count;e++)f(t,e)&&(d(t),i=p(t,e,i))}else for(let s=0;s<o.length;s++){l(t),t.hasAltLoc=!0,t.currentAltLoc=o[s];for(let e=0;e<t.count;e++){if(!f(t,e))continue;const n=t.altLoc.value(r[t.startVertex+e]);n&&n!==t.currentAltLoc||(d(t),i=p(t,e,i))}}for(let s=0,a=t.currentRings.length;s<a;s++)t.rings.push(t.currentRings[s])}function h(t,e,n,i){if(n<e)return!1;const{pred:s,color:u,left:c,right:l}=t,d=++t.currentColor;let f=e;for(let o=0;o<r.MaxDepth&&(u[f]=d,f=s[f],!(f<0));o++);let m=0,h=0,p=!1,g=0;f=n;for(let o=0;o<r.MaxDepth;o++){if(u[f]===d){g=f,p=!0;break}if(l[h++]=f,f=s[f],f<0)break}if(!p)return!1;f=e;for(let o=0;o<r.MaxDepth&&(c[m++]=f,g!==f)&&(f=s[f],!(f<0));o++);const y=m+h;if(y<3)return!1;const _=new Int32Array(y);let A=0;for(let r=0;r<m;r++)_[A++]=t.startVertex+c[r],i[c[r]]=1;for(let r=h-1;r>=0;r--)_[A++]=t.startVertex+l[r],i[l[r]]=1;(0,a.eh)(_);for(let r=0,a=t.currentRings.length;r<a;r++){const e=t.currentRings[r];if(_.length===e.length){if(o.X9.areEqual(_,e))return!1}else if(_.length>e.length&&o.X9.isSubset(_,e))return!1}return t.currentRings.push(o.X9.ofSortedArray(_)),!0}function p(t,e,n){const{bonds:o,startVertex:i,endVertex:a,isRingAtom:u,marked:c,queue:l,pred:d,depth:f}=t,{elements:m}=t.unit,{b:p,edgeProps:{flags:g},offset:y}=o;c[e]=n,f[e]=0,l[0]=e;let _=0,A=1;for(;_<A;){const e=l[_++],o=f[e],b=i+e,C=y[b],S=y[b+1];for(let y=C;y<S;y++){const _=p[y];if(_<i||_>=a||!s.I$.isCovalent(g[y]))continue;if(t.hasAltLoc){const e=t.altLoc.value(m[_]);if(e&&t.currentAltLoc!==e)continue}const b=_-i;if(c[b]===n){if(d[b]!==e&&d[e]!==b&&h(t,e,b,u))return n+1;continue}const C=Math.min(f[b],o+1);C>r.MaxDepth||(f[b]=C,c[b]=n,l[A++]=b,d[b]=e)}}return n+1}function g(t){const e=t.length,n=new Int32Array(2*e);for(let s=0;s<n.length;s++)n[s]=-1;let r="",o="",i=0;for(let s=1;s<n.length;s++){let a=n[s-i-1];for(;-1!==a&&(r=t[s%e],o=t[(i+a+1)%e],r!==o);)r<o&&(i=s-a-1),a=n[a];-1===a?(r=t[s%e],o=t[(i+a+1)%e],r!==o?(r<o&&(i=s),n[s-i]=-1):n[s-i]=a+1):n[s-i]=a+1}return i}function y(t,e){const n=t.length,r=[];let o;for(o=0;o<n-1;o++)r.push(t[(o+e)%n]),r.push("-");return r.push(t[(o+e)%n]),r.join("")}!function(t){t[t.MaxDepth=5]="MaxDepth"}(r||(r={}));var _,A=n(69926),b=n(96401),C=n(3108),S=n(75847),x=n(73868);class v{get index(){return this._index||(this._index=function(t,e){const n=new Map,r=new Map;for(let i=0,c=t.length;i<c;i++){const e=t[i];for(let t=0,r=e.length;t<r;t++){const r=e[t];n.has(r)?n.get(r).push(i):n.set(r,[i])}}for(let i=0,c=e.length;i<c;i++){const n=e[i],o=t[n];for(let t=0,e=o.length;t<e;t++){const e=o[t];r.has(e)?r.get(e).push(n):r.set(e,[n])}}const o=new i.O.UniqueEdgeBuilder(t.length);for(let i=0,c=t.length;i<c;i++){const e=t[i];for(let t=0,r=e.length;t<r;t++){const r=e[t],s=n.get(r);if(1!==s.length)for(let t=0,e=s.length;t<e;t++){const e=s[t];i>=e||o.addEdge(i,e)}}}const s=i.O.connectedComponents(o.getGraph()),a=s.componentIndex,u=[];for(let i=0;i<s.componentCount;i++)u[i]=[];for(let i=0,c=t.length;i<c;i++)u[a[i]].push(i);return{elementRingIndices:n,elementAromaticRingIndices:r,ringComponentIndex:a,ringComponents:u}}(this.all,this.aromaticRings)),this._index}get byFingerprint(){return this._byFingerprint||(this._byFingerprint=function(t,e){const n=new Map;let r=0;for(let o=0,i=e.length;o<i;o++){const i=e[o],s=_.fingerprint(t,i);n.has(s)?n.get(s).push(r):n.set(s,[r]),r++}return n}(this.unit,this.all)),this._byFingerprint}get elementRingIndices(){return this.index.elementRingIndices}get elementAromaticRingIndices(){return this.index.elementAromaticRingIndices}get ringComponentIndex(){return this.index.ringComponentIndex}get ringComponents(){return this.index.ringComponents}get aromaticRings(){return this._aromaticRings||(this._aromaticRings=function(t,e){const n=[];for(let r=0,o=e.length;r<o;++r)_.isAromatic(t,e[r])&&n.push(r);return n}(this.unit,this.all)),this._aromaticRings}constructor(t,e){this.unit=e,this.all=t}}function B(t,e){const{elements:n}=t,r=t.model.atomicHierarchy.residueAtomSegments.index,o=r[n[e[0]]];for(let i=1,s=e.length;i<s;i++)if(o!==r[n[e[i]]])return-1;return o}function I(t,e,n){const r=t.byFingerprint.get(e);if(r)for(let o=0,i=r.length;o<i;o++){const e=r[o],i=B(t.unit,t.all[e]);i>=0&&(n.has(i)?n.get(i).push(e):n.set(i,[e]))}}!function(t){function e(t){return function(t){const e=t.length,n=new Array(e);for(let s=0;s<e;s++)n[s]=t[e-s-1];const r=g(t),o=g(n);let i=!1;for(let s=0;s<e;s++){const a=t[(s+r)%e],u=n[(s+o)%e];if(a!==u){i=a<u;break}}return i?y(t,r):y(n,o)}(t)}t.fingerprint=function(t,n){const{elements:r}=t,{type_symbol:o}=t.model.atomicHierarchy.atoms,i=[];for(let e=0,s=n.length;e<s;e++)i[i.length]=o.value(r[n[e]]);return e(i)},t.elementFingerprint=e;const n=new Set([b.S8.B,b.S8.C,b.S8.N,b.S8.O,b.S8.SI,b.S8.P,b.S8.S,b.S8.GE,b.S8.AS,b.S8.SN,b.S8.SB,b.S8.BI]);t.isAromatic=function(t,e){const{elements:r,bonds:{b:i,offset:a,edgeProps:{flags:u}}}=t,{type_symbol:c,label_comp_id:l}=t.model.atomicHierarchy.atoms;if("PRO"===l.value(t.elements[e[0]]))return!1;let d=0,f=!1;for(let h=0,p=e.length;h<p;++h){const t=e[h];!f&&n.has(c.value(r[t]))&&(f=!0);for(let n=a[t],r=a[t+1];n<r;++n)s.I$.is(s.I$.Flag.Aromatic,u[n])&&o.X9.has(e,i[n])&&(d+=1)}if(d===2*e.length)return!0;if(!f)return!1;if(e.length<5)return!1;if(d>0)return!1;const m=S.c.calculateMomentsAxes((0,C.Dt)(t,e));return x.eB.magnitude(m.dirC)<.05},t.getAltId=function(t,e){const{label_alt_id:n}=t.model.atomicHierarchy.atoms,{elements:r}=t;for(let o=0,i=e.length;o<i;++o){const t=r[e[o]],i=n.value(t);if(i)return i}return""}}(_||(_={})),function(t){t.create=function(e){if(A.N.Traits.is(e.traits,A.N.Trait.Water)||A.N.Traits.is(e.traits,A.N.Trait.CoarseGrained))return new t([],e);const n=c(e);return new t(n,e)},t.byFingerprintAndResidue=function(t,e){const n=new Map;for(let r=0,o=e.length;r<o;r++){I(t,e[r],n)}return n}}(v||(v={}))},94106:function(t,e,n){function r(t,e,n){for(;e<n&&32===t.charCodeAt(e);)e++;return o(t,e,n)}function o(t,e,n){let r=e,o=0,i=1;for(45===t.charCodeAt(r)?(i=-1,++r):43===t.charCodeAt(r)&&++r;r<n;r++){const e=t.charCodeAt(r)-48;if(e>9||e<0)return i*o|0;o=10*o+e|0}return i*o}function i(t,e,n,r){return 43===e.charCodeAt(n)&&n++,t*Math.pow(10,o(e,n,r))}function s(t,e,n){for(;e<n&&32===t.charCodeAt(e);)e++;return a(t,e,n)}function a(t,e,n){let r=e,o=1,s=0,a=0,u=1;for(45===t.charCodeAt(r)?(o=-1,++r):43===t.charCodeAt(r)&&++r;r<n;){let e=t.charCodeAt(r)-48;if(!(e>=0&&e<10)){if(-2===e){for(++r;r<n;){if(e=t.charCodeAt(r)-48,!(e>=0&&e<10))return 53===e||21===e?i(o*(s+a/u),t,r+1,n):o*(s+a/u);a=10*a+e,u*=10,++r}return o*(s+a/u)}if(53===e||21===e)return i(o*s,t,r+1,n);break}s=10*s+e,++r}return o*s}var u;n.d(e,{Al:function(){return s},H9:function(){return o},jj:function(){return r},sS:function(){return a}}),function(t){t[t.Int=0]="Int",t[t.Float=1]="Float",t[t.Scientific=2]="Scientific",t[t.NaN=3]="NaN"}(u||(u={}));u.Int,u.Float,u.Scientific,u.NaN},94830:function(t,e,n){n.d(e,{LQ:function(){return o},Mx:function(){return i},Sn:function(){return s}});var r=n(86242);const o={is(t){return"function"==typeof t.charCodeAt},toString(t){try{return t.toString()}catch(e){throw new Error(`Failed to convert StringLike object into string. This might be because the length ${t.length} exceeds maximum allowed string length ${i}. (${e})`)}}},i=536870888;class s{get length(){return this._length}constructor(t=28){this._chunks=[],this._length=0,this._tmpArray=[],this.STRING_CHUNK_SIZE=2**t,this.STRING_CHUNK_SHIFT=t,this.STRING_CHUNK_MASK=2**t-1}static fromString(t,e=28){const n=new s(e);return n._append(t),n}static fromStrings(t,e=28){const n=new s(e);for(const r of t)n._append(r);return n}static fromUtf8Data(t,e=0,n=t.length,o=28){const i=2**o,a=[];let u=e;for(;u<n;){let e=Math.min(u+i,n);if(e<n)for(;128==(192&t[e]);)if(e--,e===u)throw new Error("Input is rubbish, no UTF-8 character start found in a chunk");const o=(0,r.ss)(t,u,e-u);a.push(o),u=e}return s.fromStrings(a,o)}_append(t){const e=this.STRING_CHUNK_SIZE,n=0===this._chunks.length||this._chunks[this._chunks.length-1].length===e?"":this._chunks.pop();let r=e-n.length;for(this._chunks.push(n+t.substring(0,r));r<t.length;)this._chunks.push(t.substring(r,r+e)),r+=e;this._length+=t.length}_getChunkIndex(t){return t>>>this.STRING_CHUNK_SHIFT}_getIndexInChunk(t){return t&this.STRING_CHUNK_MASK}_isOutOfRange(t){return t<0||t>=this.length}at(t){return-this.length<=t&&t<0?this.at(t+this.length):this.charAt(t)||void 0}charAt(t){if(this._isOutOfRange(t))return"";const e=this._getChunkIndex(t),n=this._getIndexInChunk(t);return this._chunks[e][n]}charCodeAt(t){if(this._isOutOfRange(t))return NaN;const e=this._getChunkIndex(t),n=this._getIndexInChunk(t);return this._chunks[e].charCodeAt(n)}substring(t,e){const n=Math.min(Math.max(null!=t?t:0,0),this.length),r=Math.min(Math.max(null!=e?e:this.length,0),this.length);if(n>r)return this.substring(r,n);if(n===r)return"";if(r-n>i)throw new Error(`Trying to create get a substring longer (${r-n}) than maximum allowed string length (${i}).`);const o=this._getChunkIndex(n),s=this._getIndexInChunk(n),a=this._getChunkIndex(r),u=this._getIndexInChunk(r);if(o===a)return this._chunks[o].substring(s,u);{const t=this._getTmpArray();t.push(this._chunks[o].substring(s,this.STRING_CHUNK_SIZE));for(let e=o+1;e<a;e++)t.push(this._chunks[e]);return t.push(this._chunks[a].substring(0,u)),t.join("")}}_getTmpArray(){for(;this._tmpArray.length;)this._tmpArray.pop();return this._tmpArray}indexOf(t,e=0){if(t.length>this.STRING_CHUNK_SIZE)throw new Error("NotImplementedError: indexOf is only implemented for searchString shorter than STRING_CHUNK_SIZE");e<0&&(e=0);const n=this._getChunkIndex(e);for(let r=n;r<this._chunks.length;r++){const o=this._chunks[r],i=r===n?this._getIndexInChunk(e):0,s=o.indexOf(t,i);if(s>=0)return r*this.STRING_CHUNK_SIZE+s;if(r!==this._chunks.length-1){const e=Math.max(this.STRING_CHUNK_SIZE-t.length+1,i),n=(o.substring(e,void 0)+this._chunks[r+1].substring(0,t.length-1)).indexOf(t);if(n>=0)return r*this.STRING_CHUNK_SIZE+e+n}}return-1}includes(t,e=0){return this.indexOf(t,e)>=0}startsWith(t,e=0){if(t.length>this.STRING_CHUNK_SIZE)throw new Error("NotImplementedError: startsWith is only implemented for searchString shorter than STRING_CHUNK_SIZE");return this.substring(e,e+t.length)===t}toString(){try{return this._chunks.join("")}catch(t){throw new Error(`Failed to convert StringLike object into string. This might be because the length ${this.length} exceeds maximum allowed string length ${i}. (${t})`)}}}},94901:function(t,e,n){n.d(e,{z:function(){return r}});var r,o=n(40319),i=n(58392),s=n(52500);!function(t){t.Descriptor={name:"index_pair_bonds"},t.Provider=i.q.create(t.Descriptor,{asDynamic:!0}),t.DefaultProps={maxDistance:-1,cacheable:!0},t.fromData=function(e,n={}){const r={...t.DefaultProps,...n},{pairs:i,count:a}=e,u=i.indexA.toArray(),c=i.indexB.toArray(),l=i.key&&i.key.toArray(),d=i.operatorA&&i.operatorA.toArray(),f=i.operatorB&&i.operatorB.toArray(),m=i.order&&i.order.toArray(),h=i.distance&&i.distance.toArray(),p=i.flag&&i.flag.toArray();let g=!1;if(d&&f){g=!0;for(let t=0,e=d.length;t<e;++t)if(-1===d[t]||-1===f[t]){g=!1;break}}const y=function(t,e,n,r){const i=new o.O.EdgeBuilder(r,t,e),a=new Int32Array(i.slotCount),u=new Array(i.slotCount),c=new Array(i.slotCount),l=new Int8Array(i.slotCount),d=new Array(i.slotCount),f=new Array(i.slotCount);for(let o=0,m=i.edgeCount;o<m;o++)i.addNextEdge(),i.assignProperty(a,n.key?n.key[o]:-1),i.assignDirectedProperty(u,n.operatorA?n.operatorA[o]:-1,c,n.operatorB?n.operatorB[o]:-1),i.assignProperty(l,n.order?n.order[o]:1),i.assignProperty(d,n.distance?n.distance[o]:-1),i.assignProperty(f,n.flag?n.flag[o]:s.I$.Flag.Covalent);return i.createGraph({key:a,operatorA:u,operatorB:c,order:l,distance:d,flag:f})}(u,c,{key:l,operatorA:d,operatorB:f,order:m,distance:h,flag:p},a),_=new Map;if(g){const{operatorA:t,operatorB:e}=y.edgeProps;for(let n=0,r=t.length;n<r;++n)if(t[n]===e[n]){const e=t[n];_.has(e)?_.get(e).push(n):_.set(e,[n])}}return{bonds:y,maxDistance:r.maxDistance,cacheable:r.cacheable,hasOperators:g,bySameOperator:_}},t.getEdgeIndexForOperators=function(t,e,n,r,o){let i,s,a,u;e<n?(i=e,s=n,a=r,u=o):(i=n,s=e,a=o,u=r);for(let c=t.offset[i],l=t.offset[i+1];c<l;c++)if(t.b[c]===s&&t.edgeProps.operatorA[c]===a&&t.edgeProps.operatorB[c]===u)return c;return-1}}(r||(r={}))},95156:function(t,e,n){n.d(e,{$:function(){return a}});var r=n(35695),o=n(98537),i=n(78605),s=n(75849);function a(){return a.zero()}!function(t){function e(){const t=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];return t[0]=0,t}function n(){const t=e();return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function a(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function u(t){for(let e=0;e<16;e++)t[e]=0;return t}t.zero=e,t.identity=n,t.setIdentity=a,t.isZero=function(t){for(let e=0;e<16;e++)if(0!==t[e])return!1;return!0},t.setZero=u,t.ofRows=function(t){const n=e();for(let e=0;e<4;e++){const r=t[e];for(let t=0;t<4;t++)n[4*t+e]=r[t]}return n};const c=n();function l(t,e,n){for(let r=0;r<16;r++)if(Math.abs(t[r]-e[r])>n)return!1;return!0}function d(t,e,n,r){t[4*n+e]=r}function f(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function m(t,e){const n=e[0]+e[5]+e[10];let r=0;return n>0?(r=2*Math.sqrt(n+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t}function h(t,e){const n=e[0],r=e[1],o=e[2],i=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=e[8],d=e[9],f=e[10],m=e[11],h=e[12],p=e[13],g=e[14],y=e[15],_=n*a-r*s,A=n*u-o*s,b=n*c-i*s,C=r*u-o*a,S=r*c-i*a,x=o*c-i*u,v=l*p-d*h,B=l*g-f*h,I=l*y-m*h,w=d*g-f*p,P=d*y-m*p,D=f*y-m*g;let M=_*D-A*P+b*w+C*I-S*B+x*v;return!!M&&(M=1/M,t[0]=(a*D-u*P+c*w)*M,t[1]=(o*P-r*D-i*w)*M,t[2]=(p*x-g*S+y*C)*M,t[3]=(f*S-d*x-m*C)*M,t[4]=(u*I-s*D-c*B)*M,t[5]=(n*D-o*I+i*B)*M,t[6]=(g*b-h*x-y*A)*M,t[7]=(l*x-f*b+m*A)*M,t[8]=(s*P-a*I+c*v)*M,t[9]=(r*I-n*P-i*v)*M,t[10]=(h*S-p*b+y*_)*M,t[11]=(d*b-l*S-m*_)*M,t[12]=(a*B-s*w-u*v)*M,t[13]=(n*w-r*B+o*v)*M,t[14]=(p*A-h*C-g*_)*M,t[15]=(l*C-d*A+f*_)*M,!0)}function p(t,e,n){const r=e[0],o=e[1],i=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],d=e[8],f=e[9],m=e[10],h=e[11],p=e[12],g=e[13],y=e[14],_=e[15];let A=n[0],b=n[1],C=n[2],S=n[3];return t[0]=A*r+b*a+C*d+S*p,t[1]=A*o+b*u+C*f+S*g,t[2]=A*i+b*c+C*m+S*y,t[3]=A*s+b*l+C*h+S*_,A=n[4],b=n[5],C=n[6],S=n[7],t[4]=A*r+b*a+C*d+S*p,t[5]=A*o+b*u+C*f+S*g,t[6]=A*i+b*c+C*m+S*y,t[7]=A*s+b*l+C*h+S*_,A=n[8],b=n[9],C=n[10],S=n[11],t[8]=A*r+b*a+C*d+S*p,t[9]=A*o+b*u+C*f+S*g,t[10]=A*i+b*c+C*m+S*y,t[11]=A*s+b*l+C*h+S*_,A=n[12],b=n[13],C=n[14],S=n[15],t[12]=A*r+b*a+C*d+S*p,t[13]=A*o+b*u+C*f+S*g,t[14]=A*i+b*c+C*m+S*y,t[15]=A*s+b*l+C*h+S*_,t}function g(t,e,n,r){return t[0]=n[0],t[4]=n[1],t[8]=n[2],t[1]=r[0],t[5]=r[1],t[9]=r[2],t[2]=e[0],t[6]=e[1],t[10]=e[2],t}function y(t,e,n){let o=n[0],i=n[1],s=n[2],u=Math.sqrt(o*o+i*i+s*s);if(Math.abs(u)<r.p)return a(t);u=1/u,o*=u,i*=u,s*=u;const c=Math.sin(e),l=Math.cos(e),d=1-l;return t[0]=o*o*d+l,t[1]=i*o*d+s*c,t[2]=s*o*d-i*c,t[3]=0,t[4]=o*i*d-s*c,t[5]=i*i*d+l,t[6]=s*i*d+o*c,t[7]=0,t[8]=o*s*d+i*c,t[9]=i*s*d-o*c,t[10]=s*s*d+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}t.isIdentity=function(t,e){return l(t,c,void 0===e?r.p:e)},t.hasNaN=function(t){for(let e=0;e<16;e++)if(Number.isNaN(t[e]))return!0;return!1},t.areEqual=l,t.setValue=d,t.getValue=function(t,e,n){return t[4*n+e]},t.toArray=function(t,e,n){return e[n+0]=t[0],e[n+1]=t[1],e[n+2]=t[2],e[n+3]=t[3],e[n+4]=t[4],e[n+5]=t[5],e[n+6]=t[6],e[n+7]=t[7],e[n+8]=t[8],e[n+9]=t[9],e[n+10]=t[10],e[n+11]=t[11],e[n+12]=t[12],e[n+13]=t[13],e[n+14]=t[14],e[n+15]=t[15],e},t.fromArray=function(t,e,n){return t[0]=e[n+0],t[1]=e[n+1],t[2]=e[n+2],t[3]=e[n+3],t[4]=e[n+4],t[5]=e[n+5],t[6]=e[n+6],t[7]=e[n+7],t[8]=e[n+8],t[9]=e[n+9],t[10]=e[n+10],t[11]=e[n+11],t[12]=e[n+12],t[13]=e[n+13],t[14]=e[n+14],t[15]=e[n+15],t},t.fromBasis=function(t,e,n,r){return u(t),d(t,0,0,e[0]),d(t,1,0,e[1]),d(t,2,0,e[2]),d(t,0,1,n[0]),d(t,1,1,n[1]),d(t,2,1,n[2]),d(t,0,2,r[0]),d(t,1,2,r[1]),d(t,2,2,r[2]),d(t,3,3,1),t},t.copy=f,t.clone=function(t){return f(e(),t)},t.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},t.getScaling=function(t,e){const n=e[0],r=e[1],o=e[2],i=e[4],s=e[5],a=e[6],u=e[8],c=e[9],l=e[10];return t[0]=Math.sqrt(n*n+r*r+o*o),t[1]=Math.sqrt(i*i+s*s+a*a),t[2]=Math.sqrt(u*u+c*c+l*l),t},t.getRotation=m,t.extractRotation=function(t,e){const n=1/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),r=1/Math.sqrt(e[4]*e[4]+e[5]*e[5]+e[6]*e[6]),o=1/Math.sqrt(e[8]*e[8]+e[9]*e[9]+e[10]*e[10]);return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=0,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=0,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.transpose=function(t,e){if(t===e){const n=e[1],r=e[2],o=e[3],i=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=i,t[11]=e[14],t[12]=o,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},t.tryInvert=h,t.invert=function(t,e){return h(t,e)||console.warn("non-invertible matrix.",e),t},t.mul=p,t.mulOffset=function(t,e,n,r,o,i){const s=e[0+o],a=e[1+o],u=e[2+o],c=e[3+o],l=e[4+o],d=e[5+o],f=e[6+o],m=e[7+o],h=e[8+o],p=e[9+o],g=e[10+o],y=e[11+o],_=e[12+o],A=e[13+o],b=e[14+o],C=e[15+o];let S=n[0+i],x=n[1+i],v=n[2+i],B=n[3+i];return t[0+r]=S*s+x*l+v*h+B*_,t[1+r]=S*a+x*d+v*p+B*A,t[2+r]=S*u+x*f+v*g+B*b,t[3+r]=S*c+x*m+v*y+B*C,S=n[4+i],x=n[5+i],v=n[6+i],B=n[7+i],t[4+r]=S*s+x*l+v*h+B*_,t[5+r]=S*a+x*d+v*p+B*A,t[6+r]=S*u+x*f+v*g+B*b,t[7+r]=S*c+x*m+v*y+B*C,S=n[8+i],x=n[9+i],v=n[10+i],B=n[11+i],t[8+r]=S*s+x*l+v*h+B*_,t[9+r]=S*a+x*d+v*p+B*A,t[10+r]=S*u+x*f+v*g+B*b,t[11+r]=S*c+x*m+v*y+B*C,S=n[12+i],x=n[13+i],v=n[14+i],B=n[15+i],t[12+r]=S*s+x*l+v*h+B*_,t[13+r]=S*a+x*d+v*p+B*A,t[14+r]=S*u+x*f+v*g+B*b,t[15+r]=S*c+x*m+v*y+B*C,t},t.mul3=function(t,e,n,r){return p(t,p(t,e,n),r)},t.translate=function(t,e,n){const r=n[0],o=n[1],i=n[2];let s,a,u,c,l,d,f,m,h,p,g,y;return e===t?(t[12]=e[0]*r+e[4]*o+e[8]*i+e[12],t[13]=e[1]*r+e[5]*o+e[9]*i+e[13],t[14]=e[2]*r+e[6]*o+e[10]*i+e[14],t[15]=e[3]*r+e[7]*o+e[11]*i+e[15]):(s=e[0],a=e[1],u=e[2],c=e[3],l=e[4],d=e[5],f=e[6],m=e[7],h=e[8],p=e[9],g=e[10],y=e[11],t[0]=s,t[1]=a,t[2]=u,t[3]=c,t[4]=l,t[5]=d,t[6]=f,t[7]=m,t[8]=h,t[9]=p,t[10]=g,t[11]=y,t[12]=s*r+l*o+h*i+e[12],t[13]=a*r+d*o+p*i+e[13],t[14]=u*r+f*o+g*i+e[14],t[15]=c*r+m*o+y*i+e[15]),t},t.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},t.setTranslation=function(t,e){return t[12]=e[0],t[13]=e[1],t[14]=e[2],t},t.setAxes=g,t.rotate=function(t,e,o,i){let s=i[0],a=i[1],u=i[2],c=Math.sqrt(s*s+a*a+u*u);if(Math.abs(c)<r.p)return n();c=1/c,s*=c,a*=c,u*=c;const l=Math.sin(o),d=Math.cos(o),f=1-d,m=e[0],h=e[1],p=e[2],g=e[3],y=e[4],_=e[5],A=e[6],b=e[7],C=e[8],S=e[9],x=e[10],v=e[11],B=s*s*f+d,I=a*s*f+u*l,w=u*s*f-a*l,P=s*a*f-u*l,D=a*a*f+d,M=u*a*f+s*l,N=s*u*f+a*l,E=a*u*f-s*l,k=u*u*f+d;return t[0]=m*B+y*I+C*w,t[1]=h*B+_*I+S*w,t[2]=p*B+A*I+x*w,t[3]=g*B+b*I+v*w,t[4]=m*P+y*D+C*M,t[5]=h*P+_*D+S*M,t[6]=p*P+A*D+x*M,t[7]=g*P+b*D+v*M,t[8]=m*N+y*E+C*k,t[9]=h*N+_*E+S*k,t[10]=p*N+A*E+x*k,t[11]=g*N+b*E+v*k,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t},t.fromRotation=y,t.scale=function(t,e,n){const r=n[0],o=n[1],i=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*o,t[5]=e[5]*o,t[6]=e[6]*o,t[7]=e[7]*o,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.scaleUniformly=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.fromUniformScaling=function(t,e){return t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t};const _=[0,0,0],A=[0,0,0];t.fromPlane=function(t,e,n){const i=o.e.cross(_,e,o.e.unitX);o.e.dot(i,i)<r.p&&o.e.cross(i,e,o.e.unitY),o.e.normalize(i,i);const s=o.e.cross(A,e,i);return o.e.normalize(s,s),g(t,e,i,s),t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},t.fromMat3=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[4]=e[3],t[5]=e[4],t[6]=e[5],t[8]=e[6],t[9]=e[7],t[10]=e[8],t},t.compose=function(t,e,n,r){const[o,i,s,a]=n,u=o+o,c=i+i,l=s+s,d=o*u,f=o*c,m=o*l,h=i*c,p=i*l,g=s*l,y=a*u,_=a*c,A=a*l,[b,C,S]=r;return t[0]=(1-(h+g))*b,t[1]=(f+A)*b,t[2]=(m-_)*b,t[3]=0,t[4]=(f-A)*C,t[5]=(1-(d+g))*C,t[6]=(p+y)*C,t[7]=0,t[8]=(m+_)*S,t[9]=(p-y)*S,t[10]=(1-(d+h))*S,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t};const b=[0,0,0],C=e();function S(t,e,n,r){let i=o.e.magnitude(o.e.set(b,t[0],t[1],t[2]));const s=o.e.magnitude(o.e.set(b,t[4],t[5],t[6])),a=o.e.magnitude(o.e.set(b,t[8],t[9],t[10]));x(t)<0&&(i=-i),e[0]=t[12],e[1]=t[13],e[2]=t[14],f(C,t);const u=1/i,c=1/s,l=1/a;return C[0]*=u,C[1]*=u,C[2]*=u,C[4]*=c,C[5]*=c,C[6]*=c,C[8]*=l,C[9]*=l,C[10]*=l,m(n,C),r[0]=i,r[1]=s,r[2]=a,t}function x(t){const e=t[0],n=t[1],r=t[2],o=t[3],i=t[4],s=t[5],a=t[6],u=t[7],c=t[8],l=t[9],d=t[10],f=t[11],m=t[12],h=t[13],p=t[14],g=t[15];return(e*s-n*i)*(d*g-f*p)-(e*a-r*i)*(l*g-f*h)+(e*u-o*i)*(l*p-d*h)+(n*a-r*s)*(c*g-f*m)-(n*u-o*s)*(c*p-d*m)+(r*u-o*a)*(c*h-l*m)}t.decompose=S,t.getDecomposition=function(t){const e=(0,o.e)(),n=(0,i.k)(),r=(0,o.e)();return S(t,e,n,r),{position:e,quaternion:n,scale:r}},t.makeTable=function(t){let e="";for(let n=0;n<4;n++){for(let r=0;r<4;r++)e+=t[4*r+n].toString(),r<3&&(e+=" ");n<3&&(e+="\n")}return e},t.determinant=x,t.isRotationAndTranslation=function(t,e){return function(t,e){const n=t[0],o=t[1],i=t[2],s=t[3],a=t[4],u=t[5],c=t[6],l=t[7],d=t[8],f=t[9],m=t[10],h=t[11],p=t[15];if(!((0,r.T)(p,1,e)&&(0,r.T)(s,0,e)&&(0,r.T)(l,0,e)&&(0,r.T)(h,0,e)))return!1;const g=Math.abs(n*(u*m-c*f)-o*(a*m-c*d)+i*(a*f-u*d));if(!(0,r.T)(g,1,e))return!1;return!0}(t,void 0!==e?e:r.p)},t.isTranslationAndUniformScaling=function(t,e){return function(t,e){const n=t[0];return(0,r.T)(t[1],0,e)&&(0,r.T)(t[2],0,e)&&(0,r.T)(t[3],0,e)&&(0,r.T)(t[4],0,e)&&(0,r.T)(t[5],n,e)&&(0,r.T)(t[6],0,e)&&(0,r.T)(t[7],0,e)&&(0,r.T)(t[8],0,e)&&(0,r.T)(t[9],0,e)&&(0,r.T)(t[10],n,e)&&(0,r.T)(t[11],0,e)&&(0,r.T)(t[15],1,e)}(t,void 0!==e?e:r.p)},t.fromQuat=function(t,e){const n=e[0],r=e[1],o=e[2],i=e[3],s=n+n,a=r+r,u=o+o,c=n*s,l=r*s,d=r*a,f=o*s,m=o*a,h=o*u,p=i*s,g=i*a,y=i*u;return t[0]=1-d-h,t[1]=l+y,t[2]=f-g,t[3]=0,t[4]=l-y,t[5]=1-c-h,t[6]=m+p,t[7]=0,t[8]=f+g,t[9]=m-p,t[10]=1-c-d,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.fromEuler=function(t,e,n){const r=e[0],o=e[1],i=e[2],s=Math.cos(r),a=Math.sin(r),u=Math.cos(o),c=Math.sin(o),l=Math.cos(i),d=Math.sin(i);if("XYZ"===n){const e=s*l,n=s*d,r=a*l,o=a*d;t[0]=u*l,t[4]=-u*d,t[8]=c,t[1]=n+r*c,t[5]=e-o*c,t[9]=-a*u,t[2]=o-e*c,t[6]=r+n*c,t[10]=s*u}else if("YXZ"===n){const e=u*l,n=u*d,r=c*l,o=c*d;t[0]=e+o*a,t[4]=r*a-n,t[8]=s*c,t[1]=s*d,t[5]=s*l,t[9]=-a,t[2]=n*a-r,t[6]=o+e*a,t[10]=s*u}else if("ZXY"===n){const e=u*l,n=u*d,r=c*l,o=c*d;t[0]=e-o*a,t[4]=-s*d,t[8]=r+n*a,t[1]=n+r*a,t[5]=s*l,t[9]=o-e*a,t[2]=-s*c,t[6]=a,t[10]=s*u}else if("ZYX"===n){const e=s*l,n=s*d,r=a*l,o=a*d;t[0]=u*l,t[4]=r*c-n,t[8]=e*c+o,t[1]=u*d,t[5]=o*c+e,t[9]=n*c-r,t[2]=-c,t[6]=a*u,t[10]=s*u}else if("YZX"===n){const e=s*u,n=s*c,r=a*u,o=a*c;t[0]=u*l,t[4]=o-e*d,t[8]=r*d+n,t[1]=d,t[5]=s*l,t[9]=-a*l,t[2]=-c*l,t[6]=n*d+r,t[10]=e-o*d}else if("XZY"===n){const e=s*u,n=s*c,r=a*u,o=a*c;t[0]=u*l,t[4]=-d,t[8]=c*l,t[1]=e*d+o,t[5]=s*l,t[9]=n*d-r,t[2]=r*d-n,t[6]=a*l,t[10]=o*d+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.perspective=function(t,e,n,r,o,i,s){const a=2*i/(n-e),u=2*i/(r-o),c=(n+e)/(n-e),l=(r+o)/(r-o),d=-(s+i)/(s-i),f=-2*s*i/(s-i);return t[0]=a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=c,t[9]=l,t[10]=d,t[11]=-1,t[12]=0,t[13]=0,t[14]=f,t[15]=0,t},t.ortho=function(t,e,n,r,o,i,s){const a=1/(n-e),u=1/(r-o),c=1/(s-i),l=(n+e)*a,d=(r+o)*u,f=(s+i)*c;return t[0]=2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=-2*c,t[11]=0,t[12]=-l,t[13]=-d,t[14]=-f,t[15]=1,t},t.lookAt=function(t,e,n,o){let i,s,u,c,l,d,f,m,h,p;const g=e[0],y=e[1],_=e[2],A=o[0],b=o[1],C=o[2],S=n[0],x=n[1],v=n[2];return Math.abs(g-S)<r.p&&Math.abs(y-x)<r.p&&Math.abs(_-v)<r.p?a(t):(f=g-S,m=y-x,h=_-v,p=1/Math.sqrt(f*f+m*m+h*h),f*=p,m*=p,h*=p,i=b*h-C*m,s=C*f-A*h,u=A*m-b*f,p=Math.sqrt(i*i+s*s+u*u),p?(p=1/p,i*=p,s*=p,u*=p):(i=0,s=0,u=0),c=m*u-h*s,l=h*i-f*u,d=f*s-m*i,p=Math.sqrt(c*c+l*l+d*d),p?(p=1/p,c*=p,l*=p,d*=p):(c=0,l=0,d=0),t[0]=i,t[1]=c,t[2]=f,t[3]=0,t[4]=s,t[5]=l,t[6]=m,t[7]=0,t[8]=u,t[9]=d,t[10]=h,t[11]=0,t[12]=-(i*g+s*y+u*_),t[13]=-(c*g+l*y+d*_),t[14]=-(f*g+m*y+h*_),t[15]=1,t)},t.targetTo=function(t,e,n,r){const o=e[0],i=e[1],s=e[2],a=r[0],u=r[1],c=r[2];let l=o-n[0],d=i-n[1],f=s-n[2],m=l*l+d*d+f*f;m>0&&(m=1/Math.sqrt(m),l*=m,d*=m,f*=m);let h=u*f-c*d,p=c*l-a*f,g=a*d-u*l;return m=h*h+p*p+g*g,m>0&&(m=1/Math.sqrt(m),h*=m,p*=m,g*=m),t[0]=h,t[1]=p,t[2]=g,t[3]=0,t[4]=d*g-f*p,t[5]=f*h-l*g,t[6]=l*p-d*h,t[7]=0,t[8]=l,t[9]=d,t[10]=f,t[11]=0,t[12]=o,t[13]=i,t[14]=s,t[15]=1,t},t.fromPermutation=function(t,e){u(t);for(let n=0;n<4;n++){d(t,n,e[n],1)}return t},t.getMaxScaleOnAxis=function(t){const e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))},t.extractBasis=function(t){return{x:o.e.create(t[0],t[1],t[2]),y:o.e.create(t[4],t[5],t[6]),z:o.e.create(t[8],t[9],t[10])}};const v=[1,0,0],B=[0,1,0],I=[0,0,1];t.rotX90=y(e(),(0,s.pu)(90),v),t.rotX180=y(e(),(0,s.pu)(180),v),t.rotY90=y(e(),(0,s.pu)(90),B),t.rotY180=y(e(),(0,s.pu)(180),B),t.rotY270=y(e(),(0,s.pu)(270),B),t.rotZ90=y(e(),(0,s.pu)(90),I),t.rotZ180=y(e(),(0,s.pu)(180),I),t.rotXY90=p(e(),t.rotX90,t.rotY90),t.rotZY90=p(e(),t.rotZ90,t.rotY90),t.rotZYZ90=p(e(),t.rotZY90,t.rotZ90),t.rotZ90X180=p(e(),t.rotZ90,t.rotX180),t.rotY90Z180=p(e(),t.rotY90,t.rotZ180),t.id=n()}(a||(a={}))},96401:function(t,e,n){n.d(e,{Hx:function(){return d},S8:function(){return r},Z6:function(){return i},kV:function(){return f},lb:function(){return l}});var r,o=n(14511);!function(t){t.H="H",t.D="D",t.T="T",t.HE="HE",t.LI="LI",t.BE="BE",t.B="B",t.C="C",t.N="N",t.O="O",t.F="F",t.NE="NE",t.NA="NA",t.MG="MG",t.AL="AL",t.SI="SI",t.P="P",t.S="S",t.CL="CL",t.AR="AR",t.K="K",t.CA="CA",t.SC="SC",t.TI="TI",t.V="V",t.CR="CR",t.MN="MN",t.FE="FE",t.CO="CO",t.NI="NI",t.CU="CU",t.ZN="ZN",t.GA="GA",t.GE="GE",t.AS="AS",t.SE="SE",t.BR="BR",t.KR="KR",t.RB="RB",t.SR="SR",t.Y="Y",t.ZR="ZR",t.NB="NB",t.MO="MO",t.TC="TC",t.RU="RU",t.RH="RH",t.PD="PD",t.AG="AG",t.CD="CD",t.IN="IN",t.SN="SN",t.SB="SB",t.TE="TE",t.I="I",t.XE="XE",t.CS="CS",t.BA="BA",t.LA="LA",t.CE="CE",t.PR="PR",t.ND="ND",t.PM="PM",t.SM="SM",t.EU="EU",t.GD="GD",t.TB="TB",t.DY="DY",t.HO="HO",t.ER="ER",t.TM="TM",t.YB="YB",t.LU="LU",t.HF="HF",t.TA="TA",t.W="W",t.RE="RE",t.OS="OS",t.IR="IR",t.PT="PT",t.AU="AU",t.HG="HG",t.TL="TL",t.PB="PB",t.BI="BI",t.PO="PO",t.AT="AT",t.RN="RN",t.FR="FR",t.RA="RA",t.AC="AC",t.TH="TH",t.PA="PA",t.U="U",t.NP="NP",t.PU="PU",t.AM="AM",t.CM="CM",t.BK="BK",t.CF="CF",t.ES="ES",t.FM="FM",t.MD="MD",t.NO="NO",t.LR="LR",t.RF="RF",t.DB="DB",t.SG="SG",t.BH="BH",t.HS="HS",t.MT="MT",t.DS="DS",t.RG="RG",t.CN="CN",t.NH="NH",t.FL="FL",t.MC="MC",t.LV="LV",t.TS="TS",t.OG="OG"}(r||(r={}));const i={H:"Hydrogen",HE:"Helium",LI:"Lithium",BE:"Beryllium",B:"Boron",C:"Carbon",N:"Nitrogen",O:"Oxygen",F:"Fluorine",NE:"Neon",NA:"Sodium",MG:"Magnesium",AL:"Aluminum",SI:"Silicon",P:"Phosphorus",S:"Sulfur",CL:"Chlorine",AR:"Argon",K:"Potassium",CA:"Calcium",SC:"Scandium",TI:"Titanium",V:"Vanadium",CR:"Chromium",MN:"Manganese",FE:"Iron",CO:"Cobalt",NI:"Nickel",CU:"Copper",ZN:"Zinc",GA:"Gallium",GE:"Germanium",AS:"Arsenic",SE:"Selenium",BR:"Bromine",KR:"Krypton",RB:"Rubidium",SR:"Strontium",Y:"Yttrium",ZR:"Zirconium",NB:"Niobium",MO:"Molybdenum",TC:"Technetium",RU:"Ruthenium",RH:"Rhodium",PD:"Palladium",AG:"Silver",CD:"Cadmium",IN:"Indium",SN:"Tin",SB:"Antimony",TE:"Tellurium",I:"Iodine",XE:"Xenon",CS:"Cesium",BA:"Barium",LA:"Lanthanum",CE:"Cerium",PR:"Praseodymium",ND:"Neodymium",PM:"Promethium",SM:"Samarium",EU:"Europium",GD:"Gadolinium",TB:"Terbium",DY:"Dysprosium",HO:"Holmium",ER:"Erbium",TM:"Thulium",YB:"Ytterbium",LU:"Lutetium",HF:"Hafnium",TA:"Tantalum",W:"Wolfram",RE:"Rhenium",OS:"Osmium",IR:"Iridium",PT:"Platinum",AU:"Gold",HG:"Mercury",TL:"Thallium",PB:"Lead",BI:"Bismuth",PO:"Polonium",AT:"Astatine",RN:"Radon",FR:"Francium",RA:"Radium",AC:"Actinium",TH:"Thorium",PA:"Protactinium",U:"Uranium",NP:"Neptunium",PU:"Plutonium",AM:"Americium",CM:"Curium",BK:"Berkelium",CF:"Californium",ES:"Einsteinium",FM:"Fermium",MD:"Mendelevium",NO:"Nobelium",LR:"Lawrencium",RF:"Rutherfordium",DB:"Dubnium",SG:"Seaborgium",BH:"Bohrium",HS:"Hassium",MT:"Meitnerium",DS:"Darmstadtium",RG:"Roentgenium",CN:"Copernicium",NH:"Nihonium",FL:"Flerovium",MC:"Moscovium",LV:"Livermorium",TS:"Tennessine",OG:"Oganesson"},s=new Set(["LI","NA","K","RB","CS","FR"]);const a=new Set(["BE","MG","CA","SR","BA","RA"]);new Set(["C","P","S","SE"]);new Set(["H","N","O","F","CL","BR","I"]);new Set(["HE","NE","AR","KR","XE","RN"]);const u=new Set(["ZN","GA","CD","IN","SN","HG","TI","PB","BI","PO","CN"]);new Set(["B","SI","GE","AS","SB","TE","AT"]);const c=new Set(["F","CL","BR","I","AT"]);function l(t){return c.has(t)}function d(t){const e=(0,o.PR)(t);return e>=21&&e<=29||e>=39&&e<=47||e>=72&&e<=79||e>=104&&e<=108}function f(t){return function(t){return s.has(t)}(t)||function(t){return a.has(t)}(t)||function(t){const e=(0,o.PR)(t);return e>=57&&e<=71}(t)||function(t){const e=(0,o.PR)(t);return e>=89&&e<=103}(t)||d(t)||function(t){return u.has(t)}(t)}},98277:function(t,e,n){var r;n.d(e,{Q:function(){return r}}),function(t){t.add=function(t,e,n){t.squaredDistances[t.count]=n,t.indices[t.count++]=e},t.reset=function(t){t.count=0},t.create=function(){return{count:0,indices:[],squaredDistances:[]}},t.copy=function(t,e){for(let n=0;n<e.count;++n)t.indices[n]=e.indices[n],t.squaredDistances[n]=e.squaredDistances[n];return t.count=e.count,t}}(r||(r={}))},98391:function(t,e,n){n.d(e,{Q1:function(){return a},Q5:function(){return u},_j:function(){return c},qM:function(){return d},Ak:function(){return l}});var r=n(12716),o=n(12284);function i(){return i.zero()}function s(){return s.zero()}function a(t){return t}function u(t,e,n,r){return{label:t,description:n,list:r,type:e}}function c(t){return t}function l(t,e,n){const r={};for(const o in t){let i=t[o];i=a.saturate(i,e),i=a.darken(i,-n),r[o]=i}return r}function d(t){return t}!function(t){t.zero=function(){const t=[.1,0,0];return t[0]=0,t},t.fromColor=function(t,e){return t[0]=(e>>16&255)/255,t[1]=(e>>8&255)/255,t[2]=(255&e)/255,t},t.toColor=function(t){return 255*t[0]<<16|255*t[1]<<8|255*t[2]}}(i||(i={})),function(t){t.zero=function(){const t=[.1,0,0];return t[0]=0,t};const e=i();t.fromColor=function(n,r){return i.fromColor(e,r),t.fromRgb(n,e)},t.toColor=function(t){return o(e,t),i.toColor(e)},t.fromRgb=function(t,e){const[n,r,o]=e,i=Math.min(n,r,o),s=Math.max(n,r,o),a=(s+i)/2;let u=0,c=0;return s===i?(u=0,c=Number.NaN):u=a<.5?(s-i)/(s+i):(s-i)/(2-s-i),n===s?c=(r-o)/(s-i):r===s?c=2+(o-n)/(s-i):o===s&&(c=4+(n-r)/(s-i)),c*=60,c<0&&(c+=360),t[0]=c,t[1]=u,t[2]=a,t};const n=[0,0,0],r=[0,0,0];function o(t,e){const[o,i,s]=e;let a,u,c;if(0===i)a=u=c=s;else{const t=n,e=r,l=s<.5?s*(1+i):s+i-s*i,d=2*s-l,f=o/360;t[0]=f+1/3,t[1]=f,t[2]=f-1/3;for(let n=0;n<3;n++)t[n]<0&&(t[n]+=1),t[n]>1&&(t[n]-=1),6*t[n]<1?e[n]=d+6*(l-d)*t[n]:2*t[n]<1?e[n]=l:3*t[n]<2?e[n]=d+(l-d)*(2/3-t[n])*6:e[n]=d;a=e[0],u=e[1],c=e[2]}return t[0]=a,t[1]=u,t[2]=c,t}t.toRgb=o,t.interpolate=function(t,e,n,r){const o=e,i=n,[s,a,u]=o,[c,l,d]=i;let f,m,h;isNaN(s)||isNaN(c)?isNaN(s)?isNaN(c)?m=Number.NaN:(m=c,1!==u&&0!==u||(f=l)):(m=s,1!==d&&0!==d||(f=a)):(h=c>s&&c-s>180?c-(s+360):c<s&&s-c>180?c+360-s:c-s,m=s+r*h),void 0===f&&(f=a+r*(l-a));const p=u+r*(d-u);return t[0]=m,t[1]=f,t[2]=p,t}}(s||(s={})),function(t){function e(t,e,n){return t<<16|e<<8|n}function n(t,e,n){return 255*t<<16|255*e<<8|255*n}t.toStyle=function(t){return`rgb(${t>>16&255}, ${t>>8&255}, ${255&t})`},t.toHexStyle=function(t){return"#"+("000000"+t.toString(16)).slice(-6)},t.toHexString=function(t){return"0x"+("000000"+t.toString(16)).slice(-6)},t.toRgbString=function(e){return`RGB: ${t.toRgb(e).join(", ")}`},t.toRgb=function(t){return[t>>16&255,t>>8&255,255&t]},t.toRgbNormalized=function(t){return[(t>>16&255)/255,(t>>8&255)/255,(255&t)/255]},t.fromHexStyle=function(t){return parseInt(t.replace("#","0x"))},t.fromHexString=function(t){return parseInt(t)},t.fromRgb=e,t.fromNormalizedRgb=n,t.fromArray=function(t,n){return e(t[n],t[n+1],t[n+2])},t.fromNormalizedArray=function(t,e){return n(t[e],t[e+1],t[e+2])},t.fromColorListEntry=function(t){return"number"==typeof t?t:t[0]},t.toArray=function(t,e,n){return e[n]=t>>16&255,e[n+1]=t>>8&255,e[n+2]=255&t,e},t.toArrayNormalized=function(t,e,n){return e[n]=(t>>16&255)/255,e[n+1]=(t>>8&255)/255,e[n+2]=(255&t)/255,e},t.toVec3=function(t,e){return t[0]=e>>16&255,t[1]=e>>8&255,t[2]=255&e,t},t.toVec3Normalized=function(t,e){return t[0]=(e>>16&255)/255,t[1]=(e>>8&255)/255,t[2]=(255&e)/255,t},t.interpolate=function(t,e,n){const r=t>>16&255,o=t>>8&255,i=255&t;return r+((e>>16&255)-r)*n<<16|o+((e>>8&255)-o)*n<<8|i+((255&e)-i)*n};const i=s.zero(),a=s.zero();function u(t){const e=t>>16&255;return e!==(t>>8&255)||e!==(255&t)}t.interpolateHsl=function(t,e,n){const r=s.fromColor(i,t),o=s.fromColor(a,e);return s.interpolate(r,r,o,n),s.toColor(r)},t.hasHue=u;const c=[0,0,0];function l(t,e){return u(t)?(r.G.fromColor(c,t),r.G.toColor(r.G.saturate(c,c,e))):t}t.saturate=l,t.desaturate=function(t,e){return l(t,-e)};const d=[0,0,0];function f(t,e){return o.E.fromColor(d,t),o.E.toColor(o.E.darken(d,d,e))}function m(t){return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function h(t){return.2126*m((t>>16&255)/255)+.7152*m((t>>8&255)/255)+.0722*m((255&t)/255)}function p(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function g(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}t.darken=f,t.lighten=function(t,e){return f(t,-e)},t.luminance=h,t.contrast=function(t,e){const n=h(t),r=h(e);return n>r?(n+.05)/(r+.05):(r+.05)/(n+.05)},t.sRGBToLinear=function(t){return n(p((t>>16&255)/255),p((t>>8&255)/255),p((255&t)/255))},t.linearToSRGB=function(t){return n(g((t>>16&255)/255),g((t>>8&255)/255),g((255&t)/255))}}(a||(a={}))},98537:function(t,e,n){n.d(e,{e:function(){return a}});var r=n(95156),o=n(41430),i=n(35695);const s=isFinite;function a(){return a.zero()}!function(t){function e(){const t=[.1,0,0];return t[0]=0,t}function n(t,n,r){const o=e();return o[0]=t,o[1]=n,o[2]=r,o}function a(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function u(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function c(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function l(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function d(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function f(t){const e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function m(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function h(t,e){const n=e[0],r=e[1],o=e[2];let i=n*n+r*r+o*o;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i),t}function p(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function g(t,e,n){const r=e[0],o=e[1],i=e[2],s=n[0],a=n[1],u=n[2];return t[0]=o*u-i*a,t[1]=i*s-r*u,t[2]=r*a-o*s,t}t.zero=e,t.clone=function(t){const n=e();return n[0]=t[0],n[1]=t[1],n[2]=t[2],n},t.isFinite=function(t){return s(t[0])&&s(t[1])&&s(t[2])},t.isInteger=function(t){return Number.isInteger(t[0])&&Number.isInteger(t[1])&&Number.isInteger(t[2])},t.hasNaN=function(t){return Number.isNaN(t[0])||Number.isNaN(t[1])||Number.isNaN(t[2])},t.setNaN=function(t){return t[0]=NaN,t[1]=NaN,t[2]=NaN,t},t.fromObj=function(t){return n(t.x,t.y,t.z)},t.toObj=function(t){return{x:t[0],y:t[1],z:t[2]}},t.fromArray=function(t,e,n){return t[0]=e[n+0],t[1]=e[n+1],t[2]=e[n+2],t},t.toArray=function(t,e,n){return e[n+0]=t[0],e[n+1]=t[1],e[n+2]=t[2],e},t.create=n,t.ofArray=function(t){const n=e();return n[0]=t[0],n[1]=t[1],n[2]=t[2],n},t.set=function(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t},t.copy=a,t.add=u,t.sub=c,t.mul=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t},t.div=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},t.scale=l,t.scaleAndAdd=d,t.scaleAndSub=function(t,e,n,r){return t[0]=e[0]-n[0]*r,t[1]=e[1]-n[1]*r,t[2]=e[2]-n[2]*r,t},t.addScalar=function(t,e,n){return t[0]=e[0]+n,t[1]=e[1]+n,t[2]=e[2]+n,t},t.subScalar=function(t,e,n){return t[0]=e[0]-n,t[1]=e[1]-n,t[2]=e[2]-n,t},t.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},t.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},t.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},t.trunc=function(t,e){return t[0]=Math.trunc(e[0]),t[1]=Math.trunc(e[1]),t[2]=Math.trunc(e[2]),t},t.abs=function(t,e){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t},t.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},t.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},t.clamp=function(t,e,n,r){return t[0]=Math.max(n[0],Math.min(r[0],e[0])),t[1]=Math.max(n[1],Math.min(r[1],e[1])),t[2]=Math.max(n[2],Math.min(r[2],e[2])),t},t.distance=function(t,e){const n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2];return Math.sqrt(n*n+r*r+o*o)},t.squaredDistance=function(t,e){const n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2];return n*n+r*r+o*o},t.magnitude=function(t){const e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)},t.squaredMagnitude=f,t.setMagnitude=function(t,e,n){return l(t,h(t,e),n)},t.negate=m,t.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},t.normalize=h,t.dot=p,t.cross=g,t.lerp=function(t,e,n,r){const o=e[0],i=e[1],s=e[2];return t[0]=o+r*(n[0]-o),t[1]=i+r*(n[1]-i),t[2]=s+r*(n[2]-s),t};const y=e();function _(t,e){const n=Math.sqrt(f(t)*f(e));if(0===n)return Math.PI/2;const r=p(t,e)/n;return Math.acos((0,o.qE)(r,-1,1))}t.slerp=function(t,e,n,r){const i=(0,o.qE)(p(e,n),-1,1),s=Math.acos(i)*r;return d(y,n,e,-i),h(y,y),u(t,l(t,e,Math.cos(s)),l(y,y,Math.sin(s)))},t.hermite=function(t,e,n,r,o,i){const s=i*i,a=s*(2*i-3)+1,u=s*(i-2)+i,c=s*(i-1),l=s*(3-2*i);return t[0]=e[0]*a+n[0]*u+r[0]*c+o[0]*l,t[1]=e[1]*a+n[1]*u+r[1]*c+o[1]*l,t[2]=e[2]*a+n[2]*u+r[2]*c+o[2]*l,t},t.bezier=function(t,e,n,r,o,i){const s=1-i,a=s*s,u=i*i,c=a*s,l=3*i*a,d=3*u*s,f=u*i;return t[0]=e[0]*c+n[0]*l+r[0]*d+o[0]*f,t[1]=e[1]*c+n[1]*l+r[1]*d+o[1]*f,t[2]=e[2]*c+n[2]*l+r[2]*d+o[2]*f,t},t.quadraticBezier=function(t,e,n,r,i){return t[0]=(0,o.iD)(e[0],n[0],r[0],i),t[1]=(0,o.iD)(e[1],n[1],r[1],i),t[2]=(0,o.iD)(e[2],n[2],r[2],i),t},t.spline=function(t,e,n,r,i,s,a){return t[0]=(0,o.Y7)(e[0],n[0],r[0],i[0],s,a),t[1]=(0,o.Y7)(e[1],n[1],r[1],i[1],s,a),t[2]=(0,o.Y7)(e[2],n[2],r[2],i[2],s,a),t},t.random=function(t,e){const n=2*Math.random()*Math.PI,r=2*Math.random()-1,o=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*o,t[1]=Math.sin(n)*o,t[2]=r*e,t},t.transformMat4=function(t,e,n){const r=e[0],o=e[1],i=e[2],s=1/(n[3]*r+n[7]*o+n[11]*i+n[15]||1);return t[0]=(n[0]*r+n[4]*o+n[8]*i+n[12])*s,t[1]=(n[1]*r+n[5]*o+n[9]*i+n[13])*s,t[2]=(n[2]*r+n[6]*o+n[10]*i+n[14])*s,t},t.transformDirection=function(t,e,n){const r=e[0],o=e[1],i=e[2];return t[0]=n[0]*r+n[4]*o+n[8]*i,t[1]=n[1]*r+n[5]*o+n[9]*i,t[2]=n[2]*r+n[6]*o+n[10]*i,h(t,t)},t.transformMat4Offset=function(t,e,n,r,o,i){const s=e[0+o],a=e[1+o],u=e[2+o],c=1/(n[3+i]*s+n[7+i]*a+n[11+i]*u+n[15+i]||1);return t[0+r]=(n[0+i]*s+n[4+i]*a+n[8+i]*u+n[12+i])*c,t[1+r]=(n[1+i]*s+n[5+i]*a+n[9+i]*u+n[13+i])*c,t[2+r]=(n[2+i]*s+n[6+i]*a+n[10+i]*u+n[14+i])*c,t},t.transformDirectionOffset=function(t,e,n,r,o,i){const s=e[0+o],a=e[1+o],u=e[2+o];t[0+r]=n[0+i]*s+n[4+i]*a+n[8+i]*u,t[1+r]=n[1+i]*s+n[5+i]*a+n[9+i]*u,t[2+r]=n[2+i]*s+n[6+i]*a+n[10+i]*u;const c=Math.hypot(t[0+r],t[1+r],t[2+r]);return c>0&&(t[0+r]/=c,t[1+r]/=c,t[2+r]/=c),t},t.transformMat3=function(t,e,n){const r=e[0],o=e[1],i=e[2];return t[0]=r*n[0]+o*n[3]+i*n[6],t[1]=r*n[1]+o*n[4]+i*n[7],t[2]=r*n[2]+o*n[5]+i*n[8],t},t.transformQuat=function(t,e,n){const r=e[0],o=e[1],i=e[2],s=n[0],a=n[1],u=n[2],c=n[3],l=c*r+a*i-u*o,d=c*o+u*r-s*i,f=c*i+s*o-a*r,m=-s*r-a*o-u*i;return t[0]=l*c+m*-s+d*-u-f*-a,t[1]=d*c+m*-a+f*-s-l*-u,t[2]=f*c+m*-u+l*-a-d*-s,t},t.angle=_;const A=e(),b=e(),C=e(),S=e(),x=e(),v=e(),B=e();t.dihedralAngle=function(t,e,n,r){c(A,t,e),c(b,n,e),c(C,e,n),c(S,r,n),g(x,A,b),g(v,C,S);const o=_(x,v);return g(B,x,v),p(b,B)>0?o:-o},t.directionFromSpherical=function(e,n,r,o){return t.set(e,o*Math.cos(r)*Math.sin(n),o*Math.sin(r)*Math.sin(n),o*Math.cos(n))},t.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},t.equals=function(t,e){const n=t[0],r=t[1],o=t[2],s=e[0],a=e[1],u=e[2];return Math.abs(n-s)<=i.p*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-a)<=i.p*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(o-u)<=i.p*Math.max(1,Math.abs(o),Math.abs(u))};const I=e();function w(t){return 0===t[0]&&0===t[1]&&0===t[2]}t.makeRotation=function(e,n,o){const s=_(n,o);if(Math.abs(s)<1e-4)return r.$.setIdentity(e);if(Math.abs(s-Math.PI)<i.p)return r.$.fromRotation(e,Math.PI,Math.abs(n[0])<.9?t.unitX:t.unitZ);const a=g(I,n,o);return r.$.fromRotation(e,s,a)},t.isZero=w,t.projectPointOnVector=function(t,e,n,r){return c(t,e,r),u(t,l(t,n,p(n,t)/f(n)),r)};const P=e();function D(t,e,n){return l(t,n,p(n,e)/f(n))}t.projectPointOnPlane=function(t,e,n,r){return h(P,n),c(t,e,r),c(t,e,l(P,P,p(t,P)))},t.projectOnVector=D;const M=e();t.projectOnPlane=function(t,e,n){return D(M,e,n),c(t,e,M)},t.orthogonalize=function(e,n,r){return h(e,g(e,g(e,n,r),n)),t.isZero(e)?(e[0]=1,e[1]=0,e[2]=0,h(e,g(e,g(e,n,e),n)),t.isZero(e)?(e[0]=0,e[1]=1,e[2]=0,h(e,g(e,g(e,n,e),n)),t.isZero(e)?(h(e,r),t.isZero(e)?(e[0]=1,e[1]=0,e[2]=0,e):e):e):e):e},t.matchDirection=function(t,e,n){return p(e,n)>0?a(t,e):m(t,a(t,e)),t},t.orthogonalDirection=function(n,r){if(w(r))return a(n,t.unitX);{const t=e();return Math.abs(r[0])<Math.abs(r[1])&&Math.abs(r[0])<Math.abs(r[2])?(t[0]=0,t[1]=r[2],t[2]=-r[1]):Math.abs(r[1])<Math.abs(r[2])?(t[0]=-r[2],t[1]=0,t[2]=r[0]):(t[0]=r[1],t[1]=-r[0],t[2]=0),h(n,t)}};const N=e(),E=e();t.triangleNormal=function(t,e,n,r){return c(N,n,e),c(E,r,e),h(t,g(t,N,E))};const k=e();t.center=function(e,n,r){return t.scaleAndAdd(e,n,t.sub(k,r,n),.5)},t.toString=function(t,e){return`[${t[0].toPrecision(e)} ${t[1].toPrecision(e)} ${t[2].toPrecision(e)}]`},t.origin=n(0,0,0),t.unit=n(1,1,1),t.negUnit=n(-1,-1,-1),t.unitX=n(1,0,0),t.unitY=n(0,1,0),t.unitZ=n(0,0,1),t.negUnitX=n(-1,0,0),t.negUnitY=n(0,-1,0),t.negUnitZ=n(0,0,-1)}(a||(a={}))},98820:function(t,e,n){n.d(e,{N:function(){return u},v:function(){return r}});var r,o=n(38530),i=n(46031),s=n(35256),a=n(75849);class u{get operatorGroups(){return this._operators||(this._operators=this.operatorsProvider()),this._operators}constructor(t,e,n){this.operatorsProvider=n,this.id=t,this.details=e}}!function(t){t.create=function(e,n,r){return new t(e,n,r)}}(u||(u={})),function(t){t.Default={assemblies:[],spacegroup:i.is.ZeroP1,isNonStandardCrystalFrame:!1},t.findAssembly=function(t,e){const n=e.toLocaleLowerCase(),r=s.i.Provider.get(t);return r?(0,o.L9)(r.assemblies,t=>t.id.toLowerCase()===n):void 0},t.getUnitcellLabel=function(t){const{cell:e,name:n,num:r}=t.spacegroup,{size:o,anglesInRadians:i}=e,s=o[0].toFixed(2),u=o[1].toFixed(2),c=o[2].toFixed(2),l=(0,a.H)(i[0]).toFixed(2),d=(0,a.H)(i[1]).toFixed(2),f=(0,a.H)(i[2]).toFixed(2),m=[];return m.push(`Unit Cell <b>${n}</b> #${r}`),m.push(`${s}${u}${c} `),m.push(`=${l} =${d} =${f}`),m.join(" | ")}}(r||(r={}))},99355:function(t,e,n){n.d(e,{c:function(){return r}});var r,o=n(54135),i=n(77936),s=n(58247),a=n(65533);!function(t){function e(t,e){return{kind:"singletons",source:t,structure:e}}function n(t,e){return{kind:"sequence",source:t,structures:e}}function r(t){return e(t,i.oE.Empty)}function u(t){return"singletons"===t.kind}function c(t){return u(t)?0===t.structure.units.length:0===t.structures.length}function l(t){return c(t)?i.oE.Empty:u(t)?t.structure:(0,s.l6)(t.source,t.structures)}function d(t,o,i){return 0===o.length?r(t):i?e(t,(0,s.l6)(t,o)):n(t,o)}t.Singletons=e,t.Sequence=n,t.Empty=r,t.isSingleton=u,t.isEmpty=c,t.structureCount=function(t){return u(t)?t.structure.elementCount:t.structures.length},t.unionStructure=l,t.toLociWithCurrentUnits=function(t){const e=[],{unitMap:n}=t.source;for(const r of l(t).units)r===n.get(r.id)?e[e.length]={unit:r,indices:a.CD.ofBounds(0,r.elements.length)}:e[e.length]={unit:r,indices:a.CD.ofSortedArray(a.X9.indicesOf(n.get(r.id).elements,r.elements))};return i.iZ.Loci(t.source,e)},t.toLociWithSourceUnits=function(t){const e=[],{unitMap:n}=t.source;for(const r of l(t).units){const t=n.get(r.id);e[e.length]=t===r?{unit:t,indices:a.CD.ofBounds(0,t.elements.length)}:{unit:t,indices:a.CD.ofSortedArray(a.X9.indicesOf(t.elements,r.elements))}}return i.iZ.Loci(t.source,e)};class f{add(t){const e=t.elementCount;0!==e&&(this.structures[this.structures.length]=t,1!==e&&(this.allSingletons=!1))}getSelection(){return d(this.source,this.structures,this.allSingletons)}constructor(t){this.source=t,this.structures=[],this.allSingletons=!0}}class m{add(t){const e=t.elementCount;0!==e&&this.uniqueSets.add(t)&&(this.structures[this.structures.length]=t,1!==e&&(this.allSingletons=!1))}getSelection(){return d(this.structure,this.structures,this.allSingletons)}constructor(t){this.structure=t,this.structures=[],this.allSingletons=!0,this.uniqueSets=(0,o.bw)(i.oE.hashCode,i.oE.areUnitIdsAndIndicesEqual)}}t.LinearBuilder=function(t){return new f(t)},t.UniqueBuilder=function(t){return new m(t)},t.forEach=function(e,n){let r=0;if(t.isSingleton(e))for(const t of e.structure.units){const{elements:o}=t;for(let s=0,u=o.length;s<u;s++){n(i.oE.create([t.getChild(a.X9.ofSingleton(o[s]))],{parent:e.source}),r++)}}else for(const t of e.structures)n(t,r++)},t.withInputStructure=function(t,r){return u(t)?e(r,t.structure):n(r,t.structures)}}(r||(r={}))},99487:function(t,e,n){function r(t){return Object.keys(t)}function o(t){throw new Error("unreachable")}function i(t){return"function"==typeof(null==t?void 0:t.then)}n.d(e,{$X:function(){return i},dr:function(){return o},mX:function(){return r}})},99572:function(t,e,n){n.d(e,{ND:function(){return o},ar:function(){return r}});var r,o,i=n(38530),s=n(77427),a=n(37631);class u{and(t){return new u(this.providers.concat([t]))}encode(t){const e=[];for(const n of this.providers){const r=n(t);if(!r.encodings.length)throw new Error("Encodings must be non-empty.");t=r.data;for(const t of r.encodings)e.push(t)}if(!(t instanceof Uint8Array))throw new Error("The encoding must result in a Uint8Array. Fix your encoding chain.");return{encoding:e,data:t}}constructor(t){this.providers=t}}!function(t){function e(t){return new u([t])}function n(t){switch(t.kind){case"ByteArray":return o.byteArray;case"FixedPoint":return o.fixedPoint(t.factor);case"IntervalQuantization":return o.intervalQuantizaiton(t.min,t.max,t.numSteps);case"RunLength":return o.runLength;case"Delta":return o.delta;case"IntegerPacking":return o.integerPacking;case"StringArray":return o.stringArray}}t.by=e,t.fromEncoding=function(t){let r=e(n(t[0]));for(let e=1;e<t.length&&"IntegerPacking"!==t[e-1].kind;e++)r=r.and(n(t[e]));return r}}(r||(r={})),function(t){t.by=function(t){return new u([t])};const e={[s.W.IntDataType.Int16]:function(t,e,n){t.setInt16(2*e,n,!0)},[s.W.IntDataType.Uint16]:function(t,e,n){t.setUint16(2*e,n,!0)},[s.W.IntDataType.Int32]:function(t,e,n){t.setInt32(4*e,n,!0)},[s.W.IntDataType.Uint32]:function(t,e,n){t.setUint32(4*e,n,!0)},[s.W.FloatDataType.Float32]:function(t,e,n){t.setFloat32(4*e,n,!0)},[s.W.FloatDataType.Float64]:function(t,e,n){t.setFloat64(8*e,n,!0)}},n={[s.W.IntDataType.Int16]:2,[s.W.IntDataType.Uint16]:2,[s.W.IntDataType.Int32]:4,[s.W.IntDataType.Uint32]:4,[s.W.FloatDataType.Float32]:4,[s.W.FloatDataType.Float64]:8};function r(t){const r=s.W.getDataType(t);if(r===s.W.IntDataType.Int8)return function(t){return{encodings:[{kind:"ByteArray",type:s.W.IntDataType.Int8}],data:new Uint8Array(t.buffer,t.byteOffset)}}(t);if(r===s.W.IntDataType.Uint8)return function(t){return{encodings:[{kind:"ByteArray",type:s.W.IntDataType.Uint8}],data:t}}(t);const o=new Uint8Array(t.length*n[r]),i=e[r],a=new DataView(o.buffer);for(let e=0,n=t.length;e<n;e++)i(a,e,t[e]);return{encodings:[{kind:"ByteArray",type:r}],data:o}}function o(t,e){let n=0;for(let r=0,o=t.length;r<o;r++)n+=t[r]/e|0;return n+=t.length,n}function c(t,e){const n=-e-1;let r=0;for(let o=0,i=t.length;o<i;o++){const i=t[o];r+=i>=0?i/e|0:i/n|0}return r+=t.length,r}t.byteArray=r,t.fixedPoint=function(t){return e=>function(t,e){const n=s.W.getDataType(t),r=new Int32Array(t.length);for(let o=0,i=t.length;o<i;o++)r[o]=Math.round(t[o]*e);return{encodings:[{kind:"FixedPoint",factor:e,srcType:n}],data:r}}(e,t)},t.intervalQuantizaiton=function(t,e,n,r=Int32Array){return o=>function(t,e,n,r,o){const i=s.W.getDataType(t);if(!t.length)return{encodings:[{kind:"IntervalQuantization",min:e,max:n,numSteps:r,srcType:i}],data:new Int32Array(0)};if(n<e){const t=e;e=n,n=t}const a=(n-e)/(r-1),u=new o(t.length);for(let s=0,c=t.length;s<c;s++){const o=t[s];u[s]=o<=e?0:o>=n?r-1:0|Math.round((o-e)/a)}return{encodings:[{kind:"IntervalQuantization",min:e,max:n,numSteps:r,srcType:i}],data:u}}(o,t,e,n,r)},t.runLength=function(t){let e=s.W.getDataType(t);if(void 0===e&&(t=new Int32Array(t),e=s.W.IntDataType.Int32),!t.length)return{encodings:[{kind:"RunLength",srcType:e,srcSize:0}],data:new Int32Array(0)};let n=2;for(let s=1,a=t.length;s<a;s++)t[s-1]!==t[s]&&(n+=2);const r=new Int32Array(n);let o=0,i=1;for(let s=1,a=t.length;s<a;s++)t[s-1]!==t[s]?(r[o]=t[s-1],r[o+1]=i,i=1,o+=2):++i;return r[o]=t[t.length-1],r[o+1]=i,{encodings:[{kind:"RunLength",srcType:e,srcSize:t.length}],data:r}},t.delta=function(t){if(!s.W.isSignedIntegerDataType(t))throw new Error("Only signed integer types can be encoded using delta encoding.");let e=s.W.getDataType(t);if(void 0===e&&(t=new Int32Array(t),e=s.W.IntDataType.Int32),!t.length)return{encodings:[{kind:"Delta",origin:0,srcType:e}],data:new t.constructor(0)};const n=new t.constructor(t.length),r=t[0];n[0]=t[0];for(let o=1,i=t.length;o<i;o++)n[o]=t[o]-t[o-1];return n[0]=0,{encodings:[{kind:"Delta",origin:r,srcType:e}],data:n}},t.integerPacking=function(t){const e=function(t){const e=function(t){for(let e=0,n=t.length;e<n;e++)if(t[e]<0)return!0;return!1}(t),n=e?c(t,127):o(t,255),r=e?c(t,32767):o(t,65535);return 4*t.length<2*r?{isSigned:e,size:t.length,bytesPerElement:4}:2*r<n?{isSigned:e,size:r,bytesPerElement:2}:{isSigned:e,size:n,bytesPerElement:1}}(t);return 4===e.bytesPerElement?r(t):function(t,e){const n=e.isSigned?1===e.bytesPerElement?127:32767:1===e.bytesPerElement?255:65535,o=-n-1,i=t.length,s=e.isSigned?1===e.bytesPerElement?new Int8Array(e.size):new Int16Array(e.size):1===e.bytesPerElement?new Uint8Array(e.size):new Uint16Array(e.size);let a=0;for(let r=0;r<i;r++){let e=t[r];if(e>=0)for(;e>=n;)s[a]=n,++a,e-=n;else for(;e<=o;)s[a]=o,++a,e-=o;s[a]=e,++a}const u=r(s);return{encodings:[{kind:"IntegerPacking",byteCount:e.bytesPerElement,isUnsigned:!e.isSigned,srcSize:i},u.encodings[0]],data:u.data}}(t,e)},t.stringArray=function(t){const e=Object.create(null),n=[],r=new Int32Array(t.length),o=i.Gm.create(Int32Array,1,Math.min(1024,t.length<32?t.length+1:Math.round(t.length/8)+1));i.Gm.add(o,0);let s=0,u=0;for(const a of t){if(null==a){r[u++]=-1;continue}let t=e[a];void 0===t&&(s+=a.length,t=n.length,n[t]=a,e[a]=t,i.Gm.add(o,s)),r[u++]=t}const c=i.Gm.compact(o),l=(0,a.P)(c).encode(c),d=(0,a.P)(r).encode(r);return{encodings:[{kind:"StringArray",dataEncoding:d.encoding,stringData:n.join(""),offsetEncoding:l.encoding,offsets:l.data}],data:d.data}}}(o||(o={}))}}]);
//# sourceMappingURL=f54b42984bfe4d114461fcea2710af414ac1fe74-5091fb9d4835f1329e10.js.map